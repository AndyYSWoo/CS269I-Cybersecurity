{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2015-02-25T14:29:00.281Z", 
    "voters": [
        "fantam1", 
        "spetr0x"
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "600.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 47495, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": null, 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "Same Origin Policy bypass", 
    "is_member_of_team?": null, 
    "vote_count": 2, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2015-03-27T14:29:01.124Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$600", 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2015-02-12T14:05:21.546Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-02-12T14:05:21.546Z", 
            "actor": {
                "username": "3apa3a", 
                "url": "/3apa3a", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/004/836/cdfc44e3113144e4f71fc0a61c9c9195e2f0ccbf_medium.jpg?1397167861"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mailru", 
            "message": "Thank you for reporting your bug to Mail.Ru Group!   We appreciate your time for helping us to make our web services safer.\n\nI have confirmed your report, and it was escalated. You will be noticed when we prepare a fix, stay in touch.\nBut I must notice, your report is not in a bug bounty program's scope. Please review [bug bounty program rules](https://hackerone.com/mailru).  ", 
            "markdown_message": "<p>Thank you for reporting your bug to Mail.Ru Group!   We appreciate your time for helping us to make our web services safer.</p>\n\n<p>I have confirmed your report, and it was escalated. You will be noticed when we prepare a fix, stay in touch.<br>\nBut I must notice, your report is not in a bug bounty program&#39;s scope. Please review <a href=\"https://hackerone.com/mailru\">bug bounty program rules</a>.  </p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 330951, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-02-12T14:55:43.783Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-02-12T14:55:43.783Z", 
            "actor": {
                "username": "zoczus", 
                "url": "/zoczus", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/124/7d8a1378a5d4a23e984126b6fdcb10132dc2be35_medium.htm?1386865149"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mailru", 
            "message": "Hello,\n\nThanks for fast reply. \n\nIt's strange - I've read your program rules carefully and as far as I know e.mail.ru (your e-mail service) is the critical one that are in scope. As I said in my report - it works for https://mail.ru AND https://e.mail.ru which is in scope. PoC shows only mail.ru one, but in e.mail.ru we are also able to bypass Same Origin Policy. Please, can you explain me why it isn't in scope? \n\nThanks!", 
            "markdown_message": "<p>Hello,</p>\n\n<p>Thanks for fast reply. </p>\n\n<p>It&#39;s strange - I&#39;ve read your program rules carefully and as far as I know e.mail.ru (your e-mail service) is the critical one that are in scope. As I said in my report - it works for <a title=\"https://mail.ru\" href=\"/redirect?signature=81d202de3049f9940ccb9ddf08d1694d2db8eb45&amp;url=https%3A%2F%2Fmail.ru\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://mail.ru</span><i class=\"icon-external-link\"></i></a> AND <a title=\"https://e.mail.ru\" href=\"/redirect?signature=a883b4ad0a9b80fb0bb356e4634198a3d8ebf449&amp;url=https%3A%2F%2Fe.mail.ru\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://e.mail.ru</span><i class=\"icon-external-link\"></i></a> which is in scope. PoC shows only mail.ru one, but in e.mail.ru we are also able to bypass Same Origin Policy. Please, can you explain me why it isn&#39;t in scope? </p>\n\n<p>Thanks!</p>\n", 
            "type": "Activities::Comment", 
            "id": 330981, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-02-12T15:14:34.495Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-02-12T15:14:34.495Z", 
            "actor": {
                "username": "3apa3a", 
                "url": "/3apa3a", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/004/836/cdfc44e3113144e4f71fc0a61c9c9195e2f0ccbf_medium.jpg?1397167861"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mailru", 
            "message": "This bug is in files.mail.ru, not in e.mail.ru and impact is same with XSS on any of .mail.ru domains outside the scope.\nIf you can demonstrate access to e.g. user's mail on e.mail.ru I will escalate it and include into scope.", 
            "markdown_message": "<p>This bug is in files.mail.ru, not in e.mail.ru and impact is same with XSS on any of .mail.ru domains outside the scope.<br>\nIf you can demonstrate access to e.g. user&#39;s mail on e.mail.ru I will escalate it and include into scope.</p>\n", 
            "type": "Activities::Comment", 
            "id": 330993, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-02-12T15:30:24.469Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-02-12T15:30:24.469Z", 
            "actor": {
                "username": "zoczus", 
                "url": "/zoczus", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/124/7d8a1378a5d4a23e984126b6fdcb10132dc2be35_medium.htm?1386865149"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mailru", 
            "message": "Ok - but I need more time to prepare exploit code. That's why if you're planing to remove / fix this uploader - please save previous version in some random name like uploader_82df5cbdaae9c4dc5b32f8a12ffc096c.swf for test purposes, to prove you that I'm able to read mails. ;-) Is that ok for you? I won't share this filename with anyone, just want to have still some testing enviorment. ", 
            "markdown_message": "<p>Ok - but I need more time to prepare exploit code. That&#39;s why if you&#39;re planing to remove / fix this uploader - please save previous version in some random name like uploader_82df5cbdaae9c4dc5b32f8a12ffc096c.swf for test purposes, to prove you that I&#39;m able to read mails. ;-) Is that ok for you? I won&#39;t share this filename with anyone, just want to have still some testing enviorment. </p>\n", 
            "type": "Activities::Comment", 
            "id": 330996, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-02-12T21:21:11.970Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-02-12T21:21:11.970Z", 
            "actor": {
                "username": "zoczus", 
                "url": "/zoczus", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/124/7d8a1378a5d4a23e984126b6fdcb10132dc2be35_medium.htm?1386865149"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mailru", 
            "message": "Stay tuned - exploit for reading user e-mails is in progress. I'd probably send you final version today. Thanks!", 
            "markdown_message": "<p>Stay tuned - exploit for reading user e-mails is in progress. I&#39;d probably send you final version today. Thanks!</p>\n", 
            "type": "Activities::Comment", 
            "id": 331177, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-02-12T23:05:38.693Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-02-12T23:05:38.693Z", 
            "actor": {
                "username": "zoczus", 
                "url": "/zoczus", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/124/7d8a1378a5d4a23e984126b6fdcb10132dc2be35_medium.htm?1386865149"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mailru", 
            "message": "Ok - I've got it. You'd probably need some additional informations about technique I used here (details are in initial report, but few changes was made).\n\nSo... using initial report technique I'm able to make cross-origin requests and gain responses. The main problem was that your HTML content have escaped 0x22 (apostrophe) char. When the content was sent to javascript callback - only 0x22 chars are escaped by flash, but as far as it was escaped before - the double escape happened and we had \\\\\" chars that broke syntax and I was unable to get the e.mail.ru html content. I worked hard all day to make some trick and ES6 (http://en.wikipedia.org/wiki/ECMAScript) supported for example in latest Firefox. In ES6 - we don't need to use 0x22 or 0x27 chars to construct strings - we can use backticks. ;) So the new, full attack scenario to read user's emails is:\n\n1.  We use initial Proof of Concept to get user's email (your API needs it). [index.php]\n2. After gaining e-mail - we pass it to gettoken.php as GET parameter.\n3. We're calling https://e.mail.ru/password/restore/?login=zuezuozuezuo`;//hehe and using gogo` as callback [gettoken.php]\n4. The flash will construct this kind of function call:\n\ngogo`<html>cotent with escaped apostrophes \\\" and double-escaped apostrophes \\\\\" and it won't break snytax (...) zuezuozuezuo`;//hehe rest of html content</html>)}catch(e)(...)\n\nUsing this trick we will gain part of html content - but we are able to extract API token from there. \n\n5. After parsing output and gaining token - we pass it (with login stolen before) to getthreads.php\n6. We have API token , user's email and we are able to gain JSON content from https://e.mail.ru/api/v1/threads/status method\n7. We're parsing JSON, get list of thread's subjects and thread ids. \n8. Using any thread ID we are able to pass it to getemail.php\n9. We are making request to https://e.mail.ru/cgi-bin/getmsg  and gaining e-mail content.\n10. Profit. :-)\n\nThe scenario above is available as video demonstration here: https://www.youtube.com/watch?v=4AZyFVVnLE8\n\nI hope now this bug is in scope. ;-) \n\nHave a nice day!\nJZ", 
            "markdown_message": "<p>Ok - I&#39;ve got it. You&#39;d probably need some additional informations about technique I used here (details are in initial report, but few changes was made).</p>\n\n<p>So... using initial report technique I&#39;m able to make cross-origin requests and gain responses. The main problem was that your HTML content have escaped 0x22 (apostrophe) char. When the content was sent to javascript callback - only 0x22 chars are escaped by flash, but as far as it was escaped before - the double escape happened and we had \\&quot; chars that broke syntax and I was unable to get the e.mail.ru html content. I worked hard all day to make some trick and ES6 (<a title=\"http://en.wikipedia.org/wiki/ECMAScript\" href=\"/redirect?signature=9904338decbce2feb131200045317a92036d5e2f&amp;url=http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FECMAScript\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://en.wikipedia.org/wiki/ECMAScript</span><i class=\"icon-external-link\"></i></a>) supported for example in latest Firefox. In ES6 - we don&#39;t need to use 0x22 or 0x27 chars to construct strings - we can use backticks. ;) So the new, full attack scenario to read user&#39;s emails is:</p>\n\n<ol>\n<li> We use initial Proof of Concept to get user&#39;s email (your API needs it). [index.php]</li>\n<li>After gaining e-mail - we pass it to gettoken.php as GET parameter.</li>\n<li>We&#39;re calling <a title=\"https://e.mail.ru/password/restore/?login=zuezuozuezuo%60%3B//hehe\" href=\"/redirect?signature=6eb2d3d5215e3e785540324a6c6fecd1379e86fb&amp;url=https%3A%2F%2Fe.mail.ru%2Fpassword%2Frestore%2F%3Flogin%3Dzuezuozuezuo%2560%253B%2F%2Fhehe\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://e.mail.ru/password/restore/?login=zuezuozuezuo%60%3B//hehe</span><i class=\"icon-external-link\"></i></a> and using gogo` as callback [gettoken.php]</li>\n<li>The flash will construct this kind of function call:</li>\n</ol>\n\n<p>gogo<code>&lt;html&gt;cotent with escaped apostrophes \\&quot; and double-escaped apostrophes \\\\&quot; and it won&#39;t break snytax (...) zuezuozuezuo</code>;//hehe rest of html content&lt;/html&gt;)}catch(e)(...)</p>\n\n<p>Using this trick we will gain part of html content - but we are able to extract API token from there. </p>\n\n<ol>\n<li>After parsing output and gaining token - we pass it (with login stolen before) to getthreads.php</li>\n<li>We have API token , user&#39;s email and we are able to gain JSON content from <a title=\"https://e.mail.ru/api/v1/threads/status\" href=\"/redirect?signature=ac4094ad883b3c194f411156a7b231a6463b0052&amp;url=https%3A%2F%2Fe.mail.ru%2Fapi%2Fv1%2Fthreads%2Fstatus\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://e.mail.ru/api/v1/threads/status</span><i class=\"icon-external-link\"></i></a> method</li>\n<li>We&#39;re parsing JSON, get list of thread&#39;s subjects and thread ids. </li>\n<li>Using any thread ID we are able to pass it to getemail.php</li>\n<li>We are making request to <a title=\"https://e.mail.ru/cgi-bin/getmsg\" href=\"/redirect?signature=eebb6343e24cc2574802c11005fa7d65861b8636&amp;url=https%3A%2F%2Fe.mail.ru%2Fcgi-bin%2Fgetmsg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://e.mail.ru/cgi-bin/getmsg</span><i class=\"icon-external-link\"></i></a>  and gaining e-mail content.</li>\n<li>Profit. :-)</li>\n</ol>\n\n<p>The scenario above is available as video demonstration here: <a title=\"https://www.youtube.com/watch?v=4AZyFVVnLE8\" href=\"/redirect?signature=02677f81104615a75a7ae94fa3405f8edc553eb9&amp;url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3D4AZyFVVnLE8\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.youtube.com/watch?v=4AZyFVVnLE8</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>I hope now this bug is in scope. ;-) </p>\n\n<p>Have a nice day!<br>\nJZ</p>\n", 
            "type": "Activities::Comment", 
            "id": 331256, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-02-12T23:06:31.576Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-02-12T23:06:31.576Z", 
            "actor": {
                "username": "zoczus", 
                "url": "/zoczus", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/124/7d8a1378a5d4a23e984126b6fdcb10132dc2be35_medium.htm?1386865149"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mailru", 
            "message": "Sorry for that, but markdown uses backticks (0x60) char to code. \n\nIf anything is not clear for you or you have any questions - feel free to ask me. ", 
            "markdown_message": "<p>Sorry for that, but markdown uses backticks (0x60) char to code. </p>\n\n<p>If anything is not clear for you or you have any questions - feel free to ask me. </p>\n", 
            "type": "Activities::Comment", 
            "id": 331257, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-02-13T00:08:58.520Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-02-13T00:08:58.520Z", 
            "actor": {
                "username": "3apa3a", 
                "url": "/3apa3a", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/004/836/cdfc44e3113144e4f71fc0a61c9c9195e2f0ccbf_medium.jpg?1397167861"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mailru", 
            "message": "at this point\n\n> We have API token , user's email and we are able to gain JSON content from https://e.mail.ru/api/v1/threads/status method\n\nyou need either to be able to bypass crossorigin policy for AJAX request with XMLHttpRequest or to access http-only ssdc cookie for e.mail.ru domain to request ajax via flash. Have you succeeded with it? Can you demonstrate a PoC?", 
            "markdown_message": "<p>at this point</p>\n\n<blockquote>\n<p>We have API token , user&#39;s email and we are able to gain JSON content from <a title=\"https://e.mail.ru/api/v1/threads/status\" href=\"/redirect?signature=ac4094ad883b3c194f411156a7b231a6463b0052&amp;url=https%3A%2F%2Fe.mail.ru%2Fapi%2Fv1%2Fthreads%2Fstatus\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://e.mail.ru/api/v1/threads/status</span><i class=\"icon-external-link\"></i></a> method</p>\n</blockquote>\n\n<p>you need either to be able to bypass crossorigin policy for AJAX request with XMLHttpRequest or to access http-only ssdc cookie for e.mail.ru domain to request ajax via flash. Have you succeeded with it? Can you demonstrate a PoC?</p>\n", 
            "type": "Activities::Comment", 
            "id": 331308, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-02-13T00:18:52.372Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-02-13T00:18:52.372Z", 
            "actor": {
                "username": "zoczus", 
                "url": "/zoczus", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/124/7d8a1378a5d4a23e984126b6fdcb10132dc2be35_medium.htm?1386865149"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mailru", 
            "message": "Full automated PoC (when working) is showed on video.\n\nThe PoC is constructed in way that we gain some info (like token), redirect to another file with GET param and then send another request, and another. Here are the links:\n\nhttps://eip.uid0.pl/mailru/index.php\nhttps://eip.uid0.pl/mailru/gettoken.php\nhttps://eip.uid0.pl/mailru/getthreads.php\nhttps://eip.uid0.pl/mailru/getemail.php\n\n(the normal php code just insert login, token, and id in some points). \n\nBTW as I already said the PoC is for Firefox only, but it would work in other browsers when ES6 would be enabled everywhere this year ;-) \n\nEvery flash request that I made succeed and flash handled (part or full) content from https://e.mail.ru/ and succesfully forwarded it to my callback in eip.uid0.pl origin. So the final answer is yes - I've succeeded with it. ;) \n\nBest!", 
            "markdown_message": "<p>Full automated PoC (when working) is showed on video.</p>\n\n<p>The PoC is constructed in way that we gain some info (like token), redirect to another file with GET param and then send another request, and another. Here are the links:</p>\n\n<p><a title=\"https://eip.uid0.pl/mailru/index.php\" href=\"/redirect?signature=b5a3bc961551702b52edba8ce7134bc76a405317&amp;url=https%3A%2F%2Feip.uid0.pl%2Fmailru%2Findex.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://eip.uid0.pl/mailru/index.php</span><i class=\"icon-external-link\"></i></a><br>\n<a title=\"https://eip.uid0.pl/mailru/gettoken.php\" href=\"/redirect?signature=675374da289f924b83ea10dbdec7b294c46ec93c&amp;url=https%3A%2F%2Feip.uid0.pl%2Fmailru%2Fgettoken.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://eip.uid0.pl/mailru/gettoken.php</span><i class=\"icon-external-link\"></i></a><br>\n<a title=\"https://eip.uid0.pl/mailru/getthreads.php\" href=\"/redirect?signature=e133ccac76ad14ebfdb2932a3a7e75f4d7631069&amp;url=https%3A%2F%2Feip.uid0.pl%2Fmailru%2Fgetthreads.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://eip.uid0.pl/mailru/getthreads.php</span><i class=\"icon-external-link\"></i></a><br>\n<a title=\"https://eip.uid0.pl/mailru/getemail.php\" href=\"/redirect?signature=0fc1fa092ad24cc988e421b8dbadfef4818befc5&amp;url=https%3A%2F%2Feip.uid0.pl%2Fmailru%2Fgetemail.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://eip.uid0.pl/mailru/getemail.php</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>(the normal php code just insert login, token, and id in some points). </p>\n\n<p>BTW as I already said the PoC is for Firefox only, but it would work in other browsers when ES6 would be enabled everywhere this year ;-) </p>\n\n<p>Every flash request that I made succeed and flash handled (part or full) content from <a title=\"https://e.mail.ru/\" href=\"/redirect?signature=b35eafef66912a4ea22c4cd323c0270d319e9ebd&amp;url=https%3A%2F%2Fe.mail.ru%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://e.mail.ru/</span><i class=\"icon-external-link\"></i></a> and succesfully forwarded it to my callback in eip.uid0.pl origin. So the final answer is yes - I&#39;ve succeeded with it. ;) </p>\n\n<p>Best!</p>\n", 
            "type": "Activities::Comment", 
            "id": 331312, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-02-13T00:21:17.934Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-02-13T00:21:17.934Z", 
            "actor": {
                "username": "3apa3a", 
                "url": "/3apa3a", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/004/836/cdfc44e3113144e4f71fc0a61c9c9195e2f0ccbf_medium.jpg?1397167861"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mailru", 
            "message": "Thanks, we'll review it.", 
            "markdown_message": "<p>Thanks, we&#39;ll review it.</p>\n", 
            "type": "Activities::Comment", 
            "id": 331313, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-02-13T00:22:24.649Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-02-13T00:22:24.649Z", 
            "actor": {
                "username": "zoczus", 
                "url": "/zoczus", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/124/7d8a1378a5d4a23e984126b6fdcb10132dc2be35_medium.htm?1386865149"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mailru", 
            "message": "Great! :) Thanks\nJZ", 
            "markdown_message": "<p>Great! :) Thanks<br>\nJZ</p>\n", 
            "type": "Activities::Comment", 
            "id": 331314, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "zoczus", 
                "url": "/zoczus"
            }, 
            "created_at": "2015-02-16T14:33:48.770Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-02-16T14:33:48.770Z", 
            "actor": {
                "username": "kpebetka", 
                "url": "/kpebetka", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/152/0a6573cf90b97f189279a1ca1ce5acc17385ded2_medium.jpg?1518727729"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mailru", 
            "message": "Your bug has been fixed! \nPlease confirm that you are no longer able to reproduce the issue. We will now make a determination on compensation for this bug. Please be patient throughout this process! ", 
            "markdown_message": "<p>Your bug has been fixed! <br>\nPlease confirm that you are no longer able to reproduce the issue. We will now make a determination on compensation for this bug. Please be patient throughout this process! </p>\n", 
            "type": "Activities::BugResolved", 
            "id": 332805, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-02-16T14:40:19.414Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-02-16T14:40:19.414Z", 
            "actor": {
                "username": "zoczus", 
                "url": "/zoczus", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/124/7d8a1378a5d4a23e984126b6fdcb10132dc2be35_medium.htm?1386865149"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mailru", 
            "message": "Yup - I do confirm that this one is fixed. Thanks! ", 
            "markdown_message": "<p>Yup - I do confirm that this one is fixed. Thanks! </p>\n", 
            "type": "Activities::Comment", 
            "id": 332809, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2015-02-25T13:54:42.698Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-02-25T13:54:42.698Z", 
            "actor": {
                "url": "/mailru", 
                "profile": {
                    "name": "Mail.ru"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/065/07da688e1d8801d35fdb85376bd9d64e424e6dab_medium.png?1542897520"
                }
            }, 
            "team_handle": "mailru", 
            "bounty_amount": "600.0", 
            "collaborator": {
                "username": "zoczus", 
                "url": "/zoczus"
            }, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BountyAwarded", 
            "id": 339890, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-02-25T14:28:55.125Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-02-25T14:28:55.125Z", 
            "actor": {
                "username": "zoczus", 
                "url": "/zoczus", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/124/7d8a1378a5d4a23e984126b6fdcb10132dc2be35_medium.htm?1386865149"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mailru", 
            "message": "Awesome! Thank you! :) We can probably public disclose now, right? :) ", 
            "markdown_message": "<p>Awesome! Thank you! :) We can probably public disclose now, right? :) </p>\n", 
            "type": "Activities::Comment", 
            "id": 339911, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-02-25T14:29:00.339Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-02-25T14:29:00.339Z", 
            "actor": {
                "username": "zoczus", 
                "url": "/zoczus", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/124/7d8a1378a5d4a23e984126b6fdcb10132dc2be35_medium.htm?1386865149"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mailru", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 339912, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-02-26T16:24:04.456Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-02-26T16:24:04.456Z", 
            "actor": {
                "username": "3apa3a", 
                "url": "/3apa3a", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/004/836/cdfc44e3113144e4f71fc0a61c9c9195e2f0ccbf_medium.jpg?1397167861"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mailru", 
            "message": "Thanks for work. I will confirm disclosure after //mail.ru/crossdomain.xml is also fixed.", 
            "markdown_message": "<p>Thanks for work. I will confirm disclosure after //mail.ru/crossdomain.xml is also fixed.</p>\n", 
            "type": "Activities::Comment", 
            "id": 340900, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-03-27T14:29:13.305Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-03-27T14:29:13.305Z", 
            "actor": {
                "url": "/mailru", 
                "profile": {
                    "name": "Mail.ru"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/065/07da688e1d8801d35fdb85376bd9d64e424e6dab_medium.png?1542897520"
                }
            }, 
            "team_handle": "mailru", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 364530, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "zoczus", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/zoczus", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/124/63bfa611d02edad5dcd6f314ac45261ea63d1b04_small.htm?1386865149"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 45, 
        "name": "Cross-Site Request Forgery (CSRF)"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -116670754.85559517, 
    "disclosed_at": "2015-03-27T14:29:12.748Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/47495", 
    "created_at": "2015-02-12T00:35:46.540Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>Hi,</p>\n\n<p>After small investigation I&#39;ve probably found something that can be exploited to bypass Same Origin Policy on mail.ru services (specially your main domain and e.mail.ru). </p>\n\n<p>First of all - let&#39;s take a look about your crossdomain.xml (both for mail.ru and e.mail.ru):</p>\n\n<p>&lt;cross-domain-policy&gt;<br>\n&lt;allow-access-from domain=&quot;*.files.mail.ru&quot; to-ports=&quot;80&quot;/&gt;<br>\n&lt;allow-access-from domain=&quot;img.imgsmail.ru&quot; to-ports=&quot;80&quot;/&gt;<br>\n&lt;allow-access-from domain=&quot;win.mail.ru&quot; to-ports=&quot;80&quot;/&gt;<br>\n&lt;allow-access-from domain=&quot;e.mail.ru&quot; to-ports=&quot;80&quot;/&gt;<br>\n&lt;allow-access-from domain=&quot;*.corp.mail.ru&quot; to-ports=&quot;80&quot;/&gt;<br>\n&lt;allow-access-from domain=&quot;img.mail.ru&quot; to-ports=&quot;80&quot;/&gt;<br>\n&lt;site-control permitted-cross-domain-policies=&quot;all&quot;/&gt;<br>\n&lt;/cross-domain-policy&gt;</p>\n\n<p>After time spent on searching useful files I found flash uploader on files.mail.ru which is mentioned in crossdomain. </p>\n\n<p>Few important things about this Flash file (<a title=\"https://files.mail.ru/uploader9.swf):\" href=\"/redirect?signature=8e51a4fa8c41e0fad58933f2ef03c37a5f06e518&amp;url=https%3A%2F%2Ffiles.mail.ru%2Fuploader9.swf%29%3A\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://files.mail.ru/uploader9.swf):</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>1) It uses Security.allowDomain(&quot;*&quot;) which is extreamly dangerous<br>\n2) It have interesting callback to ajaxCall() method. </p>\n\n<p>I want to tell you more about ajaxCall() actionscript function - here&#39;s snippet: <a title=\"https://gist.github.com/ZoczuS/82ad1e7509dd436a2db9\" href=\"/redirect?signature=cbc4d061abff9dc0956ac0b17afba63b1d5d71ab&amp;url=https%3A%2F%2Fgist.github.com%2FZoczuS%2F82ad1e7509dd436a2db9\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://gist.github.com/ZoczuS/82ad1e7509dd436a2db9</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>You can see that before request will go on there are few checks - provided URL must starts with http:// schema, must have .mail.ru before first / (to prevent sending requests to other domain). Bypass is simple here - we can use username@hostname notation - http://<a title=\".mail.ru@lab.ropchain.org\" href=\"mailto:.mail.ru@lab.ropchain.org\" rel=\"nofollow noopener noreferrer\">.mail.ru@lab.ropchain.org</a>/r.php?r=<a title=\"https://any-other-url.com\" href=\"/redirect?signature=22af00168e6faeb653a269b9b836f18088550be3&amp;url=https%3A%2F%2Fany-other-url.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://any-other-url.com</span><i class=\"icon-external-link\"></i></a> ;-) (r.php returns 301 and redirects us where $_GET[&#39;r&#39;] tells). </p>\n\n<p>To make this attack even simpler - ajaxCall() function have js_callback parameter, where we can handle our Cross-Origin response, and parse it. </p>\n\n<p>So the example attack scenario goes like this:</p>\n\n<ol>\n<li>Attacker create specially crafted webpage where he embeds uploader9.swf</li>\n<li>Because of Security.allowDomain(&#39;*&#39;) we can interact with this file from any domain, so it works. </li>\n<li>Because ajax() callback we can send requests to any other webpage.</li>\n<li>Because of crossdomain.xml of mail.ru we can gain full response from mail.ru and pass it to our js_callback (that &quot;works&quot; for attacker&#39;s origin).</li>\n</ol>\n\n<p>In this scenario I&#39;ll call <a title=\"https://mail.ru/?json=1&amp;nano=0\" href=\"/redirect?signature=b82292d66a769ff1272d12c0726775d91824ec83&amp;url=https%3A%2F%2Fmail.ru%2F%3Fjson%3D1%26nano%3D0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://mail.ru/?json=1&amp;nano=0</span><i class=\"icon-external-link\"></i></a> that returns sort of informations about logged in user in JSON format. To watch exploit in action - visit this page: <a title=\"https://eip.uid0.pl/mail.php\" href=\"/redirect?signature=c191197aff891203387195c66bac00c51a1d3345&amp;url=https%3A%2F%2Feip.uid0.pl%2Fmail.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://eip.uid0.pl/mail.php</span><i class=\"icon-external-link\"></i></a> (it requires SSL, sorry for self-signed cert).</p>\n\n<p>Video demonstration: <a title=\"https://www.youtube.com/watch?v=iIUlSJ-Wvgk\" href=\"/redirect?signature=02691551c0005ce0f310c349c336887f93b5b38f&amp;url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DiIUlSJ-Wvgk\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.youtube.com/watch?v=iIUlSJ-Wvgk</span><i class=\"icon-external-link\"></i></a> (unlisted one - only me and you have this link)</p>\n\n<p>Thanks for reading it - have a nice day!<br>\nJakub Zoczek</p>\n", 
    "vulnerability_information": "Hi,\r\n\r\nAfter small investigation I've probably found something that can be exploited to bypass Same Origin Policy on mail.ru services (specially your main domain and e.mail.ru). \r\n\r\nFirst of all - let's take a look about your crossdomain.xml (both for mail.ru and e.mail.ru):\r\n\r\n<cross-domain-policy>\r\n<allow-access-from domain=\"*.files.mail.ru\" to-ports=\"80\"/>\r\n<allow-access-from domain=\"img.imgsmail.ru\" to-ports=\"80\"/>\r\n<allow-access-from domain=\"win.mail.ru\" to-ports=\"80\"/>\r\n<allow-access-from domain=\"e.mail.ru\" to-ports=\"80\"/>\r\n<allow-access-from domain=\"*.corp.mail.ru\" to-ports=\"80\"/>\r\n<allow-access-from domain=\"img.mail.ru\" to-ports=\"80\"/>\r\n<site-control permitted-cross-domain-policies=\"all\"/>\r\n</cross-domain-policy>\r\n\r\nAfter time spent on searching useful files I found flash uploader on files.mail.ru which is mentioned in crossdomain. \r\n\r\nFew important things about this Flash file (https://files.mail.ru/uploader9.swf):\r\n\r\n1) It uses Security.allowDomain(\"*\") which is extreamly dangerous\r\n2) It have interesting callback to ajaxCall() method. \r\n\r\nI want to tell you more about ajaxCall() actionscript function - here's snippet: https://gist.github.com/ZoczuS/82ad1e7509dd436a2db9\r\n\r\nYou can see that before request will go on there are few checks - provided URL must starts with http:// schema, must have .mail.ru before first / (to prevent sending requests to other domain). Bypass is simple here - we can use username@hostname notation - http://.mail.ru@lab.ropchain.org/r.php?r=HTTPS://ANY-OTHER-URL.COM ;-) (r.php returns 301 and redirects us where $_GET['r'] tells). \r\n\r\nTo make this attack even simpler - ajaxCall() function have js_callback parameter, where we can handle our Cross-Origin response, and parse it. \r\n\r\nSo the example attack scenario goes like this:\r\n1. Attacker create specially crafted webpage where he embeds uploader9.swf\r\n2. Because of Security.allowDomain('*') we can interact with this file from any domain, so it works. \r\n3. Because ajax() callback we can send requests to any other webpage.\r\n4. Because of crossdomain.xml of mail.ru we can gain full response from mail.ru and pass it to our js_callback (that \"works\" for attacker's origin).\r\n\r\nIn this scenario I'll call https://mail.ru/?json=1&nano=0 that returns sort of informations about logged in user in JSON format. To watch exploit in action - visit this page: https://eip.uid0.pl/mail.php (it requires SSL, sorry for self-signed cert).\r\n\r\nVideo demonstration: https://www.youtube.com/watch?v=iIUlSJ-Wvgk (unlisted one - only me and you have this link)\r\n\r\nThanks for reading it - have a nice day!\r\nJakub Zoczek", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://corp.mail.ru", 
            "about": "Leading Internet company in Europe", 
            "twitter_handle": "mailru", 
            "name": "Mail.ru"
        }, 
        "handle": "mailru", 
        "url": "https://hackerone.com/mailru", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/065/b5353ff7c53e16da116c7f4e73cc5687ec7d8809_small.png?1542897520", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/065/07da688e1d8801d35fdb85376bd9d64e424e6dab_medium.png?1542897520"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 65, 
        "default_currency": "usd"
    }, 
    "is_published": false
}