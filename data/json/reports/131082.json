{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2016-06-02T08:45:27.818Z", 
    "voters": [
        "detroitsmash", 
        "penrose", 
        "spetr0x", 
        "dyabla"
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "150.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 131082, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": null, 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "Open Redirector via (apps/files_pdfviewer) for un-authenticated users.", 
    "is_member_of_team?": null, 
    "vote_count": 4, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2016-07-02T08:45:28.007Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$150", 
    "attachments": [
        {
            "file_name": "POC2.jpg", 
            "type": "image/jpeg", 
            "id": 85810, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/085/810/a4c3ca26f8b79e1067cc190b4e0662c41a5a1cba/POC2.jpg?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T225217Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=d1d9e4ad2edd5f836e8efa5b91f01e3a351016af5f3c829aaf79cd99703b13ba"
        }, 
        {
            "file_name": "POC1.jpg", 
            "type": "image/jpeg", 
            "id": 85811, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/085/811/c43c7299ba59012455079b3584cf4499faded545/POC1.jpg?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T225217Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=8caadeb1ea90cf2f8872191527b5748771d806c326004a3abb78d742f5892997"
        }
    ], 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": true, 
            "created_at": "2016-04-15T12:37:01.422Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-04-15T12:37:01.422Z", 
            "actor": {
                "url": "/owncloud", 
                "profile": {
                    "name": "ownCloud"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/059/6af0ec24c370d0d2250fdf2ac3e937f4aab2692d_medium.png?1438786688"
                }
            }, 
            "team_handle": "owncloud", 
            "message": "Thanks a lot for reporting this potential issue back to us. We take security very seriously and would appreciate if you would not share any information about this bug until we have determined a potential patch.\r\n \r\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster.", 
            "markdown_message": "<p>Thanks a lot for reporting this potential issue back to us. We take security very seriously and would appreciate if you would not share any information about this bug until we have determined a potential patch.</p>\n\n<p>Our security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster.</p>\n", 
            "type": "Activities::Comment", 
            "id": 907740, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-04-15T12:51:47.970Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-04-15T12:51:47.970Z", 
            "actor": {
                "username": "lukasreschke", 
                "url": "/lukasreschke", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/037/891/0ddfc05411893988a0d2794cd70d5dc221729713_medium.png?1438782834"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "owncloud", 
            "message": "Nice catch, @businessprotect! Thanks a lot for reporting this issue back to us.\n\nI can reproduce this behaviour using Firefox. When opening the link in Chrome this is not reproducible.\n\nI've filed an internal ticket and we'll get this sorted out for our next minor releases to be released within 3 weeks. I'll keep you updated once we determined a potential patch and will mark this issue as resolved once the patch has been released.", 
            "markdown_message": "<p>Nice catch, <a href=\"/businessprotect\">@businessprotect</a>! Thanks a lot for reporting this issue back to us.</p>\n\n<p>I can reproduce this behaviour using Firefox. When opening the link in Chrome this is not reproducible.</p>\n\n<p>I&#39;ve filed an internal ticket and we&#39;ll get this sorted out for our next minor releases to be released within 3 weeks. I&#39;ll keep you updated once we determined a potential patch and will mark this issue as resolved once the patch has been released.</p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 907756, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-04-20T09:33:12.009Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-04-20T09:33:12.009Z", 
            "actor": {
                "username": "penrose", 
                "url": "/penrose", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/068/816/bee966b5c2d2902a9d80733bca58dfbb6a36e403_medium.png?1483569948"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "owncloud", 
            "message": "I think the bug reported is due to a bad Permissive Access-Control-Allow-Origin Cross-origin. \nCheck this:\nhttps://github.com/mozilla/pdf.js/pull/6916\n\nI have also reproduced the bug using Internet Explorer.\n\n", 
            "markdown_message": "<p>I think the bug reported is due to a bad Permissive Access-Control-Allow-Origin Cross-origin. <br>\nCheck this:<br>\n<a title=\"https://github.com/mozilla/pdf.js/pull/6916\" href=\"/redirect?signature=748f44f0abee4c1783054fa9782541d2d5d2df2f&amp;url=https%3A%2F%2Fgithub.com%2Fmozilla%2Fpdf.js%2Fpull%2F6916\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/mozilla/pdf.js/pull/6916</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>I have also reproduced the bug using Internet Explorer.</p>\n", 
            "type": "Activities::Comment", 
            "id": 916825, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-04-20T15:36:44.821Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-04-20T15:36:44.821Z", 
            "actor": {
                "username": "lukasreschke", 
                "url": "/lukasreschke", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/037/891/0ddfc05411893988a0d2794cd70d5dc221729713_medium.png?1438782834"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "owncloud", 
            "message": "Very good hint, thank you @businessprotect. I'll investigate to get pdf.js updated to this as well, we're also working on adding SameSite cookies for this endpoint as well. :)", 
            "markdown_message": "<p>Very good hint, thank you <a href=\"/businessprotect\">@businessprotect</a>. I&#39;ll investigate to get pdf.js updated to this as well, we&#39;re also working on adding SameSite cookies for this endpoint as well. :)</p>\n", 
            "type": "Activities::Comment", 
            "id": 917913, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-04-20T15:57:53.427Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-04-20T15:57:53.427Z", 
            "actor": {
                "username": "penrose", 
                "url": "/penrose", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/068/816/bee966b5c2d2902a9d80733bca58dfbb6a36e403_medium.png?1483569948"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "owncloud", 
            "message": "FYI. I have talked with the guys in Mozilla probably they already got to you.", 
            "markdown_message": "<p>FYI. I have talked with the guys in Mozilla probably they already got to you.</p>\n", 
            "type": "Activities::Comment", 
            "id": 917950, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-04-20T15:59:27.608Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-04-20T15:59:27.608Z", 
            "actor": {
                "username": "lukasreschke", 
                "url": "/lukasreschke", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/037/891/0ddfc05411893988a0d2794cd70d5dc221729713_medium.png?1438782834"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "owncloud", 
            "message": "That explains [owncloud/files_pdfviewer#107](https://github.com/owncloud/files_pdfviewer/issues/107) then :-)", 
            "markdown_message": "<p>That explains <a href=\"/redirect?signature=c21d5b34e478e0a9df8967094447497a9f08de35&amp;url=https%3A%2F%2Fgithub.com%2Fowncloud%2Ffiles_pdfviewer%2Fissues%2F107\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>owncloud/files_pdfviewer#107</span><i class=\"icon-external-link\"></i></a> then :-)</p>\n", 
            "type": "Activities::Comment", 
            "id": 917953, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-04-21T15:02:43.381Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-04-21T15:02:50.168Z", 
            "actor": {
                "username": "lukasreschke", 
                "url": "/lukasreschke", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/037/891/0ddfc05411893988a0d2794cd70d5dc221729713_medium.png?1438782834"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "owncloud", 
            "message": "We've gone over some of the options here and our plan is the following:\n\n1. For our next minor releases we are going to add code to ensure that the page can only be load iframed. If not it will redirect to the ownCloud instance.\n2. For our next major release we are going to update pdf.js and will also add support for SameSite cookies with a `strict` policy for the endpoint as a further hardening.\n\nThe Pull Requests can be found here, due to the fact that this is a rather low severity issue we have created them in the public: \n\n- stable7: https://github.com/owncloud/files_pdfviewer/pull/113\n- stable8: https://github.com/owncloud/files_pdfviewer/pull/112\n- stable8.1: https://github.com/owncloud/files_pdfviewer/pull/111\n- stable8.2: https://github.com/owncloud/files_pdfviewer/pull/110\n- stable9: https://github.com/owncloud/files_pdfviewer/pull/109\n- master: https://github.com/owncloud/files_pdfviewer/pull/108\n\nYou're more than invited to test these patches if you have some spare minutes.\n\nWe're going to include this within our next maintenance release to be released in early May 2016. Our policy is to publicly disclose every fixed security bug 14 days after release and also issue an security advisory on https://owncloud.org/security/advisories/. Please do not share any information to third-parties before.\n\nOur advisories usually contain:\n\n- Real Name (or pseudonyme)\n- Company name (optional)\n- Mail address (optional) \n\nPlease let us know as much of above information so we can draft an advisory and properly credit you for the finding on that as well.", 
            "markdown_message": "<p>We&#39;ve gone over some of the options here and our plan is the following:</p>\n\n<ol>\n<li>For our next minor releases we are going to add code to ensure that the page can only be load iframed. If not it will redirect to the ownCloud instance.</li>\n<li>For our next major release we are going to update pdf.js and will also add support for SameSite cookies with a <code>strict</code> policy for the endpoint as a further hardening.</li>\n</ol>\n\n<p>The Pull Requests can be found here, due to the fact that this is a rather low severity issue we have created them in the public: </p>\n\n<ul>\n<li>stable7: <a title=\"https://github.com/owncloud/files_pdfviewer/pull/113\" href=\"/redirect?signature=625875e6b71b1375d511ae6ca8167a851e4987d5&amp;url=https%3A%2F%2Fgithub.com%2Fowncloud%2Ffiles_pdfviewer%2Fpull%2F113\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/owncloud/files_pdfviewer/pull/113</span><i class=\"icon-external-link\"></i></a>\n</li>\n<li>stable8: <a title=\"https://github.com/owncloud/files_pdfviewer/pull/112\" href=\"/redirect?signature=e61c168190b014ec6922cd6f8abb0bf2fdfbe498&amp;url=https%3A%2F%2Fgithub.com%2Fowncloud%2Ffiles_pdfviewer%2Fpull%2F112\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/owncloud/files_pdfviewer/pull/112</span><i class=\"icon-external-link\"></i></a>\n</li>\n<li>stable8.1: <a title=\"https://github.com/owncloud/files_pdfviewer/pull/111\" href=\"/redirect?signature=7456781aa3b15ec30b1fb9fdb2b28752e79351d4&amp;url=https%3A%2F%2Fgithub.com%2Fowncloud%2Ffiles_pdfviewer%2Fpull%2F111\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/owncloud/files_pdfviewer/pull/111</span><i class=\"icon-external-link\"></i></a>\n</li>\n<li>stable8.2: <a title=\"https://github.com/owncloud/files_pdfviewer/pull/110\" href=\"/redirect?signature=c9fd01b0b76b79e8a1cd070b43a074fd9293f74d&amp;url=https%3A%2F%2Fgithub.com%2Fowncloud%2Ffiles_pdfviewer%2Fpull%2F110\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/owncloud/files_pdfviewer/pull/110</span><i class=\"icon-external-link\"></i></a>\n</li>\n<li>stable9: <a title=\"https://github.com/owncloud/files_pdfviewer/pull/109\" href=\"/redirect?signature=1408d6d1329ea362fa3af20fcda26894c8f5b79b&amp;url=https%3A%2F%2Fgithub.com%2Fowncloud%2Ffiles_pdfviewer%2Fpull%2F109\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/owncloud/files_pdfviewer/pull/109</span><i class=\"icon-external-link\"></i></a>\n</li>\n<li>master: <a title=\"https://github.com/owncloud/files_pdfviewer/pull/108\" href=\"/redirect?signature=08b49fae00de522189fcab1424751b71b9a59a29&amp;url=https%3A%2F%2Fgithub.com%2Fowncloud%2Ffiles_pdfviewer%2Fpull%2F108\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/owncloud/files_pdfviewer/pull/108</span><i class=\"icon-external-link\"></i></a>\n</li>\n</ul>\n\n<p>You&#39;re more than invited to test these patches if you have some spare minutes.</p>\n\n<p>We&#39;re going to include this within our next maintenance release to be released in early May 2016. Our policy is to publicly disclose every fixed security bug 14 days after release and also issue an security advisory on <a title=\"https://owncloud.org/security/advisories/\" href=\"/redirect?signature=debb48cc31fa3c69e628fe0e5ff77df2c8c1b837&amp;url=https%3A%2F%2Fowncloud.org%2Fsecurity%2Fadvisories%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://owncloud.org/security/advisories/</span><i class=\"icon-external-link\"></i></a>. Please do not share any information to third-parties before.</p>\n\n<p>Our advisories usually contain:</p>\n\n<ul>\n<li>Real Name (or pseudonyme)</li>\n<li>Company name (optional)</li>\n<li>Mail address (optional) </li>\n</ul>\n\n<p>Please let us know as much of above information so we can draft an advisory and properly credit you for the finding on that as well.</p>\n", 
            "type": "Activities::Comment", 
            "id": 920448, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-04-21T15:28:06.476Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-04-21T15:28:06.476Z", 
            "actor": {
                "username": "penrose", 
                "url": "/penrose", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/068/816/bee966b5c2d2902a9d80733bca58dfbb6a36e403_medium.png?1483569948"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "owncloud", 
            "message": "Thank you for the cooperation. The release/patch plan seems fine. I will continue testing the code after your patch. There is not going to be any third party information sharing on my side till you resolve the issue.\n\nWhen published in your advisory you can use the following:\n\n    Company name (optional)  = Businessprotect.gr\n    Mail address (optional) =info@businessprotect.gr\n \n\n\n\n", 
            "markdown_message": "<p>Thank you for the cooperation. The release/patch plan seems fine. I will continue testing the code after your patch. There is not going to be any third party information sharing on my side till you resolve the issue.</p>\n\n<p>When published in your advisory you can use the following:</p>\n<pre class=\"highlight plaintext\"><code>Company name (optional)  = Businessprotect.gr\nMail address (optional) =info@businessprotect.gr\n</code></pre>", 
            "type": "Activities::Comment", 
            "id": 920501, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-04T07:52:26.259Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-04T07:52:26.259Z", 
            "actor": {
                "username": "lukasreschke", 
                "url": "/lukasreschke", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/037/891/0ddfc05411893988a0d2794cd70d5dc221729713_medium.png?1438782834"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "owncloud", 
            "message": "Thanks a lot for your report again. This vulnerability has been fixed with the releases, released yesterday. (https://owncloud.com/blog-owncloud-9-0-2-8-2-4-8-1-7-8-0-12-7-0-14-available/)\n\nWe will now proceed as following: \n\n1. After 14 days we will publish the security advisory as proposed below. Please let us know if you wish changes.\n2. The bug bounty panel will decide on the bounty that we can issue for this vulnerability.\n\nI'll keep you in the loop.\n\n-------------\n\n**Proposed advisory:**\n```\n# Open Redirector involving user interaction (oC-SA-2016-007)\n- 2th May 2016\n- Risk Level: Low\n- CVSS v3 Base Score: 4.3 (CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N)\n- CWE: URL Redirection to Untrusted Site ('Open Redirect') (CWE-601)\n\n##\u00a0Description\n\nAn open redirect vulnerability has been found in the way that ownCloud implemented PDF.js, a successful exploitation of this vulnerability requires multiple pre-requisites:\n\n1. User has to use a Gecko based browser (e.g. Mozilla Firefox)\n2. User has to open a link sent by the adversary\n3. User has to click on the small \"Download\" button in the top right of the PDF viewer.\n\nOnce an user has performed this step they are redirected to the URL passed as a GET parameter.\n\nNote: The user will be displayed a warning that the PDF file can't be loaded properly.\n\n## Affected software\n- ownCloud Server < 7.0.14 (CVE assignment pending)\n\t- files_pdfviewer/c69858a421b2cad219a0ea580c1ef4e0e2c9877f\n- ownCloud Server < 8.0.12 (CVE assignment pending)\n\t- files_pdfviewer/54b78d9053dac0195adbebb23dad71d43ab2f6b2\n- ownCloud Server < 8.1.7 (CVE assignment pending)\n\t- files_pdfviewer/31d4e53fe6e47353c1e7ba15ed07df29e1c174c9\n- ownCloud Server < 8.2.4 (CVE assignment pending)\n\t- files_pdfviewer/9ab7ca2e5eabea43d18b97d4622ebea30fa09a92\n- ownCloud Server < 9.0.2 (CVE assignment pending)\n\t- files_pdfviewer/a1445f0f8bf28eed89c1f56682bbb6fe574b4ecf\n\n##\u00a0Action Taken\n\nThe PDF viewer has been configured that it can only be opened via iframes. Since as a clickjacking attack the X-Frame-Options header is employed as well this doesn't make it possible to send users anymore malicious links.\n\nAs a further step for the 9.1 release of ownCloud the following changes are planned to mitigate such attack vectors even more:\n\n1. Update the PDF.js library to a version that supports whitelisting of target domains. For reference please see\u00a0https://github.com/mozilla/pdf.js/pull/6916\n2. Employ Same-Site-Cookies with a strict policy on this endpoint. Browsers supporting Same-Site-Cookies will not make it possible to access such resources directly anymore. For reference please see https://github.com/owncloud/core/pull/24092\n\n##\u00a0Acknowledgements\n\nThe ownCloud team thanks the following people for their research and responsible disclosure of the above advisory:\n\n- Businessprotect.gr (info@businessprotect.gr) - Vulnerability discovery and disclosure.\n```\n", 
            "markdown_message": "<p>Thanks a lot for your report again. This vulnerability has been fixed with the releases, released yesterday. (<a title=\"https://owncloud.com/blog-owncloud-9-0-2-8-2-4-8-1-7-8-0-12-7-0-14-available/\" href=\"/redirect?signature=5fa9e19066bff1a82edef0d8d82442f86c03d557&amp;url=https%3A%2F%2Fowncloud.com%2Fblog-owncloud-9-0-2-8-2-4-8-1-7-8-0-12-7-0-14-available%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://owncloud.com/blog-owncloud-9-0-2-8-2-4-8-1-7-8-0-12-7-0-14-available/</span><i class=\"icon-external-link\"></i></a>)</p>\n\n<p>We will now proceed as following: </p>\n\n<ol>\n<li>After 14 days we will publish the security advisory as proposed below. Please let us know if you wish changes.</li>\n<li>The bug bounty panel will decide on the bounty that we can issue for this vulnerability.</li>\n</ol>\n\n<p>I&#39;ll keep you in the loop.</p>\n\n<hr>\n\n<p><strong>Proposed advisory:</strong></p>\n<pre class=\"highlight plaintext\"><code># Open Redirector involving user interaction (oC-SA-2016-007)\n- 2th May 2016\n- Risk Level: Low\n- CVSS v3 Base Score: 4.3 (CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N)\n- CWE: URL Redirection to Untrusted Site (&#39;Open Redirect&#39;) (CWE-601)\n\n##\u00a0Description\n\nAn open redirect vulnerability has been found in the way that ownCloud implemented PDF.js, a successful exploitation of this vulnerability requires multiple pre-requisites:\n\n1. User has to use a Gecko based browser (e.g. Mozilla Firefox)\n2. User has to open a link sent by the adversary\n3. User has to click on the small &quot;Download&quot; button in the top right of the PDF viewer.\n\nOnce an user has performed this step they are redirected to the URL passed as a GET parameter.\n\nNote: The user will be displayed a warning that the PDF file can&#39;t be loaded properly.\n\n## Affected software\n- ownCloud Server &lt; 7.0.14 (CVE assignment pending)\n    - files_pdfviewer/c69858a421b2cad219a0ea580c1ef4e0e2c9877f\n- ownCloud Server &lt; 8.0.12 (CVE assignment pending)\n    - files_pdfviewer/54b78d9053dac0195adbebb23dad71d43ab2f6b2\n- ownCloud Server &lt; 8.1.7 (CVE assignment pending)\n    - files_pdfviewer/31d4e53fe6e47353c1e7ba15ed07df29e1c174c9\n- ownCloud Server &lt; 8.2.4 (CVE assignment pending)\n    - files_pdfviewer/9ab7ca2e5eabea43d18b97d4622ebea30fa09a92\n- ownCloud Server &lt; 9.0.2 (CVE assignment pending)\n    - files_pdfviewer/a1445f0f8bf28eed89c1f56682bbb6fe574b4ecf\n\n##\u00a0Action Taken\n\nThe PDF viewer has been configured that it can only be opened via iframes. Since as a clickjacking attack the X-Frame-Options header is employed as well this doesn&#39;t make it possible to send users anymore malicious links.\n\nAs a further step for the 9.1 release of ownCloud the following changes are planned to mitigate such attack vectors even more:\n\n1. Update the PDF.js library to a version that supports whitelisting of target domains. For reference please see\u00a0https://github.com/mozilla/pdf.js/pull/6916\n2. Employ Same-Site-Cookies with a strict policy on this endpoint. Browsers supporting Same-Site-Cookies will not make it possible to access such resources directly anymore. For reference please see https://github.com/owncloud/core/pull/24092\n\n##\u00a0Acknowledgements\n\nThe ownCloud team thanks the following people for their research and responsible disclosure of the above advisory:\n\n- Businessprotect.gr (info@businessprotect.gr) - Vulnerability discovery and disclosure.\n</code></pre>", 
            "type": "Activities::Comment", 
            "id": 939838, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "penrose", 
                "url": "/penrose"
            }, 
            "created_at": "2016-05-04T07:54:20.238Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-04T07:54:20.238Z", 
            "actor": {
                "username": "lukasreschke", 
                "url": "/lukasreschke", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/037/891/0ddfc05411893988a0d2794cd70d5dc221729713_medium.png?1438782834"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "owncloud", 
            "message": "Since this has been resolved I'll mark this accordingly. Bug bounty panel will decide later upon the reward and we will disclose this vulnerability after 14 days as per our policy.", 
            "markdown_message": "<p>Since this has been resolved I&#39;ll mark this accordingly. Bug bounty panel will decide later upon the reward and we will disclose this vulnerability after 14 days as per our policy.</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 939839, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-04T11:26:43.920Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-04T11:26:43.920Z", 
            "actor": {
                "username": "penrose", 
                "url": "/penrose", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/068/816/bee966b5c2d2902a9d80733bca58dfbb6a36e403_medium.png?1483569948"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "owncloud", 
            "message": "Thank you very much for the cooperation and quick fix. I hope we will talk again soon.", 
            "markdown_message": "<p>Thank you very much for the cooperation and quick fix. I hope we will talk again soon.</p>\n", 
            "type": "Activities::Comment", 
            "id": 940054, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2016-05-10T12:10:04.151Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-10T12:10:04.151Z", 
            "actor": {
                "url": "/owncloud", 
                "profile": {
                    "name": "ownCloud"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/059/6af0ec24c370d0d2250fdf2ac3e937f4aab2692d_medium.png?1438786688"
                }
            }, 
            "team_handle": "owncloud", 
            "bonus_amount": "100.0", 
            "bounty_amount": "50.0", 
            "collaborator": {
                "username": "penrose", 
                "url": "/penrose"
            }, 
            "message": "Congratulations. The bug bounty panel has deemed this report to be eligible for a bounty of $50.\n\nDue to the low severity of the bug this only met the requirements for a \"low severity\" bounty. However, we appreciate your high quality report as well as your investigation on the PDF.js front and are adding a $100 bonus resulting in a total payout of $150.\n\nOur policy mandates us to publicly disclose all issues after around 2 weeks of a patch release. We'd like you to ask you to not spread any information about this issue until then. After that, go ahead! :-)", 
            "markdown_message": "<p>Congratulations. The bug bounty panel has deemed this report to be eligible for a bounty of $50.</p>\n\n<p>Due to the low severity of the bug this only met the requirements for a &quot;low severity&quot; bounty. However, we appreciate your high quality report as well as your investigation on the PDF.js front and are adding a $100 bonus resulting in a total payout of $150.</p>\n\n<p>Our policy mandates us to publicly disclose all issues after around 2 weeks of a patch release. We&#39;d like you to ask you to not spread any information about this issue until then. After that, go ahead! :-)</p>\n", 
            "type": "Activities::BountyAwarded", 
            "id": 948656, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-11T06:55:43.345Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-11T06:55:43.345Z", 
            "actor": {
                "username": "penrose", 
                "url": "/penrose", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/068/816/bee966b5c2d2902a9d80733bca58dfbb6a36e403_medium.png?1483569948"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "owncloud", 
            "message": "Thank you, no disclosure from our side till it is public. Can i ask you how we proceed with the payout? What is the process that you follow and what do you require by my side?   ", 
            "markdown_message": "<p>Thank you, no disclosure from our side till it is public. Can i ask you how we proceed with the payout? What is the process that you follow and what do you require by my side?   </p>\n", 
            "type": "Activities::Comment", 
            "id": 950190, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-11T07:03:11.339Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-11T07:03:11.339Z", 
            "actor": {
                "username": "lukasreschke", 
                "url": "/lukasreschke", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/037/891/0ddfc05411893988a0d2794cd70d5dc221729713_medium.png?1438782834"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "owncloud", 
            "message": "Payment is handled via the HackerOne platform. You should be able to just go to https://hackerone.com/settings/bounties and enter your information there.\n\nPayout can either happen via Paypal or Bitcoin. (CoinBase)\n\nSee also https://support.hackerone.com/hc/en-us/articles/205769945-How-do-I-collect-swag-or-a-bounty- for more information.", 
            "markdown_message": "<p>Payment is handled via the HackerOne platform. You should be able to just go to <a title=\"https://hackerone.com/settings/bounties\" href=\"https://hackerone.com/settings/bounties\">https://hackerone.com/settings/bounties</a> and enter your information there.</p>\n\n<p>Payout can either happen via Paypal or Bitcoin. (CoinBase)</p>\n\n<p>See also <a title=\"https://support.hackerone.com/hc/en-us/articles/205769945-How-do-I-collect-swag-or-a-bounty-\" href=\"/redirect?signature=ba86165d715e9894a7ce646311c61b29db95f3a1&amp;url=https%3A%2F%2Fsupport.hackerone.com%2Fhc%2Fen-us%2Farticles%2F205769945-How-do-I-collect-swag-or-a-bounty-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://support.hackerone.com/hc/en-us/articles/205769945-How-do-I-collect-swag-or-a-bounty-</span><i class=\"icon-external-link\"></i></a> for more information.</p>\n", 
            "type": "Activities::Comment", 
            "id": 950193, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-06-02T08:45:27.922Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-02T08:45:27.922Z", 
            "actor": {
                "username": "penrose", 
                "url": "/penrose", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/068/816/bee966b5c2d2902a9d80733bca58dfbb6a36e403_medium.png?1483569948"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "owncloud", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 996280, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-07-02T08:45:32.913Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-07-02T08:45:32.913Z", 
            "actor": {
                "url": "/owncloud", 
                "profile": {
                    "name": "ownCloud"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/059/6af0ec24c370d0d2250fdf2ac3e937f4aab2692d_medium.png?1438786688"
                }
            }, 
            "team_handle": "owncloud", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 1050289, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "penrose", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/penrose", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/068/816/841df5e429c994757f295c80d4690815c23d0340_small.png?1483569948"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 53, 
        "name": "Open Redirect"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -76687609.17616013, 
    "disclosed_at": "2016-07-02T08:45:32.784Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/131082", 
    "created_at": "2016-04-15T12:37:01.271Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>Affected Products:  OWNCLOUD (<a title=\"https://demo.owncloud.org/index.php/apps/files_pdfviewer\" href=\"/redirect?signature=920fb55c72e7d0a680e3289115df99942bb5fea3&amp;url=https%3A%2F%2Fdemo.owncloud.org%2Findex.php%2Fapps%2Ffiles_pdfviewer\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://demo.owncloud.org/index.php/apps/files_pdfviewer</span><i class=\"icon-external-link\"></i></a>)<br>\nVersion Tested: v1.0.712, other versions might be vulnerable<br>\nClass:  Open Redirector<br>\nRemote: Yes</p>\n\n<p>A non authenticated user can be easily tricked into following one of the following links in order to download a supposedly uploaded file on an owncloud instance:<br>\nThe EvilFile the pdfviewer is trying to redirect will not load in the viewer automatically. But if the user clicks the download button on the right upper corner of the viewer any file will be downloaded instantly and the browser will be redirected to a different domain (ex. <a title=\"https://evildomain.xx\" href=\"/redirect?signature=a9282993af3562c9ea7f300fe981a709f85ed9ba&amp;url=https%3A%2F%2Fevildomain.xx\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://evildomain.xx</span><i class=\"icon-external-link\"></i></a> ).</p>\n\n<p>****OPEN REDIRECT Attack Replication Steps: </p>\n\n<p>Step 1: Visit <a title=\"https://demo.owncloud.org/index.php/apps/files_pdfviewer?file=https://evildomain.xx/EvilFile.xx\" href=\"/redirect?signature=a981cb6c1b5327b5775a8afe9c58a3f7330ab119&amp;url=https%3A%2F%2Fdemo.owncloud.org%2Findex.php%2Fapps%2Ffiles_pdfviewer%3Ffile%3Dhttps%3A%2F%2Fevildomain.xx%2FEvilFile.xx\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://demo.owncloud.org/index.php/apps/files_pdfviewer?file=https://evildomain.xx/EvilFile.xx</span><i class=\"icon-external-link\"></i></a> [ Check POC1.jpg ]</p>\n\n<p>Step 2: Click Download button on the right upper corner of the viewer.</p>\n\n<p>Step 3: Browser is redirected to <a title=\"https://evildomain.xx/EvilFile.xx\" href=\"/redirect?signature=f339a40313480a3b97ff4c45dbefa864cbc37d8a&amp;url=https%3A%2F%2Fevildomain.xx%2FEvilFile.xx\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://evildomain.xx/EvilFile.xx</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>Comment: No user authentication is required for the user to be redirected. All owncloud installations in the wild are vulnerable to this attack.</p>\n\n<p>****Example Phishing Message with OPEN REDIRECT Attack:</p>\n\n<p>Message:</p>\n\n<p>Please view the files i have shared with you by following the link below, if this file is not automatically opened please click the download button on the right upper corner: </p>\n\n<p><a title=\"https://demo.owncloud.org/index.php/apps/files_pdfviewer?file=https://evildomain.xx/remote.php/webdav/Demo.pdf%20%3CIf%20this%20file%20is%20not%20available%20please%20click%20the%20dowload%20button%20on%20the%20right%20upper%20corner%3E\" href=\"/redirect?signature=d8d65511f0513fe41fd4a1873fdad27f02c6460d&amp;url=https%3A%2F%2Fdemo.owncloud.org%2Findex.php%2Fapps%2Ffiles_pdfviewer%3Ffile%3Dhttps%3A%2F%2Fevildomain.xx%2Fremote.php%2Fwebdav%2FDemo.pdf%2520%253CIf%2520this%2520file%2520is%2520not%2520available%2520please%2520click%2520the%2520dowload%2520button%2520on%2520the%2520right%2520upper%2520corner%253E\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://demo.owncloud.org/index.php/apps/files_pdfviewer?file=https://evildomain.xx/remote.php/webdav/Demo.pdf%20%3CIf%20this%20file%20is%20not%20available%20please%20click%20the%20dowload%20button%20on%20the%20right%20upper%20corner%3E</span><i class=\"icon-external-link\"></i></a> [ Check POC2.jpg ]</p>\n", 
    "vulnerability_information": "Affected Products:  OWNCLOUD (https://demo.owncloud.org/index.php/apps/files_pdfviewer)\nVersion Tested: v1.0.712, other versions might be vulnerable\nClass:\tOpen Redirector\nRemote:\tYes\n\nA non authenticated user can be easily tricked into following one of the following links in order to download a supposedly uploaded file on an owncloud instance:\nThe EvilFile the pdfviewer is trying to redirect will not load in the viewer automatically. But if the user clicks the download button on the right upper corner of the viewer any file will be downloaded instantly and the browser will be redirected to a different domain (ex. https://evildomain.xx ).\n\n****OPEN REDIRECT Attack Replication Steps: \n\nStep 1: Visit https://demo.owncloud.org/index.php/apps/files_pdfviewer?file=https://evildomain.xx/EvilFile.xx [ Check POC1.jpg ]\n\nStep 2: Click Download button on the right upper corner of the viewer.\n\nStep 3: Browser is redirected to https://evildomain.xx/EvilFile.xx\n\nComment: No user authentication is required for the user to be redirected. All owncloud installations in the wild are vulnerable to this attack.\n\n\n****Example Phishing Message with OPEN REDIRECT Attack:\n\n\nMessage:\n\nPlease view the files i have shared with you by following the link below, if this file is not automatically opened please click the download button on the right upper corner: \n\nhttps://demo.owncloud.org/index.php/apps/files_pdfviewer?file=https://evildomain.xx/remote.php/webdav/Demo.pdf%20%3CIf%20this%20file%20is%20not%20available%20please%20click%20the%20dowload%20button%20on%20the%20right%20upper%20corner%3E [ Check POC2.jpg ]\n\n", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://www.owncloud.com", 
            "about": "ownCloud GmbH is the company behind the ownCloud Project - the most downloaded open source project for data and file sync, share and view.", 
            "twitter_handle": "ownCloud", 
            "name": "ownCloud"
        }, 
        "handle": "owncloud", 
        "url": "https://hackerone.com/owncloud", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/003/059/ef3f773944541857909a6662470c5452b3f94d88_small.png?1438786688", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/003/059/6af0ec24c370d0d2250fdf2ac3e937f4aab2692d_medium.png?1438786688"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 3059, 
        "default_currency": "usd"
    }, 
    "is_published": false
}