{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2017-04-11T17:34:28.050Z", 
    "voters": [
        "bogdantcaciuc", 
        "tk0", 
        "eveeez", 
        "muhammad_uwais", 
        "ahsan", 
        "japz", 
        "cuso4", 
        "drstache", 
        "hacklad", 
        "spetr0x", 
        "and 5 more..."
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "600.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 219607, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2017-04-13T09:14:06.043Z", 
    "vulnerability_information": "Dear Dovecot bug bounty team,\n\nDovecot is vulnerable to timing attacks, because the `verify_credentials()` function in CRAM-MD5 performs a byte-by-byte comparison, which terminates early when two characters do not match.\n\n# Summary\n---\n\nTiming attacks are a type of side channel attack where one can discover valuable information by recording the time it takes for a cryptographic algorithm to execute.\n\n### \ud83d\udc4e Don't use `memcmp()` here:\n\n~~~\nif (i == 0) {\n  /* verify response */\n  if (memcmp(response_hex, request - > response, 32) != 0) {\n    auth_request_log_info( & request - > auth_request,\n      AUTH_SUBSYS_MECH,\n      \"password mismatch\");\n    return FALSE;\n  }\n} else {\n  request - > rspauth =\n    p_strconcat(request - > pool, \"rspauth=\",\n      response_hex, NULL);\n}\n~~~\n\nLink to source code: https://github.com/dovecot/core/blob/master/src/auth/mech-digest-md5.c\n\nThe same applies in https://github.com/dovecot/core/blob/master/src/auth/mech-cram-md5.c:\n\n~~~\nif (memcmp(response_hex, request - > response, sizeof(digest) * 2) != 0) {\n  auth_request_log_info( & request - > auth_request, AUTH_SUBSYS_MECH,\n    \"password mismatch\");\n  return FALSE;\n}\n~~~\n\n`memcmp()` does a byte-by-byte comparison of two values and as soon as the two differentiate it terminates. This means the longer it takes until the operation returns, the more correct characters the attacker has guessed.\n\nLink to source code: \n\n### \ud83d\udc4d Use this instead:\n\nI would highly recommend you use OpenSSL's `CRYPTO_memcmp()`.\n\nOn a side note, this issue appears in other places too, so I will have another thorough look.\n\nBest regards,\nEd", 
    "activity_page_count": 1, 
    "severity": {
        "metrics": {
            "confidentiality": "low", 
            "privileges_required": "none", 
            "user_interaction": "none", 
            "attack_vector": "network", 
            "attack_complexity": "high", 
            "scope": "unchanged", 
            "integrity": "low", 
            "availability": "none"
        }, 
        "rating": "medium", 
        "score": 4.8, 
        "author_type": "User"
    }, 
    "title": "Dovecot authentication is vulnerable to timing attacks.", 
    "is_member_of_team?": null, 
    "vote_count": 15, 
    "summaries": [
        {
            "category": "team", 
            "can_view?": true, 
            "can_edit?": false, 
            "id": 3772, 
            "content": "It is possible under some circumstances to measure responses for authentication attempts, which can be used to assist in brute force attacks. While this issue is real, the actual practical attack is very difficult to carry out.", 
            "content_html": "<p>It is possible under some circumstances to measure responses for authentication attempts, which can be used to assist in brute force attacks. While this issue is real, the actual practical attack is very difficult to carry out.</p>\n"
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2017-05-11T17:34:28.084Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "activity_page_number": 1, 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$600", 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2017-04-08T21:23:42.143Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-04-08T21:23:42.143Z", 
            "actor": {
                "username": "tss", 
                "url": "/tss", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "dovecot", 
            "message": "Hi,\n\nInteresting reminder of timing issues and I think we need to think through more of those. However, I think specifically in this case:\n\n1) CRAM-MD5 has a unique random challenge for every authentication request, which is used to generate the final HMAC-MD5 based responses that are being compared. So this means that the final responses are practically two random 256bit values being compared. The memcmp() timing attack won't tell anything else beyond \"matches\" vs \"doesn't match\", which will be obvious anyway. On the next authentication attempt it's comparing again two different values. So it's not possible to incrementally attempt to determine the password using a timing attack.\n\n2) Dovecot doesn't immediately return failure to client when an authentication fails. Instead, it queues the failure and every 2 seconds it sends out all the pending auth failures. This already makes the timing attacks much more difficult. I guess it might make some sense to add a bit of further randomness to use 2s +- 100ms or something, although as described elsewhere it doesn't fully prevent timing attack issues, only makes them somewhat more difficult. Still, could be worth it.\n\nIf we were talking about plaintext authentication against a plaintext password then yes, a timing attack could be possible against that, although I think pretty unlikely to be successful on a real system. Still, that's something that we could fix. Quick googling suggests double-hmac comparisons with a random key.\n\nThere are probably various timing attacks against checking whether a username exists or not, but preventing those is likely not practical.\n", 
            "markdown_message": "<p>Hi,</p>\n\n<p>Interesting reminder of timing issues and I think we need to think through more of those. However, I think specifically in this case:</p>\n\n<p>1) CRAM-MD5 has a unique random challenge for every authentication request, which is used to generate the final HMAC-MD5 based responses that are being compared. So this means that the final responses are practically two random 256bit values being compared. The memcmp() timing attack won&#39;t tell anything else beyond &quot;matches&quot; vs &quot;doesn&#39;t match&quot;, which will be obvious anyway. On the next authentication attempt it&#39;s comparing again two different values. So it&#39;s not possible to incrementally attempt to determine the password using a timing attack.</p>\n\n<p>2) Dovecot doesn&#39;t immediately return failure to client when an authentication fails. Instead, it queues the failure and every 2 seconds it sends out all the pending auth failures. This already makes the timing attacks much more difficult. I guess it might make some sense to add a bit of further randomness to use 2s +- 100ms or something, although as described elsewhere it doesn&#39;t fully prevent timing attack issues, only makes them somewhat more difficult. Still, could be worth it.</p>\n\n<p>If we were talking about plaintext authentication against a plaintext password then yes, a timing attack could be possible against that, although I think pretty unlikely to be successful on a real system. Still, that&#39;s something that we could fix. Quick googling suggests double-hmac comparisons with a random key.</p>\n\n<p>There are probably various timing attacks against checking whether a username exists or not, but preventing those is likely not practical.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1600336, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-04-08T21:31:58.714Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-04-08T21:31:58.714Z", 
            "actor": {
                "username": "edoverflow", 
                "url": "/edoverflow", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/116/374/95f9ffa246b2d43ca4f14a95d8815f429544fe54_medium.png?1527882436"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "dovecot", 
            "message": "Hi @tss,\n\n> 1) CRAM-MD5 has a unique random challenge for every authentication request, which is used to generate the final HMAC-MD5 based responses that are being compared. So this means that the final responses are practically two random 256bit values being compared. The memcmp() timing attack won't tell anything else beyond \"matches\" vs \"doesn't match\", which will be obvious anyway. On the next authentication attempt it's comparing again two different values. So it's not possible to incrementally attempt to determine the password using a timing attack.\n\nOK, so in this particular instance `memcmp()` is not an issue, but there appear to many other places susceptible to timing attacks which we should look into.\n\n> 2) Dovecot doesn't immediately return failure to client when an authentication fails. Instead, it queues the failure and every 2 seconds it sends out all the pending auth failures. This already makes the timing attacks much more difficult. I guess it might make some sense to add a bit of further randomness to use 2s +- 100ms or something, although as described elsewhere it doesn't fully prevent timing attack issues, only makes them somewhat more difficult. Still, could be worth it.\n\nAs you already stated, this only makes the attack a little harder, since an adversary can simply create more queries and average them out in order to get the same result.\n\nBest regards,\nEd", 
            "markdown_message": "<p>Hi <a href=\"/tss\">@tss</a>,</p>\n\n<blockquote>\n<p>1) CRAM-MD5 has a unique random challenge for every authentication request, which is used to generate the final HMAC-MD5 based responses that are being compared. So this means that the final responses are practically two random 256bit values being compared. The memcmp() timing attack won&#39;t tell anything else beyond &quot;matches&quot; vs &quot;doesn&#39;t match&quot;, which will be obvious anyway. On the next authentication attempt it&#39;s comparing again two different values. So it&#39;s not possible to incrementally attempt to determine the password using a timing attack.</p>\n</blockquote>\n\n<p>OK, so in this particular instance <code>memcmp()</code> is not an issue, but there appear to many other places susceptible to timing attacks which we should look into.</p>\n\n<blockquote>\n<p>2) Dovecot doesn&#39;t immediately return failure to client when an authentication fails. Instead, it queues the failure and every 2 seconds it sends out all the pending auth failures. This already makes the timing attacks much more difficult. I guess it might make some sense to add a bit of further randomness to use 2s +- 100ms or something, although as described elsewhere it doesn&#39;t fully prevent timing attack issues, only makes them somewhat more difficult. Still, could be worth it.</p>\n</blockquote>\n\n<p>As you already stated, this only makes the attack a little harder, since an adversary can simply create more queries and average them out in order to get the same result.</p>\n\n<p>Best regards,<br>\nEd</p>\n", 
            "type": "Activities::Comment", 
            "id": 1600344, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-04-08T21:40:00.368Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-04-08T21:40:00.368Z", 
            "actor": {
                "username": "tss", 
                "url": "/tss", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "dovecot", 
            "message": "Although.. the double-hmac doesn't seem to be very useful, maybe that was only intended for languages that make it more difficult to do constant time memcmp() comparisons. I was first thinking it might prevent leaking the length of the password, but it doesn't. So might as well just first fail immediately if password lengths don't match, and if they do use CRYPTO_memcmp()-like implementation for doing the plaintext password comparison.\n", 
            "markdown_message": "<p>Although.. the double-hmac doesn&#39;t seem to be very useful, maybe that was only intended for languages that make it more difficult to do constant time memcmp() comparisons. I was first thinking it might prevent leaking the length of the password, but it doesn&#39;t. So might as well just first fail immediately if password lengths don&#39;t match, and if they do use CRYPTO_memcmp()-like implementation for doing the plaintext password comparison.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1600347, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-04-08T22:01:34.174Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-04-08T22:01:34.174Z", 
            "actor": {
                "username": "edoverflow", 
                "url": "/edoverflow", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/116/374/95f9ffa246b2d43ca4f14a95d8815f429544fe54_medium.png?1527882436"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "dovecot", 
            "message": "> If we were talking about plaintext authentication against a plaintext password then yes, a timing attack could be possible against that, **although I think pretty unlikely to be successful on a real system.**\n\n[I beg to differ.](http://www.cs.rice.edu/~dwallach/pub/crosby-timing2009.pdf) ;)\n\n> So might as well just first fail immediately if password lengths don't match, and if they do use CRYPTO_memcmp()-like implementation for doing the plaintext password comparison.\n\nThat sounds like a reasonable approach.", 
            "markdown_message": "<blockquote>\n<p>If we were talking about plaintext authentication against a plaintext password then yes, a timing attack could be possible against that, <strong>although I think pretty unlikely to be successful on a real system.</strong></p>\n</blockquote>\n\n<p><a href=\"/redirect?signature=71596837e41fda5a47a3b34cd6cf6a94b72cffbf&amp;url=http%3A%2F%2Fwww.cs.rice.edu%2F%7Edwallach%2Fpub%2Fcrosby-timing2009.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>I beg to differ.</span><i class=\"icon-external-link\"></i></a> ;)</p>\n\n<blockquote>\n<p>So might as well just first fail immediately if password lengths don&#39;t match, and if they do use CRYPTO_memcmp()-like implementation for doing the plaintext password comparison.</p>\n</blockquote>\n\n<p>That sounds like a reasonable approach.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1600362, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-04-09T05:34:37.450Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-04-09T05:34:37.450Z", 
            "actor": {
                "username": "akituomi", 
                "url": "/akituomi", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/060/216/b4349eaf357a8d5dc8efd3e359fd41cb2af247c0_medium.jpg?1461137575"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "dovecot", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugTriaged", 
            "id": 1600568, 
            "genius_execution_id": null
        }, 
        {
            "attachments": [
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/174/603/8c23165a726752ec2a26b6db44f51612c5b62a4a/timing.diff?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ74T23ZH2%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T224042Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDKP8gtonlolbwRCFkSK3A8zRiM4XrfrPxhuRQyPzGewY%2F8%2BrZubJgueFivdcxl7%2F3iKHqTcriXEfjKl%2BSTmdTrFI3DombVHMKOYwlG1hM21jXAfSh72gDN%2BHds5TF5Hko27v6DRiCzuemhdgF47giYHnyCL3NCtcZ280H43hMDk8jiMZIUa5jSGS%2FYM0UQD2eITjNKscKu9Fg3jnQOs%2FtI0LbTq4ZOYkHzJsx3Gx5wmY15OB78PVb%2FoanvGsdZ1G6JLoOvoTJtP%2BBGbZSfLbuJ1WmFVnDe95bwaZBXmmNFIwMDxV%2BIfpWj4A6egpifpz3xxmRRWcE1dqWPIhLKaatOintqSYA20U00rLoCNdGd9IKmu0qa6%2B8Nt35qrWRxLjUKFoVkfzI8plSmUmq%2B7hZ71fbl9wB5sUhWpjZP521spZTb6QY8FJEa8S3BRJSDNUSr0ecK5GZt3wvmq5ONCWAeZbidiSFNHoYpY72e9tiuClRIfQzkSOa7JE0OSN9ATAt8rjzLAGibK5D8CP7%2F23wI%2Fce9%2BQ7jYxhSDeUleT1ird2slt6z2voHzFGPzgGkupeiNthV4QvkyXxyIQFGYYyeRDJ%2FnjD%2Boo666m4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=890261cbb3fe1a075dbde30d826af2e3b2bd7f2fae52bd07c81e76599ded2ada", 
                    "type": "text/x-diff", 
                    "id": 174603, 
                    "filename": "timing.diff"
                }
            ], 
            "automated_response": false, 
            "created_at": "2017-04-10T07:41:38.071Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-04-10T07:41:38.071Z", 
            "actor": {
                "username": "tss", 
                "url": "/tss", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "dovecot", 
            "message": "The attached patch contains all the timing related issues I've thought of so far. Can you think of something else that could be fixed?", 
            "markdown_message": "<p>The attached patch contains all the timing related issues I&#39;ve thought of so far. Can you think of something else that could be fixed?</p>\n", 
            "type": "Activities::Comment", 
            "id": 1601797, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-04-10T16:42:57.629Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-04-10T16:42:57.629Z", 
            "actor": {
                "username": "edoverflow", 
                "url": "/edoverflow", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/116/374/95f9ffa246b2d43ca4f14a95d8815f429544fe54_medium.png?1527882436"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "dovecot", 
            "message": "Looks good to me, but you appear to have left out `/src/auth/password-scheme-pbkdf2.c`:\n\n~~~diff\n- return memcmp(key1, key2, sizeof(key1)) == 0 ? 1 : 0;\n+ return mem_equals_timing_safe(key1, key2, sizeof(key1)) == 0 ? 1 : 0;\n~~~\n\nLink to source code: https://github.com/dovecot/core/blob/master/src/auth/password-scheme-pbkdf2.c#L81", 
            "markdown_message": "<p>Looks good to me, but you appear to have left out <code>/src/auth/password-scheme-pbkdf2.c</code>:</p>\n<pre class=\"highlight diff\"><code><span class=\"gd\">- return memcmp(key1, key2, sizeof(key1)) == 0 ? 1 : 0;\n</span><span class=\"gi\">+ return mem_equals_timing_safe(key1, key2, sizeof(key1)) == 0 ? 1 : 0;\n</span></code></pre>\n<p>Link to source code: <a title=\"https://github.com/dovecot/core/blob/master/src/auth/password-scheme-pbkdf2.c#L81\" href=\"/redirect?signature=116412da69783b5d127d6761d0bc4597f2233a45&amp;url=https%3A%2F%2Fgithub.com%2Fdovecot%2Fcore%2Fblob%2Fmaster%2Fsrc%2Fauth%2Fpassword-scheme-pbkdf2.c%23L81\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/dovecot/core/blob/master/src/auth/password-scheme-pbkdf2.c#L81</span><i class=\"icon-external-link\"></i></a></p>\n", 
            "type": "Activities::Comment", 
            "id": 1602745, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-04-11T13:02:01.159Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-04-11T13:02:01.159Z", 
            "actor": {
                "username": "tss", 
                "url": "/tss", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "dovecot", 
            "message": "These fixes are now in Github:\n\nhttps://github.com/dovecot/core/commit/9464dc83df5da54457ff0b629d02e543e43d53bf\nhttps://github.com/dovecot/core/commit/f1d759d0b4860cac29b5077ee423f9de8bb7d300\nhttps://github.com/dovecot/core/commit/2656508b1a5782070c0f4d6d3dfe2ac54c964370\nhttps://github.com/dovecot/core/commit/e18b4e41d9718a199a1980688787c2743c870002\nhttps://github.com/dovecot/core/commit/ace06232cfa0e99ecca1040e8553b3216d025768", 
            "markdown_message": "<p>These fixes are now in Github:</p>\n\n<p><a title=\"https://github.com/dovecot/core/commit/9464dc83df5da54457ff0b629d02e543e43d53bf\" href=\"/redirect?signature=c4fd9a3ac31a9af81917a023928ad6eebb8d7d5a&amp;url=https%3A%2F%2Fgithub.com%2Fdovecot%2Fcore%2Fcommit%2F9464dc83df5da54457ff0b629d02e543e43d53bf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/dovecot/core/commit/9464dc83df5da54457ff0b629d02e543e43d53bf</span><i class=\"icon-external-link\"></i></a><br>\n<a title=\"https://github.com/dovecot/core/commit/f1d759d0b4860cac29b5077ee423f9de8bb7d300\" href=\"/redirect?signature=423a7a61742915731bc6717304803a67b62ecac0&amp;url=https%3A%2F%2Fgithub.com%2Fdovecot%2Fcore%2Fcommit%2Ff1d759d0b4860cac29b5077ee423f9de8bb7d300\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/dovecot/core/commit/f1d759d0b4860cac29b5077ee423f9de8bb7d300</span><i class=\"icon-external-link\"></i></a><br>\n<a title=\"https://github.com/dovecot/core/commit/2656508b1a5782070c0f4d6d3dfe2ac54c964370\" href=\"/redirect?signature=103919fed1abadfa6404bbf41cb95da7ab1d2396&amp;url=https%3A%2F%2Fgithub.com%2Fdovecot%2Fcore%2Fcommit%2F2656508b1a5782070c0f4d6d3dfe2ac54c964370\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/dovecot/core/commit/2656508b1a5782070c0f4d6d3dfe2ac54c964370</span><i class=\"icon-external-link\"></i></a><br>\n<a title=\"https://github.com/dovecot/core/commit/e18b4e41d9718a199a1980688787c2743c870002\" href=\"/redirect?signature=57d9ecb37b9dfdff2e1655fe1eed82259b222a0d&amp;url=https%3A%2F%2Fgithub.com%2Fdovecot%2Fcore%2Fcommit%2Fe18b4e41d9718a199a1980688787c2743c870002\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/dovecot/core/commit/e18b4e41d9718a199a1980688787c2743c870002</span><i class=\"icon-external-link\"></i></a><br>\n<a title=\"https://github.com/dovecot/core/commit/ace06232cfa0e99ecca1040e8553b3216d025768\" href=\"/redirect?signature=6aab966041d222b694b4f28d77a53c39adf79b13&amp;url=https%3A%2F%2Fgithub.com%2Fdovecot%2Fcore%2Fcommit%2Face06232cfa0e99ecca1040e8553b3216d025768\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/dovecot/core/commit/ace06232cfa0e99ecca1040e8553b3216d025768</span><i class=\"icon-external-link\"></i></a></p>\n", 
            "type": "Activities::Comment", 
            "id": 1604652, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-04-11T13:08:15.788Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-04-11T13:08:15.788Z", 
            "actor": {
                "username": "edoverflow", 
                "url": "/edoverflow", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/116/374/95f9ffa246b2d43ca4f14a95d8815f429544fe54_medium.png?1527882436"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "dovecot", 
            "message": "Fantastic work! I just have one final question, would you mind clarifying exactly what you mean in commit `ace06232cfa0e99ecca1040e8553b3216d025768`?\n\n> It's unlikely these could be used to perform timing attacks, since the\nattacker would have to have broken MD5/SHA badly enough to be able to\nquickly generate string that result in wanted hashes.", 
            "markdown_message": "<p>Fantastic work! I just have one final question, would you mind clarifying exactly what you mean in commit <code>ace06232cfa0e99ecca1040e8553b3216d025768</code>?</p>\n\n<blockquote>\n<p>It&#39;s unlikely these could be used to perform timing attacks, since the<br>\nattacker would have to have broken MD5/SHA badly enough to be able to<br>\nquickly generate string that result in wanted hashes.</p>\n</blockquote>\n", 
            "type": "Activities::Comment", 
            "id": 1604660, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-04-11T13:19:43.495Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-04-11T13:19:43.495Z", 
            "actor": {
                "username": "tss", 
                "url": "/tss", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "dovecot", 
            "message": "Normally a timing attack against plaintext authentication would try a single character at a time to figure out if it's a correct character, and if yes then continue to the next character. With password hashes the similar attack would have to keep changing the next byte in the password hash, keeping the previous bytes the same. And the attacker can't directly feed hashes to Dovecot - they have to be plaintext password strings. So if it attacker has determined e.g. that \"001122334455\" is the correct prefix so far and they want to try \"66\" as the next byte, they can't just add \"66\" there but need to figure out which hash(password) has such a prefix. And the further along you get the closer to \"forever\" it takes to try to find out such password strings.\n", 
            "markdown_message": "<p>Normally a timing attack against plaintext authentication would try a single character at a time to figure out if it&#39;s a correct character, and if yes then continue to the next character. With password hashes the similar attack would have to keep changing the next byte in the password hash, keeping the previous bytes the same. And the attacker can&#39;t directly feed hashes to Dovecot - they have to be plaintext password strings. So if it attacker has determined e.g. that &quot;001122334455&quot; is the correct prefix so far and they want to try &quot;66&quot; as the next byte, they can&#39;t just add &quot;66&quot; there but need to figure out which hash(password) has such a prefix. And the further along you get the closer to &quot;forever&quot; it takes to try to find out such password strings.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1604689, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-04-11T13:21:59.901Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-04-11T13:21:59.901Z", 
            "actor": {
                "username": "edoverflow", 
                "url": "/edoverflow", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/116/374/95f9ffa246b2d43ca4f14a95d8815f429544fe54_medium.png?1527882436"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "dovecot", 
            "message": "Whoops, my bad. You were referring to the possible timing attacks on the hash comparisons. Nevertheless, thank you for the clarification.", 
            "markdown_message": "<p>Whoops, my bad. You were referring to the possible timing attacks on the hash comparisons. Nevertheless, thank you for the clarification.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1604694, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-04-11T13:31:11.053Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-04-11T13:31:11.053Z", 
            "actor": {
                "username": "edoverflow", 
                "url": "/edoverflow", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/116/374/95f9ffa246b2d43ca4f14a95d8815f429544fe54_medium.png?1527882436"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "dovecot", 
            "message": "I have reviewed the changes and can confirm that this issue has been resolved. Well done on the quick fix.", 
            "markdown_message": "<p>I have reviewed the changes and can confirm that this issue has been resolved. Well done on the quick fix.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1604721, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "edoverflow", 
                "url": "/edoverflow"
            }, 
            "created_at": "2017-04-11T17:20:11.876Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-04-11T17:20:11.876Z", 
            "actor": {
                "username": "akituomi", 
                "url": "/akituomi", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/060/216/b4349eaf357a8d5dc8efd3e359fd41cb2af247c0_medium.jpg?1461137575"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "dovecot", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugResolved", 
            "id": 1605244, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2017-04-11T17:20:45.033Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-04-11T17:20:45.033Z", 
            "actor": {
                "url": "/dovecot", 
                "profile": {
                    "name": "Dovecot"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/008/907/0b3999bc5f1ae683267eea5746a94202046fcb23_medium.?1454083939"
                }
            }, 
            "team_handle": "dovecot", 
            "bonus_amount": "0.0", 
            "bounty_amount": "600.0", 
            "collaborator": {
                "username": "edoverflow", 
                "url": "/edoverflow"
            }, 
            "message": "Thank you for reporting this issue to us!", 
            "markdown_message": "<p>Thank you for reporting this issue to us!</p>\n", 
            "type": "Activities::BountyAwarded", 
            "id": 1605245, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-04-11T17:34:28.064Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-04-11T17:34:28.064Z", 
            "actor": {
                "username": "edoverflow", 
                "url": "/edoverflow", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/116/374/95f9ffa246b2d43ca4f14a95d8815f429544fe54_medium.png?1527882436"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "dovecot", 
            "first_to_agree": true, 
            "message": "Thank you very much @dovecot for the bounty! That was an impressive time to resolution. Can we disclose this report to inform fellow researchers? \ud83d\ude0a", 
            "markdown_message": "<p>Thank you very much <a href=\"/dovecot\">@dovecot</a> for the bounty! That was an impressive time to resolution. Can we disclose this report to inform fellow researchers? \ud83d\ude0a</p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1605284, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-04-11T17:43:03.777Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-04-11T17:43:03.777Z", 
            "actor": {
                "username": "akituomi", 
                "url": "/akituomi", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/060/216/b4349eaf357a8d5dc8efd3e359fd41cb2af247c0_medium.jpg?1461137575"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "dovecot", 
            "message": "We will review the publication timeline internally, but after 30 days latest.", 
            "markdown_message": "<p>We will review the publication timeline internally, but after 30 days latest.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1605324, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-04-13T09:11:39.252Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-04-13T09:11:39.252Z", 
            "actor": {
                "username": "akituomi", 
                "url": "/akituomi", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/060/216/b4349eaf357a8d5dc8efd3e359fd41cb2af247c0_medium.jpg?1461137575"
                }, 
                "hackerone_triager": false
            }, 
            "additional_data": {
                "new_title": "Dovecot authentication is vulnerable to timing attacks.", 
                "old_title": "CRAM-MD5 is vulnerable to timing attacks."
            }, 
            "team_handle": "dovecot", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportTitleUpdated", 
            "id": 1609245, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-04-13T09:14:06.057Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-04-13T09:14:06.057Z", 
            "actor": {
                "username": "akituomi", 
                "url": "/akituomi", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/060/216/b4349eaf357a8d5dc8efd3e359fd41cb2af247c0_medium.jpg?1461137575"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "dovecot", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1609247, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-04-13T09:14:06.088Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-04-13T09:14:06.088Z", 
            "actor": {
                "username": "akituomi", 
                "url": "/akituomi", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/060/216/b4349eaf357a8d5dc8efd3e359fd41cb2af247c0_medium.jpg?1461137575"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "dovecot", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 1609248, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-31T14:15:41.956Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-31T14:15:41.956Z", 
            "actor": {
                "username": "edoverflow", 
                "url": "/edoverflow", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/116/374/95f9ffa246b2d43ca4f14a95d8815f429544fe54_medium.png?1527882436"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "dovecot", 
            "message": "Hi @akituomi,\n\nWould it be possible to allocate a CVE ID for this issue?", 
            "markdown_message": "<p>Hi <a href=\"/akituomi\">@akituomi</a>,</p>\n\n<p>Would it be possible to allocate a CVE ID for this issue?</p>\n", 
            "type": "Activities::Comment", 
            "id": 2117508, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-01T13:13:52.179Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-01T13:13:52.179Z", 
            "actor": {
                "username": "akituomi", 
                "url": "/akituomi", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/060/216/b4349eaf357a8d5dc8efd3e359fd41cb2af247c0_medium.jpg?1461137575"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "dovecot", 
            "message": "Hi @edio, we will consider this.", 
            "markdown_message": "<p>Hi <a href=\"/edio\">@edio</a>, we will consider this.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2120783, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "edoverflow", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/edoverflow", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/116/374/2e86e29173a7b27dc4e4c35ecaef804781110b9f_small.png?1527882436"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 32, 
        "name": "Cryptographic Issues - Generic"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -49611974.48924433, 
    "disclosed_at": "2017-04-13T09:14:06.074Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/219607", 
    "created_at": "2017-04-08T20:22:49.639Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>Dear Dovecot bug bounty team,</p>\n\n<p>Dovecot is vulnerable to timing attacks, because the <code>verify_credentials()</code> function in CRAM-MD5 performs a byte-by-byte comparison, which terminates early when two characters do not match.</p>\n\n<h1 id=\"summary\">Summary</h1>\n\n<hr>\n\n<p>Timing attacks are a type of side channel attack where one can discover valuable information by recording the time it takes for a cryptographic algorithm to execute.</p>\n\n<h3 id=\"don-t-use-memcmp-here\">\ud83d\udc4e Don&#39;t use <code>memcmp()</code> here:</h3>\n<pre class=\"highlight plaintext\"><code>if (i == 0) {\n  /* verify response */\n  if (memcmp(response_hex, request - &gt; response, 32) != 0) {\n    auth_request_log_info( &amp; request - &gt; auth_request,\n      AUTH_SUBSYS_MECH,\n      &quot;password mismatch&quot;);\n    return FALSE;\n  }\n} else {\n  request - &gt; rspauth =\n    p_strconcat(request - &gt; pool, &quot;rspauth=&quot;,\n      response_hex, NULL);\n}\n</code></pre>\n<p>Link to source code: <a title=\"https://github.com/dovecot/core/blob/master/src/auth/mech-digest-md5.c\" href=\"/redirect?signature=18d9e1d7b12a68410afab9c04bbb472d980ee7d1&amp;url=https%3A%2F%2Fgithub.com%2Fdovecot%2Fcore%2Fblob%2Fmaster%2Fsrc%2Fauth%2Fmech-digest-md5.c\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/dovecot/core/blob/master/src/auth/mech-digest-md5.c</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>The same applies in <a title=\"https://github.com/dovecot/core/blob/master/src/auth/mech-cram-md5.c:\" href=\"/redirect?signature=5c7cc16416df89332001bd60bd5bf00ca72e2637&amp;url=https%3A%2F%2Fgithub.com%2Fdovecot%2Fcore%2Fblob%2Fmaster%2Fsrc%2Fauth%2Fmech-cram-md5.c%3A\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/dovecot/core/blob/master/src/auth/mech-cram-md5.c:</span><i class=\"icon-external-link\"></i></a></p>\n<pre class=\"highlight plaintext\"><code>if (memcmp(response_hex, request - &gt; response, sizeof(digest) * 2) != 0) {\n  auth_request_log_info( &amp; request - &gt; auth_request, AUTH_SUBSYS_MECH,\n    &quot;password mismatch&quot;);\n  return FALSE;\n}\n</code></pre>\n<p><code>memcmp()</code> does a byte-by-byte comparison of two values and as soon as the two differentiate it terminates. This means the longer it takes until the operation returns, the more correct characters the attacker has guessed.</p>\n\n<p>Link to source code: </p>\n\n<h3 id=\"use-this-instead\">\ud83d\udc4d Use this instead:</h3>\n\n<p>I would highly recommend you use OpenSSL&#39;s <code>CRYPTO_memcmp()</code>.</p>\n\n<p>On a side note, this issue appears in other places too, so I will have another thorough look.</p>\n\n<p>Best regards,<br>\nEd</p>\n", 
    "severity_rating": "medium", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "http://dovecot.fi", 
            "about": "", 
            "twitter_handle": "dovecotmail", 
            "name": "Dovecot"
        }, 
        "handle": "dovecot", 
        "url": "https://hackerone.com/dovecot", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/008/907/1babed172261a02499a2ed2421b339bd59ab62ec_small.?1454083939", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/008/907/0b3999bc5f1ae683267eea5746a94202046fcb23_medium.?1454083939"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 8907, 
        "default_currency": "usd"
    }, 
    "is_published": false
}