{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "informative", 
    "bug_reporter_agreed_on_going_public_at": null, 
    "voters": [
        "sandeepl337"
    ], 
    "facebook_team?": false, 
    "has_bounty?": false, 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 273647, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2017-10-01T20:01:26.372Z", 
    "vulnerability_information": "# Summary\n\nI just found that the Gratipay is vulnerable for adding used Primary Email Address to attacker account and Account takeover of the Gratipay. \n\n# Description\n\nI was looking at the source code of the application and I found that, \"If the email address `test@test.com` is already added in the `X` Gratipay account as primary email address, then the attacker can also add the `test@test.com` in the `Y` Gratipay account\". \n\nThe above attack can be achieved by using the `add-email` action and updating the `address` parameter with payload once you login to the account. \n\n# Steps To Reproduce\n\nAs you can see the line number 123 which is looking for the email address if it exists in the database.\n\nhttps://github.com/gratipay/gratipay.com/blob/04b85c20c681eab433e021fb9ce7d7a4258c7202/gratipay/models/participant/email.py#L123\n\nNormal behavior - When user will use the sandeepk.l337@gmail.com it is exists in the database it will not allow you add the email address in the different account, according the Line number 123.  \n\nAttack  - When the attacker try to add the sandeepk.1337@gmail.com which is already added into the other user's Gratipay account, however he can still add the other account's primary email into the attacker's  Gratipay account as primary email.\n\n`Payload:  action=add-email&address=sandeepk.l337@gmail.com%20` all you need to append the %20 (%20 is treated as the space but below line 123 is considering as new email address)\nhttps://github.com/gratipay/gratipay.com/blob/04b85c20c681eab433e021fb9ce7d7a4258c7202/gratipay/models/participant/email.py#L123\n\nOnce the above line executed then line number 131 and the application will send verification link to the email address. \n\nhttps://github.com/gratipay/gratipay.com/blob/04b85c20c681eab433e021fb9ce7d7a4258c7202/gratipay/models/participant/email.py#L131\n\nIf the Victim's email address is stolen or the attacker have temporary access to the email, then attacker can create new account on the Gratipay and add the Victim's email address into this Gratipay account. The attacker will receive all the Payment related emails and using forgot my password attacker can takeover the account. \n\n# PoC \nKindly find the attached screen shot. \n\n# Patch\nOn the line number 314 the application updating the table without verifying that, \"the requested email address is already exists in the database and assigned to other account\".  \n\nhttps://github.com/gratipay/gratipay.com/blob/04b85c20c681eab433e021fb9ce7d7a4258c7202/gratipay/models/participant/email.py#L314\n\nThe simple patch would be verifying the space encoding characters and also verifying the account is already exists in the database and assigned to the other account. \n\nIf you have any question or you need video PoC then let me know I'll prepare it separately. \n\n\nCheers. ", 
    "activity_page_count": 1, 
    "severity": {
        "rating": "none", 
        "author_type": "Team"
    }, 
    "title": "Adding Used Primary Email Address to attacker account and Account takeover", 
    "is_member_of_team?": null, 
    "vote_count": 1, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_view?": true, 
            "can_edit?": false, 
            "id": 5486, 
            "content": "tl;dr: This bug is informational and has low severity.   ", 
            "content_html": "<p>tl;dr: This bug is informational and has low severity.   </p>\n"
        }
    ], 
    "structured_scope": {
        "asset_identifier": "https://gratipay.com", 
        "max_severity": "critical", 
        "databaseId": 371, 
        "asset_type": "URL"
    }, 
    "allow_singular_disclosure_at": null, 
    "state": "Closed", 
    "cve_ids": [], 
    "activity_page_number": 1, 
    "readable_substate": "Informative", 
    "public": true, 
    "attachments": [
        {
            "file_name": "Same_Email_address_into_two_different_account_as_primary_email.png", 
            "type": "image/png", 
            "id": 225580, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/225/580/44ec99c5d2228c94d8bd89ee7b516a3e5da582c0/Same_Email_address_into_two_different_account_as_primary_email.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5B43OTPE%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T223153Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDCiDARkX3ArKGaO7%2ByK3A39tqjzyooRkX4qPdNM7MkAemep3r5%2Fh%2B11ZdH6KbZ8q2cgU%2FRMODKRq75fJ6sn%2FkR1fBrPaMFfKsP%2BSLpkSrkbyi968FqbmO6yo59Heb3d1kDMwzaNShj3ou%2Fq9qAc5NWgXlxJtABJqkgxPd5NovxMOsASin8kfBjU8OhOOEnonvd2t16oF509MVoA81P%2Frmr4njIb3UfHzYyccuDQNjHM0qV7B57bCKQeIuO%2FzLl7au%2FWR2v6R6bwK6fGUYVbcnAam9GqobWJnMl6NFbipNSdmUzB5%2BglRYaYeGXxbgxseM7SSFeehfzbywUoHEf4Ve61V1e90uyx3M0Krbm5QjS5gNgwErj0g2rC2mkrl2q%2B9ADfOzgMAX8fUODFalEv4gZf0ZKuLhpmAzEapJE5f%2BarcSkdn5b0ddy4Wa2vdsZ6lQ5NOez8qkcnaBEJZLnv3YGHyInLrIaUkqlq4iavZpr4f5Al5PueqIzLuItn5ztJjfvCu5dDIplWP0eo6r%2BIUCKsDwUNkRSgWCtJbCfl%2BPF3PKHjvnmVEBawLZlpXvaOGUvA%2FKYb2cGGXn89CPjYlwpWCj2J8Z%2B0okbim4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=79745975755a7d37a6d53894b303144762180dbebded997d9d7437359d4ef591"
        }, 
        {
            "file_name": "Payload.png", 
            "type": "image/png", 
            "id": 225581, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/225/581/5e00a63ff6c7ff65361dd9f46c026564b74a0fda/Payload.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5B43OTPE%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T223153Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDCiDARkX3ArKGaO7%2ByK3A39tqjzyooRkX4qPdNM7MkAemep3r5%2Fh%2B11ZdH6KbZ8q2cgU%2FRMODKRq75fJ6sn%2FkR1fBrPaMFfKsP%2BSLpkSrkbyi968FqbmO6yo59Heb3d1kDMwzaNShj3ou%2Fq9qAc5NWgXlxJtABJqkgxPd5NovxMOsASin8kfBjU8OhOOEnonvd2t16oF509MVoA81P%2Frmr4njIb3UfHzYyccuDQNjHM0qV7B57bCKQeIuO%2FzLl7au%2FWR2v6R6bwK6fGUYVbcnAam9GqobWJnMl6NFbipNSdmUzB5%2BglRYaYeGXxbgxseM7SSFeehfzbywUoHEf4Ve61V1e90uyx3M0Krbm5QjS5gNgwErj0g2rC2mkrl2q%2B9ADfOzgMAX8fUODFalEv4gZf0ZKuLhpmAzEapJE5f%2BarcSkdn5b0ddy4Wa2vdsZ6lQ5NOez8qkcnaBEJZLnv3YGHyInLrIaUkqlq4iavZpr4f5Al5PueqIzLuItn5ztJjfvCu5dDIplWP0eo6r%2BIUCKsDwUNkRSgWCtJbCfl%2BPF3PKHjvnmVEBawLZlpXvaOGUvA%2FKYb2cGGXn89CPjYlwpWCj2J8Z%2B0okbim4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=34db8c6db6e2e8e2ad8ca3df72fad7160c64fe26673185c2545e21ba95d0c96c"
        }
    ], 
    "singular_disclosure_disabled": true, 
    "activities": [
        {
            "automated_response": true, 
            "created_at": "2017-10-01T19:24:07.532Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-01T19:24:07.532Z", 
            "actor": {
                "url": "/gratipay", 
                "profile": {
                    "name": "Gratipay"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/868/d74b2c3d5d3975cb38a59a3176d952c3553a72f1_medium.jpg?1458214340"
                }
            }, 
            "team_handle": "gratipay", 
            "message": "Hi,\n\nThank you for your report, the receipt of which we herewith confirm. We are currently verifying the issue you reported.\n\nPlease expect additional feedback from us within the next couple of days. The \"INFORMATION SECURITY\" section of the following page has additional, useful information regarding our platform's security: http://inside.gratipay.com/howto/manage-risk\n\nWe appreciate your interest in securing our platform and look forward to working with you.\n\nYours sincerely,\nThe Gratipay Security Team", 
            "markdown_message": "<p>Hi,</p>\n\n<p>Thank you for your report, the receipt of which we herewith confirm. We are currently verifying the issue you reported.</p>\n\n<p>Please expect additional feedback from us within the next couple of days. The &quot;INFORMATION SECURITY&quot; section of the following page has additional, useful information regarding our platform&#39;s security: <a title=\"http://inside.gratipay.com/howto/manage-risk\" href=\"/redirect?signature=07ac30e85504acda37e3b100c87a61a058907aa9&amp;url=http%3A%2F%2Finside.gratipay.com%2Fhowto%2Fmanage-risk\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://inside.gratipay.com/howto/manage-risk</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>We appreciate your interest in securing our platform and look forward to working with you.</p>\n\n<p>Yours sincerely,<br>\nThe Gratipay Security Team</p>\n", 
            "type": "Activities::Comment", 
            "id": 2036702, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-01T19:57:28.355Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-01T19:57:28.355Z", 
            "actor": {
                "username": "cdl", 
                "url": "/cdl", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/114/524/8c1860c79bd621ea9fb8516c31eae5a6d3622dc0_medium.jpg?1543706379"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "gratipay", 
            "message": "Hi @sandeepl337,\n\nThanks for the report, we are currently investigating and will get back to you.\n\nBest regards,\nCorben Douglas\n", 
            "markdown_message": "<p>Hi <a href=\"/sandeepl337\">@sandeepl337</a>,</p>\n\n<p>Thanks for the report, we are currently investigating and will get back to you.</p>\n\n<p>Best regards,<br>\nCorben Douglas</p>\n", 
            "type": "Activities::Comment", 
            "id": 2036724, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-01T19:57:53.010Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-01T19:57:53.010Z", 
            "actor": {
                "username": "cdl", 
                "url": "/cdl", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/114/524/8c1860c79bd621ea9fb8516c31eae5a6d3622dc0_medium.jpg?1543706379"
                }, 
                "hackerone_triager": false
            }, 
            "additional_data": {
                "new_severity": "Low", 
                "old_severity": "Critical (10.0)"
            }, 
            "team_handle": "gratipay", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportSeverityUpdated", 
            "id": 2036726, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-01T20:01:20.043Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-01T20:01:20.043Z", 
            "actor": {
                "username": "edoverflow", 
                "url": "/edoverflow", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/116/374/95f9ffa246b2d43ca4f14a95d8815f429544fe54_medium.png?1527882436"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "gratipay", 
            "message": "Hi @sandeepl337,\n\nBased on your initial description, this appears to be functioning as intended. By adding a primary email address the attacker's account cannot actually access the victim's account, hence this is not an account takeover vulnerability. I am closing this as `Informative` instead of `N/A`, because you took the time to read our source code and demonstrated a good understanding of how the code works.\n\nBest regards,\nEd", 
            "markdown_message": "<p>Hi <a href=\"/sandeepl337\">@sandeepl337</a>,</p>\n\n<p>Based on your initial description, this appears to be functioning as intended. By adding a primary email address the attacker&#39;s account cannot actually access the victim&#39;s account, hence this is not an account takeover vulnerability. I am closing this as <code>Informative</code> instead of <code>N/A</code>, because you took the time to read our source code and demonstrated a good understanding of how the code works.</p>\n\n<p>Best regards,<br>\nEd</p>\n", 
            "type": "Activities::BugInformative", 
            "id": 2036730, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-01T20:01:26.397Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-01T20:01:26.397Z", 
            "actor": {
                "username": "edoverflow", 
                "url": "/edoverflow", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/116/374/95f9ffa246b2d43ca4f14a95d8815f429544fe54_medium.png?1527882436"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "gratipay", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 2036732, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-01T20:02:04.188Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-01T20:02:04.188Z", 
            "actor": {
                "username": "edoverflow", 
                "url": "/edoverflow", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/116/374/95f9ffa246b2d43ca4f14a95d8815f429544fe54_medium.png?1527882436"
                }, 
                "hackerone_triager": false
            }, 
            "additional_data": {
                "new_severity": "None", 
                "old_severity": "Low"
            }, 
            "team_handle": "gratipay", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportSeverityUpdated", 
            "id": 2036733, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-01T20:07:09.266Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-01T20:07:09.266Z", 
            "actor": {
                "username": "sandeepl337", 
                "url": "/sandeepl337", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/273/dde034bd75a3b37277e21f7be9dc31cee9466f86_medium.png?1440221484"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "gratipay", 
            "message": "Hi Edio, \n\nThank you for the quick investigation. Just the quick question - is it allowed to add the same email account in two different accounts ?", 
            "markdown_message": "<p>Hi Edio, </p>\n\n<p>Thank you for the quick investigation. Just the quick question - is it allowed to add the same email account in two different accounts ?</p>\n", 
            "type": "Activities::Comment", 
            "id": 2036741, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-01T20:08:40.206Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-01T20:08:40.206Z", 
            "actor": {
                "username": "edoverflow", 
                "url": "/edoverflow", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/116/374/95f9ffa246b2d43ca4f14a95d8815f429544fe54_medium.png?1527882436"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "gratipay", 
            "message": "Hi @sandeepl337,\n\nYep, in our case this is an intended feature.", 
            "markdown_message": "<p>Hi <a href=\"/sandeepl337\">@sandeepl337</a>,</p>\n\n<p>Yep, in our case this is an intended feature.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2036744, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-01T20:14:43.568Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-01T20:14:43.568Z", 
            "actor": {
                "username": "sandeepl337", 
                "url": "/sandeepl337", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/273/dde034bd75a3b37277e21f7be9dc31cee9466f86_medium.png?1440221484"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "gratipay", 
            "message": "Thank you for the update. I'm just trying to understand the code actually. So one more quick question. The code is actually is not allowing to set the `test@test.com` email in two different Gratipay accounts as you can see https://github.com/gratipay/gratipay.com/blob/04b85c20c681eab433e021fb9ce7d7a4258c7202/gratipay/models/participant/email.py#L123\n\nEven I've tried to execute using your website, it is not allowing to add same email in two different account. Correct me if I'm wrong. If it feature, never mind  :)  . \n\nThanks ", 
            "markdown_message": "<p>Thank you for the update. I&#39;m just trying to understand the code actually. So one more quick question. The code is actually is not allowing to set the <code>test@test.com</code> email in two different Gratipay accounts as you can see <a title=\"https://github.com/gratipay/gratipay.com/blob/04b85c20c681eab433e021fb9ce7d7a4258c7202/gratipay/models/participant/email.py#L123\" href=\"/redirect?signature=555413cf2369062eedc8f144bc002402d8218349&amp;url=https%3A%2F%2Fgithub.com%2Fgratipay%2Fgratipay.com%2Fblob%2F04b85c20c681eab433e021fb9ce7d7a4258c7202%2Fgratipay%2Fmodels%2Fparticipant%2Femail.py%23L123\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/gratipay/gratipay.com/blob/04b85c20c681eab433e021fb9ce7d7a4258c7202/gratipay/models/participant/email.py#L123</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>Even I&#39;ve tried to execute using your website, it is not allowing to add same email in two different account. Correct me if I&#39;m wrong. If it feature, never mind  :)  . </p>\n\n<p>Thanks </p>\n", 
            "type": "Activities::Comment", 
            "id": 2036751, 
            "genius_execution_id": null
        }, 
        {
            "attachments": [
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/225/588/d5bef3d985a1db907b89410c5afc544c7e5ff880/Screenshot_from_2017-10-01_22-30-44.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5B43OTPE%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T223154Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDCiDARkX3ArKGaO7%2ByK3A39tqjzyooRkX4qPdNM7MkAemep3r5%2Fh%2B11ZdH6KbZ8q2cgU%2FRMODKRq75fJ6sn%2FkR1fBrPaMFfKsP%2BSLpkSrkbyi968FqbmO6yo59Heb3d1kDMwzaNShj3ou%2Fq9qAc5NWgXlxJtABJqkgxPd5NovxMOsASin8kfBjU8OhOOEnonvd2t16oF509MVoA81P%2Frmr4njIb3UfHzYyccuDQNjHM0qV7B57bCKQeIuO%2FzLl7au%2FWR2v6R6bwK6fGUYVbcnAam9GqobWJnMl6NFbipNSdmUzB5%2BglRYaYeGXxbgxseM7SSFeehfzbywUoHEf4Ve61V1e90uyx3M0Krbm5QjS5gNgwErj0g2rC2mkrl2q%2B9ADfOzgMAX8fUODFalEv4gZf0ZKuLhpmAzEapJE5f%2BarcSkdn5b0ddy4Wa2vdsZ6lQ5NOez8qkcnaBEJZLnv3YGHyInLrIaUkqlq4iavZpr4f5Al5PueqIzLuItn5ztJjfvCu5dDIplWP0eo6r%2BIUCKsDwUNkRSgWCtJbCfl%2BPF3PKHjvnmVEBawLZlpXvaOGUvA%2FKYb2cGGXn89CPjYlwpWCj2J8Z%2B0okbim4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=16a18c63602ae68d6158dc8535e8b6758f52907010b2222f3e6b0116109bb232", 
                    "type": "image/png", 
                    "id": 225588, 
                    "filename": "Screenshot_from_2017-10-01_22-30-44.png"
                }
            ], 
            "automated_response": false, 
            "created_at": "2017-10-01T20:32:24.671Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-01T20:32:24.671Z", 
            "actor": {
                "username": "edoverflow", 
                "url": "/edoverflow", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/116/374/95f9ffa246b2d43ca4f14a95d8815f429544fe54_medium.png?1527882436"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "gratipay", 
            "message": "@sandeepl337: You are right. I just tested and was unable to add the same email address to two separate accounts. I apologize for responding without double checking and thank you for verifying.\n\n{F225588}", 
            "markdown_message": "<p><a href=\"/sandeepl337\">@sandeepl337</a>: You are right. I just tested and was unable to add the same email address to two separate accounts. I apologize for responding without double checking and thank you for verifying.</p>\n\n<p><a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screenshot_from_2017-10-01_22-30-44.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/225/588/d5bef3d985a1db907b89410c5afc544c7e5ff880/Screenshot_from_2017-10-01_22-30-44.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ5B43OTPE%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T223154Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDCiDARkX3ArKGaO7%2ByK3A39tqjzyooRkX4qPdNM7MkAemep3r5%2Fh%2B11ZdH6KbZ8q2cgU%2FRMODKRq75fJ6sn%2FkR1fBrPaMFfKsP%2BSLpkSrkbyi968FqbmO6yo59Heb3d1kDMwzaNShj3ou%2Fq9qAc5NWgXlxJtABJqkgxPd5NovxMOsASin8kfBjU8OhOOEnonvd2t16oF509MVoA81P%2Frmr4njIb3UfHzYyccuDQNjHM0qV7B57bCKQeIuO%2FzLl7au%2FWR2v6R6bwK6fGUYVbcnAam9GqobWJnMl6NFbipNSdmUzB5%2BglRYaYeGXxbgxseM7SSFeehfzbywUoHEf4Ve61V1e90uyx3M0Krbm5QjS5gNgwErj0g2rC2mkrl2q%2B9ADfOzgMAX8fUODFalEv4gZf0ZKuLhpmAzEapJE5f%2BarcSkdn5b0ddy4Wa2vdsZ6lQ5NOez8qkcnaBEJZLnv3YGHyInLrIaUkqlq4iavZpr4f5Al5PueqIzLuItn5ztJjfvCu5dDIplWP0eo6r%2BIUCKsDwUNkRSgWCtJbCfl%2BPF3PKHjvnmVEBawLZlpXvaOGUvA%2FKYb2cGGXn89CPjYlwpWCj2J8Z%2B0okbim4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=16a18c63602ae68d6158dc8535e8b6758f52907010b2222f3e6b0116109bb232\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/225/588/d5bef3d985a1db907b89410c5afc544c7e5ff880/Screenshot_from_2017-10-01_22-30-44.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ5B43OTPE%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T223154Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDCiDARkX3ArKGaO7%2ByK3A39tqjzyooRkX4qPdNM7MkAemep3r5%2Fh%2B11ZdH6KbZ8q2cgU%2FRMODKRq75fJ6sn%2FkR1fBrPaMFfKsP%2BSLpkSrkbyi968FqbmO6yo59Heb3d1kDMwzaNShj3ou%2Fq9qAc5NWgXlxJtABJqkgxPd5NovxMOsASin8kfBjU8OhOOEnonvd2t16oF509MVoA81P%2Frmr4njIb3UfHzYyccuDQNjHM0qV7B57bCKQeIuO%2FzLl7au%2FWR2v6R6bwK6fGUYVbcnAam9GqobWJnMl6NFbipNSdmUzB5%2BglRYaYeGXxbgxseM7SSFeehfzbywUoHEf4Ve61V1e90uyx3M0Krbm5QjS5gNgwErj0g2rC2mkrl2q%2B9ADfOzgMAX8fUODFalEv4gZf0ZKuLhpmAzEapJE5f%2BarcSkdn5b0ddy4Wa2vdsZ6lQ5NOez8qkcnaBEJZLnv3YGHyInLrIaUkqlq4iavZpr4f5Al5PueqIzLuItn5ztJjfvCu5dDIplWP0eo6r%2BIUCKsDwUNkRSgWCtJbCfl%2BPF3PKHjvnmVEBawLZlpXvaOGUvA%2FKYb2cGGXn89CPjYlwpWCj2J8Z%2B0okbim4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=16a18c63602ae68d6158dc8535e8b6758f52907010b2222f3e6b0116109bb232\" class=\"markdown-inline-image\"></a></p>\n", 
            "type": "Activities::Comment", 
            "id": 2036771, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-01T20:37:28.497Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-01T20:37:28.497Z", 
            "actor": {
                "username": "edoverflow", 
                "url": "/edoverflow", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/116/374/95f9ffa246b2d43ca4f14a95d8815f429544fe54_medium.png?1527882436"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "gratipay", 
            "message": "We still believe that this bug does not present any security implications.", 
            "markdown_message": "<p>We still believe that this bug does not present any security implications.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2036777, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-01T20:40:55.575Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-01T20:40:55.575Z", 
            "actor": {
                "username": "sandeepl337", 
                "url": "/sandeepl337", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/273/dde034bd75a3b37277e21f7be9dc31cee9466f86_medium.png?1440221484"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "gratipay", 
            "message": "Thank you for verifying at your end. So I believe now, we have a case where attacker can add the same email address to the multiple accounts. If the attacker add the email account, the attacker can receive the sensitive or user activity information like \"When my credit card is charged:\". \n\nThis is considered as business logic vulnerability which might not be directly executed but it has the impact. If you accept this bug(You may need to change Severity), then you can push the above mentioned fix.\n\n\nCheers  \n", 
            "markdown_message": "<p>Thank you for verifying at your end. So I believe now, we have a case where attacker can add the same email address to the multiple accounts. If the attacker add the email account, the attacker can receive the sensitive or user activity information like &quot;When my credit card is charged:&quot;. </p>\n\n<p>This is considered as business logic vulnerability which might not be directly executed but it has the impact. If you accept this bug(You may need to change Severity), then you can push the above mentioned fix.</p>\n\n<p>Cheers  </p>\n", 
            "type": "Activities::Comment", 
            "id": 2036780, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-01T23:58:52.273Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-01T23:58:52.273Z", 
            "actor": {
                "username": "ibram", 
                "url": "/ibram", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/020/024/c344b9dd16fa70ecf021bdae2449b08003fc27f4_medium.jpg?1476230562"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "gratipay", 
            "message": "@sandeepl337,\nCan you please explain why adding the same email address to multiple accounts is a security issue?\nBased on your comments, it seems like the attacker would be able to add the victim's email address to his own account (correct me if I am wrong). How would that lead to account takeover, based on your initial report?", 
            "markdown_message": "<p><a href=\"/sandeepl337\">@sandeepl337</a>,<br>\nCan you please explain why adding the same email address to multiple accounts is a security issue?<br>\nBased on your comments, it seems like the attacker would be able to add the victim&#39;s email address to his own account (correct me if I am wrong). How would that lead to account takeover, based on your initial report?</p>\n", 
            "type": "Activities::Comment", 
            "id": 2036874, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-02T05:37:18.555Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-02T05:37:18.555Z", 
            "actor": {
                "username": "sandeepl337", 
                "url": "/sandeepl337", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/273/dde034bd75a3b37277e21f7be9dc31cee9466f86_medium.png?1440221484"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "gratipay", 
            "message": "First, the account take over is not problem with this code and I had thought processing on the Same email can be used in multiple accounts. However, I found that this issue do not lead any security issue. \n\nLets close this ticket and Thank you for the brainstorming on this issue. ", 
            "markdown_message": "<p>First, the account take over is not problem with this code and I had thought processing on the Same email can be used in multiple accounts. However, I found that this issue do not lead any security issue. </p>\n\n<p>Lets close this ticket and Thank you for the brainstorming on this issue. </p>\n", 
            "type": "Activities::Comment", 
            "id": 2037075, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-02T05:48:01.490Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-02T05:48:01.490Z", 
            "actor": {
                "username": "cdl", 
                "url": "/cdl", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/114/524/8c1860c79bd621ea9fb8516c31eae5a6d3622dc0_medium.jpg?1543706379"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "gratipay", 
            "message": "Hi @sandeepl337 thanks for taking time and reading through our code, we're happy to see you're thinking of our security. Best of luck with future bug hunting!\nRegards,\nCorben Douglas", 
            "markdown_message": "<p>Hi <a href=\"/sandeepl337\">@sandeepl337</a> thanks for taking time and reading through our code, we&#39;re happy to see you&#39;re thinking of our security. Best of luck with future bug hunting!<br>\nRegards,<br>\nCorben Douglas</p>\n", 
            "type": "Activities::Comment", 
            "id": 2037079, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-05T14:30:36.999Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-05T14:30:36.999Z", 
            "actor": {
                "username": "sandeepl337", 
                "url": "/sandeepl337", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/273/dde034bd75a3b37277e21f7be9dc31cee9466f86_medium.png?1440221484"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "gratipay", 
            "message": "Kindly make the visibility public. ", 
            "markdown_message": "<p>Kindly make the visibility public. </p>\n", 
            "type": "Activities::Comment", 
            "id": 2046237, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-05T14:38:00.571Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-05T14:38:00.571Z", 
            "actor": {
                "username": "edoverflow", 
                "url": "/edoverflow", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/116/374/95f9ffa246b2d43ca4f14a95d8815f429544fe54_medium.png?1527882436"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "gratipay", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ManuallyDisclosed", 
            "id": 2046258, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "reporter": {
        "username": "sandeepl337", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/sandeepl337", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/273/8e81a0ac241d8a61b97103dbf1299a56ba487c5a_small.png?1440221484"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 65, 
        "name": "Business Logic Errors"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "disclosed_at": "2017-10-05T14:38:00.608Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/273647", 
    "created_at": "2017-10-01T19:24:07.343Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<h1 id=\"summary\">Summary</h1>\n\n<p>I just found that the Gratipay is vulnerable for adding used Primary Email Address to attacker account and Account takeover of the Gratipay. </p>\n\n<h1 id=\"description\">Description</h1>\n\n<p>I was looking at the source code of the application and I found that, &quot;If the email address <code>test@test.com</code> is already added in the <code>X</code> Gratipay account as primary email address, then the attacker can also add the <code>test@test.com</code> in the <code>Y</code> Gratipay account&quot;. </p>\n\n<p>The above attack can be achieved by using the <code>add-email</code> action and updating the <code>address</code> parameter with payload once you login to the account. </p>\n\n<h1 id=\"steps-to-reproduce\">Steps To Reproduce</h1>\n\n<p>As you can see the line number 123 which is looking for the email address if it exists in the database.</p>\n\n<p><a title=\"https://github.com/gratipay/gratipay.com/blob/04b85c20c681eab433e021fb9ce7d7a4258c7202/gratipay/models/participant/email.py#L123\" href=\"/redirect?signature=555413cf2369062eedc8f144bc002402d8218349&amp;url=https%3A%2F%2Fgithub.com%2Fgratipay%2Fgratipay.com%2Fblob%2F04b85c20c681eab433e021fb9ce7d7a4258c7202%2Fgratipay%2Fmodels%2Fparticipant%2Femail.py%23L123\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/gratipay/gratipay.com/blob/04b85c20c681eab433e021fb9ce7d7a4258c7202/gratipay/models/participant/email.py#L123</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>Normal behavior - When user will use the <a title=\"sandeepk.l337@gmail.com\" href=\"mailto:sandeepk.l337@gmail.com\" rel=\"nofollow noopener noreferrer\">sandeepk.l337@gmail.com</a> it is exists in the database it will not allow you add the email address in the different account, according the Line number 123.  </p>\n\n<p>Attack  - When the attacker try to add the <a title=\"sandeepk.1337@gmail.com\" href=\"mailto:sandeepk.1337@gmail.com\" rel=\"nofollow noopener noreferrer\">sandeepk.1337@gmail.com</a> which is already added into the other user&#39;s Gratipay account, however he can still add the other account&#39;s primary email into the attacker&#39;s  Gratipay account as primary email.</p>\n\n<p><code>Payload:  action=add-email&amp;address=sandeepk.l337@gmail.com%20</code> all you need to append the %20 (%20 is treated as the space but below line 123 is considering as new email address)<br>\n<a title=\"https://github.com/gratipay/gratipay.com/blob/04b85c20c681eab433e021fb9ce7d7a4258c7202/gratipay/models/participant/email.py#L123\" href=\"/redirect?signature=555413cf2369062eedc8f144bc002402d8218349&amp;url=https%3A%2F%2Fgithub.com%2Fgratipay%2Fgratipay.com%2Fblob%2F04b85c20c681eab433e021fb9ce7d7a4258c7202%2Fgratipay%2Fmodels%2Fparticipant%2Femail.py%23L123\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/gratipay/gratipay.com/blob/04b85c20c681eab433e021fb9ce7d7a4258c7202/gratipay/models/participant/email.py#L123</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>Once the above line executed then line number 131 and the application will send verification link to the email address. </p>\n\n<p><a title=\"https://github.com/gratipay/gratipay.com/blob/04b85c20c681eab433e021fb9ce7d7a4258c7202/gratipay/models/participant/email.py#L131\" href=\"/redirect?signature=690d9f370284f6b766f81db3d06c481d00a4d71a&amp;url=https%3A%2F%2Fgithub.com%2Fgratipay%2Fgratipay.com%2Fblob%2F04b85c20c681eab433e021fb9ce7d7a4258c7202%2Fgratipay%2Fmodels%2Fparticipant%2Femail.py%23L131\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/gratipay/gratipay.com/blob/04b85c20c681eab433e021fb9ce7d7a4258c7202/gratipay/models/participant/email.py#L131</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>If the Victim&#39;s email address is stolen or the attacker have temporary access to the email, then attacker can create new account on the Gratipay and add the Victim&#39;s email address into this Gratipay account. The attacker will receive all the Payment related emails and using forgot my password attacker can takeover the account. </p>\n\n<h1 id=\"poc\">PoC</h1>\n\n<p>Kindly find the attached screen shot. </p>\n\n<h1 id=\"patch\">Patch</h1>\n\n<p>On the line number 314 the application updating the table without verifying that, &quot;the requested email address is already exists in the database and assigned to other account&quot;.  </p>\n\n<p><a title=\"https://github.com/gratipay/gratipay.com/blob/04b85c20c681eab433e021fb9ce7d7a4258c7202/gratipay/models/participant/email.py#L314\" href=\"/redirect?signature=f05d521af7d6f01a61a6bbdfe892e8117428431f&amp;url=https%3A%2F%2Fgithub.com%2Fgratipay%2Fgratipay.com%2Fblob%2F04b85c20c681eab433e021fb9ce7d7a4258c7202%2Fgratipay%2Fmodels%2Fparticipant%2Femail.py%23L314\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/gratipay/gratipay.com/blob/04b85c20c681eab433e021fb9ce7d7a4258c7202/gratipay/models/participant/email.py#L314</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>The simple patch would be verifying the space encoding characters and also verifying the account is already exists in the database and assigned to the other account. </p>\n\n<p>If you have any question or you need video PoC then let me know I&#39;ll prepare it separately. </p>\n\n<p>Cheers. </p>\n", 
    "severity_rating": "none", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://gratipay.com/", 
            "about": "Gratitude? Gratipay! The easiest way for your company to pay for open source.", 
            "twitter_handle": "Gratipay", 
            "name": "Gratipay"
        }, 
        "handle": "gratipay", 
        "url": "https://hackerone.com/gratipay", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/001/868/5b2b5a44e2439cf6fe880b374cbbeaf38d740c6b_small.jpg?1458214340", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/001/868/d74b2c3d5d3975cb38a59a3176d952c3553a72f1_medium.jpg?1458214340"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 1868, 
        "default_currency": "usd"
    }, 
    "is_published": false
}