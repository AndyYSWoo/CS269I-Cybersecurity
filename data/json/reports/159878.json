{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2016-12-05T08:38:33.756Z", 
    "voters": [
        "spam404", 
        "bogdantcaciuc", 
        "flashdisk", 
        "eveeez", 
        "dmatrix", 
        "madrobot", 
        "mpz", 
        "harry_mg", 
        "ak1t4", 
        "an0n-j", 
        "and 9 more..."
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "400.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 159878, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": null, 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "[render.bitstrips.com] Stored XSS via an incorrect avatar property value", 
    "is_member_of_team?": null, 
    "vote_count": 19, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2017-01-04T08:38:33.798Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$400", 
    "attachments": [
        {
            "file_name": "bit_poc.wmv", 
            "type": "video/x-ms-asf", 
            "id": 112661, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/112/661/c95b98c625a347d2913e7613d60dd5c3a38bee2d/bit_poc.wmv?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5B43OTPE%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T224518Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDCiDARkX3ArKGaO7%2ByK3A39tqjzyooRkX4qPdNM7MkAemep3r5%2Fh%2B11ZdH6KbZ8q2cgU%2FRMODKRq75fJ6sn%2FkR1fBrPaMFfKsP%2BSLpkSrkbyi968FqbmO6yo59Heb3d1kDMwzaNShj3ou%2Fq9qAc5NWgXlxJtABJqkgxPd5NovxMOsASin8kfBjU8OhOOEnonvd2t16oF509MVoA81P%2Frmr4njIb3UfHzYyccuDQNjHM0qV7B57bCKQeIuO%2FzLl7au%2FWR2v6R6bwK6fGUYVbcnAam9GqobWJnMl6NFbipNSdmUzB5%2BglRYaYeGXxbgxseM7SSFeehfzbywUoHEf4Ve61V1e90uyx3M0Krbm5QjS5gNgwErj0g2rC2mkrl2q%2B9ADfOzgMAX8fUODFalEv4gZf0ZKuLhpmAzEapJE5f%2BarcSkdn5b0ddy4Wa2vdsZ6lQ5NOez8qkcnaBEJZLnv3YGHyInLrIaUkqlq4iavZpr4f5Al5PueqIzLuItn5ztJjfvCu5dDIplWP0eo6r%2BIUCKsDwUNkRSgWCtJbCfl%2BPF3PKHjvnmVEBawLZlpXvaOGUvA%2FKYb2cGGXn89CPjYlwpWCj2J8Z%2B0okbim4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=d155c90916534dcabb43093758818d379d978dce990bdf7d4969744b0e1e5584"
        }
    ], 
    "singular_disclosure_disabled": true, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2016-08-17T20:27:38.660Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-17T20:27:38.660Z", 
            "actor": {
                "username": "bugtriage-josh", 
                "url": "/bugtriage-josh", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "snapchat", 
            "message": "Thank you for your report.\n\nWhile this is interesting, it seems that this payload doesn't actually execute without user interaction, (you had to find the SVG and open it in a seperate window for the JavaScript to execute).  Can you demonstrate a way to perform a Cross-Site Scripting attack that does not require a user to do this?  Further, it seems that this attack is confined to your own account.  I'm not sure how you would be able to attack other users in this way.  Can you clarify how this attack could be used to attack other users?\n\nThanks, and good luck with your future bug hunting.", 
            "markdown_message": "<p>Thank you for your report.</p>\n\n<p>While this is interesting, it seems that this payload doesn&#39;t actually execute without user interaction, (you had to find the SVG and open it in a seperate window for the JavaScript to execute).  Can you demonstrate a way to perform a Cross-Site Scripting attack that does not require a user to do this?  Further, it seems that this attack is confined to your own account.  I&#39;m not sure how you would be able to attack other users in this way.  Can you clarify how this attack could be used to attack other users?</p>\n\n<p>Thanks, and good luck with your future bug hunting.</p>\n", 
            "type": "Activities::BugNeedsMoreInfo", 
            "id": 1132832, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-08-17T20:45:20.323Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-17T20:45:20.323Z", 
            "actor": {
                "username": "s_p_q_r", 
                "url": "/s_p_q_r", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/032/547/3374585ea2b1d03bea7462bcc3cf7c2275f0f738_medium.jpg?1433541220"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "snapchat", 
            "message": "Hello,\n\n> While this is interesting, it seems that this payload doesn't actually execute without user interaction, (you had to find the SVG and open it in a seperate window for the JavaScript to execute).\n\nI don't understand quite well what you mean here. As an **attacker** I do have to find it, as shown in my PoC, and then send to the victim. The victim doesn't have to do anything else but just open it.\n\n> Further, it seems that this attack is confined to your own account.\n\nNo, it is not. The link is available for everyone.\n\n\u00a0\nIn my report I provided a PoC link: https://render.bitstrips.com/render/6688424/173752531_2_s1-v1.png\n\nAfter a victim opens it, the script is executed without any user interaction. Did you try it?", 
            "markdown_message": "<p>Hello,</p>\n\n<blockquote>\n<p>While this is interesting, it seems that this payload doesn&#39;t actually execute without user interaction, (you had to find the SVG and open it in a seperate window for the JavaScript to execute).</p>\n</blockquote>\n\n<p>I don&#39;t understand quite well what you mean here. As an <strong>attacker</strong> I do have to find it, as shown in my PoC, and then send to the victim. The victim doesn&#39;t have to do anything else but just open it.</p>\n\n<blockquote>\n<p>Further, it seems that this attack is confined to your own account.</p>\n</blockquote>\n\n<p>No, it is not. The link is available for everyone.</p>\n\n<p>\u00a0<br>\nIn my report I provided a PoC link: <a title=\"https://render.bitstrips.com/render/6688424/173752531_2_s1-v1.png\" href=\"/redirect?signature=7dda9c662c78f93e05c4eb690a001b528be28e1c&amp;url=https%3A%2F%2Frender.bitstrips.com%2Frender%2F6688424%2F173752531_2_s1-v1.png\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://render.bitstrips.com/render/6688424/173752531_2_s1-v1.png</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>After a victim opens it, the script is executed without any user interaction. Did you try it?</p>\n", 
            "type": "Activities::BugNew", 
            "id": 1132871, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-08-17T21:29:18.034Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-17T21:31:00.733Z", 
            "actor": {
                "username": "bugtriage-josh", 
                "url": "/bugtriage-josh", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "snapchat", 
            "message": "@s_p_q_r -- Ah OK, I understand now; sorry about that.  We are able to reproduce this behavior, and we'll be sure to reach out if we have further questions, as we continue to investigate.", 
            "markdown_message": "<p><a href=\"/s_p_q_r\">@s_p_q_r</a> -- Ah OK, I understand now; sorry about that.  We are able to reproduce this behavior, and we&#39;ll be sure to reach out if we have further questions, as we continue to investigate.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1132995, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-08-17T22:22:54.219Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-17T22:22:54.219Z", 
            "actor": {
                "username": "s_p_q_r", 
                "url": "/s_p_q_r", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/032/547/3374585ea2b1d03bea7462bcc3cf7c2275f0f738_medium.jpg?1433541220"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "snapchat", 
            "message": "Ok, I see, no problem. Thanks for taking a look!", 
            "markdown_message": "<p>Ok, I see, no problem. Thanks for taking a look!</p>\n", 
            "type": "Activities::Comment", 
            "id": 1133133, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-08-22T20:54:51.444Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-22T20:54:51.444Z", 
            "actor": {
                "username": "divya", 
                "url": "/divya", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "snapchat", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugTriaged", 
            "id": 1145907, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2016-09-29T00:20:39.578Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-09-29T00:20:39.578Z", 
            "actor": {
                "url": "/snapchat", 
                "profile": {
                    "name": "Snapchat"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/513/05cbda412fc3539d8297bd6865bd59af476be2ce_medium.png?1432078031"
                }
            }, 
            "team_handle": "snapchat", 
            "bounty_amount": "400.0", 
            "collaborator": {
                "username": "s_p_q_r", 
                "url": "/s_p_q_r"
            }, 
            "message": "Hi @s_p_q_r \n\nYour PoC should no longer work. We are rolling out some more defenses around this. Please note that this domain does not have any authentication, which limits what you can do. We will leave this report open until all the changes land in production.\n\nCongratulations! The panel has decided to award you $400 for your bug report. We appreciate your efforts - thanks, and good luck on your future bug hunting!", 
            "markdown_message": "<p>Hi <a href=\"/s_p_q_r\">@s_p_q_r</a> </p>\n\n<p>Your PoC should no longer work. We are rolling out some more defenses around this. Please note that this domain does not have any authentication, which limits what you can do. We will leave this report open until all the changes land in production.</p>\n\n<p>Congratulations! The panel has decided to award you $400 for your bug report. We appreciate your efforts - thanks, and good luck on your future bug hunting!</p>\n", 
            "type": "Activities::BountyAwarded", 
            "id": 1222821, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "s_p_q_r", 
                "url": "/s_p_q_r"
            }, 
            "created_at": "2016-10-20T18:08:00.077Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-10-20T18:08:00.077Z", 
            "actor": {
                "username": "gdb", 
                "url": "/gdb", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "snapchat", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugResolved", 
            "id": 1258444, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-10-31T20:18:21.922Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-10-31T20:18:21.922Z", 
            "actor": {
                "username": "s_p_q_r", 
                "url": "/s_p_q_r", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/032/547/3374585ea2b1d03bea7462bcc3cf7c2275f0f738_medium.jpg?1433541220"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "snapchat", 
            "message": "Hi,\n\nYep, looks fixed now.\n\nThanks for the bounty!", 
            "markdown_message": "<p>Hi,</p>\n\n<p>Yep, looks fixed now.</p>\n\n<p>Thanks for the bounty!</p>\n", 
            "type": "Activities::Comment", 
            "id": 1276995, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-12-05T08:38:33.773Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-12-05T08:38:33.773Z", 
            "actor": {
                "username": "s_p_q_r", 
                "url": "/s_p_q_r", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/032/547/3374585ea2b1d03bea7462bcc3cf7c2275f0f738_medium.jpg?1433541220"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "snapchat", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1340760, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-01-04T08:38:41.632Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-01-04T08:38:41.632Z", 
            "actor": {
                "url": "/snapchat", 
                "profile": {
                    "name": "Snapchat"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/513/05cbda412fc3539d8297bd6865bd59af476be2ce_medium.png?1432078031"
                }
            }, 
            "team_handle": "snapchat", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 1398183, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "s_p_q_r", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/s_p_q_r", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/032/547/096b7aa1face7e7ce0fe10d3382ec45d167fc546_small.jpg?1433541220"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 60, 
        "name": "Cross-site Scripting (XSS) - Generic"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -60617204.39993844, 
    "disclosed_at": "2017-01-04T08:38:41.609Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/159878", 
    "created_at": "2016-08-16T23:25:17.572Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>While modifying an avatar, an attacker has the opportunity to submit XSS payloads as its property values. The resulting png file will return a 500 error with the payload in the response body. The response has a <strong>text/html</strong> content type, which makes the XSS attack possible.</p>\n\n<p><strong>PoC:</strong></p>\n\n<ol>\n<li>Go to <a title=\"https://www.bitmoji.com/account/\" href=\"/redirect?signature=4c44c899f4cd67679f0b654eff44417c76bf5c13&amp;url=https%3A%2F%2Fwww.bitmoji.com%2Faccount%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.bitmoji.com/account/</span><i class=\"icon-external-link\"></i></a> and create a new account</li>\n<li>Choose the avatar style and save it. The following POST request will be sent:</li>\n</ol>\n\n<blockquote>\n<p>POST /user/avatar?styles=1,4&amp;app_id=13 HTTP/1.1<br>\nHost: api.bitmoji.com</p>\n\n<p>avatar_id=%id%&amp;char_data=%data%</p>\n</blockquote>\n\n<p>3. Modify the <strong>data</strong> value: set any <strong>pd2</strong> object property value (for example, <strong>jaw</strong>) to <strong>&lt;svg onload=alert(document.domain)&gt;</strong>:</p>\n<pre class=\"highlight plaintext\"><code>{&quot;colours&quot;:{},&quot;pd2&quot;:{&quot;cranium&quot;:&quot;cranium_midstraightmale&quot;,&quot;forehead&quot;:&quot;forehead_standard&quot;,&quot;hair_back&quot;:&quot;hair_back_midstraightmale&quot;,&quot;hair_front&quot;:&quot;hair_front_midstraightmale&quot;,&quot;hairbottom&quot;:&quot;hairbottom_blank&quot;,&quot;detail_L2_L&quot;:&quot;_blank&quot;,&quot;detail_L2_R&quot;:&quot;_blank&quot;,&quot;jaw&quot;:&quot;&lt;svg onload=alert(document.domain)&gt;&quot;,&quot;beard&quot;:&quot;_blank&quot;,&quot;stachin&quot;:&quot;_blank&quot;,&quot;stachout&quot;:&quot;_blank&quot;},&quot;body&quot;:{},&quot;style&quot;:1}\n</code></pre>\n<p>and submit the request again.</p>\n\n<p>4. Go to your account and click &quot;Edit yor avatar&quot;. In your browser web console you will see a <a title=\"https://render.bitstrips.com/render/***/*.png\" href=\"/redirect?signature=02e8f6980eb030f4f5ffcd12d19f20b2c7a76150&amp;url=https%3A%2F%2Frender.bitstrips.com%2Frender%2F%2A%2A%2A%2F%2A.png\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://render.bitstrips.com/render/***/*.png</span><i class=\"icon-external-link\"></i></a> link with a 500 error. Open this link.</p>\n\n<p>The script will be executed.</p>\n\n<p>A PoC link: <a title=\"https://render.bitstrips.com/render/6688424/173752531_2_s1-v1.png\" href=\"/redirect?signature=7dda9c662c78f93e05c4eb690a001b528be28e1c&amp;url=https%3A%2F%2Frender.bitstrips.com%2Frender%2F6688424%2F173752531_2_s1-v1.png\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://render.bitstrips.com/render/6688424/173752531_2_s1-v1.png</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>I also recorded a video (see the attachment) of these steps, I hope it will help you reproduce the issue.</p>\n", 
    "vulnerability_information": "While modifying an avatar, an attacker has the opportunity to submit XSS payloads as its property values. The resulting png file will return a 500 error with the payload in the response body. The response has a **text/html** content type, which makes the XSS attack possible.\n\n**PoC:**\n\n1. Go to https://www.bitmoji.com/account/ and create a new account\n2. Choose the avatar style and save it. The following POST request will be sent:\n\n> POST /user/avatar?styles=1,4&app_id=13 HTTP/1.1\n> Host: api.bitmoji.com\n> \n> avatar_id=%id%&char_data=%data%\n\n3\\. Modify the **data** value: set any **pd2** object property value (for example, **jaw**) to **<svg onload=alert(document.domain)>**:\n\n```\n{\"colours\":{},\"pd2\":{\"cranium\":\"cranium_midstraightmale\",\"forehead\":\"forehead_standard\",\"hair_back\":\"hair_back_midstraightmale\",\"hair_front\":\"hair_front_midstraightmale\",\"hairbottom\":\"hairbottom_blank\",\"detail_L2_L\":\"_blank\",\"detail_L2_R\":\"_blank\",\"jaw\":\"<svg onload=alert(document.domain)>\",\"beard\":\"_blank\",\"stachin\":\"_blank\",\"stachout\":\"_blank\"},\"body\":{},\"style\":1}\n```\n\nand submit the request again.\n\n4\\. Go to your account and click \"Edit yor avatar\". In your browser web console you will see a https://render.bitstrips.com/render/***/*.png link with a 500 error. Open this link.\n\nThe script will be executed.\n\nA PoC link: https://render.bitstrips.com/render/6688424/173752531_2_s1-v1.png\n\nI also recorded a video (see the attachment) of these steps, I hope it will help you reproduce the issue.\n\n\n", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://www.snapchat.com/", 
            "about": "", 
            "twitter_handle": "", 
            "name": "Snapchat"
        }, 
        "handle": "snapchat", 
        "url": "https://hackerone.com/snapchat", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/513/787aa235c91a9f2ac341e1c826c7dbbeeb118393_small.png?1432078031", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/513/05cbda412fc3539d8297bd6865bd59af476be2ce_medium.png?1432078031"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 513, 
        "default_currency": "usd"
    }, 
    "is_published": false
}