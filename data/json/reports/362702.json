{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "informative", 
    "bug_reporter_agreed_on_going_public_at": "2018-07-06T13:34:36.730Z", 
    "voters": [
        "ibrahimd"
    ], 
    "facebook_team?": false, 
    "has_bounty?": false, 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 362702, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2018-07-06T10:37:28.062Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "XSS in express-useragent through HTTP User-Agent", 
    "is_member_of_team?": null, 
    "vote_count": 1, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": {
        "asset_identifier": "express-useragent", 
        "max_severity": "critical", 
        "databaseId": 11571, 
        "asset_type": "SOURCE_CODE"
    }, 
    "allow_singular_disclosure_at": null, 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Informative", 
    "public": true, 
    "attachments": [
        {
            "file_name": "express_useragent_xss.mkv", 
            "type": "video/x-matroska", 
            "id": 305912, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/305/912/8c4e45709d9acdfbb5f4a707c76fc698192695a3/express_useragent_xss.mkv?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ2IMG7FL4%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T221918Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDHPJ1yKYcYWYj%2F9LNiK3AzyAo4x%2BPxakyZiJlRkk9M72fGqw4SrPH5qRWwrCEzUaWrTNXkqpALXRS4Q9wnQBmHJ21tNzuwZNzHm1q41ngqtlwpJP4F8P9DJ8J86pGXCj5zxKl27Xdyrp0yXro5KHbNg%2FMI31tP3CPajYLHppvbpzE4HgT6%2BgX56T9THRU9i0iPR2sPERJ5V8T5PqNGlaAxkIH%2BcDEYPwwdeod1TBqaVJeTbSTUwavuHFWj8I9aJc5ijS9LvHWHNGB5FXbFATn8ghcjqVzqIroA9nxNuPJ2vxIaAor9r4p%2Fy1e5TWqKKtSEWtQu68kIwE8NsRg80HQRso%2BCvRE8ecUk4iHSIS0Q3jmxteI2SvJRO0qZ3QaRjTDGmiTz95bj%2F%2F4H%2BR7Jy4C8RK9HLXC%2BPnDh%2FazH%2BgKdjL01iP%2BgzbXEnOyhh3IA5Imss19EK%2B2EWDifocttquTy%2F9L1a3OBtcs43O1R7Q7IURroixlPAhRunZI2Z9MyZSlDzcJsSgY9uPguXfm%2BdDi6ysAHwhyXucVtSiReGyNvDkzSArwNHacFF2yzh47gdSbs3NLHHvBIWOzk4ozBhf5yrOj2mTit4ouKem4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=db1936d3707170abb8659389bbe4870d403f29457bdbbb22d1ce14b73b6dd362"
        }, 
        {
            "file_name": "Screenshot_from_2018-04-09_18-50-35_(1).png", 
            "type": "image/png", 
            "id": 305913, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/305/913/2cf634e9d3228e78c63df9b9457467db928168b8/Screenshot_from_2018-04-09_18-50-35_%281%29.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ2IMG7FL4%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T221918Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDHPJ1yKYcYWYj%2F9LNiK3AzyAo4x%2BPxakyZiJlRkk9M72fGqw4SrPH5qRWwrCEzUaWrTNXkqpALXRS4Q9wnQBmHJ21tNzuwZNzHm1q41ngqtlwpJP4F8P9DJ8J86pGXCj5zxKl27Xdyrp0yXro5KHbNg%2FMI31tP3CPajYLHppvbpzE4HgT6%2BgX56T9THRU9i0iPR2sPERJ5V8T5PqNGlaAxkIH%2BcDEYPwwdeod1TBqaVJeTbSTUwavuHFWj8I9aJc5ijS9LvHWHNGB5FXbFATn8ghcjqVzqIroA9nxNuPJ2vxIaAor9r4p%2Fy1e5TWqKKtSEWtQu68kIwE8NsRg80HQRso%2BCvRE8ecUk4iHSIS0Q3jmxteI2SvJRO0qZ3QaRjTDGmiTz95bj%2F%2F4H%2BR7Jy4C8RK9HLXC%2BPnDh%2FazH%2BgKdjL01iP%2BgzbXEnOyhh3IA5Imss19EK%2B2EWDifocttquTy%2F9L1a3OBtcs43O1R7Q7IURroixlPAhRunZI2Z9MyZSlDzcJsSgY9uPguXfm%2BdDi6ysAHwhyXucVtSiReGyNvDkzSArwNHacFF2yzh47gdSbs3NLHHvBIWOzk4ozBhf5yrOj2mTit4ouKem4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=45c96e9799e69930e1a262cf99967d405900c00cab1ef4cc6465b182dfaf0319"
        }, 
        {
            "file_name": "Screenshot_from_2018-04-09_18-51-21_(1).png", 
            "type": "image/png", 
            "id": 305914, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/305/914/8773f06a8e47477582c406f804456e7c06e028cd/Screenshot_from_2018-04-09_18-51-21_%281%29.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ2IMG7FL4%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T221918Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDHPJ1yKYcYWYj%2F9LNiK3AzyAo4x%2BPxakyZiJlRkk9M72fGqw4SrPH5qRWwrCEzUaWrTNXkqpALXRS4Q9wnQBmHJ21tNzuwZNzHm1q41ngqtlwpJP4F8P9DJ8J86pGXCj5zxKl27Xdyrp0yXro5KHbNg%2FMI31tP3CPajYLHppvbpzE4HgT6%2BgX56T9THRU9i0iPR2sPERJ5V8T5PqNGlaAxkIH%2BcDEYPwwdeod1TBqaVJeTbSTUwavuHFWj8I9aJc5ijS9LvHWHNGB5FXbFATn8ghcjqVzqIroA9nxNuPJ2vxIaAor9r4p%2Fy1e5TWqKKtSEWtQu68kIwE8NsRg80HQRso%2BCvRE8ecUk4iHSIS0Q3jmxteI2SvJRO0qZ3QaRjTDGmiTz95bj%2F%2F4H%2BR7Jy4C8RK9HLXC%2BPnDh%2FazH%2BgKdjL01iP%2BgzbXEnOyhh3IA5Imss19EK%2B2EWDifocttquTy%2F9L1a3OBtcs43O1R7Q7IURroixlPAhRunZI2Z9MyZSlDzcJsSgY9uPguXfm%2BdDi6ysAHwhyXucVtSiReGyNvDkzSArwNHacFF2yzh47gdSbs3NLHHvBIWOzk4ozBhf5yrOj2mTit4ouKem4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=69534b7ae45ac1b944693f3ee2bbc77c2ee787cf91ffea59c8d42988bcced2f5"
        }
    ], 
    "singular_disclosure_disabled": true, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2018-06-16T18:53:36.963Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-06-16T18:53:36.963Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugTriaged", 
            "id": 2894629, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-06-16T18:58:57.143Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-06-16T18:58:57.143Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "Hi @ibrahimd \n\nThanks for reporting this issue.\nI will invite the package maintainer to this issue.\n\nI'm not sure I follow the actual vulnerability. The POC happens when the useragent string is sent back to the client that requests it. The purpose of the middleware is to parse useragent data and it will be odd to escape it in the middleware.\n\nIMO it will be the responsibility of the user using this middleware to understand which context it is used and escape it properly (it can be JSON, markdown, HTML, JS, etc)", 
            "markdown_message": "<p>Hi <a href=\"/ibrahimd\">@ibrahimd</a> </p>\n\n<p>Thanks for reporting this issue.<br>\nI will invite the package maintainer to this issue.</p>\n\n<p>I&#39;m not sure I follow the actual vulnerability. The POC happens when the useragent string is sent back to the client that requests it. The purpose of the middleware is to parse useragent data and it will be odd to escape it in the middleware.</p>\n\n<p>IMO it will be the responsibility of the user using this middleware to understand which context it is used and escape it properly (it can be JSON, markdown, HTML, JS, etc)</p>\n", 
            "type": "Activities::Comment", 
            "id": 2894646, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-06-17T15:35:10.728Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-06-17T15:35:10.728Z", 
            "actor": {
                "username": "ba3142c38d7de2241d2c522", 
                "url": "/ba3142c38d7de2241d2c522", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ExternalUserJoined", 
            "id": 2896719, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-06-17T15:38:37.778Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-06-17T15:38:37.778Z", 
            "actor": {
                "username": "ba3142c38d7de2241d2c522", 
                "url": "/ba3142c38d7de2241d2c522", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "I agree with @lirantal.", 
            "markdown_message": "<p>I agree with <a href=\"/lirantal\">@lirantal</a>.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2896723, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-06-17T18:02:53.242Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-06-17T18:02:53.242Z", 
            "actor": {
                "username": "ibrahimd", 
                "url": "/ibrahimd", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/171/863/d30061502060fc0f1fc22d5a8ea64ba95830a75c_medium.jpg?1527972686"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "Hi,\nSorry for the slow response. I agree with @lirantal:\n```\nIMO it will be the responsibility of the user using this middleware to understand which context it is used and escape it properly (it can be JSON, markdown, HTML, JS, etc)\n```\nBur here is the catch, I think that @bougakovgeorge should at least escape greater/less sign **<>** from the user agent value. By removing *<>* most if not all XSS vectors that require **<>** won't work. \nHere is a list of some user agents:\n* Mozilla/5.0 (Android 4.4; Mobile; rv:41.0) Gecko/41.0 Firefox/41.0\n* Mozilla/5.0 (X11; Linux x86_64; rv:10.0) Gecko/20100101 Firefox/10.0\n* Mozilla/5.0 (TV; rv:44.0) Gecko/44.0 Firefox/44.0\n\nAs you can see on the above list none of the user agent contains **<>* *, we could use a white list of allowed characters to minimize  XSS injection. I would like to suggest to update provided examples on github showing a secure way on how to implement the middleware for both client/server side.\n\nServer side:\n\nAs we know the middleware returns a JSON so we should set this HTTP HEADER `Content-Type: application/json` to prevent an XSS to be executed in modern web browsers.\n\nClient side:\n\nHere, its more complicated because it really depends on how the developer will use the return valued. Its more about which context the value will be reflected but in any case the user should sanitize the returned value before outputting/reflecting it.\n\nIf you need more information let me know,\n@ibrahimd  ", 
            "markdown_message": "<p>Hi,<br>\nSorry for the slow response. I agree with <a href=\"/lirantal\">@lirantal</a>:</p>\n<pre class=\"highlight plaintext\"><code>IMO it will be the responsibility of the user using this middleware to understand which context it is used and escape it properly (it can be JSON, markdown, HTML, JS, etc)\n</code></pre>\n<p>Bur here is the catch, I think that <a href=\"/bougakovgeorge\">@bougakovgeorge</a> should at least escape greater/less sign <strong>&lt;&gt;</strong> from the user agent value. By removing <em>&lt;&gt;</em> most if not all XSS vectors that require <strong>&lt;&gt;</strong> won&#39;t work. <br>\nHere is a list of some user agents:</p>\n\n<ul>\n<li>Mozilla/5.0 (Android 4.4; Mobile; rv:41.0) Gecko/41.0 Firefox/41.0</li>\n<li>Mozilla/5.0 (X11; Linux x86_64; rv:10.0) Gecko/20100101 Firefox/10.0</li>\n<li>Mozilla/5.0 (TV; rv:44.0) Gecko/44.0 Firefox/44.0</li>\n</ul>\n\n<p>As you can see on the above list none of the user agent contains *<em>&lt;&gt;</em> *, we could use a white list of allowed characters to minimize  XSS injection. I would like to suggest to update provided examples on github showing a secure way on how to implement the middleware for both client/server side.</p>\n\n<p>Server side:</p>\n\n<p>As we know the middleware returns a JSON so we should set this HTTP HEADER <code>Content-Type: application/json</code> to prevent an XSS to be executed in modern web browsers.</p>\n\n<p>Client side:</p>\n\n<p>Here, its more complicated because it really depends on how the developer will use the return valued. Its more about which context the value will be reflected but in any case the user should sanitize the returned value before outputting/reflecting it.</p>\n\n<p>If you need more information let me know,<br>\n<a href=\"/ibrahimd\">@ibrahimd</a>  </p>\n", 
            "type": "Activities::Comment", 
            "id": 2896954, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-06-17T20:58:29.808Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-06-17T20:58:29.808Z", 
            "actor": {
                "username": "ba3142c38d7de2241d2c522", 
                "url": "/ba3142c38d7de2241d2c522", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "You must be mistaken. I am NOT the maintainer of the library, I just responded to your issue. @biggora (https://github.com/biggora) is the maintainer.", 
            "markdown_message": "<p>You must be mistaken. I am NOT the maintainer of the library, I just responded to your issue. <a href=\"/biggora\">@biggora</a> (<a title=\"https://github.com/biggora\" href=\"/redirect?signature=74be90365d4fd1b7efaf7d0a9fcc751e63d48442&amp;url=https%3A%2F%2Fgithub.com%2Fbiggora\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/biggora</span><i class=\"icon-external-link\"></i></a>) is the maintainer.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2897154, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-06-17T21:06:44.847Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-06-17T21:06:44.847Z", 
            "actor": {
                "username": "ibrahimd", 
                "url": "/ibrahimd", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/171/863/d30061502060fc0f1fc22d5a8ea64ba95830a75c_medium.jpg?1527972686"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "Hi @bougakovgeorge,  my apologies, I thought you were the maintainer, because @lirantal  said that he will invite the package maintainer.", 
            "markdown_message": "<p>Hi <a href=\"/bougakovgeorge\">@bougakovgeorge</a>,  my apologies, I thought you were the maintainer, because <a href=\"/lirantal\">@lirantal</a>  said that he will invite the package maintainer.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2897169, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-06-17T21:13:54.356Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-06-17T21:13:54.356Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@bougakovgeorge  I have also invited Alexy but unfortunately he hasn't yet joined this issue. If you're able to ping him we'll appreciate it.\n\n@ibrahimd updating the examples is ok. About blacklisting the < > it's again up to the maintainer's since one can argue that it is a free text field (there's nothing that forbids those chars as far as I know).", 
            "markdown_message": "<p><a href=\"/bougakovgeorge\">@bougakovgeorge</a>  I have also invited Alexy but unfortunately he hasn&#39;t yet joined this issue. If you&#39;re able to ping him we&#39;ll appreciate it.</p>\n\n<p><a href=\"/ibrahimd\">@ibrahimd</a> updating the examples is ok. About blacklisting the &lt; &gt; it&#39;s again up to the maintainer&#39;s since one can argue that it is a free text field (there&#39;s nothing that forbids those chars as far as I know).</p>\n", 
            "type": "Activities::Comment", 
            "id": 2897172, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "old_scope": "useragent", 
            "created_at": "2018-06-29T21:51:22.992Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-06-29T21:51:22.992Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "new_scope": "express-useragent", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ChangedScope", 
            "id": 2960498, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-06-29T21:53:00.466Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-06-29T21:53:00.466Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@ibrahimd I tried inviting the author again.\nIf there will be no sign from him on this report during next week I will proceed with closing this report as informative.\n\nIf you're able to help contact him and ask him to join this conversation I will greatly appreciate it so we can check with him about adding security disclosures in the README and updating the examples.", 
            "markdown_message": "<p><a href=\"/ibrahimd\">@ibrahimd</a> I tried inviting the author again.<br>\nIf there will be no sign from him on this report during next week I will proceed with closing this report as informative.</p>\n\n<p>If you&#39;re able to help contact him and ask him to join this conversation I will greatly appreciate it so we can check with him about adding security disclosures in the README and updating the examples.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2960499, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-06-30T12:00:09.986Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-06-30T12:00:09.986Z", 
            "actor": {
                "username": "ibrahimd", 
                "url": "/ibrahimd", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/171/863/d30061502060fc0f1fc22d5a8ea64ba95830a75c_medium.jpg?1527972686"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@lirantal  thanks for the update.\n\nI'm a little bit disappointed with the idea if we can't get the module author to participate to this thread during the next week, you will close the report as `informative`. I work hard to report only valid bugs to rise my hackerone's signal and reputation. \n\nIn the end I will gladly accept your final decision.  \n\nI'll send him a PR, he seems to be responsive to pull requests, in the description section I'll explain our situation here.", 
            "markdown_message": "<p><a href=\"/lirantal\">@lirantal</a>  thanks for the update.</p>\n\n<p>I&#39;m a little bit disappointed with the idea if we can&#39;t get the module author to participate to this thread during the next week, you will close the report as <code>informative</code>. I work hard to report only valid bugs to rise my hackerone&#39;s signal and reputation. </p>\n\n<p>In the end I will gladly accept your final decision.  </p>\n\n<p>I&#39;ll send him a PR, he seems to be responsive to pull requests, in the description section I&#39;ll explain our situation here.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2965905, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-06-30T15:01:16.099Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-06-30T15:01:16.099Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@ibrahimd I will follow-up and do my best to get him on the conversation. I saw already that you opened the issue in their repository and there wasn't any response from the author, only from a contributor who isn't stepping in to fill the gap so we'd need the module maintainer for this.\n\nWill definitely appreciate if you can also ping him and get him to join this conversation.", 
            "markdown_message": "<p><a href=\"/ibrahimd\">@ibrahimd</a> I will follow-up and do my best to get him on the conversation. I saw already that you opened the issue in their repository and there wasn&#39;t any response from the author, only from a contributor who isn&#39;t stepping in to fill the gap so we&#39;d need the module maintainer for this.</p>\n\n<p>Will definitely appreciate if you can also ping him and get him to join this conversation.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2966103, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-06-30T22:06:49.877Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-06-30T22:06:49.877Z", 
            "actor": {
                "username": "ba3142c38d7de2241d2c522", 
                "url": "/ba3142c38d7de2241d2c522", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "I would totally help you fix it, I just can\u2019t imagine and/or replicate the issue with just a browser.", 
            "markdown_message": "<p>I would totally help you fix it, I just can\u2019t imagine and/or replicate the issue with just a browser.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2966779, 
            "genius_execution_id": null
        }, 
        {
            "attachments": [
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/314/226/46a757f7678d9bc23f46fd3b502a73b8236a07af/User-Agent_switcher-new_user-agent.PNG?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ2IMG7FL4%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T221918Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDHPJ1yKYcYWYj%2F9LNiK3AzyAo4x%2BPxakyZiJlRkk9M72fGqw4SrPH5qRWwrCEzUaWrTNXkqpALXRS4Q9wnQBmHJ21tNzuwZNzHm1q41ngqtlwpJP4F8P9DJ8J86pGXCj5zxKl27Xdyrp0yXro5KHbNg%2FMI31tP3CPajYLHppvbpzE4HgT6%2BgX56T9THRU9i0iPR2sPERJ5V8T5PqNGlaAxkIH%2BcDEYPwwdeod1TBqaVJeTbSTUwavuHFWj8I9aJc5ijS9LvHWHNGB5FXbFATn8ghcjqVzqIroA9nxNuPJ2vxIaAor9r4p%2Fy1e5TWqKKtSEWtQu68kIwE8NsRg80HQRso%2BCvRE8ecUk4iHSIS0Q3jmxteI2SvJRO0qZ3QaRjTDGmiTz95bj%2F%2F4H%2BR7Jy4C8RK9HLXC%2BPnDh%2FazH%2BgKdjL01iP%2BgzbXEnOyhh3IA5Imss19EK%2B2EWDifocttquTy%2F9L1a3OBtcs43O1R7Q7IURroixlPAhRunZI2Z9MyZSlDzcJsSgY9uPguXfm%2BdDi6ysAHwhyXucVtSiReGyNvDkzSArwNHacFF2yzh47gdSbs3NLHHvBIWOzk4ozBhf5yrOj2mTit4ouKem4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=44aab12ea89548878993d09af5afa78f848df81eb845f70b564fa817675deb86", 
                    "type": "image/png", 
                    "id": 314226, 
                    "filename": "User-Agent_switcher-new_user-agent.PNG"
                }, 
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/314/225/a76578c5b52dbd4944a3da8ff86fa850008bb1c3/User-agent_XSS-popup.PNG?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ2IMG7FL4%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T221918Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDHPJ1yKYcYWYj%2F9LNiK3AzyAo4x%2BPxakyZiJlRkk9M72fGqw4SrPH5qRWwrCEzUaWrTNXkqpALXRS4Q9wnQBmHJ21tNzuwZNzHm1q41ngqtlwpJP4F8P9DJ8J86pGXCj5zxKl27Xdyrp0yXro5KHbNg%2FMI31tP3CPajYLHppvbpzE4HgT6%2BgX56T9THRU9i0iPR2sPERJ5V8T5PqNGlaAxkIH%2BcDEYPwwdeod1TBqaVJeTbSTUwavuHFWj8I9aJc5ijS9LvHWHNGB5FXbFATn8ghcjqVzqIroA9nxNuPJ2vxIaAor9r4p%2Fy1e5TWqKKtSEWtQu68kIwE8NsRg80HQRso%2BCvRE8ecUk4iHSIS0Q3jmxteI2SvJRO0qZ3QaRjTDGmiTz95bj%2F%2F4H%2BR7Jy4C8RK9HLXC%2BPnDh%2FazH%2BgKdjL01iP%2BgzbXEnOyhh3IA5Imss19EK%2B2EWDifocttquTy%2F9L1a3OBtcs43O1R7Q7IURroixlPAhRunZI2Z9MyZSlDzcJsSgY9uPguXfm%2BdDi6ysAHwhyXucVtSiReGyNvDkzSArwNHacFF2yzh47gdSbs3NLHHvBIWOzk4ozBhf5yrOj2mTit4ouKem4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=022618f878e571ef60d04f9ac7e5d0a4bd78df5be9092ddbfd54dd214ed763ac", 
                    "type": "image/png", 
                    "id": 314225, 
                    "filename": "User-agent_XSS-popup.PNG"
                }
            ], 
            "automated_response": false, 
            "created_at": "2018-07-01T11:19:30.526Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-07-01T11:19:30.526Z", 
            "actor": {
                "username": "ibrahimd", 
                "url": "/ibrahimd", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/171/863/d30061502060fc0f1fc22d5a8ea64ba95830a75c_medium.jpg?1527972686"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@bougakovgeorge reproduction steps using a browser:\n1. install [User-Agent Switcher - chrome extension](https://chrome.google.com/webstore/detail/user-agent-switcher/clddifkhlkcojbojppdojfeeikdkgiae?hl=en)\n2. create a new user-agent\n3. name your new user-agent whatever you want  {F314226}\n4. set user-agent value to: `<script>alert(0)</script>`  {F314226}\n5. select the new user agent \n6. start one of the test examples: `node test/express.js`\n7. browse: `http://localhost:3000` using chrome\n8. the XSS value will be reflected but not triggered due the fact its reflected inside JSON context.\n\nFrom here we know that the user agent is not sanitized, let's edit one of the examples (express.js) simulating a scenario of developer who want to display the user agent of the visitor:\n\n1. edit test/express.js:\n\n```javascript\n...\napp.get('/', function (req, res) {\n    res.send(\"User-Agent: \" + req.useragent.source);\n});\n...\n```\n2. save changes and run again the server: `node express.js`\n3. visit `http://localhost:3000` using chrome (make sure user-agent switch is on and using custom payload)\n4. XSS window should pop up. {F314225}\n\n@lirantal I am sure you're doing your best, I'll do my best as well. If you need anything else please let me know.", 
            "markdown_message": "<p><a href=\"/bougakovgeorge\">@bougakovgeorge</a> reproduction steps using a browser:</p>\n\n<ol>\n<li>install <a href=\"/redirect?signature=930a0cea3bbe4a012b786939b3de24a5dcb21c9d&amp;url=https%3A%2F%2Fchrome.google.com%2Fwebstore%2Fdetail%2Fuser-agent-switcher%2Fclddifkhlkcojbojppdojfeeikdkgiae%3Fhl%3Den\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>User-Agent Switcher - chrome extension</span><i class=\"icon-external-link\"></i></a>\n</li>\n<li>create a new user-agent</li>\n<li>name your new user-agent whatever you want  <a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"User-Agent_switcher-new_user-agent.PNG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/314/226/46a757f7678d9bc23f46fd3b502a73b8236a07af/User-Agent_switcher-new_user-agent.PNG?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ2IMG7FL4%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221918Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDHPJ1yKYcYWYj%2F9LNiK3AzyAo4x%2BPxakyZiJlRkk9M72fGqw4SrPH5qRWwrCEzUaWrTNXkqpALXRS4Q9wnQBmHJ21tNzuwZNzHm1q41ngqtlwpJP4F8P9DJ8J86pGXCj5zxKl27Xdyrp0yXro5KHbNg%2FMI31tP3CPajYLHppvbpzE4HgT6%2BgX56T9THRU9i0iPR2sPERJ5V8T5PqNGlaAxkIH%2BcDEYPwwdeod1TBqaVJeTbSTUwavuHFWj8I9aJc5ijS9LvHWHNGB5FXbFATn8ghcjqVzqIroA9nxNuPJ2vxIaAor9r4p%2Fy1e5TWqKKtSEWtQu68kIwE8NsRg80HQRso%2BCvRE8ecUk4iHSIS0Q3jmxteI2SvJRO0qZ3QaRjTDGmiTz95bj%2F%2F4H%2BR7Jy4C8RK9HLXC%2BPnDh%2FazH%2BgKdjL01iP%2BgzbXEnOyhh3IA5Imss19EK%2B2EWDifocttquTy%2F9L1a3OBtcs43O1R7Q7IURroixlPAhRunZI2Z9MyZSlDzcJsSgY9uPguXfm%2BdDi6ysAHwhyXucVtSiReGyNvDkzSArwNHacFF2yzh47gdSbs3NLHHvBIWOzk4ozBhf5yrOj2mTit4ouKem4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=44aab12ea89548878993d09af5afa78f848df81eb845f70b564fa817675deb86\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/314/226/46a757f7678d9bc23f46fd3b502a73b8236a07af/User-Agent_switcher-new_user-agent.PNG?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ2IMG7FL4%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221918Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDHPJ1yKYcYWYj%2F9LNiK3AzyAo4x%2BPxakyZiJlRkk9M72fGqw4SrPH5qRWwrCEzUaWrTNXkqpALXRS4Q9wnQBmHJ21tNzuwZNzHm1q41ngqtlwpJP4F8P9DJ8J86pGXCj5zxKl27Xdyrp0yXro5KHbNg%2FMI31tP3CPajYLHppvbpzE4HgT6%2BgX56T9THRU9i0iPR2sPERJ5V8T5PqNGlaAxkIH%2BcDEYPwwdeod1TBqaVJeTbSTUwavuHFWj8I9aJc5ijS9LvHWHNGB5FXbFATn8ghcjqVzqIroA9nxNuPJ2vxIaAor9r4p%2Fy1e5TWqKKtSEWtQu68kIwE8NsRg80HQRso%2BCvRE8ecUk4iHSIS0Q3jmxteI2SvJRO0qZ3QaRjTDGmiTz95bj%2F%2F4H%2BR7Jy4C8RK9HLXC%2BPnDh%2FazH%2BgKdjL01iP%2BgzbXEnOyhh3IA5Imss19EK%2B2EWDifocttquTy%2F9L1a3OBtcs43O1R7Q7IURroixlPAhRunZI2Z9MyZSlDzcJsSgY9uPguXfm%2BdDi6ysAHwhyXucVtSiReGyNvDkzSArwNHacFF2yzh47gdSbs3NLHHvBIWOzk4ozBhf5yrOj2mTit4ouKem4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=44aab12ea89548878993d09af5afa78f848df81eb845f70b564fa817675deb86\" class=\"markdown-inline-image\"></a>\n</li>\n<li>set user-agent value to: <code>&lt;script&gt;alert(0)&lt;/script&gt;</code>  <a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"User-Agent_switcher-new_user-agent.PNG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/314/226/46a757f7678d9bc23f46fd3b502a73b8236a07af/User-Agent_switcher-new_user-agent.PNG?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ2IMG7FL4%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221918Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDHPJ1yKYcYWYj%2F9LNiK3AzyAo4x%2BPxakyZiJlRkk9M72fGqw4SrPH5qRWwrCEzUaWrTNXkqpALXRS4Q9wnQBmHJ21tNzuwZNzHm1q41ngqtlwpJP4F8P9DJ8J86pGXCj5zxKl27Xdyrp0yXro5KHbNg%2FMI31tP3CPajYLHppvbpzE4HgT6%2BgX56T9THRU9i0iPR2sPERJ5V8T5PqNGlaAxkIH%2BcDEYPwwdeod1TBqaVJeTbSTUwavuHFWj8I9aJc5ijS9LvHWHNGB5FXbFATn8ghcjqVzqIroA9nxNuPJ2vxIaAor9r4p%2Fy1e5TWqKKtSEWtQu68kIwE8NsRg80HQRso%2BCvRE8ecUk4iHSIS0Q3jmxteI2SvJRO0qZ3QaRjTDGmiTz95bj%2F%2F4H%2BR7Jy4C8RK9HLXC%2BPnDh%2FazH%2BgKdjL01iP%2BgzbXEnOyhh3IA5Imss19EK%2B2EWDifocttquTy%2F9L1a3OBtcs43O1R7Q7IURroixlPAhRunZI2Z9MyZSlDzcJsSgY9uPguXfm%2BdDi6ysAHwhyXucVtSiReGyNvDkzSArwNHacFF2yzh47gdSbs3NLHHvBIWOzk4ozBhf5yrOj2mTit4ouKem4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=44aab12ea89548878993d09af5afa78f848df81eb845f70b564fa817675deb86\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/314/226/46a757f7678d9bc23f46fd3b502a73b8236a07af/User-Agent_switcher-new_user-agent.PNG?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ2IMG7FL4%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221918Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDHPJ1yKYcYWYj%2F9LNiK3AzyAo4x%2BPxakyZiJlRkk9M72fGqw4SrPH5qRWwrCEzUaWrTNXkqpALXRS4Q9wnQBmHJ21tNzuwZNzHm1q41ngqtlwpJP4F8P9DJ8J86pGXCj5zxKl27Xdyrp0yXro5KHbNg%2FMI31tP3CPajYLHppvbpzE4HgT6%2BgX56T9THRU9i0iPR2sPERJ5V8T5PqNGlaAxkIH%2BcDEYPwwdeod1TBqaVJeTbSTUwavuHFWj8I9aJc5ijS9LvHWHNGB5FXbFATn8ghcjqVzqIroA9nxNuPJ2vxIaAor9r4p%2Fy1e5TWqKKtSEWtQu68kIwE8NsRg80HQRso%2BCvRE8ecUk4iHSIS0Q3jmxteI2SvJRO0qZ3QaRjTDGmiTz95bj%2F%2F4H%2BR7Jy4C8RK9HLXC%2BPnDh%2FazH%2BgKdjL01iP%2BgzbXEnOyhh3IA5Imss19EK%2B2EWDifocttquTy%2F9L1a3OBtcs43O1R7Q7IURroixlPAhRunZI2Z9MyZSlDzcJsSgY9uPguXfm%2BdDi6ysAHwhyXucVtSiReGyNvDkzSArwNHacFF2yzh47gdSbs3NLHHvBIWOzk4ozBhf5yrOj2mTit4ouKem4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=44aab12ea89548878993d09af5afa78f848df81eb845f70b564fa817675deb86\" class=\"markdown-inline-image\"></a>\n</li>\n<li>select the new user agent </li>\n<li>start one of the test examples: <code>node test/express.js</code>\n</li>\n<li>browse: <code>http://localhost:3000</code> using chrome</li>\n<li>the XSS value will be reflected but not triggered due the fact its reflected inside JSON context.</li>\n</ol>\n\n<p>From here we know that the user agent is not sanitized, let&#39;s edit one of the examples (express.js) simulating a scenario of developer who want to display the user agent of the visitor:</p>\n\n<ol>\n<li>edit test/express.js:</li>\n</ol>\n<pre class=\"highlight javascript\"><code><span class=\"p\">...</span>\n<span class=\"nx\">app</span><span class=\"p\">.</span><span class=\"nx\">get</span><span class=\"p\">(</span><span class=\"s1\">&#39;/&#39;</span><span class=\"p\">,</span> <span class=\"kd\">function</span> <span class=\"p\">(</span><span class=\"nx\">req</span><span class=\"p\">,</span> <span class=\"nx\">res</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n    <span class=\"nx\">res</span><span class=\"p\">.</span><span class=\"nx\">send</span><span class=\"p\">(</span><span class=\"s2\">&quot;User-Agent: &quot;</span> <span class=\"o\">+</span> <span class=\"nx\">req</span><span class=\"p\">.</span><span class=\"nx\">useragent</span><span class=\"p\">.</span><span class=\"nx\">source</span><span class=\"p\">);</span>\n<span class=\"p\">});</span>\n<span class=\"p\">...</span>\n</code></pre>\n<ol>\n<li>save changes and run again the server: <code>node express.js</code>\n</li>\n<li>visit <code>http://localhost:3000</code> using chrome (make sure user-agent switch is on and using custom payload)</li>\n<li>XSS window should pop up. <a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"User-agent_XSS-popup.PNG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/314/225/a76578c5b52dbd4944a3da8ff86fa850008bb1c3/User-agent_XSS-popup.PNG?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ2IMG7FL4%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221918Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDHPJ1yKYcYWYj%2F9LNiK3AzyAo4x%2BPxakyZiJlRkk9M72fGqw4SrPH5qRWwrCEzUaWrTNXkqpALXRS4Q9wnQBmHJ21tNzuwZNzHm1q41ngqtlwpJP4F8P9DJ8J86pGXCj5zxKl27Xdyrp0yXro5KHbNg%2FMI31tP3CPajYLHppvbpzE4HgT6%2BgX56T9THRU9i0iPR2sPERJ5V8T5PqNGlaAxkIH%2BcDEYPwwdeod1TBqaVJeTbSTUwavuHFWj8I9aJc5ijS9LvHWHNGB5FXbFATn8ghcjqVzqIroA9nxNuPJ2vxIaAor9r4p%2Fy1e5TWqKKtSEWtQu68kIwE8NsRg80HQRso%2BCvRE8ecUk4iHSIS0Q3jmxteI2SvJRO0qZ3QaRjTDGmiTz95bj%2F%2F4H%2BR7Jy4C8RK9HLXC%2BPnDh%2FazH%2BgKdjL01iP%2BgzbXEnOyhh3IA5Imss19EK%2B2EWDifocttquTy%2F9L1a3OBtcs43O1R7Q7IURroixlPAhRunZI2Z9MyZSlDzcJsSgY9uPguXfm%2BdDi6ysAHwhyXucVtSiReGyNvDkzSArwNHacFF2yzh47gdSbs3NLHHvBIWOzk4ozBhf5yrOj2mTit4ouKem4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=022618f878e571ef60d04f9ac7e5d0a4bd78df5be9092ddbfd54dd214ed763ac\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/314/225/a76578c5b52dbd4944a3da8ff86fa850008bb1c3/User-agent_XSS-popup.PNG?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ2IMG7FL4%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221918Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDHPJ1yKYcYWYj%2F9LNiK3AzyAo4x%2BPxakyZiJlRkk9M72fGqw4SrPH5qRWwrCEzUaWrTNXkqpALXRS4Q9wnQBmHJ21tNzuwZNzHm1q41ngqtlwpJP4F8P9DJ8J86pGXCj5zxKl27Xdyrp0yXro5KHbNg%2FMI31tP3CPajYLHppvbpzE4HgT6%2BgX56T9THRU9i0iPR2sPERJ5V8T5PqNGlaAxkIH%2BcDEYPwwdeod1TBqaVJeTbSTUwavuHFWj8I9aJc5ijS9LvHWHNGB5FXbFATn8ghcjqVzqIroA9nxNuPJ2vxIaAor9r4p%2Fy1e5TWqKKtSEWtQu68kIwE8NsRg80HQRso%2BCvRE8ecUk4iHSIS0Q3jmxteI2SvJRO0qZ3QaRjTDGmiTz95bj%2F%2F4H%2BR7Jy4C8RK9HLXC%2BPnDh%2FazH%2BgKdjL01iP%2BgzbXEnOyhh3IA5Imss19EK%2B2EWDifocttquTy%2F9L1a3OBtcs43O1R7Q7IURroixlPAhRunZI2Z9MyZSlDzcJsSgY9uPguXfm%2BdDi6ysAHwhyXucVtSiReGyNvDkzSArwNHacFF2yzh47gdSbs3NLHHvBIWOzk4ozBhf5yrOj2mTit4ouKem4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=022618f878e571ef60d04f9ac7e5d0a4bd78df5be9092ddbfd54dd214ed763ac\" class=\"markdown-inline-image\"></a>\n</li>\n</ol>\n\n<p><a href=\"/lirantal\">@lirantal</a> I am sure you&#39;re doing your best, I&#39;ll do my best as well. If you need anything else please let me know.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2968349, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-07-01T11:53:53.095Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-07-01T11:53:53.095Z", 
            "actor": {
                "username": "ba3142c38d7de2241d2c522", 
                "url": "/ba3142c38d7de2241d2c522", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "You can switch your UA without any extensions, but only an idiot will switch his user agent to \u2018<script>maliciouscode();</script>\u2019 and visit a JSON page. Also, if a web developer needs to see what browser user uses, they can see the UA string using \u2018window.navigator.useragent\u2019 which is perfectly safe.\nAlso, AFAIK HTTP protocol specification does not forbid <> characters and escaping and/or them will be a violation of specification.", 
            "markdown_message": "<p>You can switch your UA without any extensions, but only an idiot will switch his user agent to \u2018&lt;script&gt;maliciouscode();&lt;/script&gt;\u2019 and visit a JSON page. Also, if a web developer needs to see what browser user uses, they can see the UA string using \u2018window.navigator.useragent\u2019 which is perfectly safe.<br>\nAlso, AFAIK HTTP protocol specification does not forbid &lt;&gt; characters and escaping and/or them will be a violation of specification.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2968377, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-07-01T16:23:11.522Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-07-01T16:23:11.522Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@bougakovgeorge Let's try to keep it civilized and respectful. We all have good intentions.\nRegardless to a fix or not, do you agree to add a disclaimer in the README ?", 
            "markdown_message": "<p><a href=\"/bougakovgeorge\">@bougakovgeorge</a> Let&#39;s try to keep it civilized and respectful. We all have good intentions.<br>\nRegardless to a fix or not, do you agree to add a disclaimer in the README ?</p>\n", 
            "type": "Activities::Comment", 
            "id": 2968628, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-07-01T18:00:31.922Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-07-01T18:00:31.922Z", 
            "actor": {
                "username": "ba3142c38d7de2241d2c522", 
                "url": "/ba3142c38d7de2241d2c522", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "I also have good intentions, and a disclaimer can be nice, but I just can\u2019t imagine a **real** scenario where this exploit can be used and executed. I also think that if you patch this library to escape these symbols, you need to make it an option and don\u2019t force it. Also, I don\u2019t think that this module is still maintained and [I repeat] I am not the maintainer or a contributor of this module. I just wanted to use it in my service, implemented it and wanted to open an issue and a pull request to add macOS Mojave support and I just saw your issue and expressed my opinion. Sorry for any misunderstanding caused.\n\nSide note: Is your main goal \u201cto rise my (ibrahimd\u2019s) hackerone's signal and reputation.\u201d? It\u2019s kinda strange...", 
            "markdown_message": "<p>I also have good intentions, and a disclaimer can be nice, but I just can\u2019t imagine a <strong>real</strong> scenario where this exploit can be used and executed. I also think that if you patch this library to escape these symbols, you need to make it an option and don\u2019t force it. Also, I don\u2019t think that this module is still maintained and [I repeat] I am not the maintainer or a contributor of this module. I just wanted to use it in my service, implemented it and wanted to open an issue and a pull request to add macOS Mojave support and I just saw your issue and expressed my opinion. Sorry for any misunderstanding caused.</p>\n\n<p>Side note: Is your main goal \u201cto rise my (ibrahimd\u2019s) hackerone&#39;s signal and reputation.\u201d? It\u2019s kinda strange...</p>\n", 
            "type": "Activities::Comment", 
            "id": 2968893, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-07-01T19:00:58.359Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-07-01T19:00:58.359Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@bougakovgeorge I appreciate your involvement in the conversation, though I don't like that insinuation in that side note. Maybe you need to read my comment https://hackerone.com/reports/362702#activity-2894646 again.\n\nThank you for your contribution in triaging the security report.", 
            "markdown_message": "<p><a href=\"/bougakovgeorge\">@bougakovgeorge</a> I appreciate your involvement in the conversation, though I don&#39;t like that insinuation in that side note. Maybe you need to read my comment <a title=\"https://hackerone.com/reports/362702#activity-2894646\" href=\"https://hackerone.com/reports/362702#activity-2894646\">https://hackerone.com/reports/362702#activity-2894646</a> again.</p>\n\n<p>Thank you for your contribution in triaging the security report.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2968988, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-07-01T20:32:07.999Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-07-01T20:32:07.999Z", 
            "actor": {
                "username": "ba3142c38d7de2241d2c522", 
                "url": "/ba3142c38d7de2241d2c522", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "I didn\u2019t mean to insult anyone, but Ibrahim wrote the exact thing I included in the side note. Is there any way I can leave this conversation because I am totally the wrong guy to be here. I am not a maintainer, I don\u2019t even have write access to the repo, so can you please exclude me from this mailing list?", 
            "markdown_message": "<p>I didn\u2019t mean to insult anyone, but Ibrahim wrote the exact thing I included in the side note. Is there any way I can leave this conversation because I am totally the wrong guy to be here. I am not a maintainer, I don\u2019t even have write access to the repo, so can you please exclude me from this mailing list?</p>\n", 
            "type": "Activities::Comment", 
            "id": 2969088, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-07-01T21:26:00.915Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-07-01T21:26:00.915Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "Sure, I'll go ahead and remove you from the thread.\nThanks for joining in the first place and willing to help!\n", 
            "markdown_message": "<p>Sure, I&#39;ll go ahead and remove you from the thread.<br>\nThanks for joining in the first place and willing to help!</p>\n", 
            "type": "Activities::Comment", 
            "id": 2969157, 
            "genius_execution_id": null
        }, 
        {
            "removed_user": {
                "url": "/ba3142c38d7de2241d2c522", 
                "username": "ba3142c38d7de2241d2c522"
            }, 
            "automated_response": false, 
            "created_at": "2018-07-01T21:26:10.902Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-07-01T21:26:10.902Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ExternalUserRemoved", 
            "id": 2969160, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-07-06T08:22:45.129Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-07-06T08:22:45.129Z", 
            "actor": {
                "username": "ibrahimd", 
                "url": "/ibrahimd", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/171/863/d30061502060fc0f1fc22d5a8ea64ba95830a75c_medium.jpg?1527972686"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@lirantal as you could noticed, four days ago  I tried to reach out the owner of the module on twitter, no response yet. This morning I sent him a message on facebook waiting for a feedback. I think that's the best I can do in this situation.  ", 
            "markdown_message": "<p><a href=\"/lirantal\">@lirantal</a> as you could noticed, four days ago  I tried to reach out the owner of the module on twitter, no response yet. This morning I sent him a message on facebook waiting for a feedback. I think that&#39;s the best I can do in this situation.  </p>\n", 
            "type": "Activities::Comment", 
            "id": 2998151, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-07-06T10:16:15.081Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-07-06T10:16:15.081Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "Agree.\nShould we go ahead and resolve this report as informative and disclose it?", 
            "markdown_message": "<p>Agree.<br>\nShould we go ahead and resolve this report as informative and disclose it?</p>\n", 
            "type": "Activities::Comment", 
            "id": 2999158, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-07-06T10:33:50.577Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-07-06T10:33:50.577Z", 
            "actor": {
                "username": "ibrahimd", 
                "url": "/ibrahimd", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/171/863/d30061502060fc0f1fc22d5a8ea64ba95830a75c_medium.jpg?1527972686"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "Yes, go ahead.", 
            "markdown_message": "<p>Yes, go ahead.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2999466, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-07-06T10:37:11.446Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-07-06T10:37:11.446Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "Closing report.", 
            "markdown_message": "<p>Closing report.</p>\n", 
            "type": "Activities::BugInformative", 
            "id": 2999477, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-07-06T10:37:28.097Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-07-06T10:37:28.097Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 2999478, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-07-06T13:34:36.773Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-07-06T13:34:36.773Z", 
            "actor": {
                "username": "ibrahimd", 
                "url": "/ibrahimd", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/171/863/d30061502060fc0f1fc22d5a8ea64ba95830a75c_medium.jpg?1527972686"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 3000160, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-07-06T13:34:36.894Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-07-06T13:34:36.894Z", 
            "actor": {
                "username": "ibrahimd", 
                "url": "/ibrahimd", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/171/863/d30061502060fc0f1fc22d5a8ea64ba95830a75c_medium.jpg?1527972686"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 3000161, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "reporter": {
        "username": "ibrahimd", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/ibrahimd", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/171/863/cdc179dd040027eb60421a3650d5d4e334e3bd02_small.jpg?1527972686"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 60, 
        "name": "Cross-site Scripting (XSS) - Generic"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "disclosed_at": "2018-07-06T13:34:36.850Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/362702", 
    "created_at": "2018-06-06T11:28:49.469Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>Hello, </p>\n\n<p>I would like to report an XSS in express-useragent  module  due  a lack of validating User-Agent header. Please note I already created an <a href=\"/redirect?signature=9a91d9dd01fdbd4a797ddd7c20bc3c7cdbaee88a&amp;url=https%3A%2F%2Fgithub.com%2Fbiggora%2Fexpress-useragent%2Fissues%2F98\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>Github issue</span><i class=\"icon-external-link\"></i></a> and asked for CVE ( <a href=\"/redirect?signature=9398add2a852840193d4e538db48f0ccfe1c12a1&amp;url=https%3A%2F%2Fcve.mitre.org%2Fcgi-bin%2Fcvename.cgi%3Fname%3DCVE-2018-9863\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>CVE-2018-9863</span><i class=\"icon-external-link\"></i></a>). I did not know about Node.js third-party modules on hackerone.</p>\n\n<h2 id=\"description\">Description</h2>\n\n<p>express-useragent is simple NodeJS/ExpressJS middleware exposing User-Agent details to your application and views. Basically it parses User-Agent and return it in structured JSON format.</p>\n\n<h2 id=\"the-issue\">The issue</h2>\n\n<p>while parsing User-Agent there are no escaping or sanitization mechanism. User-Agent header is controlled by the user. An attacker can craft a malicious script and inject it through the HTTP header.</p>\n\n<h2 id=\"steps-to-reproduce\">Steps to reproduce</h2>\n\n<ul>\n<li>git clone <a title=\"https://github.com/biggora/express-useragent\" href=\"/redirect?signature=f8439b26f0792334a153f595fa3cf05af67d8f98&amp;url=https%3A%2F%2Fgithub.com%2Fbiggora%2Fexpress-useragent\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/biggora/express-useragent</span><i class=\"icon-external-link\"></i></a> </li>\n<li>cd express-useragent</li>\n<li>\n<code>node test/http.js</code>  (an HTTP server should listen on 3000 tcp)</li>\n<li><code>curl &quot;http://localhost:3000&quot; -H &#39;User-Agent: &lt;script&gt;alert(&quot;XSS&quot;)&lt;/script&gt;&#39; &gt; poc.html</code></li>\n<li>open poc.html with your favorite web browser</li>\n<li>you should see an alertbox popup </li>\n</ul>\n\n<h3 id=\"proof-of-concept-screenshots\">Proof of concept (screenshots)</h3>\n\n<p><a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screenshot_from_2018-04-09_18-50-35_(1).png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/305/913/2cf634e9d3228e78c63df9b9457467db928168b8/Screenshot_from_2018-04-09_18-50-35_%281%29.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ2IMG7FL4%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221918Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDHPJ1yKYcYWYj%2F9LNiK3AzyAo4x%2BPxakyZiJlRkk9M72fGqw4SrPH5qRWwrCEzUaWrTNXkqpALXRS4Q9wnQBmHJ21tNzuwZNzHm1q41ngqtlwpJP4F8P9DJ8J86pGXCj5zxKl27Xdyrp0yXro5KHbNg%2FMI31tP3CPajYLHppvbpzE4HgT6%2BgX56T9THRU9i0iPR2sPERJ5V8T5PqNGlaAxkIH%2BcDEYPwwdeod1TBqaVJeTbSTUwavuHFWj8I9aJc5ijS9LvHWHNGB5FXbFATn8ghcjqVzqIroA9nxNuPJ2vxIaAor9r4p%2Fy1e5TWqKKtSEWtQu68kIwE8NsRg80HQRso%2BCvRE8ecUk4iHSIS0Q3jmxteI2SvJRO0qZ3QaRjTDGmiTz95bj%2F%2F4H%2BR7Jy4C8RK9HLXC%2BPnDh%2FazH%2BgKdjL01iP%2BgzbXEnOyhh3IA5Imss19EK%2B2EWDifocttquTy%2F9L1a3OBtcs43O1R7Q7IURroixlPAhRunZI2Z9MyZSlDzcJsSgY9uPguXfm%2BdDi6ysAHwhyXucVtSiReGyNvDkzSArwNHacFF2yzh47gdSbs3NLHHvBIWOzk4ozBhf5yrOj2mTit4ouKem4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=45c96e9799e69930e1a262cf99967d405900c00cab1ef4cc6465b182dfaf0319\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/305/913/2cf634e9d3228e78c63df9b9457467db928168b8/Screenshot_from_2018-04-09_18-50-35_%281%29.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ2IMG7FL4%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221918Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDHPJ1yKYcYWYj%2F9LNiK3AzyAo4x%2BPxakyZiJlRkk9M72fGqw4SrPH5qRWwrCEzUaWrTNXkqpALXRS4Q9wnQBmHJ21tNzuwZNzHm1q41ngqtlwpJP4F8P9DJ8J86pGXCj5zxKl27Xdyrp0yXro5KHbNg%2FMI31tP3CPajYLHppvbpzE4HgT6%2BgX56T9THRU9i0iPR2sPERJ5V8T5PqNGlaAxkIH%2BcDEYPwwdeod1TBqaVJeTbSTUwavuHFWj8I9aJc5ijS9LvHWHNGB5FXbFATn8ghcjqVzqIroA9nxNuPJ2vxIaAor9r4p%2Fy1e5TWqKKtSEWtQu68kIwE8NsRg80HQRso%2BCvRE8ecUk4iHSIS0Q3jmxteI2SvJRO0qZ3QaRjTDGmiTz95bj%2F%2F4H%2BR7Jy4C8RK9HLXC%2BPnDh%2FazH%2BgKdjL01iP%2BgzbXEnOyhh3IA5Imss19EK%2B2EWDifocttquTy%2F9L1a3OBtcs43O1R7Q7IURroixlPAhRunZI2Z9MyZSlDzcJsSgY9uPguXfm%2BdDi6ysAHwhyXucVtSiReGyNvDkzSArwNHacFF2yzh47gdSbs3NLHHvBIWOzk4ozBhf5yrOj2mTit4ouKem4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=45c96e9799e69930e1a262cf99967d405900c00cab1ef4cc6465b182dfaf0319\" class=\"markdown-inline-image\"></a><br>\n<a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screenshot_from_2018-04-09_18-51-21_(1).png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/305/914/8773f06a8e47477582c406f804456e7c06e028cd/Screenshot_from_2018-04-09_18-51-21_%281%29.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ2IMG7FL4%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221918Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDHPJ1yKYcYWYj%2F9LNiK3AzyAo4x%2BPxakyZiJlRkk9M72fGqw4SrPH5qRWwrCEzUaWrTNXkqpALXRS4Q9wnQBmHJ21tNzuwZNzHm1q41ngqtlwpJP4F8P9DJ8J86pGXCj5zxKl27Xdyrp0yXro5KHbNg%2FMI31tP3CPajYLHppvbpzE4HgT6%2BgX56T9THRU9i0iPR2sPERJ5V8T5PqNGlaAxkIH%2BcDEYPwwdeod1TBqaVJeTbSTUwavuHFWj8I9aJc5ijS9LvHWHNGB5FXbFATn8ghcjqVzqIroA9nxNuPJ2vxIaAor9r4p%2Fy1e5TWqKKtSEWtQu68kIwE8NsRg80HQRso%2BCvRE8ecUk4iHSIS0Q3jmxteI2SvJRO0qZ3QaRjTDGmiTz95bj%2F%2F4H%2BR7Jy4C8RK9HLXC%2BPnDh%2FazH%2BgKdjL01iP%2BgzbXEnOyhh3IA5Imss19EK%2B2EWDifocttquTy%2F9L1a3OBtcs43O1R7Q7IURroixlPAhRunZI2Z9MyZSlDzcJsSgY9uPguXfm%2BdDi6ysAHwhyXucVtSiReGyNvDkzSArwNHacFF2yzh47gdSbs3NLHHvBIWOzk4ozBhf5yrOj2mTit4ouKem4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=69534b7ae45ac1b944693f3ee2bbc77c2ee787cf91ffea59c8d42988bcced2f5\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/305/914/8773f06a8e47477582c406f804456e7c06e028cd/Screenshot_from_2018-04-09_18-51-21_%281%29.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ2IMG7FL4%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221918Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDHPJ1yKYcYWYj%2F9LNiK3AzyAo4x%2BPxakyZiJlRkk9M72fGqw4SrPH5qRWwrCEzUaWrTNXkqpALXRS4Q9wnQBmHJ21tNzuwZNzHm1q41ngqtlwpJP4F8P9DJ8J86pGXCj5zxKl27Xdyrp0yXro5KHbNg%2FMI31tP3CPajYLHppvbpzE4HgT6%2BgX56T9THRU9i0iPR2sPERJ5V8T5PqNGlaAxkIH%2BcDEYPwwdeod1TBqaVJeTbSTUwavuHFWj8I9aJc5ijS9LvHWHNGB5FXbFATn8ghcjqVzqIroA9nxNuPJ2vxIaAor9r4p%2Fy1e5TWqKKtSEWtQu68kIwE8NsRg80HQRso%2BCvRE8ecUk4iHSIS0Q3jmxteI2SvJRO0qZ3QaRjTDGmiTz95bj%2F%2F4H%2BR7Jy4C8RK9HLXC%2BPnDh%2FazH%2BgKdjL01iP%2BgzbXEnOyhh3IA5Imss19EK%2B2EWDifocttquTy%2F9L1a3OBtcs43O1R7Q7IURroixlPAhRunZI2Z9MyZSlDzcJsSgY9uPguXfm%2BdDi6ysAHwhyXucVtSiReGyNvDkzSArwNHacFF2yzh47gdSbs3NLHHvBIWOzk4ozBhf5yrOj2mTit4ouKem4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=69534b7ae45ac1b944693f3ee2bbc77c2ee787cf91ffea59c8d42988bcced2f5\" class=\"markdown-inline-image\"></a></p>\n\n<h3 id=\"proof-of-concept-with-a-fix-video-express_useragent_xss-mkv-f305912\">Proof of concept with a fix (video) <a href=\"#\" class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"express_useragent_xss.mkv\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/305/912/8c4e45709d9acdfbb5f4a707c76fc698192695a3/express_useragent_xss.mkv?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ2IMG7FL4%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221918Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDHPJ1yKYcYWYj%2F9LNiK3AzyAo4x%2BPxakyZiJlRkk9M72fGqw4SrPH5qRWwrCEzUaWrTNXkqpALXRS4Q9wnQBmHJ21tNzuwZNzHm1q41ngqtlwpJP4F8P9DJ8J86pGXCj5zxKl27Xdyrp0yXro5KHbNg%2FMI31tP3CPajYLHppvbpzE4HgT6%2BgX56T9THRU9i0iPR2sPERJ5V8T5PqNGlaAxkIH%2BcDEYPwwdeod1TBqaVJeTbSTUwavuHFWj8I9aJc5ijS9LvHWHNGB5FXbFATn8ghcjqVzqIroA9nxNuPJ2vxIaAor9r4p%2Fy1e5TWqKKtSEWtQu68kIwE8NsRg80HQRso%2BCvRE8ecUk4iHSIS0Q3jmxteI2SvJRO0qZ3QaRjTDGmiTz95bj%2F%2F4H%2BR7Jy4C8RK9HLXC%2BPnDh%2FazH%2BgKdjL01iP%2BgzbXEnOyhh3IA5Imss19EK%2B2EWDifocttquTy%2F9L1a3OBtcs43O1R7Q7IURroixlPAhRunZI2Z9MyZSlDzcJsSgY9uPguXfm%2BdDi6ysAHwhyXucVtSiReGyNvDkzSArwNHacFF2yzh47gdSbs3NLHHvBIWOzk4ozBhf5yrOj2mTit4ouKem4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=db1936d3707170abb8659389bbe4870d403f29457bdbbb22d1ce14b73b6dd362\" data-attachment-type=\"video/x-matroska\">express_useragent_xss.mkv (F305912)</a>\n</h3>\n\n<h2 id=\"mitigation\">Mitigation</h2>\n\n<p>Correctly escape and sanitize user input ( HTTP User-Agent ). Please note I proposed a fix in the video</p>\n\n<h2 id=\"impact\">Impact</h2>\n\n<p>An attacker could execute javascript code that could lead to XSS.</p>\n", 
    "vulnerability_information": "Hello, \n\nI would like to report an XSS in express-useragent  module  due  a lack of validating User-Agent header. Please note I already created an [Github issue](https://github.com/biggora/express-useragent/issues/98) and asked for CVE ( [CVE-2018-9863](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-9863)). I did not know about Node.js third-party modules on hackerone.\n\n## Description\nexpress-useragent is simple NodeJS/ExpressJS middleware exposing User-Agent details to your application and views. Basically it parses User-Agent and return it in structured JSON format.\n\n## The issue\nwhile parsing User-Agent there are no escaping or sanitization mechanism. User-Agent header is controlled by the user. An attacker can craft a malicious script and inject it through the HTTP header.\n\n## Steps to reproduce\n* git clone https://github.com/biggora/express-useragent \n* cd express-useragent\n* ```node test/http.js```  (an HTTP server should listen on 3000 tcp)\n* ```curl \"http://localhost:3000\" -H 'User-Agent: <script>alert(\"XSS\")</script>' > poc.html```\n* open poc.html with your favorite web browser\n* you should see an alertbox popup \n\n### Proof of concept (screenshots)\n{F305913}\n{F305914}\n\n### Proof of concept with a fix (video) {F305912}\n\n## Mitigation\nCorrectly escape and sanitize user input ( HTTP User-Agent ). Please note I proposed a fix in the video\n\n## Impact\n\nAn attacker could execute javascript code that could lead to XSS.", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://nodejs.org/en/security/", 
            "about": "This program is used to handle vulnerabilities in the Node.js ecosystem.", 
            "twitter_handle": "", 
            "name": "Node.js third-party modules"
        }, 
        "handle": "nodejs-ecosystem", 
        "url": "https://hackerone.com/nodejs-ecosystem", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/023/949/309112251b444244d95977d1299148aae6482789_small.?1508679627", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/023/949/c1f5f15ac094c1327c13dd19f55dbcb7411272bd_medium.?1508679627"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 23949, 
        "default_currency": "usd"
    }, 
    "is_published": false
}