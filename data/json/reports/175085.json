{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": null, 
    "voters": [
        "eveeez", 
        "babayaga_", 
        "japz", 
        "spetr0x", 
        "qd_"
    ], 
    "facebook_team?": false, 
    "has_bounty?": false, 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 175085, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2016-12-13T20:02:30.609Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "URI scheme bypass in mail app lead to HTML content spoof and opener control", 
    "is_member_of_team?": null, 
    "vote_count": 5, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2017-01-12T20:02:30.638Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "attachments": [
        {
            "file_name": "shareimg.png", 
            "type": "image/png", 
            "id": 127148, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/127/148/dc4ae41388280f99ef2b563d0a498bbe5661f215/shareimg.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5B43OTPE%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T224455Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDCiDARkX3ArKGaO7%2ByK3A39tqjzyooRkX4qPdNM7MkAemep3r5%2Fh%2B11ZdH6KbZ8q2cgU%2FRMODKRq75fJ6sn%2FkR1fBrPaMFfKsP%2BSLpkSrkbyi968FqbmO6yo59Heb3d1kDMwzaNShj3ou%2Fq9qAc5NWgXlxJtABJqkgxPd5NovxMOsASin8kfBjU8OhOOEnonvd2t16oF509MVoA81P%2Frmr4njIb3UfHzYyccuDQNjHM0qV7B57bCKQeIuO%2FzLl7au%2FWR2v6R6bwK6fGUYVbcnAam9GqobWJnMl6NFbipNSdmUzB5%2BglRYaYeGXxbgxseM7SSFeehfzbywUoHEf4Ve61V1e90uyx3M0Krbm5QjS5gNgwErj0g2rC2mkrl2q%2B9ADfOzgMAX8fUODFalEv4gZf0ZKuLhpmAzEapJE5f%2BarcSkdn5b0ddy4Wa2vdsZ6lQ5NOez8qkcnaBEJZLnv3YGHyInLrIaUkqlq4iavZpr4f5Al5PueqIzLuItn5ztJjfvCu5dDIplWP0eo6r%2BIUCKsDwUNkRSgWCtJbCfl%2BPF3PKHjvnmVEBawLZlpXvaOGUvA%2FKYb2cGGXn89CPjYlwpWCj2J8Z%2B0okbim4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=beb8b4ea27fefb165d8512e4a43907a66593b25c017907ea1730584b6430599d"
        }, 
        {
            "file_name": "send.png", 
            "type": "image/png", 
            "id": 127149, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/127/149/800b78fc460926ea711623876dac82d52755df36/send.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5B43OTPE%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T224455Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDCiDARkX3ArKGaO7%2ByK3A39tqjzyooRkX4qPdNM7MkAemep3r5%2Fh%2B11ZdH6KbZ8q2cgU%2FRMODKRq75fJ6sn%2FkR1fBrPaMFfKsP%2BSLpkSrkbyi968FqbmO6yo59Heb3d1kDMwzaNShj3ou%2Fq9qAc5NWgXlxJtABJqkgxPd5NovxMOsASin8kfBjU8OhOOEnonvd2t16oF509MVoA81P%2Frmr4njIb3UfHzYyccuDQNjHM0qV7B57bCKQeIuO%2FzLl7au%2FWR2v6R6bwK6fGUYVbcnAam9GqobWJnMl6NFbipNSdmUzB5%2BglRYaYeGXxbgxseM7SSFeehfzbywUoHEf4Ve61V1e90uyx3M0Krbm5QjS5gNgwErj0g2rC2mkrl2q%2B9ADfOzgMAX8fUODFalEv4gZf0ZKuLhpmAzEapJE5f%2BarcSkdn5b0ddy4Wa2vdsZ6lQ5NOez8qkcnaBEJZLnv3YGHyInLrIaUkqlq4iavZpr4f5Al5PueqIzLuItn5ztJjfvCu5dDIplWP0eo6r%2BIUCKsDwUNkRSgWCtJbCfl%2BPF3PKHjvnmVEBawLZlpXvaOGUvA%2FKYb2cGGXn89CPjYlwpWCj2J8Z%2B0okbim4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=9a04249312d49c61f0d66f7094b7e277c33317006e1ba281f4bbcba031de48f4"
        }
    ], 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": true, 
            "created_at": "2016-10-11T07:59:08.788Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-10-11T07:59:08.788Z", 
            "actor": {
                "url": "/nextcloud", 
                "profile": {
                    "name": "Nextcloud"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/291/1d2ac8991616fcd3e3cdd567d02b7e70e20a3883_medium.png?1491410731"
                }
            }, 
            "team_handle": "nextcloud", 
            "message": "Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.", 
            "markdown_message": "<p>Thanks a lot for reporting this potential issue back to us!</p>\n\n<p>Our security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we&#39;d like to ask you to not disclose this issue to any other party.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1241653, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-10-11T08:42:06.487Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-10-11T08:42:06.487Z", 
            "actor": {
                "username": "lukasreschke", 
                "url": "/lukasreschke", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/037/891/0ddfc05411893988a0d2794cd70d5dc221729713_medium.png?1438782834"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nextcloud", 
            "message": "Thanks for your report. I'll escalate this to the developer of the mail app and get back to you once we've more information.", 
            "markdown_message": "<p>Thanks for your report. I&#39;ll escalate this to the developer of the mail app and get back to you once we&#39;ve more information.</p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 1241727, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-10-27T16:24:42.756Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-10-27T16:24:42.756Z", 
            "actor": {
                "username": "christophwurst", 
                "url": "/christophwurst", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nextcloud", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ExternalUserJoined", 
            "id": 1271219, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-11-13T16:07:38.080Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-11-13T16:07:38.080Z", 
            "actor": {
                "username": "lukasreschke", 
                "url": "/lukasreschke", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/037/891/0ddfc05411893988a0d2794cd70d5dc221729713_medium.png?1438782834"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nextcloud", 
            "message": "@christophwurst Any update on this?", 
            "markdown_message": "<p><a href=\"/christophwurst\">@christophwurst</a> Any update on this?</p>\n", 
            "type": "Activities::Comment", 
            "id": 1297054, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-11-19T19:07:57.989Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-11-19T19:07:57.989Z", 
            "actor": {
                "username": "christophwurst", 
                "url": "/christophwurst", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nextcloud", 
            "message": "Hi and thanks for your report.\nI created PR https://github.com/nextcloud/mail/pull/188 and https://github.com/nextcloud/mail/pull/187 to fix the reported problems.", 
            "markdown_message": "<p>Hi and thanks for your report.<br>\nI created PR <a title=\"https://github.com/nextcloud/mail/pull/188\" href=\"/redirect?signature=ce71894eeb47d77022e56c68110cc26f28102d17&amp;url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fmail%2Fpull%2F188\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/nextcloud/mail/pull/188</span><i class=\"icon-external-link\"></i></a> and <a title=\"https://github.com/nextcloud/mail/pull/187\" href=\"/redirect?signature=c4eae5d8314377011a82c1187e322e5e6d1ae860&amp;url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fmail%2Fpull%2F187\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/nextcloud/mail/pull/187</span><i class=\"icon-external-link\"></i></a> to fix the reported problems.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1308346, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "trichimtrich", 
                "url": "/trichimtrich"
            }, 
            "created_at": "2016-12-13T20:01:54.848Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-12-13T20:01:54.848Z", 
            "actor": {
                "username": "lukasreschke", 
                "url": "/lukasreschke", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/037/891/0ddfc05411893988a0d2794cd70d5dc221729713_medium.png?1438782834"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nextcloud", 
            "message": "Thanks a lot for your report again. This has been resolved in the Nextcloud Mail 0.6.2 release and the update is available via the Nextcloud app store: https://apps.nextcloud.com/apps/mail", 
            "markdown_message": "<p>Thanks a lot for your report again. This has been resolved in the Nextcloud Mail 0.6.2 release and the update is available via the Nextcloud app store: <a title=\"https://apps.nextcloud.com/apps/mail\" href=\"/redirect?signature=335cec01b85bb7b9093f93d420d52fd62400682b&amp;url=https%3A%2F%2Fapps.nextcloud.com%2Fapps%2Fmail\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://apps.nextcloud.com/apps/mail</span><i class=\"icon-external-link\"></i></a></p>\n", 
            "type": "Activities::BugResolved", 
            "id": 1362479, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-12-13T20:02:26.176Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-12-13T20:02:26.176Z", 
            "actor": {
                "url": "/nextcloud", 
                "profile": {
                    "name": "Nextcloud"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/291/1d2ac8991616fcd3e3cdd567d02b7e70e20a3883_medium.png?1491410731"
                }
            }, 
            "team_handle": "nextcloud", 
            "message": "Since this is bug in an optional app for Nextcloud this is not covered by our monetary rewards.", 
            "markdown_message": "<p>Since this is bug in an optional app for Nextcloud this is not covered by our monetary rewards.</p>\n", 
            "type": "Activities::NotEligibleForBounty", 
            "id": 1362480, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-12-13T20:02:30.624Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-12-13T20:02:30.624Z", 
            "actor": {
                "username": "lukasreschke", 
                "url": "/lukasreschke", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/037/891/0ddfc05411893988a0d2794cd70d5dc221729713_medium.png?1438782834"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nextcloud", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1362481, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-01-12T20:02:32.191Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-01-12T20:02:32.191Z", 
            "actor": {
                "url": "/nextcloud", 
                "profile": {
                    "name": "Nextcloud"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/291/1d2ac8991616fcd3e3cdd567d02b7e70e20a3883_medium.png?1491410731"
                }
            }, 
            "team_handle": "nextcloud", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 1416797, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "trichimtrich", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/trichimtrich", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/054/327/f9669349064a2f5d0a24c7b5781000a8db7c915d_small.jpg?1503071594"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 57, 
        "name": "Violation of Secure Design Principles"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -59884944.62057558, 
    "disclosed_at": "2017-01-12T20:02:32.175Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/175085", 
    "created_at": "2016-10-11T07:59:08.673Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<h2 id=\"bug\">Bug</h2>\n\n<p>When we load a HTML mail from mailbox via api, etc<br>\n<code>http://nextcloud/index.php/apps/mail/accounts/&lt;accountID&gt;/folders/SU5CT1g=/messages/&lt;mailID&gt;/html</code><br>\nOur content will be passed to HTML Purifier to strip malicious XSS patterns.<br>\nAfter that, an filter will apply to transform acceptable URI schemes <code>http, https, ftp, cid</code> to redirect/proxy service. <br>\nThere&#39;s a bug in here, only <code>http, https, cid</code> scheme are filtered.<br>\nSo we can add <code>src</code> attribute or <code>href</code> from url with scheme <code>ftp</code> or <code>NULL</code> (like <code>&#39;../../abc/xyz&#39;</code>) . We can easily bypass image filter (also Content-Security-Policy)<br>\nNotice that there&#39;s a filter that append <code>target=_blank</code> to all <code>&lt;a&gt;</code> tag. This can lead to opener bug <a href=\"/redirect?signature=008f013f39462c528f2577302945cdd60b4f9e11&amp;url=https%3A%2F%2Fmathiasbynens.github.io%2Frel-noopener%2F%23hax\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://mathiasbynens.github.io/rel-noopener/#hax</span><i class=\"icon-external-link\"></i></a> that I learned from <a href=\"https://hackerone.com/reports/124620\">124620</a>.<br>\nAnd finally it can leak accountID of user</p>\n\n<h2 id=\"poc\">PoC</h2>\n\n<ul>\n<li>Attacker create a shared link of a image</li>\n</ul>\n\n<p><code>http://192.168.200.117/nextcloud/index.php/s/HUw7Cwa40Phlt8v/download</code></p>\n\n<ul>\n<li>Attacker start a ftp server and create a html page.</li>\n</ul>\n\n<p><code>ftp://chim:chim@localhost/test.html</code></p>\n\n<ul>\n<li>Attacker send a HTML email</li>\n</ul>\n<pre class=\"highlight plaintext\"><code>&lt;h1&gt;test schema&lt;/h1&gt;\n&lt;p&gt;\n    &lt;a href=&quot;http://file.trich.im&quot;&gt;Link via redirect&lt;/a&gt;&lt;br&gt;\n    &lt;a href=&#39;ftp://chim:chim@localhost/hihi.html&#39;&gt;Bypass link&lt;/a&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n    Filtered img&lt;img src=&#39;http://192.168.200.117/nextcloud/index.php/s/HUw7Cwa40Phlt8v/download&#39;&gt;&lt;br&gt;\n    Bypass img &lt;img src=&#39;/nextcloud/index.php/s/HUw7Cwa40Phlt8v/download&#39;&gt;\n&lt;/p&gt;\n</code></pre>\n<h2 id=\"video-demo-https-www-youtube-com-watch-v-bdod49gokdi\">Video Demo <a title=\"https://www.youtube.com/watch?v=BdOD49gokdI\" href=\"/redirect?signature=5f95fc99313fbb11008c0bc5d5a2a5e8e9181d89&amp;url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DBdOD49gokdI\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.youtube.com/watch?v=BdOD49gokdI</span><i class=\"icon-external-link\"></i></a>\n</h2>\n", 
    "vulnerability_information": "## Bug\nWhen we load a HTML mail from mailbox via api, etc\n`http://nextcloud/index.php/apps/mail/accounts/<accountID>/folders/SU5CT1g=/messages/<mailID>/html`\nOur content will be passed to HTML Purifier to strip malicious XSS patterns.\nAfter that, an filter will apply to transform acceptable URI schemes `http, https, ftp, cid` to redirect/proxy service. \nThere's a bug in here, only `http, https, cid` scheme are filtered.\nSo we can add `src` attribute or `href` from url with scheme `ftp` or `NULL` (like `'../../abc/xyz'`) . We can easily bypass image filter (also Content-Security-Policy)\nNotice that there's a filter that append `target=_blank` to all `<a>` tag. This can lead to opener bug [https://mathiasbynens.github.io/rel-noopener/#hax] (https://mathiasbynens.github.io/rel-noopener/#hax) that I learned from [124620] (https://hackerone.com/reports/124620).\nAnd finally it can leak accountID of user\n\n## PoC\n* Attacker create a shared link of a image\n\n`http://192.168.200.117/nextcloud/index.php/s/HUw7Cwa40Phlt8v/download`\n* Attacker start a ftp server and create a html page.\n\n`ftp://chim:chim@localhost/test.html`\n* Attacker send a HTML email\n\n```\n<h1>test schema</h1>\n<p>\n\t<a href=\"http://file.trich.im\">Link via redirect</a><br>\n\t<a href='ftp://chim:chim@localhost/hihi.html'>Bypass link</a>\n</p>\n\n<p>\n\tFiltered img<img src='http://192.168.200.117/nextcloud/index.php/s/HUw7Cwa40Phlt8v/download'><br>\n\tBypass img <img src='/nextcloud/index.php/s/HUw7Cwa40Phlt8v/download'>\n</p>\n```\n\n## Video Demo https://www.youtube.com/watch?v=BdOD49gokdI", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://nextcloud.com", 
            "about": "Access, share and protect your files, calendars, contacts, communication & more at home and in your enterprise.", 
            "twitter_handle": "nextclouders", 
            "name": "Nextcloud"
        }, 
        "handle": "nextcloud", 
        "url": "https://hackerone.com/nextcloud", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/013/291/5d33b6e08fad356e1743fd899fe7d6dda9971209_small.png?1491410731", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/013/291/1d2ac8991616fcd3e3cdd567d02b7e70e20a3883_medium.png?1491410731"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 13291, 
        "default_currency": "usd"
    }, 
    "is_published": false
}