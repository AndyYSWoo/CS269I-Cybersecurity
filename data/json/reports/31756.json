{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2015-04-06T09:40:07.380Z", 
    "voters": [
        "pavanw3b"
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "3000.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 31756, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2015-04-06T02:21:41.959Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "Drupal 7 pre auth sql injection and remote code execution", 
    "is_member_of_team?": null, 
    "vote_count": 1, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2015-05-06T02:21:42.364Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$3,000", 
    "attachments": [
        {
            "file_name": "poc.tgz", 
            "type": "application/x-gzip", 
            "id": 18972, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/018/972/a84ca61f69d55f4a9c37e47021cdbfd9277bfd70/poc.tgz?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZPLQ5BUN%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T230124Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEBAaDEDfEiV3fKrg6NgnRyK3A7F%2Fgez30Q8XtbjxqPJCCDyrQ1WHG1Ms%2BiNrFhPkOjxdxkFI7%2FmeBoEwld%2BBg%2Fxd80VL0fBmaI1bmWp0zg6aX3Qwij6Juakmq0CD%2BT0VKPI9Mv2HfX3HQxVWEBGpOnXIMa70ybfCeA6ngLfjzZ%2BmAKRvBYchPKl0PwQ8yLr9mwnOCm39lR9j%2B24XxNKqYMYUEJ3NA9k%2Fd7JwpEM3wAt5gmC4rTYUqAbBGTwYgUpmI5BUVoAx6LHPb6Nw7%2FHNfhTTliVzDxrjgf52JrHtXxBegb6ouh6poSiwmNtym3r9MWBqKBOvl070%2F6rDrhs%2FuP0WiKmCwI1JyHbYYbf5AgyM3nZHR5btWT9DfsNecf%2FlxPEGzGCmoCpChk%2Bk2rqFE9irbvPPxk%2Fk10j%2FLL5y5DQ6isQsQrESVRTZhIBbrPPqQPmw9fsoqoRuXpCFXub61Q%2FcyUsaztL6W3IBg%2FAGix7q7Jl7yLTmZ%2BoGw83EZ78riCzaBxqTBlW9CYKaFjAp7bk8eGZHD%2FfvNe7NJxsiAlIaSr73q%2B3Wdi4jOujwLywCLMlAwWzkd2GlleOtLzf5N9Y7lZZwgWkA9icoyMOm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=b0fc8546d3d1fd05cad1a69b7cf744714003d9fef3c33772eec3d5194e1c9639"
        }
    ], 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2014-11-04T21:31:11.551Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-11-04T21:31:11.551Z", 
            "actor": {
                "username": "shorst", 
                "url": "/shorst", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/129/7ba659e7774c748f8efa8af0693d73b0d8b2d916_medium.png?1413557891"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "Two weeks after the Bug the Drupal Security Team released this statement:\n\n *Automated attacks began compromising Drupal 7 websites that were not patched or updated to Drupal 7.32 within hours of the announcement of SA-CORE-2014-005 - Drupal core - SQL injection. You should proceed under the assumption that every Drupal 7 website was compromised unless updated or patched before Oct 15th, 11pm UTC, that is 7 hours after the announcement.*\n\nThis is why I wrote some additional infos about the Bug and two PoCs to our website: https://www.sektioneins.de/blog/14-11-03-drupal-sql-injection-vulnerability-PoC.html", 
            "markdown_message": "<p>Two weeks after the Bug the Drupal Security Team released this statement:</p>\n\n<p><em>Automated attacks began compromising Drupal 7 websites that were not patched or updated to Drupal 7.32 within hours of the announcement of SA-CORE-2014-005 - Drupal core - SQL injection. You should proceed under the assumption that every Drupal 7 website was compromised unless updated or patched before Oct 15th, 11pm UTC, that is 7 hours after the announcement.</em></p>\n\n<p>This is why I wrote some additional infos about the Bug and two PoCs to our website: <a title=\"https://www.sektioneins.de/blog/14-11-03-drupal-sql-injection-vulnerability-PoC.html\" href=\"/redirect?signature=8308f3405e682e84ebe0b31c294ec4d17b551de5&amp;url=https%3A%2F%2Fwww.sektioneins.de%2Fblog%2F14-11-03-drupal-sql-injection-vulnerability-PoC.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.sektioneins.de/blog/14-11-03-drupal-sql-injection-vulnerability-PoC.html</span><i class=\"icon-external-link\"></i></a></p>\n", 
            "type": "Activities::Comment", 
            "id": 153776, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-11-17T06:34:27.914Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-11-17T06:34:27.914Z", 
            "actor": {
                "username": "arice", 
                "url": "/arice", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/74e2a8a31fee27a0c9b3d1d90dd64f4e38b2fb1c_medium.jpeg?1466604112"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "We don't currently offer bounties on Drupal vulnerabilities, but this one might have been severe enough for an exception. I'll nominate to the panel and get back to you shortly. Thanks!", 
            "markdown_message": "<p>We don&#39;t currently offer bounties on Drupal vulnerabilities, but this one might have been severe enough for an exception. I&#39;ll nominate to the panel and get back to you shortly. Thanks!</p>\n", 
            "type": "Activities::Comment", 
            "id": 161690, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-01-29T15:49:47.527Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-01-29T15:49:47.527Z", 
            "actor": {
                "username": "shorst", 
                "url": "/shorst", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/129/7ba659e7774c748f8efa8af0693d73b0d8b2d916_medium.png?1413557891"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "hey, wanted to ask if there is any news? BR", 
            "markdown_message": "<p>hey, wanted to ask if there is any news? BR</p>\n", 
            "type": "Activities::Comment", 
            "id": 320573, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "shorst", 
                "url": "/shorst"
            }, 
            "created_at": "2015-04-06T02:20:11.315Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-04-06T02:20:11.315Z", 
            "actor": {
                "username": "arice", 
                "url": "/arice", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/74e2a8a31fee27a0c9b3d1d90dd64f4e38b2fb1c_medium.jpeg?1466604112"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugResolved", 
            "id": 372802, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2015-04-06T02:21:36.211Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-04-06T02:21:36.211Z", 
            "actor": {
                "url": "/internet", 
                "profile": {
                    "name": "The Internet"
                }, 
                "ibb": true, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/38e952fcff2c0aae0d011d5cecd07e5f62ecbd63_medium.png?1383767658"
                }
            }, 
            "team_handle": "internet", 
            "bounty_amount": "3000.0", 
            "collaborator": {
                "username": "shorst", 
                "url": "/shorst"
            }, 
            "message": "We went in circles for a bit on this one given that it's an unusual bounty for the program, but the severity and active exploitation observed here warrant an exception. Thanks for the great find!", 
            "markdown_message": "<p>We went in circles for a bit on this one given that it&#39;s an unusual bounty for the program, but the severity and active exploitation observed here warrant an exception. Thanks for the great find!</p>\n", 
            "type": "Activities::BountyAwarded", 
            "id": 372804, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-04-06T02:21:42.035Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-04-06T02:21:42.035Z", 
            "actor": {
                "username": "arice", 
                "url": "/arice", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/74e2a8a31fee27a0c9b3d1d90dd64f4e38b2fb1c_medium.jpeg?1466604112"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 372805, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-04-06T09:40:07.837Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-04-06T09:40:07.837Z", 
            "actor": {
                "username": "shorst", 
                "url": "/shorst", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/129/7ba659e7774c748f8efa8af0693d73b0d8b2d916_medium.png?1413557891"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 372956, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-04-06T09:40:09.464Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-04-06T09:40:09.464Z", 
            "actor": {
                "username": "shorst", 
                "url": "/shorst", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/129/7ba659e7774c748f8efa8af0693d73b0d8b2d916_medium.png?1413557891"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 372957, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "shorst", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/shorst", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/013/129/dfdba188a3b1fb0080d12fcea9a5e82fa0546365_small.png?1413557891"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 67, 
        "name": "SQL Injection"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -113258381.95404445, 
    "disclosed_at": "2015-04-06T09:40:09.432Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/31756", 
    "created_at": "2014-10-17T10:50:36.095Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<h1 id=\"motivation\">Motivation</h1>\n\n<p>I found a SQL Injection bug in Drupal &lt; 7.32. Which can lead to a code execution. </p>\n\n<p>You need not have any user or knowledge of the targeted site.</p>\n\n<p>Since Drupal is used as they state by &quot;millions of websites and applications&quot; I thought about applying for this bug bounty.</p>\n\n<h1 id=\"the-bug\">The Bug</h1>\n\n<p>Drupal uses Prepared Statements to secure the SQL Querys from Injections. To handle IN statements they created a expandArguments function, which uses the Array keys to create names for the placeholders. </p>\n<pre class=\"highlight plaintext\"><code>foreach ($data as $i =&gt; $value) {\n      [...]\n      $new_keys[$key . &#39;_&#39; . $i] = $value;\n}\n</code></pre>\n<p>The function assumes that it is called with an array which has no keys. Example:</p>\n<pre class=\"highlight plaintext\"><code>db_query(&quot;SELECT * FROM {users} where name IN (:name)&quot;, array(&#39;:name&#39;=&gt;array(&#39;user1&#39;,&#39;user2&#39;)));\n</code></pre>\n<p>Which results in this SQL Statement</p>\n<pre class=\"highlight plaintext\"><code>SELECT * from users where name IN (:name_0, :name_1)\n</code></pre>\n<p>with the parameters name_0 = user1 and name_1 = user2.</p>\n\n<p>The Problem occurs, if the array has keys, which are no integers. Example:</p>\n<pre class=\"highlight plaintext\"><code>db_query(&quot;SELECT * FROM {users} where name IN (:name)&quot;, array(&#39;:name&#39;=&gt;array(&#39;test) -- &#39; =&gt; &#39;user1&#39;,&#39;test&#39; =&gt; &#39;user2&#39;)));\n</code></pre>\n<p>this results in an exploitable SQL query:</p>\n<pre class=\"highlight plaintext\"><code> SELECT * FROM users WHERE name IN (:name_test) -- , :name_test )\n</code></pre>\n<p>with parameters :name_test = user2.</p>\n\n<p>Since Drupal uses PDO, multi-queries are allowed. So this SQL Injection can be used to insert arbitrary data in the database, dump or modify existing data or drop the whole database.</p>\n\n<p>With the possibility to INSERT arbitrary data into the database an attacker can execute any PHP code through a manipulated Session and Drupal features with callbacks.</p>\n\n<h1 id=\"advisory\">Advisory</h1>\n\n<p><a title=\"https://www.sektioneins.de/advisories/advisory-012014-drupal-pre-auth-sql-injection-vulnerability.html\" href=\"/redirect?signature=314f292a1514efe0fa020afed000caa8ac1ebf63&amp;url=https%3A%2F%2Fwww.sektioneins.de%2Fadvisories%2Fadvisory-012014-drupal-pre-auth-sql-injection-vulnerability.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.sektioneins.de/advisories/advisory-012014-drupal-pre-auth-sql-injection-vulnerability.html</span><i class=\"icon-external-link\"></i></a></p>\n\n<h1 id=\"cve-information\">CVE Information</h1>\n\n<p>The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name CVE-2014-3704 to this vulnerability.</p>\n\n<h1 id=\"poc\">Poc</h1>\n\n<p>I included two PoCs. The first creates one request to create a session which has Admin privileges (UserID 1). The second executes code with only one request and destroys the session afterwards to not create a new Database entry. Some parts of the Second PoC were discovered with help of my coworker Stefan Esser.</p>\n", 
    "vulnerability_information": "# Motivation\r\nI found a SQL Injection bug in Drupal < 7.32. Which can lead to a code execution. \r\n\r\nYou need not have any user or knowledge of the targeted site.\r\n\r\nSince Drupal is used as they state by \"millions of websites and applications\" I thought about applying for this bug bounty.\r\n\r\n# The Bug\r\nDrupal uses Prepared Statements to secure the SQL Querys from Injections. To handle IN statements they created a expandArguments function, which uses the Array keys to create names for the placeholders. \r\n\r\n    foreach ($data as $i => $value) {\r\n          [...]\r\n          $new_keys[$key . '_' . $i] = $value;\r\n    }\r\n\r\nThe function assumes that it is called with an array which has no keys. Example:\r\n\r\n    db_query(\"SELECT * FROM {users} where name IN (:name)\", array(':name'=>array('user1','user2')));\r\n\r\nWhich results in this SQL Statement\r\n\r\n    SELECT * from users where name IN (:name_0, :name_1)\r\n\r\nwith the parameters name_0 = user1 and name_1 = user2.\r\n\r\nThe Problem occurs, if the array has keys, which are no integers. Example:\r\n\r\n    db_query(\"SELECT * FROM {users} where name IN (:name)\", array(':name'=>array('test) -- ' => 'user1','test' => 'user2')));\r\n\r\nthis results in an exploitable SQL query:\r\n\r\n     SELECT * FROM users WHERE name IN (:name_test) -- , :name_test )\r\n\r\nwith parameters :name_test = user2.\r\n\r\nSince Drupal uses PDO, multi-queries are allowed. So this SQL Injection can be used to insert arbitrary data in the database, dump or modify existing data or drop the whole database.\r\n\r\nWith the possibility to INSERT arbitrary data into the database an attacker can execute any PHP code through a manipulated Session and Drupal features with callbacks.\r\n\r\n# Advisory\r\nhttps://www.sektioneins.de/advisories/advisory-012014-drupal-pre-auth-sql-injection-vulnerability.html\r\n\r\n# CVE Information\r\nThe Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name CVE-2014-3704 to this vulnerability.\r\n\r\n# Poc\r\nI included two PoCs. The first creates one request to create a session which has Admin privileges (UserID 1). The second executes code with only one request and destroys the session afterwards to not create a new Database entry. Some parts of the Second PoC were discovered with help of my coworker Stefan Esser.", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "", 
            "about": "Hack all the things.", 
            "twitter_handle": null, 
            "name": "The Internet"
        }, 
        "handle": "internet", 
        "url": "https://hackerone.com/internet", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/020/b94983d2ec09553c3e08f98cc718cb17e01112e6_small.png?1383767658", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/38e952fcff2c0aae0d011d5cecd07e5f62ecbd63_medium.png?1383767658"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 20, 
        "default_currency": "usd"
    }, 
    "is_published": false
}