{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2017-07-20T08:37:39.476Z", 
    "voters": [
        "bl4de", 
        "jr0ch17", 
        "spam404", 
        "003random", 
        "s_p_q_r", 
        "bhavukjain1", 
        "samux", 
        "akaash_pantherdefence", 
        "malcolmx", 
        "eveeez", 
        "and 13 more..."
    ], 
    "facebook_team?": false, 
    "has_bounty?": false, 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 244677, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2017-07-20T15:36:20.784Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "Add arbitrary content to Password Reset Email", 
    "is_member_of_team?": null, 
    "vote_count": 23, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2017-08-19T08:37:39.536Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "attachments": [
        {
            "file_name": "h1uploadedattachment.png", 
            "type": "image/png", 
            "id": 209902, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/209/902/3a44308bef3d5a659ade717f9af0a8b451252ff0/h1uploadedattachment.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5B43OTPE%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T223527Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDCiDARkX3ArKGaO7%2ByK3A39tqjzyooRkX4qPdNM7MkAemep3r5%2Fh%2B11ZdH6KbZ8q2cgU%2FRMODKRq75fJ6sn%2FkR1fBrPaMFfKsP%2BSLpkSrkbyi968FqbmO6yo59Heb3d1kDMwzaNShj3ou%2Fq9qAc5NWgXlxJtABJqkgxPd5NovxMOsASin8kfBjU8OhOOEnonvd2t16oF509MVoA81P%2Frmr4njIb3UfHzYyccuDQNjHM0qV7B57bCKQeIuO%2FzLl7au%2FWR2v6R6bwK6fGUYVbcnAam9GqobWJnMl6NFbipNSdmUzB5%2BglRYaYeGXxbgxseM7SSFeehfzbywUoHEf4Ve61V1e90uyx3M0Krbm5QjS5gNgwErj0g2rC2mkrl2q%2B9ADfOzgMAX8fUODFalEv4gZf0ZKuLhpmAzEapJE5f%2BarcSkdn5b0ddy4Wa2vdsZ6lQ5NOez8qkcnaBEJZLnv3YGHyInLrIaUkqlq4iavZpr4f5Al5PueqIzLuItn5ztJjfvCu5dDIplWP0eo6r%2BIUCKsDwUNkRSgWCtJbCfl%2BPF3PKHjvnmVEBawLZlpXvaOGUvA%2FKYb2cGGXn89CPjYlwpWCj2J8Z%2B0okbim4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=78bf838dfe63c7d741c38c17ce6649f46c305d31349e002bb38175ed7d705008"
        }
    ], 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "reporter": {
                "username": "footstep", 
                "url": "/footstep"
            }, 
            "created_at": "2017-06-30T10:05:48.880Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-30T10:05:48.880Z", 
            "actor": {
                "username": "alanhamlett", 
                "url": "/alanhamlett", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/175/849/ae248e8b4efd907388a4912c0af4a5550a162d4f_medium.jpg?1498750521"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "wakatime", 
            "message": "Thanks for the report! It's fixed now using https://github.com/selwin/python-user-agents to parse the user agent header.", 
            "markdown_message": "<p>Thanks for the report! It&#39;s fixed now using <a title=\"https://github.com/selwin/python-user-agents\" href=\"/redirect?signature=d2f08d5521200a847f49f6dd8aa92239d6c8bb78&amp;url=https%3A%2F%2Fgithub.com%2Fselwin%2Fpython-user-agents\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/selwin/python-user-agents</span><i class=\"icon-external-link\"></i></a> to parse the user agent header.</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 1793749, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-06-30T10:12:54.252Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-30T10:12:54.252Z", 
            "actor": {
                "username": "footstep", 
                "url": "/footstep", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/040/985/f6984fa964ecb9e27c9ac7b37599af06c8ec8bf1_medium.png?1454165301"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "wakatime", 
            "message": "That was fast :)", 
            "markdown_message": "<p>That was fast :)</p>\n", 
            "type": "Activities::Comment", 
            "id": 1793759, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-07-20T08:37:39.498Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-07-20T08:37:39.498Z", 
            "actor": {
                "username": "footstep", 
                "url": "/footstep", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/040/985/f6984fa964ecb9e27c9ac7b37599af06c8ec8bf1_medium.png?1454165301"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "wakatime", 
            "first_to_agree": true, 
            "message": "Shall we? \ud83d\ude09", 
            "markdown_message": "<p>Shall we? \ud83d\ude09</p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1852373, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-07-20T15:36:20.802Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-07-20T15:36:20.802Z", 
            "actor": {
                "username": "alanhamlett", 
                "url": "/alanhamlett", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/175/849/ae248e8b4efd907388a4912c0af4a5550a162d4f_medium.jpg?1498750521"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "wakatime", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1853522, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-07-20T15:36:20.858Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-07-20T15:36:20.858Z", 
            "actor": {
                "username": "alanhamlett", 
                "url": "/alanhamlett", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/175/849/ae248e8b4efd907388a4912c0af4a5550a162d4f_medium.jpg?1498750521"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "wakatime", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 1853523, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-07-20T18:40:44.738Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-07-20T18:40:44.738Z", 
            "actor": {
                "username": "footstep", 
                "url": "/footstep", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/040/985/f6984fa964ecb9e27c9ac7b37599af06c8ec8bf1_medium.png?1454165301"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "wakatime", 
            "message": "Hi!\n\nPlease redact my email in the **Request** above.", 
            "markdown_message": "<p>Hi!</p>\n\n<p>Please redact my email in the <strong>Request</strong> above.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1854476, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-07-21T08:22:31.993Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-07-21T08:22:31.993Z", 
            "actor": {
                "username": "footstep", 
                "url": "/footstep", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/040/985/f6984fa964ecb9e27c9ac7b37599af06c8ec8bf1_medium.png?1454165301"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "wakatime", 
            "message": "Still not redacted in the `Referer` header", 
            "markdown_message": "<p>Still not redacted in the <code>Referer</code> header</p>\n", 
            "type": "Activities::Comment", 
            "id": 1855893, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-07-21T14:15:53.852Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-07-21T14:15:53.852Z", 
            "actor": {
                "username": "alanhamlett", 
                "url": "/alanhamlett", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/175/849/ae248e8b4efd907388a4912c0af4a5550a162d4f_medium.jpg?1498750521"
                }, 
                "hackerone_triager": false
            }, 
            "additional_data": {
                "new_title": "Content injection through Password Reset Email", 
                "old_title": "Email Injection through Password Reset"
            }, 
            "team_handle": "wakatime", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportTitleUpdated", 
            "id": 1856609, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-07-21T14:17:18.411Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-07-21T14:17:18.411Z", 
            "actor": {
                "username": "alanhamlett", 
                "url": "/alanhamlett", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/175/849/ae248e8b4efd907388a4912c0af4a5550a162d4f_medium.jpg?1498750521"
                }, 
                "hackerone_triager": false
            }, 
            "additional_data": {
                "new_title": "Add arbitrary content to Password Reset Email", 
                "old_title": "Content injection through Password Reset Email"
            }, 
            "team_handle": "wakatime", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportTitleUpdated", 
            "id": 1856612, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "footstep", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/footstep", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/040/985/108b1b2b44b1103a11a7db90699dadb4c83b113a_small.png?1454165301"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 70, 
        "name": "Code Injection"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -41003868.30066384, 
    "disclosed_at": "2017-07-20T15:36:20.840Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/244677", 
    "created_at": "2017-06-30T08:59:53.936Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>Hi,</p>\n\n<p>I noticed the inclusion of <code>IP Address</code> in the email sent for password reset. Then I tried including a new <em>header</em>, <code>X-Forwarded-For</code> to see if the IP Address in the email could change. Though it didn&#39;t change it but it did include whatever value that was injected in the header.</p>\n\n<h3 id=\"request\">Request</h3>\n<pre class=\"highlight plaintext\"><code>POST /api/v1/users/reset_password HTTP/1.1\nHost: wakatime.com\nX-Forwarded-For: _For precaution, send your email and new password to \u2588\u2588\u2588@email.com or visit www.evil.com.\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:53.0) Gecko/20100101 Firefox/53.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nContent-Type: application/json\nX-CSRFToken: [Token]\nX-Requested-With: XMLHttpRequest\nReferer: https://wakatime.com/reset_password?email=\u2588\u2588\u2588\u2588@gmail.com\nContent-Length: 35\nCookie: [Cookie]\nConnection: close\n\n{&quot;email&quot;:&quot;EmailAddress&quot;}\n</code></pre>\n<p>What is included in the request is </p>\n\n<blockquote>\n<p>X-Forwarded-For: _For precaution, send your email and new password to \u2588\u2588\u2588\u2588\u2588\u2588\u2588@email.com or visit <a href=\"/redirect?signature=7a665fb24ca1c5f79f4d859c04a917bcd86bf600&amp;url=http%3A%2F%2Fwww.evil.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>www.evil.com</span><i class=\"icon-external-link\"></i></a>.</p>\n</blockquote>\n\n<p>Then the reflection in email is shown below,<br>\n<a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"h1uploadedattachment.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/209/902/3a44308bef3d5a659ade717f9af0a8b451252ff0/h1uploadedattachment.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ5B43OTPE%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T223527Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDCiDARkX3ArKGaO7%2ByK3A39tqjzyooRkX4qPdNM7MkAemep3r5%2Fh%2B11ZdH6KbZ8q2cgU%2FRMODKRq75fJ6sn%2FkR1fBrPaMFfKsP%2BSLpkSrkbyi968FqbmO6yo59Heb3d1kDMwzaNShj3ou%2Fq9qAc5NWgXlxJtABJqkgxPd5NovxMOsASin8kfBjU8OhOOEnonvd2t16oF509MVoA81P%2Frmr4njIb3UfHzYyccuDQNjHM0qV7B57bCKQeIuO%2FzLl7au%2FWR2v6R6bwK6fGUYVbcnAam9GqobWJnMl6NFbipNSdmUzB5%2BglRYaYeGXxbgxseM7SSFeehfzbywUoHEf4Ve61V1e90uyx3M0Krbm5QjS5gNgwErj0g2rC2mkrl2q%2B9ADfOzgMAX8fUODFalEv4gZf0ZKuLhpmAzEapJE5f%2BarcSkdn5b0ddy4Wa2vdsZ6lQ5NOez8qkcnaBEJZLnv3YGHyInLrIaUkqlq4iavZpr4f5Al5PueqIzLuItn5ztJjfvCu5dDIplWP0eo6r%2BIUCKsDwUNkRSgWCtJbCfl%2BPF3PKHjvnmVEBawLZlpXvaOGUvA%2FKYb2cGGXn89CPjYlwpWCj2J8Z%2B0okbim4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=78bf838dfe63c7d741c38c17ce6649f46c305d31349e002bb38175ed7d705008\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/209/902/3a44308bef3d5a659ade717f9af0a8b451252ff0/h1uploadedattachment.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ5B43OTPE%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T223527Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDCiDARkX3ArKGaO7%2ByK3A39tqjzyooRkX4qPdNM7MkAemep3r5%2Fh%2B11ZdH6KbZ8q2cgU%2FRMODKRq75fJ6sn%2FkR1fBrPaMFfKsP%2BSLpkSrkbyi968FqbmO6yo59Heb3d1kDMwzaNShj3ou%2Fq9qAc5NWgXlxJtABJqkgxPd5NovxMOsASin8kfBjU8OhOOEnonvd2t16oF509MVoA81P%2Frmr4njIb3UfHzYyccuDQNjHM0qV7B57bCKQeIuO%2FzLl7au%2FWR2v6R6bwK6fGUYVbcnAam9GqobWJnMl6NFbipNSdmUzB5%2BglRYaYeGXxbgxseM7SSFeehfzbywUoHEf4Ve61V1e90uyx3M0Krbm5QjS5gNgwErj0g2rC2mkrl2q%2B9ADfOzgMAX8fUODFalEv4gZf0ZKuLhpmAzEapJE5f%2BarcSkdn5b0ddy4Wa2vdsZ6lQ5NOez8qkcnaBEJZLnv3YGHyInLrIaUkqlq4iavZpr4f5Al5PueqIzLuItn5ztJjfvCu5dDIplWP0eo6r%2BIUCKsDwUNkRSgWCtJbCfl%2BPF3PKHjvnmVEBawLZlpXvaOGUvA%2FKYb2cGGXn89CPjYlwpWCj2J8Z%2B0okbim4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=78bf838dfe63c7d741c38c17ce6649f46c305d31349e002bb38175ed7d705008\" class=\"markdown-inline-image\"></a></p>\n\n<p>Best Regards,<br>\nShuaib</p>\n", 
    "vulnerability_information": "Hi,\n\nI noticed the inclusion of `IP Address` in the email sent for password reset. Then I tried including a new *header*, `X-Forwarded-For` to see if the IP Address in the email could change. Though it didn't change it but it did include whatever value that was injected in the header.\n\n###Request\n```\nPOST /api/v1/users/reset_password HTTP/1.1\nHost: wakatime.com\nX-Forwarded-For: _For precaution, send your email and new password to \u2588\u2588\u2588@email.com or visit www.evil.com.\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:53.0) Gecko/20100101 Firefox/53.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nContent-Type: application/json\nX-CSRFToken: [Token]\nX-Requested-With: XMLHttpRequest\nReferer: https://wakatime.com/reset_password?email=\u2588\u2588\u2588\u2588@gmail.com\nContent-Length: 35\nCookie: [Cookie]\nConnection: close\n\n{\"email\":\"EmailAddress\"}\n```\n\nWhat is included in the request is \n> X-Forwarded-For: _For precaution, send your email and new password to \u2588\u2588\u2588\u2588\u2588\u2588\u2588@email.com or visit www.evil.com.\n\nThen the reflection in email is shown below,\n{F209902}\n\nBest Regards,\nShuaib", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://wakatime.com", 
            "about": "Automated metrics about your programming from text editor plugins.", 
            "twitter_handle": "wakatime", 
            "name": "WakaTime"
        }, 
        "handle": "wakatime", 
        "url": "https://hackerone.com/wakatime", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/021/801/2caa9152d96549f89882e75d40046966865ee3ae_small.?1497459373", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/021/801/1c6ea4e2a9016e302a8fa034ca3c8cf62f48a9a5_medium.?1497459373"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 21801, 
        "default_currency": "usd"
    }, 
    "is_published": false
}