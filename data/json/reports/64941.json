{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2015-06-11T19:56:43.484Z", 
    "voters": [], 
    "facebook_team?": false, 
    "has_bounty?": false, 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 64941, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2015-06-11T19:56:34.528Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "Header Misconfiguration - PHP API", 
    "is_member_of_team?": null, 
    "vote_count": 0, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2015-07-11T19:56:34.703Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "singular_disclosure_disabled": true, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2015-06-08T14:35:38.830Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-06-08T14:35:38.830Z", 
            "actor": {
                "username": "paulos_", 
                "url": "/paulos_", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/008/601/4588a51ca509a58d1c27bb823bebe9594409951c_medium.png?1502343645"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify", 
            "message": "Hey,\n\nUpdates? :'(\n\nThanks", 
            "markdown_message": "<p>Hey,</p>\n\n<p>Updates? :&#39;(</p>\n\n<p>Thanks</p>\n", 
            "type": "Activities::Comment", 
            "id": 444411, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-06-09T19:49:11.560Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-06-09T19:49:11.560Z", 
            "actor": {
                "username": "francoischagnon", 
                "url": "/francoischagnon", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/019/168/3b5130025fbf90eaeb1c9234baa340dfead68f44_medium.jpg?1429126005"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify", 
            "message": "Hello @paulos_,\n\nUnfortunately this code is obsolete\u00a0and not supported by Shopify at this time (as is indicated in the README). This means that the code is out of scope of the bug bounty. I have asked for the github repository to be removed to avoid people using the code. I'll mark this issue as Resolved after it's done.", 
            "markdown_message": "<p>Hello <a href=\"/paulos_\">@paulos_</a>,</p>\n\n<p>Unfortunately this code is obsolete\u00a0and not supported by Shopify at this time (as is indicated in the README). This means that the code is out of scope of the bug bounty. I have asked for the github repository to be removed to avoid people using the code. I&#39;ll mark this issue as Resolved after it&#39;s done.</p>\n", 
            "type": "Activities::Comment", 
            "id": 447947, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-06-09T19:49:41.123Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-06-09T19:49:41.123Z", 
            "actor": {
                "username": "francoischagnon", 
                "url": "/francoischagnon", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/019/168/3b5130025fbf90eaeb1c9234baa340dfead68f44_medium.jpg?1429126005"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugTriaged", 
            "id": 447949, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-06-11T19:53:06.331Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-06-11T19:53:06.331Z", 
            "actor": {
                "username": "paulos_", 
                "url": "/paulos_", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/008/601/4588a51ca509a58d1c27bb823bebe9594409951c_medium.png?1502343645"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify", 
            "message": "rechecked, its removed! :)", 
            "markdown_message": "<p>rechecked, its removed! :)</p>\n", 
            "type": "Activities::Comment", 
            "id": 461207, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "paulos_", 
                "url": "/paulos_"
            }, 
            "created_at": "2015-06-11T19:54:16.051Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-06-11T19:54:16.051Z", 
            "actor": {
                "username": "francoischagnon", 
                "url": "/francoischagnon", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/019/168/3b5130025fbf90eaeb1c9234baa340dfead68f44_medium.jpg?1429126005"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify", 
            "message": "Thanks again for reporting this issue.", 
            "markdown_message": "<p>Thanks again for reporting this issue.</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 461208, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-06-11T19:56:17.421Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-06-11T19:56:17.421Z", 
            "actor": {
                "url": "/shopify", 
                "profile": {
                    "name": "Shopify"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/382/30421c25f4a7b03ec3250e36efb64f7291402806_medium.jpg?1532728703"
                }
            }, 
            "team_handle": "shopify", 
            "message": "This report is out of scope of our program, so it is not eligible for a bounty.", 
            "markdown_message": "<p>This report is out of scope of our program, so it is not eligible for a bounty.</p>\n", 
            "type": "Activities::NotEligibleForBounty", 
            "id": 461211, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-06-11T19:56:34.556Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-06-11T19:56:34.556Z", 
            "actor": {
                "username": "francoischagnon", 
                "url": "/francoischagnon", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/019/168/3b5130025fbf90eaeb1c9234baa340dfead68f44_medium.jpg?1429126005"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 461212, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-06-11T19:56:43.516Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-06-11T19:56:56.527Z", 
            "actor": {
                "username": "paulos_", 
                "url": "/paulos_", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/008/601/4588a51ca509a58d1c27bb823bebe9594409951c_medium.png?1502343645"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 461213, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-06-11T19:56:43.912Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-06-11T19:56:43.912Z", 
            "actor": {
                "username": "paulos_", 
                "url": "/paulos_", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/008/601/4588a51ca509a58d1c27bb823bebe9594409951c_medium.png?1502343645"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 461214, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "paulos_", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/paulos_", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/008/601/c4386dbd803651038555e18d6df83bbc6fd22459_small.png?1502343645"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 57, 
        "name": "Violation of Secure Design Principles"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -107492635.73110679, 
    "disclosed_at": "2015-06-11T19:56:43.885Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/64941", 
    "created_at": "2015-05-30T18:12:37.773Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>Hey,</p>\n\n<p>Your index api page auth can easily be bypassed because it doesn&#39;t use proper auth practices in its PHP core. Here is the master code from Shopify: </p>\n\n<p><a title=\"https://github.com/Shopify/shopify_php_api/blob/master/index.php\" href=\"/redirect?signature=a7c06b6c1ad6844334b8b8ebca12b5a577cbae24&amp;url=https%3A%2F%2Fgithub.com%2FShopify%2Fshopify_php_api%2Fblob%2Fmaster%2Findex.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/Shopify/shopify_php_api/blob/master/index.php</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>it says:</p>\n\n<p>if (!isset($_SESSION[&#39;shop&#39;]) || !isset($_SESSION[&#39;token&#39;])) header(&quot;Location: login.php&quot;);</p>\n\n<p>This easily can be bypassed because the browser can decide to receive 301/302 redirects. and since if not logged in, the code tries to decide to redirect back to the login page, and the browser can ignore it. this can create an authentication bypass and also full path disclosure.</p>\n\n<p>I have written a similar example in my blog, <a title=\"http://www.paulosyibelo.com/2014/08/header-based-login-bypass.html\" href=\"/redirect?signature=af442f99fe2d014968c12329ebe8323bd3d52a54&amp;url=http%3A%2F%2Fwww.paulosyibelo.com%2F2014%2F08%2Fheader-based-login-bypass.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://www.paulosyibelo.com/2014/08/header-based-login-bypass.html</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>P.S: The issue exists not only on the index.php page, but in almost every page. (ex: <a title=\"https://github.com/Shopify/shopify_php_api/blob/master/login.php\" href=\"/redirect?signature=cebc9ea24bffe332691cecf8dde5571cad00c8e9&amp;url=https%3A%2F%2Fgithub.com%2FShopify%2Fshopify_php_api%2Fblob%2Fmaster%2Flogin.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/Shopify/shopify_php_api/blob/master/login.php</span><i class=\"icon-external-link\"></i></a>)</p>\n\n<p>The best practice I would recommend would be creating another function instead of the header one, like:</p>\n\n<p>function redirect($url){<br>\n    header(&quot;Location: $url&quot;);<br>\n    exit();<br>\n}</p>\n\n<p>The easiest approch is to exit(); the code after the redirection. or else, the rest of the page still renders no matter what. I hope I don&#39;t need to provide a POC as its a crystal clear bug (also with the link).</p>\n\n<p>Thanks,</p>\n", 
    "vulnerability_information": "Hey,\r\n\r\nYour index api page auth can easily be bypassed because it doesn't use proper auth practices in its PHP core. Here is the master code from Shopify: \r\n\r\nhttps://github.com/Shopify/shopify_php_api/blob/master/index.php\r\n\r\nit says:\r\n\r\nif (!isset($_SESSION['shop']) || !isset($_SESSION['token'])) header(\"Location: login.php\");\r\n\r\nThis easily can be bypassed because the browser can decide to receive 301/302 redirects. and since if not logged in, the code tries to decide to redirect back to the login page, and the browser can ignore it. this can create an authentication bypass and also full path disclosure.\r\n\r\n I have written a similar example in my blog, http://www.paulosyibelo.com/2014/08/header-based-login-bypass.html\r\n\r\nP.S: The issue exists not only on the index.php page, but in almost every page. (ex: https://github.com/Shopify/shopify_php_api/blob/master/login.php)\r\n\r\nThe best practice I would recommend would be creating another function instead of the header one, like:\r\n\r\nfunction redirect($url){\r\n    header(\"Location: $url\");\r\n    exit();\r\n}\r\n\r\nThe easiest approch is to exit(); the code after the redirection. or else, the rest of the page still renders no matter what. I hope I don't need to provide a POC as its a crystal clear bug (also with the link).\r\n\r\nThanks,", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://www.shopify.com", 
            "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between.", 
            "twitter_handle": "", 
            "name": "Shopify"
        }, 
        "handle": "shopify", 
        "url": "https://hackerone.com/shopify", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/001/382/1e9872bf9cfe04008c2673e07bfecaa83858cca1_small.jpg?1532728703", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/001/382/30421c25f4a7b03ec3250e36efb64f7291402806_medium.jpg?1532728703"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 1382, 
        "default_currency": "usd"
    }, 
    "is_published": false
}