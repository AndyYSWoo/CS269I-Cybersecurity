{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "informative", 
    "bug_reporter_agreed_on_going_public_at": "2017-01-15T22:07:23.165Z", 
    "voters": [
        "dremos", 
        "japz", 
        "spetr0x"
    ], 
    "facebook_team?": false, 
    "has_bounty?": false, 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 145604, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2016-06-20T21:05:12.896Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "Avatar image upload and bypass  real image verification ", 
    "is_member_of_team?": null, 
    "vote_count": 3, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": null, 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Informative", 
    "public": true, 
    "singular_disclosure_disabled": true, 
    "activities": [
        {
            "automated_response": true, 
            "created_at": "2016-06-18T01:50:11.020Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-18T01:50:11.020Z", 
            "actor": {
                "url": "/nextcloud", 
                "profile": {
                    "name": "Nextcloud"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/291/1d2ac8991616fcd3e3cdd567d02b7e70e20a3883_medium.png?1491410731"
                }
            }, 
            "team_handle": "nextcloud", 
            "message": "Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.", 
            "markdown_message": "<p>Thanks a lot for reporting this potential issue back to us!</p>\n\n<p>Our security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we&#39;d like to ask you to not disclose this issue to any other party.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1020549, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-06-19T09:54:26.480Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-19T09:54:26.480Z", 
            "actor": {
                "username": "lukasreschke", 
                "url": "/lukasreschke", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/037/891/0ddfc05411893988a0d2794cd70d5dc221729713_medium.png?1438782834"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nextcloud", 
            "message": "Based on your initial description, there do not appear to be any security implications as a direct result of this behavior. If you disagree, please reply with additional information describing your reasoning. Including a working proof-of-concept can be incredibly helpful in our assessment of these claims.", 
            "markdown_message": "<p>Based on your initial description, there do not appear to be any security implications as a direct result of this behavior. If you disagree, please reply with additional information describing your reasoning. Including a working proof-of-concept can be incredibly helpful in our assessment of these claims.</p>\n", 
            "type": "Activities::BugInformative", 
            "id": 1023154, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-06-20T20:59:27.662Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-20T20:59:27.662Z", 
            "actor": {
                "username": "dremos", 
                "url": "/dremos", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/018/998/606de2fecef884ade592e54f45808e3c38e790f8_medium.jpg?1534160422"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nextcloud", 
            "message": "requested to disclose this report publicly.\nWould You Mind ?\n\n", 
            "markdown_message": "<p>requested to disclose this report publicly.<br>\nWould You Mind ?</p>\n", 
            "type": "Activities::Comment", 
            "id": 1025541, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-06-20T21:05:12.923Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-20T21:05:12.923Z", 
            "actor": {
                "username": "lukasreschke", 
                "url": "/lukasreschke", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/037/891/0ddfc05411893988a0d2794cd70d5dc221729713_medium.png?1438782834"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nextcloud", 
            "first_to_agree": true, 
            "message": "Sure.", 
            "markdown_message": "<p>Sure.</p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1025553, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-01-15T22:07:23.182Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-01-15T22:07:23.182Z", 
            "actor": {
                "username": "dremos", 
                "url": "/dremos", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/018/998/606de2fecef884ade592e54f45808e3c38e790f8_medium.jpg?1534160422"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nextcloud", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1421767, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-01-15T22:07:23.211Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-01-15T22:07:23.211Z", 
            "actor": {
                "username": "dremos", 
                "url": "/dremos", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/018/998/606de2fecef884ade592e54f45808e3c38e790f8_medium.jpg?1534160422"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nextcloud", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 1421768, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "reporter": {
        "username": "dremos", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/dremos", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/018/998/234d3c6c39f6ba3eae44293857fe462ad9dcf0eb_small.jpg?1534160422"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 57, 
        "name": "Violation of Secure Design Principles"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "disclosed_at": "2017-01-15T22:07:23.197Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/145604", 
    "created_at": "2016-06-18T01:50:10.608Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>Hi</p>\n\n<p>We can bypass Avatar Upload image verification and extension  uploading a php file or any other extension binding a valide  jpeg image  , there is no risk for the moment because the avatar is renamed to avatar_upload on the remote server , but it ll be nice to secure this part of code .</p>\n\n<h2 id=\"example\">Example  </h2>\n\n<p>here is the same file with two different extension : </p>\n\n<p><a title=\"http://91.121.108.101/image1.jpg\" href=\"/redirect?signature=0de967d07ca267ab83e16409dc5c99af5f5723f6&amp;url=http%3A%2F%2F91.121.108.101%2Fimage1.jpg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://91.121.108.101/image1.jpg</span><i class=\"icon-external-link\"></i></a><br>\n<a title=\"http://91.121.108.101/image1.php\" href=\"/redirect?signature=36ac0411416c86fec16b898500ae7fa8aba45494&amp;url=http%3A%2F%2F91.121.108.101%2Fimage1.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://91.121.108.101/image1.php</span><i class=\"icon-external-link\"></i></a>      &lt;== execute php code inside the image </p>\n\n<p>1) download image1.jpg</p>\n\n<p>2) as you can see  if you open the file image1.jpg  file on notepad it hide php code ( phpinfo(); function in this case .</p>\n\n<p>3) rename image1.jpg to image1.php  , and try to upload it on the avatar upload form , it pass the verification  .</p>\n\n<p>This verification is not enought in this  file :  /core/controller/avatarcontroller.php  </p>\n<pre class=\"highlight plaintext\"><code>if ($image-&gt;valid()) {\n            $mimeType = $image-&gt;mimeType();\n            if ($mimeType !== &#39;image/jpeg&#39; &amp;&amp; $mimeType !== &#39;image/png&#39;) {\n                return new DataResponse(\n                    [&#39;data&#39; =&gt; [&#39;message&#39; =&gt; $this-&gt;l-&gt;t(&#39;Unknown filetype&#39;)]],\n                    Http::STATUS_OK,\n                    $headers\n                );\n            }\n</code></pre>", 
    "vulnerability_information": "Hi\n\nWe can bypass Avatar Upload image verification and extension  uploading a php file or any other extension binding a valide  jpeg image  , there is no risk for the moment because the avatar is renamed to avatar_upload on the remote server , but it ll be nice to secure this part of code .\n\nExample  \n---------------\nhere is the same file with two different extension : \n\nhttp://91.121.108.101/image1.jpg\nhttp://91.121.108.101/image1.php      <== execute php code inside the image \n\n1) download image1.jpg\n\n2) as you can see  if you open the file image1.jpg  file on notepad it hide php code ( phpinfo(); function in this case .\n\n3) rename image1.jpg to image1.php  , and try to upload it on the avatar upload form , it pass the verification  .\n\nThis verification is not enought in this  file :  /core/controller/avatarcontroller.php  \n\n\n\tif ($image->valid()) {\n\t\t\t\t$mimeType = $image->mimeType();\n\t\t\t\tif ($mimeType !== 'image/jpeg' && $mimeType !== 'image/png') {\n\t\t\t\t\treturn new DataResponse(\n\t\t\t\t\t\t['data' => ['message' => $this->l->t('Unknown filetype')]],\n\t\t\t\t\t\tHttp::STATUS_OK,\n\t\t\t\t\t\t$headers\n\t\t\t\t\t);\n\t\t\t\t}\n\n\n", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://nextcloud.com", 
            "about": "Access, share and protect your files, calendars, contacts, communication & more at home and in your enterprise.", 
            "twitter_handle": "nextclouders", 
            "name": "Nextcloud"
        }, 
        "handle": "nextcloud", 
        "url": "https://hackerone.com/nextcloud", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/013/291/5d33b6e08fad356e1743fd899fe7d6dda9971209_small.png?1491410731", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/013/291/1d2ac8991616fcd3e3cdd567d02b7e70e20a3883_medium.png?1491410731"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 13291, 
        "default_currency": "usd"
    }, 
    "is_published": false
}