{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": true, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2017-10-19T10:14:57.622Z", 
    "voters": [
        "eveeez", 
        "geeknik", 
        "mr_r3boot", 
        "hisxo", 
        "spetr0x", 
        "hthomison1078"
    ], 
    "facebook_team?": false, 
    "has_bounty?": false, 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 126598, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2017-10-19T09:41:06.532Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "Overreads/overcopies in torsocks", 
    "is_member_of_team?": null, 
    "vote_count": 6, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2017-11-18T09:41:06.607Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2016-04-12T19:09:49.858Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-04-12T19:09:49.858Z", 
            "actor": {
                "username": "geko", 
                "url": "/geko", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "message": "Thanks, and sorry that it took me so long to get back to you. Yes, torsocks is alas out of scope of our bug bounty program. We might add it later but for now it is just core Tor and Tor Browser. That said I've informed the torsocks main developer and he confirms these issues. I am leaving this bug here until it is properly fixed. We might even add links to the bugs in our own bug tracker for reference. Thanks again for this report it is really appreciated.", 
            "markdown_message": "<p>Thanks, and sorry that it took me so long to get back to you. Yes, torsocks is alas out of scope of our bug bounty program. We might add it later but for now it is just core Tor and Tor Browser. That said I&#39;ve informed the torsocks main developer and he confirms these issues. I am leaving this bug here until it is properly fixed. We might even add links to the bugs in our own bug tracker for reference. Thanks again for this report it is really appreciated.</p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 901954, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-04-12T23:21:54.381Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-04-12T23:21:54.381Z", 
            "actor": {
                "username": "guido", 
                "url": "/guido", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/983/055f2e31c3b25e230eeb37461df974006ba7b0bd_medium.jpg?1403536399"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "message": "Thanks.\n\nAm I still the only one who has submitted a valid report to Tor? On the timeline ( https://hackerone.com/torproject ) I only see myself still, and that usually means I am the only valid reporter, but I was thinking that maybe you or HackerOne configured something so that I don't see the other reporters?\n\nGuido", 
            "markdown_message": "<p>Thanks.</p>\n\n<p>Am I still the only one who has submitted a valid report to Tor? On the timeline ( <a title=\"https://hackerone.com/torproject\" href=\"https://hackerone.com/torproject\">https://hackerone.com/torproject</a> ) I only see myself still, and that usually means I am the only valid reporter, but I was thinking that maybe you or HackerOne configured something so that I don&#39;t see the other reporters?</p>\n\n<p>Guido</p>\n", 
            "type": "Activities::Comment", 
            "id": 902554, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-06-04T09:40:25.563Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-04T09:40:25.563Z", 
            "actor": {
                "username": "guido", 
                "url": "/guido", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/983/055f2e31c3b25e230eeb37461df974006ba7b0bd_medium.jpg?1403536399"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "message": "Has there been any progress in the resolution of this bug? I can create and submit a patch if that will help speed up the process.\n\nGuido", 
            "markdown_message": "<p>Has there been any progress in the resolution of this bug? I can create and submit a patch if that will help speed up the process.</p>\n\n<p>Guido</p>\n", 
            "type": "Activities::Comment", 
            "id": 999565, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-06-06T11:53:58.465Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-06T11:53:58.465Z", 
            "actor": {
                "username": "asn", 
                "url": "/asn", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "message": "Hello Guido,\n\nDavid (the lead torsocks dev) told me that this bug is on his TODO list, but the list is quite deep.\n\nHe said that if you prepare a patch, that will greatly speed up progress here.  If you are up for this, feel free to attach the patch in this hackerone ticket here.\n\nThanks!", 
            "markdown_message": "<p>Hello Guido,</p>\n\n<p>David (the lead torsocks dev) told me that this bug is on his TODO list, but the list is quite deep.</p>\n\n<p>He said that if you prepare a patch, that will greatly speed up progress here.  If you are up for this, feel free to attach the patch in this hackerone ticket here.</p>\n\n<p>Thanks!</p>\n", 
            "type": "Activities::Comment", 
            "id": 1000909, 
            "genius_execution_id": null
        }, 
        {
            "attachments": [
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/098/446/855019145e6bd226734053a29e128e7c5e9c0747/0003-Ensure-length-of-hostname-doesn-t-exceed-255-bytes-i.patch?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSGAJTS7X%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T223118Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDNv1JJkb2JCBJezLRSK3A3HLsRbM1N2dJQCs3cdkO9DdSlu97QyvuTWjB9TDM0zF0K5xYiGpDCZFKPrax%2BsFz5KI1WenrJdfAQhjK2VjV8ng750HOo6R9QtyoSkXqJSITk3z0sX6u%2BaGuR53DR1SgrXgU4%2BZj3kzVsOKKtd61G%2BDZP2N3q%2FR9lSxtCBWOIkOltAHyGZcqelOD%2BNHIXr08GPe3urs8MfpCWN12Uc98ELvbzHllGEdfFgQzzzB%2Fh03QvsfmUHldJCz%2F09ZO2mOXeVGvvhGa6P439ow0kmfHorCf2l49cQlp550RAVCceslQNRsIpjs%2FscvNzwUdv1wSWwe0IojrRDLG4nQFwiQ1K3a1GlpxXYzTv176jcnZhJdyzHXn0aNVd3n2yu6QXF1RyrednAqH6GTeLsY%2BmFdJvs1E%2FSPzNOEj5naR190ChZbKYdPEncIwhYy7S7R055CIUnAzUObhGpKBIz%2FL7hX57SOAVB8Fp6J9NWYxxkcT1Ux5M8TRdPzjlD4gsEW3VAWt2ylLrHUu11rkw%2BhgkA7Cbe4vsOk6sYBm%2BDSV9vvQVz42kWGtRMos%2BFMKzKt4FX3akfBm1nwEgIo656m4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=d11269847dbfa1c5c2fdcbd813438aeea3ace306d98ee13f1402482247ab23cd", 
                    "type": "text/x-diff", 
                    "id": 98446, 
                    "filename": "0003-Ensure-length-of-hostname-doesn-t-exceed-255-bytes-i.patch"
                }, 
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/098/444/9f3c927d5a2cebd6e354918f5469d078407ec5c6/0001-Remove-overcopy-in-tsocks_gethostbyname.patch?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSGAJTS7X%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T223118Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDNv1JJkb2JCBJezLRSK3A3HLsRbM1N2dJQCs3cdkO9DdSlu97QyvuTWjB9TDM0zF0K5xYiGpDCZFKPrax%2BsFz5KI1WenrJdfAQhjK2VjV8ng750HOo6R9QtyoSkXqJSITk3z0sX6u%2BaGuR53DR1SgrXgU4%2BZj3kzVsOKKtd61G%2BDZP2N3q%2FR9lSxtCBWOIkOltAHyGZcqelOD%2BNHIXr08GPe3urs8MfpCWN12Uc98ELvbzHllGEdfFgQzzzB%2Fh03QvsfmUHldJCz%2F09ZO2mOXeVGvvhGa6P439ow0kmfHorCf2l49cQlp550RAVCceslQNRsIpjs%2FscvNzwUdv1wSWwe0IojrRDLG4nQFwiQ1K3a1GlpxXYzTv176jcnZhJdyzHXn0aNVd3n2yu6QXF1RyrednAqH6GTeLsY%2BmFdJvs1E%2FSPzNOEj5naR190ChZbKYdPEncIwhYy7S7R055CIUnAzUObhGpKBIz%2FL7hX57SOAVB8Fp6J9NWYxxkcT1Ux5M8TRdPzjlD4gsEW3VAWt2ylLrHUu11rkw%2BhgkA7Cbe4vsOk6sYBm%2BDSV9vvQVz42kWGtRMos%2BFMKzKt4FX3akfBm1nwEgIo656m4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5e4df2d58f00e5d4fa840c022a0cad810cd74e37f14ec43d1e1af447665fc84c", 
                    "type": "text/x-diff", 
                    "id": 98444, 
                    "filename": "0001-Remove-overcopy-in-tsocks_gethostbyname.patch"
                }, 
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/098/445/f40552e4a6a98ec5032bd9b634e8b089bc7d3be4/0002-Remove-potential-overcopy-in-tsocks_gethostbyaddr.patch?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSGAJTS7X%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T223118Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDNv1JJkb2JCBJezLRSK3A3HLsRbM1N2dJQCs3cdkO9DdSlu97QyvuTWjB9TDM0zF0K5xYiGpDCZFKPrax%2BsFz5KI1WenrJdfAQhjK2VjV8ng750HOo6R9QtyoSkXqJSITk3z0sX6u%2BaGuR53DR1SgrXgU4%2BZj3kzVsOKKtd61G%2BDZP2N3q%2FR9lSxtCBWOIkOltAHyGZcqelOD%2BNHIXr08GPe3urs8MfpCWN12Uc98ELvbzHllGEdfFgQzzzB%2Fh03QvsfmUHldJCz%2F09ZO2mOXeVGvvhGa6P439ow0kmfHorCf2l49cQlp550RAVCceslQNRsIpjs%2FscvNzwUdv1wSWwe0IojrRDLG4nQFwiQ1K3a1GlpxXYzTv176jcnZhJdyzHXn0aNVd3n2yu6QXF1RyrednAqH6GTeLsY%2BmFdJvs1E%2FSPzNOEj5naR190ChZbKYdPEncIwhYy7S7R055CIUnAzUObhGpKBIz%2FL7hX57SOAVB8Fp6J9NWYxxkcT1Ux5M8TRdPzjlD4gsEW3VAWt2ylLrHUu11rkw%2BhgkA7Cbe4vsOk6sYBm%2BDSV9vvQVz42kWGtRMos%2BFMKzKt4FX3akfBm1nwEgIo656m4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=90fc1d43c0266ad7f97f4261b30cc2baa6a6286720ea3ff50792b90f5295dfe4", 
                    "type": "text/x-diff", 
                    "id": 98445, 
                    "filename": "0002-Remove-potential-overcopy-in-tsocks_gethostbyaddr.patch"
                }
            ], 
            "automated_response": false, 
            "created_at": "2016-06-08T01:08:14.699Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-08T01:08:14.699Z", 
            "actor": {
                "username": "guido", 
                "url": "/guido", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/983/055f2e31c3b25e230eeb37461df974006ba7b0bd_medium.jpg?1403536399"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "message": "Here are patches for the issues brought up in this report.\n\nI recommend that David carefully reviews the patches before applying them, of course.\n\nDo you appreciate that I submit reports for out-of-scope Tor software via HackerOne or do you prefer I do so by some other means?\n\nGuido\n\n", 
            "markdown_message": "<p>Here are patches for the issues brought up in this report.</p>\n\n<p>I recommend that David carefully reviews the patches before applying them, of course.</p>\n\n<p>Do you appreciate that I submit reports for out-of-scope Tor software via HackerOne or do you prefer I do so by some other means?</p>\n\n<p>Guido</p>\n", 
            "type": "Activities::Comment", 
            "id": 1003998, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-06-09T13:46:38.322Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-09T13:46:38.322Z", 
            "actor": {
                "username": "asn", 
                "url": "/asn", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "message": "Hello guido,\n\nthanks for the patches. I notified David and he said he is going to check them out.\n\nI think submitting reports for out-of-scope Tor software can be done through hackerone if that is convenient for you. Otherwise, feel free to open tickets in trac.torproject.org and CC the right people (or CC me and I will triage the ticket as needed).\n\nThanks!", 
            "markdown_message": "<p>Hello guido,</p>\n\n<p>thanks for the patches. I notified David and he said he is going to check them out.</p>\n\n<p>I think submitting reports for out-of-scope Tor software can be done through hackerone if that is convenient for you. Otherwise, feel free to open tickets in trac.torproject.org and CC the right people (or CC me and I will triage the ticket as needed).</p>\n\n<p>Thanks!</p>\n", 
            "type": "Activities::Comment", 
            "id": 1006474, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-08-21T15:14:28.950Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-21T15:14:28.950Z", 
            "actor": {
                "username": "dgoulet", 
                "url": "/dgoulet", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/070/294/b4d9b00ea55cb1c6b4b851c0e94589c8d1ac33be_medium.jpeg?1471786640"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "message": "Hi guido,\n\nOk I finally fixed these issues. Epic delay but at least it will get in the next 2.2.0 stable.\n\nI've fixed both issues although second one, this `hostname[300] = '\\0';` can't happen because `buffer.len` is a `uint8_t` thus 256 is the maximum value so at most `hostname` can be of size `257` because of `hostname = zmalloc(buffer.len + 1);` making the memcpy go up to 256 bytes. I've changed that to a strncpy() here.\n\nNonetheless, I've fixed those issues. Huge thanks! See commit `23651bc` and `34b1f1c`. Please let me know if I fucked up :).", 
            "markdown_message": "<p>Hi guido,</p>\n\n<p>Ok I finally fixed these issues. Epic delay but at least it will get in the next 2.2.0 stable.</p>\n\n<p>I&#39;ve fixed both issues although second one, this <code>hostname[300] = &#39;\\0&#39;;</code> can&#39;t happen because <code>buffer.len</code> is a <code>uint8_t</code> thus 256 is the maximum value so at most <code>hostname</code> can be of size <code>257</code> because of <code>hostname = zmalloc(buffer.len + 1);</code> making the memcpy go up to 256 bytes. I&#39;ve changed that to a strncpy() here.</p>\n\n<p>Nonetheless, I&#39;ve fixed those issues. Huge thanks! See commit <code>23651bc</code> and <code>34b1f1c</code>. Please let me know if I fucked up :).</p>\n", 
            "type": "Activities::Comment", 
            "id": 1143226, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "guido", 
                "url": "/guido"
            }, 
            "created_at": "2016-08-21T15:14:37.686Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-21T15:14:37.686Z", 
            "actor": {
                "username": "dgoulet", 
                "url": "/dgoulet", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/070/294/b4d9b00ea55cb1c6b4b851c0e94589c8d1ac33be_medium.jpeg?1471786640"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugResolved", 
            "id": 1143227, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-04-11T10:09:30.727Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-04-11T10:09:30.727Z", 
            "actor": {
                "url": "/torproject", 
                "profile": {
                    "name": "Tor"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/800/f60c4e0509668a31fcd9604fc653ef8a43f2e5c4_medium.jpg?1453239375"
                }
            }, 
            "team_handle": "torproject", 
            "message": "Thanks for the bug report Guido! \n\nSeems like we forgot this one open. I'm closing it for good :)", 
            "markdown_message": "<p>Thanks for the bug report Guido! </p>\n\n<p>Seems like we forgot this one open. I&#39;m closing it for good :)</p>\n", 
            "type": "Activities::CommentsClosed", 
            "id": 1604388, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-04-11T10:09:52.635Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-04-11T10:09:52.635Z", 
            "actor": {
                "url": "/torproject", 
                "profile": {
                    "name": "Tor"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/800/f60c4e0509668a31fcd9604fc653ef8a43f2e5c4_medium.jpg?1453239375"
                }
            }, 
            "team_handle": "torproject", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::NotEligibleForBounty", 
            "id": 1604389, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-19T09:41:06.567Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-19T09:41:06.567Z", 
            "actor": {
                "username": "geko", 
                "url": "/geko", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 2083679, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-19T10:14:57.644Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-19T10:14:57.644Z", 
            "actor": {
                "username": "guido", 
                "url": "/guido", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/983/055f2e31c3b25e230eeb37461df974006ba7b0bd_medium.jpg?1403536399"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 2083730, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-19T10:14:57.705Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-19T10:14:57.705Z", 
            "actor": {
                "username": "guido", 
                "url": "/guido", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/983/055f2e31c3b25e230eeb37461df974006ba7b0bd_medium.jpg?1403536399"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 2083731, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "guido", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/guido", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/002/983/bc1fffcbbb736a8fa94816a1961b7b76725881eb_small.jpg?1403536399"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 2, 
        "name": "Memory Corruption - Generic"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -33137411.991113555, 
    "disclosed_at": "2017-10-19T10:14:57.678Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/126598", 
    "created_at": "2016-03-28T22:31:30.976Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>First off, I know torsocks isn&#39;t in scope, so I don&#39;t expect anything in return for this. I happened to stumble upon this so why not report it. However if you feel generous you&#39;re welcome to give me bounty/swag ofcourse :P.</p>\n\n<p>Here 16 bytes instead of 4 are copied, thereby copying 12 bytes of non-relevant stack memory.</p>\n<pre class=\"highlight c\"><code> <span class=\"mi\">62</span> <span class=\"n\">LIBC_GETHOSTBYNAME_RET_TYPE</span> <span class=\"n\">tsocks_gethostbyname</span><span class=\"p\">(</span><span class=\"n\">LIBC_GETHOSTBYNAME_SIG</span><span class=\"p\">)</span>\n <span class=\"mi\">63</span> <span class=\"p\">{</span>\n <span class=\"mi\">64</span>     <span class=\"kt\">int</span> <span class=\"n\">ret</span><span class=\"p\">;</span>\n <span class=\"mi\">65</span>     <span class=\"kt\">uint32_t</span> <span class=\"n\">ip</span><span class=\"p\">;</span>\n <span class=\"p\">...</span>\n <span class=\"mi\">86</span>     <span class=\"n\">memcpy</span><span class=\"p\">(</span><span class=\"n\">tsocks_he_addr</span><span class=\"p\">,</span> <span class=\"o\">&amp;</span><span class=\"n\">ip</span><span class=\"p\">,</span> <span class=\"k\">sizeof</span><span class=\"p\">(</span><span class=\"n\">tsocks_he_addr</span><span class=\"p\">));</span>\n</code></pre>\n<p>Here 255 bytes (<code>sizeof(tsocks_he_name)</code>) are copied even if the resolved hostname is much smaller (say 20 bytes). Thus a overread/overcopy of hundreds of bytes occurs.</p>\n<pre class=\"highlight c\"><code><span class=\"mi\">151</span> <span class=\"n\">LIBC_GETHOSTBYADDR_RET_TYPE</span> <span class=\"n\">tsocks_gethostbyaddr</span><span class=\"p\">(</span><span class=\"n\">LIBC_GETHOSTBYADDR_SIG</span><span class=\"p\">)</span>\n<span class=\"mi\">152</span> <span class=\"p\">{</span>\n<span class=\"mi\">153</span>     <span class=\"kt\">int</span> <span class=\"n\">ret</span><span class=\"p\">;</span>\n<span class=\"mi\">154</span>     <span class=\"kt\">char</span> <span class=\"o\">*</span><span class=\"n\">hostname</span><span class=\"p\">;</span>\n<span class=\"p\">...</span>\n<span class=\"mi\">173</span>     <span class=\"n\">ret</span> <span class=\"o\">=</span> <span class=\"n\">tsocks_tor_resolve_ptr</span><span class=\"p\">(</span><span class=\"n\">addr</span><span class=\"p\">,</span> <span class=\"o\">&amp;</span><span class=\"n\">hostname</span><span class=\"p\">,</span> <span class=\"n\">type</span><span class=\"p\">);</span>\n<span class=\"p\">...</span>\n<span class=\"mi\">184</span>         <span class=\"n\">memcpy</span><span class=\"p\">(</span><span class=\"n\">tsocks_he_name</span><span class=\"p\">,</span> <span class=\"n\">hostname</span><span class=\"p\">,</span> <span class=\"k\">sizeof</span><span class=\"p\">(</span><span class=\"n\">tsocks_he_name</span><span class=\"p\">));</span>\n</code></pre>\n<p><code>hostname</code> is set via this path:</p>\n\n<p><code>tsocks_gethostbyaddr</code> calls <code>tsocks_tor_resolve_ptr</code><br>\n<code>tsocks_tor_resolve_ptr</code> calls <code>socks5_recv_resolve_ptr_reply</code></p>\n\n<p>in (<code>lib/torsocks.c</code>)</p>\n<pre class=\"highlight c\"><code><span class=\"mi\">641</span>     <span class=\"cm\">/* Force IPv4 resolution for now. */</span>\n<span class=\"mi\">642</span>     <span class=\"n\">ret</span> <span class=\"o\">=</span> <span class=\"n\">socks5_recv_resolve_ptr_reply</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"n\">conn</span><span class=\"p\">,</span> <span class=\"n\">ip</span><span class=\"p\">);</span>\n<span class=\"mi\">643</span>     <span class=\"nf\">if</span> <span class=\"p\">(</span><span class=\"n\">ret</span> <span class=\"o\">&lt;</span> <span class=\"mi\">0</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n<span class=\"mi\">644</span>         <span class=\"k\">goto</span> <span class=\"n\">end_close</span><span class=\"p\">;</span>\n<span class=\"mi\">645</span>     <span class=\"p\">}</span>\n</code></pre>\n<p>(<code>socks5_recv_resolve_ptr_reply</code>, in <code>common/socks5.c</code>)</p>\n<pre class=\"highlight c\"><code><span class=\"mi\">784</span> <span class=\"n\">ATTR_HIDDEN</span>                                                          \n<span class=\"mi\">785</span> <span class=\"kt\">int</span> <span class=\"n\">socks5_recv_resolve_ptr_reply</span><span class=\"p\">(</span><span class=\"k\">struct</span> <span class=\"n\">connection</span> <span class=\"o\">*</span><span class=\"n\">conn</span><span class=\"p\">,</span> <span class=\"kt\">char</span> <span class=\"o\">**</span><span class=\"n\">_hostname</span><span class=\"p\">)</span>                                                                   \n<span class=\"mi\">786</span> <span class=\"p\">{</span>\n<span class=\"mi\">787</span>     <span class=\"kt\">int</span> <span class=\"n\">ret</span><span class=\"p\">;</span>\n<span class=\"mi\">788</span>     <span class=\"kt\">ssize_t</span> <span class=\"n\">ret_recv</span><span class=\"p\">;</span>\n<span class=\"mi\">789</span>     <span class=\"kt\">char</span> <span class=\"o\">*</span><span class=\"n\">hostname</span> <span class=\"o\">=</span> <span class=\"nb\">NULL</span><span class=\"p\">;</span>\n<span class=\"p\">...</span>\n<span class=\"mi\">799</span>     <span class=\"n\">ret_recv</span> <span class=\"o\">=</span> <span class=\"n\">recv_data</span><span class=\"p\">(</span><span class=\"n\">conn</span><span class=\"o\">-&gt;</span><span class=\"n\">fd</span><span class=\"p\">,</span> <span class=\"o\">&amp;</span><span class=\"n\">buffer</span><span class=\"p\">,</span> <span class=\"k\">sizeof</span><span class=\"p\">(</span><span class=\"n\">buffer</span><span class=\"p\">));</span>\n<span class=\"p\">...</span>\n<span class=\"mi\">817</span>     <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">buffer</span><span class=\"p\">.</span><span class=\"n\">msg</span><span class=\"p\">.</span><span class=\"n\">atyp</span> <span class=\"o\">==</span> <span class=\"n\">SOCKS5_ATYP_DOMAIN</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n<span class=\"mi\">818</span>         <span class=\"cm\">/* Allocate hostname len plus an extra for the null byte. */</span>\n<span class=\"mi\">819</span>         <span class=\"n\">hostname</span> <span class=\"o\">=</span> <span class=\"n\">zmalloc</span><span class=\"p\">(</span><span class=\"n\">buffer</span><span class=\"p\">.</span><span class=\"n\">len</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">);</span>\n<span class=\"mi\">820</span>         <span class=\"nf\">if</span> <span class=\"p\">(</span><span class=\"o\">!</span><span class=\"n\">hostname</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n<span class=\"mi\">821</span>             <span class=\"n\">ret</span> <span class=\"o\">=</span> <span class=\"o\">-</span><span class=\"n\">ENOMEM</span><span class=\"p\">;</span>\n<span class=\"mi\">822</span>             <span class=\"k\">goto</span> <span class=\"n\">error</span><span class=\"p\">;</span>\n<span class=\"mi\">823</span>         <span class=\"p\">}</span>\n<span class=\"mi\">824</span>         <span class=\"n\">ret_recv</span> <span class=\"o\">=</span> <span class=\"n\">recv_data</span><span class=\"p\">(</span><span class=\"n\">conn</span><span class=\"o\">-&gt;</span><span class=\"n\">fd</span><span class=\"p\">,</span> <span class=\"n\">hostname</span><span class=\"p\">,</span> <span class=\"n\">buffer</span><span class=\"p\">.</span><span class=\"n\">len</span><span class=\"p\">);</span>\n<span class=\"mi\">825</span>         <span class=\"nf\">if</span> <span class=\"p\">(</span><span class=\"n\">ret_recv</span> <span class=\"o\">&lt;</span> <span class=\"mi\">0</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n<span class=\"mi\">826</span>             <span class=\"n\">ret</span> <span class=\"o\">=</span> <span class=\"n\">ret_recv</span><span class=\"p\">;</span>\n<span class=\"mi\">827</span>             <span class=\"k\">goto</span> <span class=\"n\">error</span><span class=\"p\">;</span>\n<span class=\"mi\">828</span>         <span class=\"p\">}</span>\n<span class=\"mi\">829</span>         <span class=\"n\">hostname</span><span class=\"p\">[</span><span class=\"n\">buffer</span><span class=\"p\">.</span><span class=\"n\">len</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"sc\">&#39;\\0&#39;</span><span class=\"p\">;</span>\n<span class=\"mi\">830</span>     <span class=\"p\">}</span> <span class=\"k\">else</span> <span class=\"p\">{</span>\n</code></pre>\n<p>Also, if recv_data() puts over 255 bytes in &#39;buffer&#39;, say 300 bytes, then line 829 becomes:</p>\n<pre class=\"highlight c\"><code><span class=\"mi\">829</span>         <span class=\"n\">hostname</span><span class=\"p\">[</span><span class=\"mi\">300</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"sc\">&#39;\\0&#39;</span><span class=\"p\">;</span>\n</code></pre>\n<p>and consequently <code>tsocks_gethostbyaddr</code> puts a string of 300 bytes in h_addr_list:</p>\n<pre class=\"highlight c\"><code><span class=\"mi\">184</span>         <span class=\"n\">memcpy</span><span class=\"p\">(</span><span class=\"n\">tsocks_he_name</span><span class=\"p\">,</span> <span class=\"n\">hostname</span><span class=\"p\">,</span> <span class=\"k\">sizeof</span><span class=\"p\">(</span><span class=\"n\">tsocks_he_name</span><span class=\"p\">));</span>\n<span class=\"mi\">185</span>         <span class=\"n\">free</span><span class=\"p\">(</span><span class=\"n\">hostname</span><span class=\"p\">);</span>\n<span class=\"mi\">186</span>         <span class=\"n\">tsocks_he_addr_list</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"kt\">char</span> <span class=\"o\">*</span><span class=\"p\">)</span> <span class=\"n\">addr</span><span class=\"p\">;</span>\n<span class=\"mi\">187</span>     <span class=\"p\">}</span>\n<span class=\"mi\">188</span> \n<span class=\"mi\">189</span>     <span class=\"n\">tsocks_he</span><span class=\"p\">.</span><span class=\"n\">h_name</span> <span class=\"o\">=</span> <span class=\"n\">tsocks_he_name</span><span class=\"p\">;</span>\n<span class=\"mi\">190</span>     <span class=\"n\">tsocks_he</span><span class=\"p\">.</span><span class=\"n\">h_aliases</span> <span class=\"o\">=</span> <span class=\"nb\">NULL</span><span class=\"p\">;</span>                                                                                                                \n<span class=\"mi\">191</span>     <span class=\"n\">tsocks_he</span><span class=\"p\">.</span><span class=\"n\">h_length</span> <span class=\"o\">=</span> <span class=\"n\">strlen</span><span class=\"p\">(</span><span class=\"n\">tsocks_he_name</span><span class=\"p\">);</span>\n<span class=\"mi\">192</span>     <span class=\"n\">tsocks_he</span><span class=\"p\">.</span><span class=\"n\">h_addrtype</span> <span class=\"o\">=</span> <span class=\"n\">type</span><span class=\"p\">;</span>\n<span class=\"mi\">193</span>     <span class=\"n\">tsocks_he</span><span class=\"p\">.</span><span class=\"n\">h_addr_list</span> <span class=\"o\">=</span> <span class=\"n\">tsocks_he_addr_list</span><span class=\"p\">;</span>\n</code></pre>\n<p>If the application using this library things that it is guaranteed that the strings in h_addr_list are never more than 255 bytes, an overflow in the &quot;parent&quot; application might occur. But honestly I haven&#39;t tested whether any of this could actually occur.</p>\n\n<p>Although I think there isn&#39;t a <em>direct</em> security risk in the overreads/overcopies, it could lead to crashes, and moreover, their existence makes it easier to secretly implement backdoors in applications that use torsocks as a wrapper (they could introduce code that looks like a regular programming error but in fact exploit the fact that torsocks writes non-relevant heap/stack memory in order to aid an attacker with ASLR circumvention, for example), if you get my drift.</p>\n\n<p>Guido</p>\n", 
    "vulnerability_information": "First off, I know torsocks isn't in scope, so I don't expect anything in return for this. I happened to stumble upon this so why not report it. However if you feel generous you're welcome to give me bounty/swag ofcourse :P.\n\nHere 16 bytes instead of 4 are copied, thereby copying 12 bytes of non-relevant stack memory.\n\n```c\n 62 LIBC_GETHOSTBYNAME_RET_TYPE tsocks_gethostbyname(LIBC_GETHOSTBYNAME_SIG)\n 63 {\n 64     int ret;\n 65     uint32_t ip;\n ...\n 86     memcpy(tsocks_he_addr, &ip, sizeof(tsocks_he_addr));\n```\n\nHere 255 bytes (```sizeof(tsocks_he_name)```) are copied even if the resolved hostname is much smaller (say 20 bytes). Thus a overread/overcopy of hundreds of bytes occurs.\n\n```c\n151 LIBC_GETHOSTBYADDR_RET_TYPE tsocks_gethostbyaddr(LIBC_GETHOSTBYADDR_SIG)\n152 {\n153     int ret;\n154     char *hostname;\n...\n173     ret = tsocks_tor_resolve_ptr(addr, &hostname, type);\n...\n184         memcpy(tsocks_he_name, hostname, sizeof(tsocks_he_name));\n```\n\n```hostname``` is set via this path:\n\n```tsocks_gethostbyaddr``` calls ```tsocks_tor_resolve_ptr```\n```tsocks_tor_resolve_ptr``` calls ```socks5_recv_resolve_ptr_reply```\n\nin (```lib/torsocks.c```)\n```c\n641     /* Force IPv4 resolution for now. */\n642     ret = socks5_recv_resolve_ptr_reply(&conn, ip);\n643     if (ret < 0) {\n644         goto end_close;\n645     }\n```\n\n(```socks5_recv_resolve_ptr_reply```, in ```common/socks5.c```)\n```c\n784 ATTR_HIDDEN                                                          \n785 int socks5_recv_resolve_ptr_reply(struct connection *conn, char **_hostname)                                                                   \n786 {\n787     int ret;\n788     ssize_t ret_recv;\n789     char *hostname = NULL;\n...\n799     ret_recv = recv_data(conn->fd, &buffer, sizeof(buffer));\n...\n817     if (buffer.msg.atyp == SOCKS5_ATYP_DOMAIN) {\n818         /* Allocate hostname len plus an extra for the null byte. */\n819         hostname = zmalloc(buffer.len + 1);\n820         if (!hostname) {\n821             ret = -ENOMEM;\n822             goto error;\n823         }\n824         ret_recv = recv_data(conn->fd, hostname, buffer.len);\n825         if (ret_recv < 0) {\n826             ret = ret_recv;\n827             goto error;\n828         }\n829         hostname[buffer.len] = '\\0';\n830     } else {\n```\n\nAlso, if recv_data() puts over 255 bytes in 'buffer', say 300 bytes, then line 829 becomes:\n\n```c\n829         hostname[300] = '\\0';\n```\n\nand consequently ```tsocks_gethostbyaddr``` puts a string of 300 bytes in h_addr_list:\n\n```c\n184         memcpy(tsocks_he_name, hostname, sizeof(tsocks_he_name));\n185         free(hostname);\n186         tsocks_he_addr_list[0] = (char *) addr;\n187     }\n188 \n189     tsocks_he.h_name = tsocks_he_name;\n190     tsocks_he.h_aliases = NULL;                                                                                                                \n191     tsocks_he.h_length = strlen(tsocks_he_name);\n192     tsocks_he.h_addrtype = type;\n193     tsocks_he.h_addr_list = tsocks_he_addr_list;\n```\n\nIf the application using this library things that it is guaranteed that the strings in h_addr_list are never more than 255 bytes, an overflow in the \"parent\" application might occur. But honestly I haven't tested whether any of this could actually occur.\n\nAlthough I think there isn't a *direct* security risk in the overreads/overcopies, it could lead to crashes, and moreover, their existence makes it easier to secretly implement backdoors in applications that use torsocks as a wrapper (they could introduce code that looks like a regular programming error but in fact exploit the fact that torsocks writes non-relevant heap/stack memory in order to aid an attacker with ASLR circumvention, for example), if you get my drift.\n\nGuido\n", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://www.torproject.org/", 
            "about": "Anonymity Online", 
            "twitter_handle": "torproject", 
            "name": "Tor"
        }, 
        "handle": "torproject", 
        "url": "https://hackerone.com/torproject", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/001/800/fe36670e5f7b7381549279801c447ae8a3ee12b0_small.jpg?1453239375", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/001/800/f60c4e0509668a31fcd9604fc653ef8a43f2e5c4_medium.jpg?1453239375"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 1800, 
        "default_currency": "usd"
    }, 
    "is_published": false
}