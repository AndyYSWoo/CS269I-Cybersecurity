{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2018-05-04T02:23:44.749Z", 
    "voters": [
        "eveeez", 
        "whitesector", 
        "c37hun", 
        "japz", 
        "testinghacker0x01"
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "150.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 341925, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2018-05-22T15:10:08.163Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "invalid handling of redirect_uri at o2.mail.ru/jsapi/button", 
    "is_member_of_team?": null, 
    "vote_count": 5, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_view?": true, 
            "can_edit?": false, 
            "id": 7596, 
            "content": "It was possible to embed login button on site that is not whitelisted for a specific app the button was created for. Problem was caused because button had *.mail.ru as whitelisted domain, playing around this I found out that \"example.com/?a=.mail.ru\" was actually valid value for parameter and button getting successfully embeded resulting in postMessage steal / login to external app on attacker's website, revealing some user information.", 
            "content_html": "<p>It was possible to embed login button on site that is not whitelisted for a specific app the button was created for. Problem was caused because button had *.mail.ru as whitelisted domain, playing around this I found out that &quot;example.com/?a=.mail.ru&quot; was actually valid value for parameter and button getting successfully embeded resulting in postMessage steal / login to external app on attacker&#39;s website, revealing some user information.</p>\n"
        }
    ], 
    "structured_scope": {
        "asset_identifier": "o2.mail.ru", 
        "max_severity": "critical", 
        "databaseId": 255, 
        "asset_type": "URL"
    }, 
    "allow_singular_disclosure_at": "2018-06-03T02:23:44.847Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$150", 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2018-04-23T11:05:08.375Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-04-23T11:05:08.375Z", 
            "actor": {
                "username": "3apa3a", 
                "url": "/3apa3a", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/004/836/cdfc44e3113144e4f71fc0a61c9c9195e2f0ccbf_medium.jpg?1397167861"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mailru", 
            "message": "Thank you for reporting your bug to Mail.Ru Group!   We appreciate your time for helping us to make our web services safer.\nWe are currently reviewing your submission and will be back in touch soon.", 
            "markdown_message": "<p>Thank you for reporting your bug to Mail.Ru Group!   We appreciate your time for helping us to make our web services safer.<br>\nWe are currently reviewing your submission and will be back in touch soon.</p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 2653061, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2018-04-25T15:19:25.459Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-04-25T15:19:25.459Z", 
            "actor": {
                "url": "/mailru", 
                "profile": {
                    "name": "Mail.ru"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/065/07da688e1d8801d35fdb85376bd9d64e424e6dab_medium.png?1542897520"
                }
            }, 
            "team_handle": "mailru", 
            "bonus_amount": "0.0", 
            "bounty_amount": "150.0", 
            "collaborator": {
                "username": "ruvlol", 
                "url": "/ruvlol"
            }, 
            "message": "\u041f\u0440\u0438\u0432\u0435\u0442, \u0432\u043e\u0437\u043d\u0430\u0433\u0440\u0430\u0436\u0434\u0435\u043d\u0438\u0435 \u0437\u0430 \u043d\u0430\u0439\u0434\u0435\u043d\u043d\u0443\u044e \u0443\u044f\u0437\u0432\u0438\u043c\u043e\u0441\u0442\u044c \u043d\u0430\u0447\u0438\u0441\u043b\u0435\u043d\u043e \u043d\u0430 \u0442\u0432\u043e\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442. \u041d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435 https://hackerone.com/settings/bounties \u043c\u043e\u0436\u043d\u043e \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u0436\u0435\u043b\u0430\u0435\u043c\u044b\u0439 \u043c\u0435\u0442\u043e\u0434 \u0432\u044b\u043f\u043b\u0430\u0442\u044b. \n\n\u0421\u043f\u0430\u0441\u0438\u0431\u043e \u0438 \u0436\u0434\u0435\u043c \u043e\u0442 \u0442\u0435\u0431\u044f \u043d\u043e\u0432\u044b\u0445 \u0431\u0430\u0433\u0440\u0435\u043f\u043e\u0440\u0442\u043e\u0432!\n\nP.S. \u0440\u0430\u0431\u043e\u0442\u0430 \u043f\u043e \u0443\u0441\u0442\u0440\u0430\u043d\u0435\u043d\u0438\u044e \u0443\u044f\u0437\u0432\u0438\u043c\u043e\u0441\u0442\u0438 \u043f\u043e\u043a\u0430 \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0430\u0435\u0442\u0441\u044f.", 
            "markdown_message": "<p>\u041f\u0440\u0438\u0432\u0435\u0442, \u0432\u043e\u0437\u043d\u0430\u0433\u0440\u0430\u0436\u0434\u0435\u043d\u0438\u0435 \u0437\u0430 \u043d\u0430\u0439\u0434\u0435\u043d\u043d\u0443\u044e \u0443\u044f\u0437\u0432\u0438\u043c\u043e\u0441\u0442\u044c \u043d\u0430\u0447\u0438\u0441\u043b\u0435\u043d\u043e \u043d\u0430 \u0442\u0432\u043e\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442. \u041d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435 <a title=\"https://hackerone.com/settings/bounties\" href=\"https://hackerone.com/settings/bounties\">https://hackerone.com/settings/bounties</a> \u043c\u043e\u0436\u043d\u043e \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u0436\u0435\u043b\u0430\u0435\u043c\u044b\u0439 \u043c\u0435\u0442\u043e\u0434 \u0432\u044b\u043f\u043b\u0430\u0442\u044b. </p>\n\n<p>\u0421\u043f\u0430\u0441\u0438\u0431\u043e \u0438 \u0436\u0434\u0435\u043c \u043e\u0442 \u0442\u0435\u0431\u044f \u043d\u043e\u0432\u044b\u0445 \u0431\u0430\u0433\u0440\u0435\u043f\u043e\u0440\u0442\u043e\u0432!</p>\n\n<p>P.S. \u0440\u0430\u0431\u043e\u0442\u0430 \u043f\u043e \u0443\u0441\u0442\u0440\u0430\u043d\u0435\u043d\u0438\u044e \u0443\u044f\u0437\u0432\u0438\u043c\u043e\u0441\u0442\u0438 \u043f\u043e\u043a\u0430 \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0430\u0435\u0442\u0441\u044f.</p>\n", 
            "type": "Activities::BountyAwarded", 
            "id": 2664388, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "ruvlol", 
                "url": "/ruvlol"
            }, 
            "created_at": "2018-04-27T11:55:40.194Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-04-27T11:55:40.194Z", 
            "actor": {
                "username": "yngwie", 
                "url": "/yngwie", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/012/185/ad5308359bf6a481fe9e4914745578cf991c5c2f_medium.jpg?1450100092"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mailru", 
            "message": "This bug has been fixed! \nPlease confirm that you are no longer able to reproduce the issue. ", 
            "markdown_message": "<p>This bug has been fixed! <br>\nPlease confirm that you are no longer able to reproduce the issue. </p>\n", 
            "type": "Activities::BugResolved", 
            "id": 2672300, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-04-27T12:19:56.735Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-04-27T12:19:56.735Z", 
            "actor": {
                "username": "ruvlol", 
                "url": "/ruvlol", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/191/587/a328cc1e5d3ed2a7bd030603a33f37742aa1930d_medium.svg?1540469087"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mailru", 
            "message": "Fixed.", 
            "markdown_message": "<p>Fixed.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2672343, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-05-04T02:23:44.791Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-05-04T02:23:44.791Z", 
            "actor": {
                "username": "ruvlol", 
                "url": "/ruvlol", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/191/587/a328cc1e5d3ed2a7bd030603a33f37742aa1930d_medium.svg?1540469087"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mailru", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 2698346, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-05-22T15:10:08.198Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-05-22T15:10:08.198Z", 
            "actor": {
                "username": "kpebetka", 
                "url": "/kpebetka", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/152/0a6573cf90b97f189279a1ca1ce5acc17385ded2_medium.jpg?1518727729"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mailru", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 2779265, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-05-22T15:10:08.326Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-05-22T15:10:08.326Z", 
            "actor": {
                "username": "kpebetka", 
                "url": "/kpebetka", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/152/0a6573cf90b97f189279a1ca1ce5acc17385ded2_medium.jpg?1518727729"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mailru", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 2779266, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "ruvlol", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/ruvlol", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/191/587/e5a5f33dd580d01a0f3471777a942fe1b42c3f20_small.svg?1540469087"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 26, 
        "name": "Improper Access Control - Generic"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -16142402.043356854, 
    "disclosed_at": "2018-05-22T15:10:08.293Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/341925", 
    "created_at": "2018-04-23T06:59:52.847Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>o2.mail.ru/jsapi/button gets embedded as login window in website that using o2 oauth. parameter redirect_uri by default may have either value of white listed domain from particular app by clientId either it may lead to *.mail.ru, then it contacts with parent window via postmessages. Other domains as value of redirect_uri resulting 403. The way /jsapi/button counts *.mail.ru as a whitelisted domain for redirect_uri is dangerous because it may be used bypass 403 to other domains like in this example:</p>\n\n<p>redirect_uri=evil.com?a=.mail.ru , then button will send postmessages to evil.com with <strong>any client Id</strong></p>\n\n<h2 id=\"domain-site-application\">Domain, site, application</h2>\n\n<p>o2.mail.ru/jsapi/button</p>\n\n<h2 id=\"steps-to-reproduce\">Steps to reproduce</h2>\n\n<ol>\n<li>&lt;iframe src=&quot;https://o2.mail.ru/jsapi/button?client_id=de6cefc49cbc44eea5a5a65e8de15b88&amp;redirect_uri=https://notmail.com?a=.mail.ru&amp;ui=login_as%20userpic&quot;&gt; </li>\n<li>replace client_id for id of your application</li>\n</ol>\n\n<h2 id=\"actual-results\">Actual results</h2>\n\n<p>PostMessages will be sent to attacker controlled domain. Currently there is only info may be stolen about is victim logged in for specific client id or not, but if you will extend button possibilities in future this may cause a risk for oauth implementation.</p>\n\n<h2 id=\"expected-results-security-impact-description-and-recommendations\">Expected results, security impact description and recommendations</h2>\n\n<p>validate subdomain part for &quot;?&quot; &quot;#&quot; &quot;@&quot; and other url confusing symbols when redirect uri is pointing to mail.ru subdomain</p>\n\n<h2 id=\"poc-exploit-code-screenshots-video-references-additional-resources\">PoC, exploit code, screenshots, video, references, additional resources</h2>\n\n<p>&lt;iframe src=&quot;https://o2.mail.ru/jsapi/button?client_id=de6cefc49cbc44eea5a5a65e8de15b88&amp;redirect_uri=https://notmail.com?a=.mail.ru&amp;ui=login_as%20userpic&quot;&gt;</p>\n\n<h2 id=\"impact\">Impact</h2>\n\n<p>bypass redirect_uri whitelist of /jsapi/button</p>\n", 
    "vulnerability_information": "o2.mail.ru/jsapi/button gets embedded as login window in website that using o2 oauth. parameter redirect_uri by default may have either value of white listed domain from particular app by clientId either it may lead to *.mail.ru, then it contacts with parent window via postmessages. Other domains as value of redirect_uri resulting 403. The way /jsapi/button counts *.mail.ru as a whitelisted domain for redirect_uri is dangerous because it may be used bypass 403 to other domains like in this example:\n\nredirect_uri=evil.com?a=.mail.ru , then button will send postmessages to evil.com with **any client Id**\n\nDomain, site, application\n--\no2.mail.ru/jsapi/button\n\nSteps to reproduce\n--\n1. <iframe src=\"https://o2.mail.ru/jsapi/button?client_id=de6cefc49cbc44eea5a5a65e8de15b88&redirect_uri=https://notmail.com?a=.mail.ru&ui=login_as%20userpic\"> \n2. replace client_id for id of your application\n\nActual results\n--\nPostMessages will be sent to attacker controlled domain. Currently there is only info may be stolen about is victim logged in for specific client id or not, but if you will extend button possibilities in future this may cause a risk for oauth implementation.\n\nExpected results, security impact description and recommendations\n--\nvalidate subdomain part for \"?\" \"#\" \"@\" and other url confusing symbols when redirect uri is pointing to mail.ru subdomain\n\nPoC, exploit code, screenshots, video, references, additional resources\n--\n<iframe src=\"https://o2.mail.ru/jsapi/button?client_id=de6cefc49cbc44eea5a5a65e8de15b88&redirect_uri=https://notmail.com?a=.mail.ru&ui=login_as%20userpic\">\n\n## Impact\n\nbypass redirect_uri whitelist of /jsapi/button", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://corp.mail.ru", 
            "about": "Leading Internet company in Europe", 
            "twitter_handle": "mailru", 
            "name": "Mail.ru"
        }, 
        "handle": "mailru", 
        "url": "https://hackerone.com/mailru", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/065/b5353ff7c53e16da116c7f4e73cc5687ec7d8809_small.png?1542897520", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/065/07da688e1d8801d35fdb85376bd9d64e424e6dab_medium.png?1542897520"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 65, 
        "default_currency": "usd"
    }, 
    "is_published": false
}