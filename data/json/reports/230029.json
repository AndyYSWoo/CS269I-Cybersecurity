{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2017-06-27T22:40:25.224Z", 
    "voters": [
        "sp1d3rs", 
        "skansing", 
        "eveeez", 
        "gamliel", 
        "axolotl", 
        "kiraak-boy", 
        "ronygigi", 
        "khaledibnalwalid", 
        "smit"
    ], 
    "facebook_team?": false, 
    "has_bounty?": false, 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 230029, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": null, 
    "vulnerability_information": "## Intro\n\nFirst things first, so... Crayons, crayons everywhere :)\n\n\n__Type of issue__: Core CMS issue\n__Level of severity__: Internal Attack Vector \n__Concrete5 version__: 8.1.0\n\n## Summary\n\nThere is Stored XSS vulnerability in __Name__ field (SEO dialog) for pages. Malicious user is able to prepare payload which is then executed in SEO dialog and on Page Search (index.php/dashboard/sitemap/search).\n\n## Steps to reproduce\n\n- login into Concrete5 instance\n- go to Dashboard -> Full Sitemap\n- on Pages list, select one and click. Popup with options will show up\n\n{F186242}\n\n- select __SEO__ option. SEO dialog will show up on the screen\n\n{F186244}\n\n- in ```Name``` field, put following payload, right after Page name:\n\n```\n\" onmouseover=\"alert('Stored XSS in SEO Name field')\"\n```\n\n- click ```Save changes```\n\nNow, there are two places, where injected payload is retrieved from database and executed:\n\n- SEO dialog box, when user mouse-over ```Name``` field\n- Page Search, when user mouse-over infected Page name:\n\n{F186245}\n\n{F186246}\n\nIn first execution (SEO dialog), it is possible to inject payload which will execute __without any user interaction__:\n\n```\n\" onfocus=\"alert('Stored XSS in SEO Name field')\"  autofocus=\"true\"\n```\n\n(__Warning__: injecting this payload will cause XSS execution every time when SEO dialog for infected page will appear on screen. It blocks any possibility to edit ```Name``` and reverts changes)\n\n\n## Technical details\n\nThis vulnerability exists, because there is not enough sanitization of ```cName``` property read from request ```$_POST```,and then use in ```update()``` method in ```Page``` class (concrete5-8.1.0/concrete/src/Page/Page.php, line 1882 - some fragments of code are removed, I've left only ```cName``` processing here, I'm pretty sure you know source code well enough to get the point):\n\n```PHP\npublic function update($data)\n    {\n        (...)\n\n        $cName = $this->getCollectionName();\n        \n        (...)\n\n        if (isset($data['cName'])) {\n            $cName = $data['cName'];\n        }\n        \n        (...)\n        $txt = Core::make('helper/text');\n        $isHomePage = $this->isHomePage();\n        \n        (...)\n        $cName = $txt->sanitize($cName);    // line 1950\n\n        if ($this->isGeneratedCollection()) {\n            if (isset($data['cFilename'])) {\n                $cFilename = $data['cFilename'];\n            }\n            // we only update a subset\n            $v = [$cName, $cHandle, $cDescription, $cDatePublic, $cvID, $this->cID];\n            $q = 'update CollectionVersions set cvName = ?, cvHandle = ?, cvDescription = ?, cvDatePublic = ? where cvID = ? and cID = ?';\n            $r = $db->prepare($q);\n            $r->execute($v);\n        } else {\n\n        (...)\n```\n\nIn line 1950, method ```sanitize()``` from ```Text``` class is called (concrete5-8.1.0/concrete/src/Utility/Service/Text.php)\n\n```PHP\npublic function sanitize($string, $max_length = 0, $allowed = '')\n    {\n        $text = trim(strip_tags($string, $allowed));            // line 97\n        if ($max_length > 0) {\n            if (function_exists('mb_substr')) {\n                $text = mb_substr($text, 0, $max_length, APP_CHARSET);\n            } else {\n                $text = substr($text, 0, $max_length);\n            }\n        }\n        if ($text == null) {\n            return \"\"; // we need to explicitly return a string otherwise some DB functions might insert this as a ZERO.\n        }\n\n        return $text;\n    }\n\n```\n\nIn line 97, ```strip_tags()``` method is called, which prevents ```cName``` from being infected by HTML tags, like ```<script>```, however it does not protect against presented attack vector, where HTML attribute is injected, with inline JavaScript event handler.\n\n```\nstring strip_tags ( string $str [, string $allowable_tags ] )\n\nThis function tries to return a string with all NULL bytes, HTML and PHP tags stripped from a given str. It uses the same tag stripping state machine as the fgetss() function.\n```\n\nWebiste itself is protected well, and XSS payload is not executed (printed ```cName``` is sanitized correctly):\n\n{F186243}\n\n## Testing environment\n\nSystem:\n- Concrete5 version 8.1.0, installed localy\n- PHP ver. 5.6.30\n- Apache HTTP Server 2.4.25 for macOS\n- MySQL ver. 5.7.13 for macOS\n\nThis vulnerability was tested on macOS Sierra 10.12.5 with following browsers:\n\n- Chrome 58\n- Chromium build 60.0.3104.0\n- Safari 10.1.1\n\n__XSS Auditor__ build in WebKit/Blink based browsers __does not prevent__ against this injection. I am pretty sure this vulnerability will work in any browser, in any version including the newest ones.\n\n\n\n## Impact\n\nAlthough this attack vector is internal only (```Name``` attribute is sanitized when displayed on page while browsing the website), there is still possible for malicious user with eg. lower privileges, to inject such payload and trick other user(s) with higher privileges (like site admin) to open infected SEO dialog or Page Search, which will execute payload in such user context. I assume here that Concrete5 CMS is used to build website, where many users have permissions to add or edit content.\n\n\n## Wrap up\n\nI hope my report will help keep Concrete5 safe in the future.\n\nBest Regards,\n\nRafal 'bl4de' Janicki", 
    "activity_page_count": 1, 
    "severity": {
        "rating": "medium", 
        "author_type": "User"
    }, 
    "title": "Stored XSS in Pages SEO dialog Name field (concrete5 8.1.0)", 
    "is_member_of_team?": null, 
    "vote_count": 9, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2017-07-27T22:40:25.266Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "activity_page_number": 1, 
    "readable_substate": "Resolved", 
    "public": true, 
    "attachments": [
        {
            "file_name": "seo1.png", 
            "type": "image/png", 
            "id": 186242, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/186/242/f4033c5f9d8281708bd4b8930f5b525783832994/seo1.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6DOF4BH7%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T223507Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDAsIeiAo1xTw4kIWniK3AwV1z%2FDNuc2GpLi7AJOEJ0e4NWAql7yl6ReQj30YP2K5FBrc9xv0H8z3PZE4N7C099Z%2FTC7v7C1gzo54Jgi%2FX3cl%2B1K8PJ1QoShLHpAAjRjf5ciIakpyJZtfax9fUrlrfbg93561WLH%2BcAlYZYP%2FDoT4YEiEnKFoc6r1kz0vtgQeOMs4HdHNkjkFGMI77%2BHQkyTCbcJv5zS%2BkPk%2FmeIs5TPwLonNR3KC9vVtG8%2FxH87F2PEClO9BEdrskZjtMWY6P010JBQmt1CorTu4hj%2BXFqvR%2F690HP1hcC8CWJCyppmtZv0XEClGLMVyC6ib3jbvYHrbrPEHfmQP2RQi0FwMeueNkOH5qbyGqwmmxB4agSDiXM3XAl%2BTc87Wf5p1e%2Bc0zjzZ0xQeKM%2F%2B6b6TparaVSEWnYgYleztcjU3fPWHAZNwL16PwqewCVGh0Qp%2BPnUemfdihk3MmFQeIjHmE7sOQgXva7HlIEEEJ1hyrapkEutFP16gxCQzYqmfLGEsK0wbCxHgen0YqfDv81EZR726krPSisHScLMujI0SnwbcN8IyUwIYqnw663l%2FY9Dhpcje1uM19tGvbMUolrmm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c464139093d2f4467e4764629b6db783ec422f79835054655c34339943baf097"
        }, 
        {
            "file_name": "seo5.png", 
            "type": "image/png", 
            "id": 186243, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/186/243/acf5b31c82f14a3e55cfa91781fdca8e1cfd5eb9/seo5.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6DOF4BH7%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T223507Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDAsIeiAo1xTw4kIWniK3AwV1z%2FDNuc2GpLi7AJOEJ0e4NWAql7yl6ReQj30YP2K5FBrc9xv0H8z3PZE4N7C099Z%2FTC7v7C1gzo54Jgi%2FX3cl%2B1K8PJ1QoShLHpAAjRjf5ciIakpyJZtfax9fUrlrfbg93561WLH%2BcAlYZYP%2FDoT4YEiEnKFoc6r1kz0vtgQeOMs4HdHNkjkFGMI77%2BHQkyTCbcJv5zS%2BkPk%2FmeIs5TPwLonNR3KC9vVtG8%2FxH87F2PEClO9BEdrskZjtMWY6P010JBQmt1CorTu4hj%2BXFqvR%2F690HP1hcC8CWJCyppmtZv0XEClGLMVyC6ib3jbvYHrbrPEHfmQP2RQi0FwMeueNkOH5qbyGqwmmxB4agSDiXM3XAl%2BTc87Wf5p1e%2Bc0zjzZ0xQeKM%2F%2B6b6TparaVSEWnYgYleztcjU3fPWHAZNwL16PwqewCVGh0Qp%2BPnUemfdihk3MmFQeIjHmE7sOQgXva7HlIEEEJ1hyrapkEutFP16gxCQzYqmfLGEsK0wbCxHgen0YqfDv81EZR726krPSisHScLMujI0SnwbcN8IyUwIYqnw663l%2FY9Dhpcje1uM19tGvbMUolrmm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=e3ac9b659bfa216a02ea92c253ba9266a5b9b070361b507a80a8e85611b9a811"
        }, 
        {
            "file_name": "seo2.png", 
            "type": "image/png", 
            "id": 186244, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/186/244/3e88c487361320239a76b24841beccd8dd63e4fb/seo2.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6DOF4BH7%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T223507Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDAsIeiAo1xTw4kIWniK3AwV1z%2FDNuc2GpLi7AJOEJ0e4NWAql7yl6ReQj30YP2K5FBrc9xv0H8z3PZE4N7C099Z%2FTC7v7C1gzo54Jgi%2FX3cl%2B1K8PJ1QoShLHpAAjRjf5ciIakpyJZtfax9fUrlrfbg93561WLH%2BcAlYZYP%2FDoT4YEiEnKFoc6r1kz0vtgQeOMs4HdHNkjkFGMI77%2BHQkyTCbcJv5zS%2BkPk%2FmeIs5TPwLonNR3KC9vVtG8%2FxH87F2PEClO9BEdrskZjtMWY6P010JBQmt1CorTu4hj%2BXFqvR%2F690HP1hcC8CWJCyppmtZv0XEClGLMVyC6ib3jbvYHrbrPEHfmQP2RQi0FwMeueNkOH5qbyGqwmmxB4agSDiXM3XAl%2BTc87Wf5p1e%2Bc0zjzZ0xQeKM%2F%2B6b6TparaVSEWnYgYleztcjU3fPWHAZNwL16PwqewCVGh0Qp%2BPnUemfdihk3MmFQeIjHmE7sOQgXva7HlIEEEJ1hyrapkEutFP16gxCQzYqmfLGEsK0wbCxHgen0YqfDv81EZR726krPSisHScLMujI0SnwbcN8IyUwIYqnw663l%2FY9Dhpcje1uM19tGvbMUolrmm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=a111c75e0b70269ea1e3178f24e26d77911bb06dda91406e413b896a5ac0ef96"
        }, 
        {
            "file_name": "seo3.png", 
            "type": "image/png", 
            "id": 186245, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/186/245/6055c2f566d788369de48f6e82d4b908914c04e8/seo3.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6DOF4BH7%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T223507Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDAsIeiAo1xTw4kIWniK3AwV1z%2FDNuc2GpLi7AJOEJ0e4NWAql7yl6ReQj30YP2K5FBrc9xv0H8z3PZE4N7C099Z%2FTC7v7C1gzo54Jgi%2FX3cl%2B1K8PJ1QoShLHpAAjRjf5ciIakpyJZtfax9fUrlrfbg93561WLH%2BcAlYZYP%2FDoT4YEiEnKFoc6r1kz0vtgQeOMs4HdHNkjkFGMI77%2BHQkyTCbcJv5zS%2BkPk%2FmeIs5TPwLonNR3KC9vVtG8%2FxH87F2PEClO9BEdrskZjtMWY6P010JBQmt1CorTu4hj%2BXFqvR%2F690HP1hcC8CWJCyppmtZv0XEClGLMVyC6ib3jbvYHrbrPEHfmQP2RQi0FwMeueNkOH5qbyGqwmmxB4agSDiXM3XAl%2BTc87Wf5p1e%2Bc0zjzZ0xQeKM%2F%2B6b6TparaVSEWnYgYleztcjU3fPWHAZNwL16PwqewCVGh0Qp%2BPnUemfdihk3MmFQeIjHmE7sOQgXva7HlIEEEJ1hyrapkEutFP16gxCQzYqmfLGEsK0wbCxHgen0YqfDv81EZR726krPSisHScLMujI0SnwbcN8IyUwIYqnw663l%2FY9Dhpcje1uM19tGvbMUolrmm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=6b29275b5e456736342f5efdc1fb4fa4eed558cd4734c4f18e1eb88dc5e2ff1d"
        }, 
        {
            "file_name": "seo4.png", 
            "type": "image/png", 
            "id": 186246, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/186/246/104b2a51bf9abd3dc82f52da1fde4dc32a795059/seo4.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6DOF4BH7%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T223507Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDAsIeiAo1xTw4kIWniK3AwV1z%2FDNuc2GpLi7AJOEJ0e4NWAql7yl6ReQj30YP2K5FBrc9xv0H8z3PZE4N7C099Z%2FTC7v7C1gzo54Jgi%2FX3cl%2B1K8PJ1QoShLHpAAjRjf5ciIakpyJZtfax9fUrlrfbg93561WLH%2BcAlYZYP%2FDoT4YEiEnKFoc6r1kz0vtgQeOMs4HdHNkjkFGMI77%2BHQkyTCbcJv5zS%2BkPk%2FmeIs5TPwLonNR3KC9vVtG8%2FxH87F2PEClO9BEdrskZjtMWY6P010JBQmt1CorTu4hj%2BXFqvR%2F690HP1hcC8CWJCyppmtZv0XEClGLMVyC6ib3jbvYHrbrPEHfmQP2RQi0FwMeueNkOH5qbyGqwmmxB4agSDiXM3XAl%2BTc87Wf5p1e%2Bc0zjzZ0xQeKM%2F%2B6b6TparaVSEWnYgYleztcjU3fPWHAZNwL16PwqewCVGh0Qp%2BPnUemfdihk3MmFQeIjHmE7sOQgXva7HlIEEEJ1hyrapkEutFP16gxCQzYqmfLGEsK0wbCxHgen0YqfDv81EZR726krPSisHScLMujI0SnwbcN8IyUwIYqnw663l%2FY9Dhpcje1uM19tGvbMUolrmm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=11f6cb3d78bd2f3863a14338ae46aa300ad37b31c238638366ae1d5b45915e88"
        }
    ], 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2017-05-19T23:41:57.135Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-05-19T23:41:57.135Z", 
            "actor": {
                "username": "bl4de", 
                "url": "/bl4de", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/017/622/32292cbe1a952c345aef237a5dde32d13a7489cf_medium.jpg?1424108731"
                }, 
                "hackerone_triager": false
            }, 
            "additional_data": {
                "new_title": "Stored XSS in Pages SEO dialog Name field (concrete5 8.1.0)", 
                "old_title": "Stored XSS in Pages SEO dialog Name field"
            }, 
            "team_handle": "concrete5", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportTitleUpdated", 
            "id": 1687401, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-05-27T08:57:46.549Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-05-27T08:57:46.549Z", 
            "actor": {
                "username": "bl4de", 
                "url": "/bl4de", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/017/622/32292cbe1a952c345aef237a5dde32d13a7489cf_medium.jpg?1424108731"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "concrete5", 
            "message": "Verified and reproducible on:\n\nCore Version - 8.2.0b1\nVersion Installed - 8.2.0b1\nDatabase Version - 20170505000000\n\nRegards,\n\nbl4de", 
            "markdown_message": "<p>Verified and reproducible on:</p>\n\n<p>Core Version - 8.2.0b1<br>\nVersion Installed - 8.2.0b1<br>\nDatabase Version - 20170505000000</p>\n\n<p>Regards,</p>\n\n<p>bl4de</p>\n", 
            "type": "Activities::Comment", 
            "id": 1704932, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-06-13T23:41:14.326Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-13T23:41:14.326Z", 
            "actor": {
                "username": "korvin", 
                "url": "/korvin", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/454/9a0e6f861d861e27945d02c73b3598bb6abb5bff_medium.jpg?1406656654"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "concrete5", 
            "message": "Hi Bl4de,\nI've pushed a commit to the develop branch, can you double check that that has resolved this issue?", 
            "markdown_message": "<p>Hi Bl4de,<br>\nI&#39;ve pushed a commit to the develop branch, can you double check that that has resolved this issue?</p>\n", 
            "type": "Activities::Comment", 
            "id": 1754140, 
            "genius_execution_id": null
        }, 
        {
            "attachments": [
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/194/029/756f724829950a323e3c3c3c7b153d414bbf2eea/Zrzut_ekranu_2017-06-14_o_01.04.25.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6DOF4BH7%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T223507Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDAsIeiAo1xTw4kIWniK3AwV1z%2FDNuc2GpLi7AJOEJ0e4NWAql7yl6ReQj30YP2K5FBrc9xv0H8z3PZE4N7C099Z%2FTC7v7C1gzo54Jgi%2FX3cl%2B1K8PJ1QoShLHpAAjRjf5ciIakpyJZtfax9fUrlrfbg93561WLH%2BcAlYZYP%2FDoT4YEiEnKFoc6r1kz0vtgQeOMs4HdHNkjkFGMI77%2BHQkyTCbcJv5zS%2BkPk%2FmeIs5TPwLonNR3KC9vVtG8%2FxH87F2PEClO9BEdrskZjtMWY6P010JBQmt1CorTu4hj%2BXFqvR%2F690HP1hcC8CWJCyppmtZv0XEClGLMVyC6ib3jbvYHrbrPEHfmQP2RQi0FwMeueNkOH5qbyGqwmmxB4agSDiXM3XAl%2BTc87Wf5p1e%2Bc0zjzZ0xQeKM%2F%2B6b6TparaVSEWnYgYleztcjU3fPWHAZNwL16PwqewCVGh0Qp%2BPnUemfdihk3MmFQeIjHmE7sOQgXva7HlIEEEJ1hyrapkEutFP16gxCQzYqmfLGEsK0wbCxHgen0YqfDv81EZR726krPSisHScLMujI0SnwbcN8IyUwIYqnw663l%2FY9Dhpcje1uM19tGvbMUolrmm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=07009831e8cc5f5dafd670501e0618a808a82ac3d585775d769f883e8e5967ee", 
                    "type": "image/png", 
                    "id": 194029, 
                    "filename": "Zrzut_ekranu_2017-06-14_o_01.04.25.png"
                }
            ], 
            "automated_response": false, 
            "created_at": "2017-06-14T00:08:05.915Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-14T00:08:40.919Z", 
            "actor": {
                "username": "bl4de", 
                "url": "/bl4de", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/017/622/32292cbe1a952c345aef237a5dde32d13a7489cf_medium.jpg?1424108731"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "concrete5", 
            "message": "Hi @korvin \n\nI can confirm that XSS in SEO dialog is fixed now, however is still reproducible on Sitemap -> Page Search list, in ```<tr>``` element:\n\n```HTML\n<tr data-launch-search-menu=\"168\" data-page-id=\"168\" data-page-name=\"name\" onmouseover=\"alert('Stored XSS in SEO Name field')\" \"=\"\" class=\"\">\n\t<td><span class=\"ccm-search-results-checkbox\"><input type=\"checkbox\" class=\"ccm-flat-checkbox\" data-search-checkbox=\"individual\" value=\"168\"></span></td>\n\t\n\t\t\t<td>Blog</td>\n\t\t\n\t\n\t\t\t<td class=\"ccm-search-results-name\">name\" onmouseover=\"alert('Stored XSS in SEO Name field')\"</td>\n\t\t\n\t\n\t\t\t<td>5/27/17, 9:13 AM</td>\n\t\t\n\t\n\t\t\t<td>6/14/17, 1:01 AM</td>\n\t\t\n\t\n\t\t\t<td>admin</td>\n\t\t\n\t\n</tr>\n```\n\n{F194029}\n\nLet me know if you need more information\n\nRegards,\n\nbl4de", 
            "markdown_message": "<p>Hi <a href=\"/korvin\">@korvin</a> </p>\n\n<p>I can confirm that XSS in SEO dialog is fixed now, however is still reproducible on Sitemap -&gt; Page Search list, in <code>&lt;tr&gt;</code> element:</p>\n<pre class=\"highlight plaintext\"><code>&lt;tr data-launch-search-menu=&quot;168&quot; data-page-id=&quot;168&quot; data-page-name=&quot;name&quot; onmouseover=&quot;alert(&#39;Stored XSS in SEO Name field&#39;)&quot; &quot;=&quot;&quot; class=&quot;&quot;&gt;\n    &lt;td&gt;&lt;span class=&quot;ccm-search-results-checkbox&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;ccm-flat-checkbox&quot; data-search-checkbox=&quot;individual&quot; value=&quot;168&quot;&gt;&lt;/span&gt;&lt;/td&gt;\n\n            &lt;td&gt;Blog&lt;/td&gt;\n\n\n            &lt;td class=&quot;ccm-search-results-name&quot;&gt;name&quot; onmouseover=&quot;alert(&#39;Stored XSS in SEO Name field&#39;)&quot;&lt;/td&gt;\n\n\n            &lt;td&gt;5/27/17, 9:13 AM&lt;/td&gt;\n\n\n            &lt;td&gt;6/14/17, 1:01 AM&lt;/td&gt;\n\n\n            &lt;td&gt;admin&lt;/td&gt;\n\n\n&lt;/tr&gt;\n</code></pre>\n<p><a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Zrzut_ekranu_2017-06-14_o_01.04.25.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/194/029/756f724829950a323e3c3c3c7b153d414bbf2eea/Zrzut_ekranu_2017-06-14_o_01.04.25.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ6DOF4BH7%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T223507Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDAsIeiAo1xTw4kIWniK3AwV1z%2FDNuc2GpLi7AJOEJ0e4NWAql7yl6ReQj30YP2K5FBrc9xv0H8z3PZE4N7C099Z%2FTC7v7C1gzo54Jgi%2FX3cl%2B1K8PJ1QoShLHpAAjRjf5ciIakpyJZtfax9fUrlrfbg93561WLH%2BcAlYZYP%2FDoT4YEiEnKFoc6r1kz0vtgQeOMs4HdHNkjkFGMI77%2BHQkyTCbcJv5zS%2BkPk%2FmeIs5TPwLonNR3KC9vVtG8%2FxH87F2PEClO9BEdrskZjtMWY6P010JBQmt1CorTu4hj%2BXFqvR%2F690HP1hcC8CWJCyppmtZv0XEClGLMVyC6ib3jbvYHrbrPEHfmQP2RQi0FwMeueNkOH5qbyGqwmmxB4agSDiXM3XAl%2BTc87Wf5p1e%2Bc0zjzZ0xQeKM%2F%2B6b6TparaVSEWnYgYleztcjU3fPWHAZNwL16PwqewCVGh0Qp%2BPnUemfdihk3MmFQeIjHmE7sOQgXva7HlIEEEJ1hyrapkEutFP16gxCQzYqmfLGEsK0wbCxHgen0YqfDv81EZR726krPSisHScLMujI0SnwbcN8IyUwIYqnw663l%2FY9Dhpcje1uM19tGvbMUolrmm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=07009831e8cc5f5dafd670501e0618a808a82ac3d585775d769f883e8e5967ee\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/194/029/756f724829950a323e3c3c3c7b153d414bbf2eea/Zrzut_ekranu_2017-06-14_o_01.04.25.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ6DOF4BH7%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T223507Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDAsIeiAo1xTw4kIWniK3AwV1z%2FDNuc2GpLi7AJOEJ0e4NWAql7yl6ReQj30YP2K5FBrc9xv0H8z3PZE4N7C099Z%2FTC7v7C1gzo54Jgi%2FX3cl%2B1K8PJ1QoShLHpAAjRjf5ciIakpyJZtfax9fUrlrfbg93561WLH%2BcAlYZYP%2FDoT4YEiEnKFoc6r1kz0vtgQeOMs4HdHNkjkFGMI77%2BHQkyTCbcJv5zS%2BkPk%2FmeIs5TPwLonNR3KC9vVtG8%2FxH87F2PEClO9BEdrskZjtMWY6P010JBQmt1CorTu4hj%2BXFqvR%2F690HP1hcC8CWJCyppmtZv0XEClGLMVyC6ib3jbvYHrbrPEHfmQP2RQi0FwMeueNkOH5qbyGqwmmxB4agSDiXM3XAl%2BTc87Wf5p1e%2Bc0zjzZ0xQeKM%2F%2B6b6TparaVSEWnYgYleztcjU3fPWHAZNwL16PwqewCVGh0Qp%2BPnUemfdihk3MmFQeIjHmE7sOQgXva7HlIEEEJ1hyrapkEutFP16gxCQzYqmfLGEsK0wbCxHgen0YqfDv81EZR726krPSisHScLMujI0SnwbcN8IyUwIYqnw663l%2FY9Dhpcje1uM19tGvbMUolrmm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=07009831e8cc5f5dafd670501e0618a808a82ac3d585775d769f883e8e5967ee\" class=\"markdown-inline-image\"></a></p>\n\n<p>Let me know if you need more information</p>\n\n<p>Regards,</p>\n\n<p>bl4de</p>\n", 
            "type": "Activities::Comment", 
            "id": 1754152, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-06-27T22:35:46.726Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-27T22:35:46.726Z", 
            "actor": {
                "username": "korvin", 
                "url": "/korvin", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/454/9a0e6f861d861e27945d02c73b3598bb6abb5bff_medium.jpg?1406656654"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "concrete5", 
            "message": "Hi Bl4de,\nI've opened this pull request which should resolve this issue before the 8.2 release. https://github.com/concrete5/concrete5/pull/5633\n\nBest wishes,\nKorvin", 
            "markdown_message": "<p>Hi Bl4de,<br>\nI&#39;ve opened this pull request which should resolve this issue before the 8.2 release. <a title=\"https://github.com/concrete5/concrete5/pull/5633\" href=\"/redirect?signature=3422661a0dc62d8368e06fd4c38208ff2b5a0968&amp;url=https%3A%2F%2Fgithub.com%2Fconcrete5%2Fconcrete5%2Fpull%2F5633\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/concrete5/concrete5/pull/5633</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>Best wishes,<br>\nKorvin</p>\n", 
            "type": "Activities::Comment", 
            "id": 1786135, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "bl4de", 
                "url": "/bl4de"
            }, 
            "created_at": "2017-06-27T22:35:57.179Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-27T22:35:57.179Z", 
            "actor": {
                "username": "korvin", 
                "url": "/korvin", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/454/9a0e6f861d861e27945d02c73b3598bb6abb5bff_medium.jpg?1406656654"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "concrete5", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugResolved", 
            "id": 1786137, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-06-27T22:40:13.596Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-27T22:40:13.596Z", 
            "actor": {
                "username": "bl4de", 
                "url": "/bl4de", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/017/622/32292cbe1a952c345aef237a5dde32d13a7489cf_medium.jpg?1424108731"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "concrete5", 
            "message": "Hi @korvin \n\nThat sounds good :)\nDon't you mind disclosing this report?\n\nThanks!\n\nbl4de", 
            "markdown_message": "<p>Hi <a href=\"/korvin\">@korvin</a> </p>\n\n<p>That sounds good :)<br>\nDon&#39;t you mind disclosing this report?</p>\n\n<p>Thanks!</p>\n\n<p>bl4de</p>\n", 
            "type": "Activities::Comment", 
            "id": 1786155, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-06-27T22:40:25.245Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-27T22:40:25.245Z", 
            "actor": {
                "username": "bl4de", 
                "url": "/bl4de", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/017/622/32292cbe1a952c345aef237a5dde32d13a7489cf_medium.jpg?1424108731"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "concrete5", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1786158, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-06-27T22:41:49.160Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-27T22:41:49.160Z", 
            "actor": {
                "username": "korvin", 
                "url": "/korvin", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/454/9a0e6f861d861e27945d02c73b3598bb6abb5bff_medium.jpg?1406656654"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "concrete5", 
            "message": "Let's disclose this once 8.2.0 lands.", 
            "markdown_message": "<p>Let&#39;s disclose this once 8.2.0 lands.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1786162, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-06-27T22:43:51.196Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-27T22:43:51.196Z", 
            "actor": {
                "username": "bl4de", 
                "url": "/bl4de", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/017/622/32292cbe1a952c345aef237a5dde32d13a7489cf_medium.jpg?1424108731"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "concrete5", 
            "message": "Of course, this sounds reasonable to me.\n\nRegards,\n\nbl4de", 
            "markdown_message": "<p>Of course, this sounds reasonable to me.</p>\n\n<p>Regards,</p>\n\n<p>bl4de</p>\n", 
            "type": "Activities::Comment", 
            "id": 1786170, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-07-27T22:40:43.071Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-07-27T22:40:43.071Z", 
            "actor": {
                "url": "/concrete5", 
                "profile": {
                    "name": "concrete5"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/060/80201c838134b35b9b1acd99ad8a7a7c214aa374_medium.jpg?1393279055"
                }
            }, 
            "team_handle": "concrete5", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 1871580, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "bl4de", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/bl4de", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/017/622/36f4fb2f20566c21ddbacf07cd490330ca853c91_small.jpg?1424108731"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 62, 
        "name": "Cross-site Scripting (XSS) - Stored"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -42940482.5056984, 
    "disclosed_at": "2017-07-27T22:40:43.044Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/230029", 
    "created_at": "2017-05-19T23:32:12.892Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<h2 id=\"intro\">Intro</h2>\n\n<p>First things first, so... Crayons, crayons everywhere :)</p>\n\n<p><strong>Type of issue</strong>: Core CMS issue<br>\n<strong>Level of severity</strong>: Internal Attack Vector <br>\n<strong>Concrete5 version</strong>: 8.1.0</p>\n\n<h2 id=\"summary\">Summary</h2>\n\n<p>There is Stored XSS vulnerability in <strong>Name</strong> field (SEO dialog) for pages. Malicious user is able to prepare payload which is then executed in SEO dialog and on Page Search (index.php/dashboard/sitemap/search).</p>\n\n<h2 id=\"steps-to-reproduce\">Steps to reproduce</h2>\n\n<ul>\n<li>login into Concrete5 instance</li>\n<li>go to Dashboard -&gt; Full Sitemap</li>\n<li>on Pages list, select one and click. Popup with options will show up</li>\n</ul>\n\n<p><a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"seo1.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/186/242/f4033c5f9d8281708bd4b8930f5b525783832994/seo1.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ6DOF4BH7%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T223507Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDAsIeiAo1xTw4kIWniK3AwV1z%2FDNuc2GpLi7AJOEJ0e4NWAql7yl6ReQj30YP2K5FBrc9xv0H8z3PZE4N7C099Z%2FTC7v7C1gzo54Jgi%2FX3cl%2B1K8PJ1QoShLHpAAjRjf5ciIakpyJZtfax9fUrlrfbg93561WLH%2BcAlYZYP%2FDoT4YEiEnKFoc6r1kz0vtgQeOMs4HdHNkjkFGMI77%2BHQkyTCbcJv5zS%2BkPk%2FmeIs5TPwLonNR3KC9vVtG8%2FxH87F2PEClO9BEdrskZjtMWY6P010JBQmt1CorTu4hj%2BXFqvR%2F690HP1hcC8CWJCyppmtZv0XEClGLMVyC6ib3jbvYHrbrPEHfmQP2RQi0FwMeueNkOH5qbyGqwmmxB4agSDiXM3XAl%2BTc87Wf5p1e%2Bc0zjzZ0xQeKM%2F%2B6b6TparaVSEWnYgYleztcjU3fPWHAZNwL16PwqewCVGh0Qp%2BPnUemfdihk3MmFQeIjHmE7sOQgXva7HlIEEEJ1hyrapkEutFP16gxCQzYqmfLGEsK0wbCxHgen0YqfDv81EZR726krPSisHScLMujI0SnwbcN8IyUwIYqnw663l%2FY9Dhpcje1uM19tGvbMUolrmm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=c464139093d2f4467e4764629b6db783ec422f79835054655c34339943baf097\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/186/242/f4033c5f9d8281708bd4b8930f5b525783832994/seo1.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ6DOF4BH7%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T223507Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDAsIeiAo1xTw4kIWniK3AwV1z%2FDNuc2GpLi7AJOEJ0e4NWAql7yl6ReQj30YP2K5FBrc9xv0H8z3PZE4N7C099Z%2FTC7v7C1gzo54Jgi%2FX3cl%2B1K8PJ1QoShLHpAAjRjf5ciIakpyJZtfax9fUrlrfbg93561WLH%2BcAlYZYP%2FDoT4YEiEnKFoc6r1kz0vtgQeOMs4HdHNkjkFGMI77%2BHQkyTCbcJv5zS%2BkPk%2FmeIs5TPwLonNR3KC9vVtG8%2FxH87F2PEClO9BEdrskZjtMWY6P010JBQmt1CorTu4hj%2BXFqvR%2F690HP1hcC8CWJCyppmtZv0XEClGLMVyC6ib3jbvYHrbrPEHfmQP2RQi0FwMeueNkOH5qbyGqwmmxB4agSDiXM3XAl%2BTc87Wf5p1e%2Bc0zjzZ0xQeKM%2F%2B6b6TparaVSEWnYgYleztcjU3fPWHAZNwL16PwqewCVGh0Qp%2BPnUemfdihk3MmFQeIjHmE7sOQgXva7HlIEEEJ1hyrapkEutFP16gxCQzYqmfLGEsK0wbCxHgen0YqfDv81EZR726krPSisHScLMujI0SnwbcN8IyUwIYqnw663l%2FY9Dhpcje1uM19tGvbMUolrmm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=c464139093d2f4467e4764629b6db783ec422f79835054655c34339943baf097\" class=\"markdown-inline-image\"></a></p>\n\n<ul>\n<li>select <strong>SEO</strong> option. SEO dialog will show up on the screen</li>\n</ul>\n\n<p><a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"seo2.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/186/244/3e88c487361320239a76b24841beccd8dd63e4fb/seo2.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ6DOF4BH7%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T223507Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDAsIeiAo1xTw4kIWniK3AwV1z%2FDNuc2GpLi7AJOEJ0e4NWAql7yl6ReQj30YP2K5FBrc9xv0H8z3PZE4N7C099Z%2FTC7v7C1gzo54Jgi%2FX3cl%2B1K8PJ1QoShLHpAAjRjf5ciIakpyJZtfax9fUrlrfbg93561WLH%2BcAlYZYP%2FDoT4YEiEnKFoc6r1kz0vtgQeOMs4HdHNkjkFGMI77%2BHQkyTCbcJv5zS%2BkPk%2FmeIs5TPwLonNR3KC9vVtG8%2FxH87F2PEClO9BEdrskZjtMWY6P010JBQmt1CorTu4hj%2BXFqvR%2F690HP1hcC8CWJCyppmtZv0XEClGLMVyC6ib3jbvYHrbrPEHfmQP2RQi0FwMeueNkOH5qbyGqwmmxB4agSDiXM3XAl%2BTc87Wf5p1e%2Bc0zjzZ0xQeKM%2F%2B6b6TparaVSEWnYgYleztcjU3fPWHAZNwL16PwqewCVGh0Qp%2BPnUemfdihk3MmFQeIjHmE7sOQgXva7HlIEEEJ1hyrapkEutFP16gxCQzYqmfLGEsK0wbCxHgen0YqfDv81EZR726krPSisHScLMujI0SnwbcN8IyUwIYqnw663l%2FY9Dhpcje1uM19tGvbMUolrmm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=a111c75e0b70269ea1e3178f24e26d77911bb06dda91406e413b896a5ac0ef96\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/186/244/3e88c487361320239a76b24841beccd8dd63e4fb/seo2.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ6DOF4BH7%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T223507Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDAsIeiAo1xTw4kIWniK3AwV1z%2FDNuc2GpLi7AJOEJ0e4NWAql7yl6ReQj30YP2K5FBrc9xv0H8z3PZE4N7C099Z%2FTC7v7C1gzo54Jgi%2FX3cl%2B1K8PJ1QoShLHpAAjRjf5ciIakpyJZtfax9fUrlrfbg93561WLH%2BcAlYZYP%2FDoT4YEiEnKFoc6r1kz0vtgQeOMs4HdHNkjkFGMI77%2BHQkyTCbcJv5zS%2BkPk%2FmeIs5TPwLonNR3KC9vVtG8%2FxH87F2PEClO9BEdrskZjtMWY6P010JBQmt1CorTu4hj%2BXFqvR%2F690HP1hcC8CWJCyppmtZv0XEClGLMVyC6ib3jbvYHrbrPEHfmQP2RQi0FwMeueNkOH5qbyGqwmmxB4agSDiXM3XAl%2BTc87Wf5p1e%2Bc0zjzZ0xQeKM%2F%2B6b6TparaVSEWnYgYleztcjU3fPWHAZNwL16PwqewCVGh0Qp%2BPnUemfdihk3MmFQeIjHmE7sOQgXva7HlIEEEJ1hyrapkEutFP16gxCQzYqmfLGEsK0wbCxHgen0YqfDv81EZR726krPSisHScLMujI0SnwbcN8IyUwIYqnw663l%2FY9Dhpcje1uM19tGvbMUolrmm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=a111c75e0b70269ea1e3178f24e26d77911bb06dda91406e413b896a5ac0ef96\" class=\"markdown-inline-image\"></a></p>\n\n<ul>\n<li>in <code>Name</code> field, put following payload, right after Page name:</li>\n</ul>\n<pre class=\"highlight plaintext\"><code>&quot; onmouseover=&quot;alert(&#39;Stored XSS in SEO Name field&#39;)&quot;\n</code></pre>\n<ul>\n<li>click <code>Save changes</code>\n</li>\n</ul>\n\n<p>Now, there are two places, where injected payload is retrieved from database and executed:</p>\n\n<ul>\n<li>SEO dialog box, when user mouse-over <code>Name</code> field</li>\n<li>Page Search, when user mouse-over infected Page name:</li>\n</ul>\n\n<p><a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"seo3.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/186/245/6055c2f566d788369de48f6e82d4b908914c04e8/seo3.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ6DOF4BH7%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T223507Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDAsIeiAo1xTw4kIWniK3AwV1z%2FDNuc2GpLi7AJOEJ0e4NWAql7yl6ReQj30YP2K5FBrc9xv0H8z3PZE4N7C099Z%2FTC7v7C1gzo54Jgi%2FX3cl%2B1K8PJ1QoShLHpAAjRjf5ciIakpyJZtfax9fUrlrfbg93561WLH%2BcAlYZYP%2FDoT4YEiEnKFoc6r1kz0vtgQeOMs4HdHNkjkFGMI77%2BHQkyTCbcJv5zS%2BkPk%2FmeIs5TPwLonNR3KC9vVtG8%2FxH87F2PEClO9BEdrskZjtMWY6P010JBQmt1CorTu4hj%2BXFqvR%2F690HP1hcC8CWJCyppmtZv0XEClGLMVyC6ib3jbvYHrbrPEHfmQP2RQi0FwMeueNkOH5qbyGqwmmxB4agSDiXM3XAl%2BTc87Wf5p1e%2Bc0zjzZ0xQeKM%2F%2B6b6TparaVSEWnYgYleztcjU3fPWHAZNwL16PwqewCVGh0Qp%2BPnUemfdihk3MmFQeIjHmE7sOQgXva7HlIEEEJ1hyrapkEutFP16gxCQzYqmfLGEsK0wbCxHgen0YqfDv81EZR726krPSisHScLMujI0SnwbcN8IyUwIYqnw663l%2FY9Dhpcje1uM19tGvbMUolrmm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=6b29275b5e456736342f5efdc1fb4fa4eed558cd4734c4f18e1eb88dc5e2ff1d\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/186/245/6055c2f566d788369de48f6e82d4b908914c04e8/seo3.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ6DOF4BH7%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T223507Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDAsIeiAo1xTw4kIWniK3AwV1z%2FDNuc2GpLi7AJOEJ0e4NWAql7yl6ReQj30YP2K5FBrc9xv0H8z3PZE4N7C099Z%2FTC7v7C1gzo54Jgi%2FX3cl%2B1K8PJ1QoShLHpAAjRjf5ciIakpyJZtfax9fUrlrfbg93561WLH%2BcAlYZYP%2FDoT4YEiEnKFoc6r1kz0vtgQeOMs4HdHNkjkFGMI77%2BHQkyTCbcJv5zS%2BkPk%2FmeIs5TPwLonNR3KC9vVtG8%2FxH87F2PEClO9BEdrskZjtMWY6P010JBQmt1CorTu4hj%2BXFqvR%2F690HP1hcC8CWJCyppmtZv0XEClGLMVyC6ib3jbvYHrbrPEHfmQP2RQi0FwMeueNkOH5qbyGqwmmxB4agSDiXM3XAl%2BTc87Wf5p1e%2Bc0zjzZ0xQeKM%2F%2B6b6TparaVSEWnYgYleztcjU3fPWHAZNwL16PwqewCVGh0Qp%2BPnUemfdihk3MmFQeIjHmE7sOQgXva7HlIEEEJ1hyrapkEutFP16gxCQzYqmfLGEsK0wbCxHgen0YqfDv81EZR726krPSisHScLMujI0SnwbcN8IyUwIYqnw663l%2FY9Dhpcje1uM19tGvbMUolrmm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=6b29275b5e456736342f5efdc1fb4fa4eed558cd4734c4f18e1eb88dc5e2ff1d\" class=\"markdown-inline-image\"></a></p>\n\n<p><a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"seo4.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/186/246/104b2a51bf9abd3dc82f52da1fde4dc32a795059/seo4.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ6DOF4BH7%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T223507Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDAsIeiAo1xTw4kIWniK3AwV1z%2FDNuc2GpLi7AJOEJ0e4NWAql7yl6ReQj30YP2K5FBrc9xv0H8z3PZE4N7C099Z%2FTC7v7C1gzo54Jgi%2FX3cl%2B1K8PJ1QoShLHpAAjRjf5ciIakpyJZtfax9fUrlrfbg93561WLH%2BcAlYZYP%2FDoT4YEiEnKFoc6r1kz0vtgQeOMs4HdHNkjkFGMI77%2BHQkyTCbcJv5zS%2BkPk%2FmeIs5TPwLonNR3KC9vVtG8%2FxH87F2PEClO9BEdrskZjtMWY6P010JBQmt1CorTu4hj%2BXFqvR%2F690HP1hcC8CWJCyppmtZv0XEClGLMVyC6ib3jbvYHrbrPEHfmQP2RQi0FwMeueNkOH5qbyGqwmmxB4agSDiXM3XAl%2BTc87Wf5p1e%2Bc0zjzZ0xQeKM%2F%2B6b6TparaVSEWnYgYleztcjU3fPWHAZNwL16PwqewCVGh0Qp%2BPnUemfdihk3MmFQeIjHmE7sOQgXva7HlIEEEJ1hyrapkEutFP16gxCQzYqmfLGEsK0wbCxHgen0YqfDv81EZR726krPSisHScLMujI0SnwbcN8IyUwIYqnw663l%2FY9Dhpcje1uM19tGvbMUolrmm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=11f6cb3d78bd2f3863a14338ae46aa300ad37b31c238638366ae1d5b45915e88\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/186/246/104b2a51bf9abd3dc82f52da1fde4dc32a795059/seo4.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ6DOF4BH7%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T223507Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDAsIeiAo1xTw4kIWniK3AwV1z%2FDNuc2GpLi7AJOEJ0e4NWAql7yl6ReQj30YP2K5FBrc9xv0H8z3PZE4N7C099Z%2FTC7v7C1gzo54Jgi%2FX3cl%2B1K8PJ1QoShLHpAAjRjf5ciIakpyJZtfax9fUrlrfbg93561WLH%2BcAlYZYP%2FDoT4YEiEnKFoc6r1kz0vtgQeOMs4HdHNkjkFGMI77%2BHQkyTCbcJv5zS%2BkPk%2FmeIs5TPwLonNR3KC9vVtG8%2FxH87F2PEClO9BEdrskZjtMWY6P010JBQmt1CorTu4hj%2BXFqvR%2F690HP1hcC8CWJCyppmtZv0XEClGLMVyC6ib3jbvYHrbrPEHfmQP2RQi0FwMeueNkOH5qbyGqwmmxB4agSDiXM3XAl%2BTc87Wf5p1e%2Bc0zjzZ0xQeKM%2F%2B6b6TparaVSEWnYgYleztcjU3fPWHAZNwL16PwqewCVGh0Qp%2BPnUemfdihk3MmFQeIjHmE7sOQgXva7HlIEEEJ1hyrapkEutFP16gxCQzYqmfLGEsK0wbCxHgen0YqfDv81EZR726krPSisHScLMujI0SnwbcN8IyUwIYqnw663l%2FY9Dhpcje1uM19tGvbMUolrmm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=11f6cb3d78bd2f3863a14338ae46aa300ad37b31c238638366ae1d5b45915e88\" class=\"markdown-inline-image\"></a></p>\n\n<p>In first execution (SEO dialog), it is possible to inject payload which will execute <strong>without any user interaction</strong>:</p>\n<pre class=\"highlight plaintext\"><code>&quot; onfocus=&quot;alert(&#39;Stored XSS in SEO Name field&#39;)&quot;  autofocus=&quot;true&quot;\n</code></pre>\n<p>(<strong>Warning</strong>: injecting this payload will cause XSS execution every time when SEO dialog for infected page will appear on screen. It blocks any possibility to edit <code>Name</code> and reverts changes)</p>\n\n<h2 id=\"technical-details\">Technical details</h2>\n\n<p>This vulnerability exists, because there is not enough sanitization of <code>cName</code> property read from request <code>$_POST</code>,and then use in <code>update()</code> method in <code>Page</code> class (concrete5-8.1.0/concrete/src/Page/Page.php, line 1882 - some fragments of code are removed, I&#39;ve left only <code>cName</code> processing here, I&#39;m pretty sure you know source code well enough to get the point):</p>\n<pre class=\"highlight plaintext\"><code>public function update($data)\n    {\n        (...)\n\n        $cName = $this-&gt;getCollectionName();\n\n        (...)\n\n        if (isset($data[&#39;cName&#39;])) {\n            $cName = $data[&#39;cName&#39;];\n        }\n\n        (...)\n        $txt = Core::make(&#39;helper/text&#39;);\n        $isHomePage = $this-&gt;isHomePage();\n\n        (...)\n        $cName = $txt-&gt;sanitize($cName);    // line 1950\n\n        if ($this-&gt;isGeneratedCollection()) {\n            if (isset($data[&#39;cFilename&#39;])) {\n                $cFilename = $data[&#39;cFilename&#39;];\n            }\n            // we only update a subset\n            $v = [$cName, $cHandle, $cDescription, $cDatePublic, $cvID, $this-&gt;cID];\n            $q = &#39;update CollectionVersions set cvName = ?, cvHandle = ?, cvDescription = ?, cvDatePublic = ? where cvID = ? and cID = ?&#39;;\n            $r = $db-&gt;prepare($q);\n            $r-&gt;execute($v);\n        } else {\n\n        (...)\n</code></pre>\n<p>In line 1950, method <code>sanitize()</code> from <code>Text</code> class is called (concrete5-8.1.0/concrete/src/Utility/Service/Text.php)</p>\n<pre class=\"highlight plaintext\"><code>public function sanitize($string, $max_length = 0, $allowed = &#39;&#39;)\n    {\n        $text = trim(strip_tags($string, $allowed));            // line 97\n        if ($max_length &gt; 0) {\n            if (function_exists(&#39;mb_substr&#39;)) {\n                $text = mb_substr($text, 0, $max_length, APP_CHARSET);\n            } else {\n                $text = substr($text, 0, $max_length);\n            }\n        }\n        if ($text == null) {\n            return &quot;&quot;; // we need to explicitly return a string otherwise some DB functions might insert this as a ZERO.\n        }\n\n        return $text;\n    }\n\n</code></pre>\n<p>In line 97, <code>strip_tags()</code> method is called, which prevents <code>cName</code> from being infected by HTML tags, like <code>&lt;script&gt;</code>, however it does not protect against presented attack vector, where HTML attribute is injected, with inline JavaScript event handler.</p>\n<pre class=\"highlight plaintext\"><code>string strip_tags ( string $str [, string $allowable_tags ] )\n\nThis function tries to return a string with all NULL bytes, HTML and PHP tags stripped from a given str. It uses the same tag stripping state machine as the fgetss() function.\n</code></pre>\n<p>Webiste itself is protected well, and XSS payload is not executed (printed <code>cName</code> is sanitized correctly):</p>\n\n<p><a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"seo5.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/186/243/acf5b31c82f14a3e55cfa91781fdca8e1cfd5eb9/seo5.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ6DOF4BH7%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T223507Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDAsIeiAo1xTw4kIWniK3AwV1z%2FDNuc2GpLi7AJOEJ0e4NWAql7yl6ReQj30YP2K5FBrc9xv0H8z3PZE4N7C099Z%2FTC7v7C1gzo54Jgi%2FX3cl%2B1K8PJ1QoShLHpAAjRjf5ciIakpyJZtfax9fUrlrfbg93561WLH%2BcAlYZYP%2FDoT4YEiEnKFoc6r1kz0vtgQeOMs4HdHNkjkFGMI77%2BHQkyTCbcJv5zS%2BkPk%2FmeIs5TPwLonNR3KC9vVtG8%2FxH87F2PEClO9BEdrskZjtMWY6P010JBQmt1CorTu4hj%2BXFqvR%2F690HP1hcC8CWJCyppmtZv0XEClGLMVyC6ib3jbvYHrbrPEHfmQP2RQi0FwMeueNkOH5qbyGqwmmxB4agSDiXM3XAl%2BTc87Wf5p1e%2Bc0zjzZ0xQeKM%2F%2B6b6TparaVSEWnYgYleztcjU3fPWHAZNwL16PwqewCVGh0Qp%2BPnUemfdihk3MmFQeIjHmE7sOQgXva7HlIEEEJ1hyrapkEutFP16gxCQzYqmfLGEsK0wbCxHgen0YqfDv81EZR726krPSisHScLMujI0SnwbcN8IyUwIYqnw663l%2FY9Dhpcje1uM19tGvbMUolrmm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=e3ac9b659bfa216a02ea92c253ba9266a5b9b070361b507a80a8e85611b9a811\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/186/243/acf5b31c82f14a3e55cfa91781fdca8e1cfd5eb9/seo5.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ6DOF4BH7%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T223507Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDAsIeiAo1xTw4kIWniK3AwV1z%2FDNuc2GpLi7AJOEJ0e4NWAql7yl6ReQj30YP2K5FBrc9xv0H8z3PZE4N7C099Z%2FTC7v7C1gzo54Jgi%2FX3cl%2B1K8PJ1QoShLHpAAjRjf5ciIakpyJZtfax9fUrlrfbg93561WLH%2BcAlYZYP%2FDoT4YEiEnKFoc6r1kz0vtgQeOMs4HdHNkjkFGMI77%2BHQkyTCbcJv5zS%2BkPk%2FmeIs5TPwLonNR3KC9vVtG8%2FxH87F2PEClO9BEdrskZjtMWY6P010JBQmt1CorTu4hj%2BXFqvR%2F690HP1hcC8CWJCyppmtZv0XEClGLMVyC6ib3jbvYHrbrPEHfmQP2RQi0FwMeueNkOH5qbyGqwmmxB4agSDiXM3XAl%2BTc87Wf5p1e%2Bc0zjzZ0xQeKM%2F%2B6b6TparaVSEWnYgYleztcjU3fPWHAZNwL16PwqewCVGh0Qp%2BPnUemfdihk3MmFQeIjHmE7sOQgXva7HlIEEEJ1hyrapkEutFP16gxCQzYqmfLGEsK0wbCxHgen0YqfDv81EZR726krPSisHScLMujI0SnwbcN8IyUwIYqnw663l%2FY9Dhpcje1uM19tGvbMUolrmm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=e3ac9b659bfa216a02ea92c253ba9266a5b9b070361b507a80a8e85611b9a811\" class=\"markdown-inline-image\"></a></p>\n\n<h2 id=\"testing-environment\">Testing environment</h2>\n\n<p>System:</p>\n\n<ul>\n<li>Concrete5 version 8.1.0, installed localy</li>\n<li>PHP ver. 5.6.30</li>\n<li>Apache HTTP Server 2.4.25 for macOS</li>\n<li>MySQL ver. 5.7.13 for macOS</li>\n</ul>\n\n<p>This vulnerability was tested on macOS Sierra 10.12.5 with following browsers:</p>\n\n<ul>\n<li>Chrome 58</li>\n<li>Chromium build 60.0.3104.0</li>\n<li>Safari 10.1.1</li>\n</ul>\n\n<p><strong>XSS Auditor</strong> build in WebKit/Blink based browsers <strong>does not prevent</strong> against this injection. I am pretty sure this vulnerability will work in any browser, in any version including the newest ones.</p>\n\n<h2 id=\"impact\">Impact</h2>\n\n<p>Although this attack vector is internal only (<code>Name</code> attribute is sanitized when displayed on page while browsing the website), there is still possible for malicious user with eg. lower privileges, to inject such payload and trick other user(s) with higher privileges (like site admin) to open infected SEO dialog or Page Search, which will execute payload in such user context. I assume here that Concrete5 CMS is used to build website, where many users have permissions to add or edit content.</p>\n\n<h2 id=\"wrap-up\">Wrap up</h2>\n\n<p>I hope my report will help keep Concrete5 safe in the future.</p>\n\n<p>Best Regards,</p>\n\n<p>Rafal &#39;bl4de&#39; Janicki</p>\n", 
    "severity_rating": "medium", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://www.concrete5.org", 
            "about": "A simple and powerful content management system.", 
            "twitter_handle": "concrete5", 
            "name": "concrete5"
        }, 
        "handle": "concrete5", 
        "url": "https://hackerone.com/concrete5", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/060/622f9171a70969f5b0edaf2c826c92ea6e022fb3_small.jpg?1393279055", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/060/80201c838134b35b9b1acd99ad8a7a7c214aa374_medium.jpg?1393279055"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 60, 
        "default_currency": "usd"
    }, 
    "is_published": false
}