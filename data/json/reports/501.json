{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": null, 
    "voters": [
        "alexbirsan", 
        "juliocesar", 
        "eveeez", 
        "axolotl", 
        "luckydivino", 
        "ak1t4", 
        "mygf", 
        "japz", 
        "spetr0x", 
        "cryptographer", 
        "and 2 more..."
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "7500.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 501, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2014-11-10T17:57:50.850Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "TLS Virtual Host Confusion", 
    "is_member_of_team?": null, 
    "vote_count": 12, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2014-11-10T17:57:39.218Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$7,500", 
    "attachments": [
        {
            "file_name": "Dropbox.avi", 
            "type": "video/x-msvideo", 
            "id": 2387, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/002/387/9be4c05ae17f9361ce72bb8e596fc7090832d61e/Dropbox.avi?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZPLQ5BUN%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T230255Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEBAaDEDfEiV3fKrg6NgnRyK3A7F%2Fgez30Q8XtbjxqPJCCDyrQ1WHG1Ms%2BiNrFhPkOjxdxkFI7%2FmeBoEwld%2BBg%2Fxd80VL0fBmaI1bmWp0zg6aX3Qwij6Juakmq0CD%2BT0VKPI9Mv2HfX3HQxVWEBGpOnXIMa70ybfCeA6ngLfjzZ%2BmAKRvBYchPKl0PwQ8yLr9mwnOCm39lR9j%2B24XxNKqYMYUEJ3NA9k%2Fd7JwpEM3wAt5gmC4rTYUqAbBGTwYgUpmI5BUVoAx6LHPb6Nw7%2FHNfhTTliVzDxrjgf52JrHtXxBegb6ouh6poSiwmNtym3r9MWBqKBOvl070%2F6rDrhs%2FuP0WiKmCwI1JyHbYYbf5AgyM3nZHR5btWT9DfsNecf%2FlxPEGzGCmoCpChk%2Bk2rqFE9irbvPPxk%2Fk10j%2FLL5y5DQ6isQsQrESVRTZhIBbrPPqQPmw9fsoqoRuXpCFXub61Q%2FcyUsaztL6W3IBg%2FAGix7q7Jl7yLTmZ%2BoGw83EZ78riCzaBxqTBlW9CYKaFjAp7bk8eGZHD%2FfvNe7NJxsiAlIaSr73q%2B3Wdi4jOujwLywCLMlAwWzkd2GlleOtLzf5N9Y7lZZwgWkA9icoyMOm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=8b65534f07b280ab0abbd8ef517ee55ef2837b03dda6fdfa6aae87b05b43b697"
        }, 
        {
            "file_name": "CloudFlare.avi", 
            "type": "video/x-msvideo", 
            "id": 2388, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/002/388/b1d769148a8deedcab5e668910fcd6e08c1b244a/CloudFlare.avi?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZPLQ5BUN%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T230255Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEBAaDEDfEiV3fKrg6NgnRyK3A7F%2Fgez30Q8XtbjxqPJCCDyrQ1WHG1Ms%2BiNrFhPkOjxdxkFI7%2FmeBoEwld%2BBg%2Fxd80VL0fBmaI1bmWp0zg6aX3Qwij6Juakmq0CD%2BT0VKPI9Mv2HfX3HQxVWEBGpOnXIMa70ybfCeA6ngLfjzZ%2BmAKRvBYchPKl0PwQ8yLr9mwnOCm39lR9j%2B24XxNKqYMYUEJ3NA9k%2Fd7JwpEM3wAt5gmC4rTYUqAbBGTwYgUpmI5BUVoAx6LHPb6Nw7%2FHNfhTTliVzDxrjgf52JrHtXxBegb6ouh6poSiwmNtym3r9MWBqKBOvl070%2F6rDrhs%2FuP0WiKmCwI1JyHbYYbf5AgyM3nZHR5btWT9DfsNecf%2FlxPEGzGCmoCpChk%2Bk2rqFE9irbvPPxk%2Fk10j%2FLL5y5DQ6isQsQrESVRTZhIBbrPPqQPmw9fsoqoRuXpCFXub61Q%2FcyUsaztL6W3IBg%2FAGix7q7Jl7yLTmZ%2BoGw83EZ78riCzaBxqTBlW9CYKaFjAp7bk8eGZHD%2FfvNe7NJxsiAlIaSr73q%2B3Wdi4jOujwLywCLMlAwWzkd2GlleOtLzf5N9Y7lZZwgWkA9icoyMOm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=7861a9b3854c8bdc41bf22d4a0b1ccfbf680f5674b59eb6c68acb1a902783df0"
        }, 
        {
            "file_name": "Pinterest.avi", 
            "type": "video/x-msvideo", 
            "id": 2389, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/002/389/0a5793eeb02e668e0ba09dba638da660680d03eb/Pinterest.avi?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZPLQ5BUN%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T230255Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEBAaDEDfEiV3fKrg6NgnRyK3A7F%2Fgez30Q8XtbjxqPJCCDyrQ1WHG1Ms%2BiNrFhPkOjxdxkFI7%2FmeBoEwld%2BBg%2Fxd80VL0fBmaI1bmWp0zg6aX3Qwij6Juakmq0CD%2BT0VKPI9Mv2HfX3HQxVWEBGpOnXIMa70ybfCeA6ngLfjzZ%2BmAKRvBYchPKl0PwQ8yLr9mwnOCm39lR9j%2B24XxNKqYMYUEJ3NA9k%2Fd7JwpEM3wAt5gmC4rTYUqAbBGTwYgUpmI5BUVoAx6LHPb6Nw7%2FHNfhTTliVzDxrjgf52JrHtXxBegb6ouh6poSiwmNtym3r9MWBqKBOvl070%2F6rDrhs%2FuP0WiKmCwI1JyHbYYbf5AgyM3nZHR5btWT9DfsNecf%2FlxPEGzGCmoCpChk%2Bk2rqFE9irbvPPxk%2Fk10j%2FLL5y5DQ6isQsQrESVRTZhIBbrPPqQPmw9fsoqoRuXpCFXub61Q%2FcyUsaztL6W3IBg%2FAGix7q7Jl7yLTmZ%2BoGw83EZ78riCzaBxqTBlW9CYKaFjAp7bk8eGZHD%2FfvNe7NJxsiAlIaSr73q%2B3Wdi4jOujwLywCLMlAwWzkd2GlleOtLzf5N9Y7lZZwgWkA9icoyMOm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=887b8eab6d777163657c495d381c598b29d595d7dbec1be1d96e70997acca705"
        }, 
        {
            "file_name": "Akamai2.avi", 
            "type": "video/x-msvideo", 
            "id": 2390, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/002/390/f4ca99cffdcb7a2ac261c020505da8c6965ded8e/Akamai2.avi?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZPLQ5BUN%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T230255Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEBAaDEDfEiV3fKrg6NgnRyK3A7F%2Fgez30Q8XtbjxqPJCCDyrQ1WHG1Ms%2BiNrFhPkOjxdxkFI7%2FmeBoEwld%2BBg%2Fxd80VL0fBmaI1bmWp0zg6aX3Qwij6Juakmq0CD%2BT0VKPI9Mv2HfX3HQxVWEBGpOnXIMa70ybfCeA6ngLfjzZ%2BmAKRvBYchPKl0PwQ8yLr9mwnOCm39lR9j%2B24XxNKqYMYUEJ3NA9k%2Fd7JwpEM3wAt5gmC4rTYUqAbBGTwYgUpmI5BUVoAx6LHPb6Nw7%2FHNfhTTliVzDxrjgf52JrHtXxBegb6ouh6poSiwmNtym3r9MWBqKBOvl070%2F6rDrhs%2FuP0WiKmCwI1JyHbYYbf5AgyM3nZHR5btWT9DfsNecf%2FlxPEGzGCmoCpChk%2Bk2rqFE9irbvPPxk%2Fk10j%2FLL5y5DQ6isQsQrESVRTZhIBbrPPqQPmw9fsoqoRuXpCFXub61Q%2FcyUsaztL6W3IBg%2FAGix7q7Jl7yLTmZ%2BoGw83EZ78riCzaBxqTBlW9CYKaFjAp7bk8eGZHD%2FfvNe7NJxsiAlIaSr73q%2B3Wdi4jOujwLywCLMlAwWzkd2GlleOtLzf5N9Y7lZZwgWkA9icoyMOm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=8de39ff4ffbfe603fe1f52049b4503516d1b231dcf128d9a3fb812c8f759406c"
        }
    ], 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2013-12-04T16:53:15.829Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2013-12-04T16:53:15.829Z", 
            "actor": {
                "username": "arice", 
                "url": "/arice", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/74e2a8a31fee27a0c9b3d1d90dd64f4e38b2fb1c_medium.jpeg?1466604112"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "This is excellent work. We'd be like to help out however we can be of use. A few quick questions:\n\nDo you have a public disclosure timeline or strategy yet? I imagine this might be dependent upon Akamai and other CDNs, but please keep us updated.\n\nI'm interested in brainstorming further mitigation possibilities with a few colleagues. Do we have your permission to share this confidentially? \n\n> By default, a request received over TLS with an unrecognized Host header should be immediately rejected.\n\nI agree that this is an effective solution, but I suspect it might be a contentious change. Have you discussed this proposed mitigation with any of the popular web servers?", 
            "markdown_message": "<p>This is excellent work. We&#39;d be like to help out however we can be of use. A few quick questions:</p>\n\n<p>Do you have a public disclosure timeline or strategy yet? I imagine this might be dependent upon Akamai and other CDNs, but please keep us updated.</p>\n\n<p>I&#39;m interested in brainstorming further mitigation possibilities with a few colleagues. Do we have your permission to share this confidentially? </p>\n\n<blockquote>\n<p>By default, a request received over TLS with an unrecognized Host header should be immediately rejected.</p>\n</blockquote>\n\n<p>I agree that this is an effective solution, but I suspect it might be a contentious change. Have you discussed this proposed mitigation with any of the popular web servers?</p>\n", 
            "type": "Activities::Comment", 
            "id": 2955, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2013-12-04T18:28:40.936Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2013-12-04T18:28:40.936Z", 
            "actor": {
                "username": "adl", 
                "url": "/adl", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "Thank you for your support.\n\n>Do you have a public disclosure timeline or strategy yet?\n> I imagine this might be dependent upon Akamai and other CDNs, but please keep us updated.\n\nWe expect that this class of attacks will be difficult to fix easily. At this point, we plan to discuss it in a submission to the USENIX Security conference which takes place in August (alternatively, if we struggle to convince websites that this is an issue, we may go for a venue with better media coverage, like Defcon, also in the summer). This should leave sufficient time to get CDNs and large websites fixed\n\n>I'm interested in brainstorming further mitigation possibilities with a few colleagues. Do we have your permission to share this confidentially?\n\nYes, as long as usual disclosure practices are followed it is most likely a good idea to get early awareness in organizations such as Facebook. I have been discussing this class of attack with some Microsoft Research people as well (in fact, I theorized the attack when I was an intern at MSR this summer).\n\n>I agree that this is an effective solution, but I suspect it might be a contentious change. Have you discussed this proposed mitigation with any of the popular web servers?\n\nI'm afraid you may be right. While we do have some contacts in the top Internet organizations I'm afraid we have none when it comes to HTTP servers. We were hoping you could assist in that regard (since you advertise nginx and Apache in your program), as we feel that any solution to this problem will involve them.", 
            "markdown_message": "<p>Thank you for your support.</p>\n\n<blockquote>\n<p>Do you have a public disclosure timeline or strategy yet?<br>\nI imagine this might be dependent upon Akamai and other CDNs, but please keep us updated.</p>\n</blockquote>\n\n<p>We expect that this class of attacks will be difficult to fix easily. At this point, we plan to discuss it in a submission to the USENIX Security conference which takes place in August (alternatively, if we struggle to convince websites that this is an issue, we may go for a venue with better media coverage, like Defcon, also in the summer). This should leave sufficient time to get CDNs and large websites fixed</p>\n\n<blockquote>\n<p>I&#39;m interested in brainstorming further mitigation possibilities with a few colleagues. Do we have your permission to share this confidentially?</p>\n</blockquote>\n\n<p>Yes, as long as usual disclosure practices are followed it is most likely a good idea to get early awareness in organizations such as Facebook. I have been discussing this class of attack with some Microsoft Research people as well (in fact, I theorized the attack when I was an intern at MSR this summer).</p>\n\n<blockquote>\n<p>I agree that this is an effective solution, but I suspect it might be a contentious change. Have you discussed this proposed mitigation with any of the popular web servers?</p>\n</blockquote>\n\n<p>I&#39;m afraid you may be right. While we do have some contacts in the top Internet organizations I&#39;m afraid we have none when it comes to HTTP servers. We were hoping you could assist in that regard (since you advertise nginx and Apache in your program), as we feel that any solution to this problem will involve them.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2957, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2013-12-05T01:21:01.229Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2013-12-05T01:21:01.229Z", 
            "actor": {
                "username": "agl", 
                "url": "/agl", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": null, 
            "markdown_message": "", 
            "type": "Activities::ExternalUserJoined", 
            "id": 2966, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2013-12-05T01:28:16.086Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2013-12-05T01:28:16.086Z", 
            "actor": {
                "username": "agl", 
                "url": "/agl", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "This is great work. While the attack in general is not new (see [1] for example) you clearly have some high-profile examples and, obviously, the issue could do with some extra publicity!\n\nIf you need security contacts at Twitter, Akamai, Cloudflare, Paypal or Microsoft I can help.\n\nIf you want a security contact at Apache, I work with Ben Laurie. (Although he's currently traveling.)\n\n[1] http://ha.ckers.org/blog/20100822/mitm-dns-rebinding-ssltls-wildcards-and-xss/", 
            "markdown_message": "<p>This is great work. While the attack in general is not new (see [1] for example) you clearly have some high-profile examples and, obviously, the issue could do with some extra publicity!</p>\n\n<p>If you need security contacts at Twitter, Akamai, Cloudflare, Paypal or Microsoft I can help.</p>\n\n<p>If you want a security contact at Apache, I work with Ben Laurie. (Although he&#39;s currently traveling.)</p>\n\n<p>[1] <a title=\"http://ha.ckers.org/blog/20100822/mitm-dns-rebinding-ssltls-wildcards-and-xss/\" href=\"/redirect?signature=d3e02340112bf7295e7aa43b5ad15b7d1eb30151&amp;url=http%3A%2F%2Fha.ckers.org%2Fblog%2F20100822%2Fmitm-dns-rebinding-ssltls-wildcards-and-xss%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://ha.ckers.org/blog/20100822/mitm-dns-rebinding-ssltls-wildcards-and-xss/</span><i class=\"icon-external-link\"></i></a></p>\n", 
            "type": "Activities::Comment", 
            "id": 2967, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2013-12-05T22:22:05.482Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2013-12-05T22:22:05.482Z", 
            "actor": {
                "username": "adl", 
                "url": "/adl", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "We meet again, agl. I have contacted Rich Salz at Akamai but didn't get an answer yet. Do you know anyone else there?\n\nI think getting Ben Laurie's opinion on the possibility of changing the host fallback mechanism would be valuable. A fix could possibly help against attacks related to non-sanitized use of $_SERVER['HTTP_HOST'] by a malicious client (I think this was used against some password recovery scripts?).", 
            "markdown_message": "<p>We meet again, agl. I have contacted Rich Salz at Akamai but didn&#39;t get an answer yet. Do you know anyone else there?</p>\n\n<p>I think getting Ben Laurie&#39;s opinion on the possibility of changing the host fallback mechanism would be valuable. A fix could possibly help against attacks related to non-sanitized use of $_SERVER[&#39;HTTP_HOST&#39;] by a malicious client (I think this was used against some password recovery scripts?).</p>\n", 
            "type": "Activities::Comment", 
            "id": 2987, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2013-12-05T22:28:54.184Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2013-12-05T22:28:54.184Z", 
            "actor": {
                "username": "agl", 
                "url": "/agl", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "I've sent an introduction email to yourself and a decent contact at Akamai for SSL matters.\n\nI'll contact Ben about this too.", 
            "markdown_message": "<p>I&#39;ve sent an introduction email to yourself and a decent contact at Akamai for SSL matters.</p>\n\n<p>I&#39;ll contact Ben about this too.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2988, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2013-12-06T08:25:06.603Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2013-12-06T08:25:06.603Z", 
            "actor": {
                "username": "arice", 
                "url": "/arice", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/74e2a8a31fee27a0c9b3d1d90dd64f4e38b2fb1c_medium.jpeg?1466604112"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "Having an `agl` and an `adl` on this thread is kicking my dyslexia into overtime. :) adl, let me know if you don't make progress Akamai. We have good contacts on their security team that we can escalate through as well. \n\nAdditionally: \n\nI'll intro you to Maxim at Nginx for their thoughts on potential mitigations.\n\nHave you had successful contact with CloudFlare? Seems like a hopefully easy fix on their end and we can put you in touch.\n\nWe're also undergoing an audit of our hosts at Facebook. While we have not identified any vulnerable hosts yet, we've had a few close calls that make us uncomfortable. We'll let you know if any exploitable cases turn up.", 
            "markdown_message": "<p>Having an <code>agl</code> and an <code>adl</code> on this thread is kicking my dyslexia into overtime. :) adl, let me know if you don&#39;t make progress Akamai. We have good contacts on their security team that we can escalate through as well. </p>\n\n<p>Additionally: </p>\n\n<p>I&#39;ll intro you to Maxim at Nginx for their thoughts on potential mitigations.</p>\n\n<p>Have you had successful contact with CloudFlare? Seems like a hopefully easy fix on their end and we can put you in touch.</p>\n\n<p>We&#39;re also undergoing an audit of our hosts at Facebook. While we have not identified any vulnerable hosts yet, we&#39;ve had a few close calls that make us uncomfortable. We&#39;ll let you know if any exploitable cases turn up.</p>\n", 
            "type": "Activities::Comment", 
            "id": 3000, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2013-12-06T14:16:59.379Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2013-12-06T14:16:59.379Z", 
            "actor": {
                "username": "adl", 
                "url": "/adl", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "Thanks arice. I don't remember finding a bad host at Facebook but my search was far from exhaustive. It seems that CDN related queries have been moved to fbcdn.net, which is good both for security and performance. There is still one CDN wildcard certificate on the facebook.com origin at 2.20.242.132 that you may want to get rid of.\n\nFor CloudFlare, we haven't contacted them yet since I am still checking some strange features they have (e.g. \"host override\", which seems quite dodgy). I think the difficulty of getting one's domain removed from CloudFlare certificates has been pointed out before - it would be nice to convince them to change this aspect of their operation as well. The redirection to HTTP problem should indeed be easy to solve.\n\nGoing back to the attack, there is another interesting aspect that we have yet to investigate. It is now increasingly common to set up shared TLS session caches for performance. For instance, the Google terminator design uses the same encryption key for all TLS tickets, regardless of certificate or SNI. This is somewhat OK as long as the routing is only based on the Host header, and the fallback for unknown hosts is safe and uniform on all terminators (and the key changes sometimes for forward secrecy).\nHowever, it could be dangerous if customer-uploaded certificates (e.g. for appspot domains) used the same ticket keys (I couldn't test this since \"virtual IP\" certificates require a paid account, but it's worth checking). If two servers use the same ticket key but different certificates (regardless of SNI), a confusion attack remains possible despite the name mismatch because resumption will ignore the different certificate. TLS-level authentication features may also be bad there. It would be interesting to find a DNS rebinding attack that relies on a shared session cache.\n", 
            "markdown_message": "<p>Thanks arice. I don&#39;t remember finding a bad host at Facebook but my search was far from exhaustive. It seems that CDN related queries have been moved to fbcdn.net, which is good both for security and performance. There is still one CDN wildcard certificate on the facebook.com origin at 2.20.242.132 that you may want to get rid of.</p>\n\n<p>For CloudFlare, we haven&#39;t contacted them yet since I am still checking some strange features they have (e.g. &quot;host override&quot;, which seems quite dodgy). I think the difficulty of getting one&#39;s domain removed from CloudFlare certificates has been pointed out before - it would be nice to convince them to change this aspect of their operation as well. The redirection to HTTP problem should indeed be easy to solve.</p>\n\n<p>Going back to the attack, there is another interesting aspect that we have yet to investigate. It is now increasingly common to set up shared TLS session caches for performance. For instance, the Google terminator design uses the same encryption key for all TLS tickets, regardless of certificate or SNI. This is somewhat OK as long as the routing is only based on the Host header, and the fallback for unknown hosts is safe and uniform on all terminators (and the key changes sometimes for forward secrecy).<br>\nHowever, it could be dangerous if customer-uploaded certificates (e.g. for appspot domains) used the same ticket keys (I couldn&#39;t test this since &quot;virtual IP&quot; certificates require a paid account, but it&#39;s worth checking). If two servers use the same ticket key but different certificates (regardless of SNI), a confusion attack remains possible despite the name mismatch because resumption will ignore the different certificate. TLS-level authentication features may also be bad there. It would be interesting to find a DNS rebinding attack that relies on a shared session cache.</p>\n", 
            "type": "Activities::Comment", 
            "id": 3007, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2013-12-14T00:17:36.119Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2013-12-14T00:28:49.296Z", 
            "actor": {
                "username": "adl", 
                "url": "/adl", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "The fix for Akamai is deployed on most of their PoPs now. The other vendors we contacted have been responsive; in particular Dropbox has been already fixed.\r\n\r\nGoing back to my certificate/session discussion above, as I suspected, I found several instances where I can break the same origin policy between domains served behind the same load balancer. For instance, the low-trust git.mozilla.org [63.245.215.69] shares the same session cache (but not certificate) as the high-trust bugzilla.mozilla.org. [63.245.215.80]. Thus, if the user connects to bugzilla.mozilla.org and caches a session, the attacker may rebind it to git.mozilla.org's IP. The session will be resumed (bypassing certificate validation) and the Host header ignored, returning the (potentially malicious) files from git.mozilla.org. (I suggest checking all the Google terminators for their fallback behavior as their design is perfect for this attack - in particular, the user-submitted appspot certificates must not share sessions with other Google services).\r\n\r\nThe above attack suggests a TLS-level mitigation: SNI should be included in the session cache/ticket, and it should not be possible to resume a session whose SNI doesn't match the server's cached/decrypted SNI. In other words, resumption should fail in the following case:\r\n\r\nopenssl s_client -servername www.google.com -sess_out session.bin -connect www.google.com:443\r\nopenssl s_client -servername www.youtube.com -sess_in session.bin -connect www.youtube.com:443", 
            "markdown_message": "<p>The fix for Akamai is deployed on most of their PoPs now. The other vendors we contacted have been responsive; in particular Dropbox has been already fixed.</p>\n\n<p>Going back to my certificate/session discussion above, as I suspected, I found several instances where I can break the same origin policy between domains served behind the same load balancer. For instance, the low-trust git.mozilla.org [63.245.215.69] shares the same session cache (but not certificate) as the high-trust bugzilla.mozilla.org. [63.245.215.80]. Thus, if the user connects to bugzilla.mozilla.org and caches a session, the attacker may rebind it to git.mozilla.org&#39;s IP. The session will be resumed (bypassing certificate validation) and the Host header ignored, returning the (potentially malicious) files from git.mozilla.org. (I suggest checking all the Google terminators for their fallback behavior as their design is perfect for this attack - in particular, the user-submitted appspot certificates must not share sessions with other Google services).</p>\n\n<p>The above attack suggests a TLS-level mitigation: SNI should be included in the session cache/ticket, and it should not be possible to resume a session whose SNI doesn&#39;t match the server&#39;s cached/decrypted SNI. In other words, resumption should fail in the following case:</p>\n\n<p>openssl s_client -servername <a href=\"/redirect?signature=43cd652c2f1835df993825d00bed0660f498fc42&amp;url=http%3A%2F%2Fwww.google.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>www.google.com</span><i class=\"icon-external-link\"></i></a> -sess_out session.bin -connect <a href=\"/redirect?signature=fd5e0aae38be77b56663947fa1d562e94351ac3c&amp;url=http%3A%2F%2Fwww.google.com%3A443\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>www.google.com:443</span><i class=\"icon-external-link\"></i></a><br>\nopenssl s_client -servername <a href=\"/redirect?signature=0023d2275d95941a17c9632b0293d4edf44b8e96&amp;url=http%3A%2F%2Fwww.youtube.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>www.youtube.com</span><i class=\"icon-external-link\"></i></a> -sess_in session.bin -connect <a href=\"/redirect?signature=39a296d06975624f1cd7d545fc1a15479a8dff8d&amp;url=http%3A%2F%2Fwww.youtube.com%3A443\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>www.youtube.com:443</span><i class=\"icon-external-link\"></i></a></p>\n", 
            "type": "Activities::Comment", 
            "id": 3103, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2013-12-14T00:30:35.409Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2013-12-14T00:30:35.409Z", 
            "actor": {
                "username": "arice", 
                "url": "/arice", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/74e2a8a31fee27a0c9b3d1d90dd64f4e38b2fb1c_medium.jpeg?1466604112"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "Glad to see Akamai resolved! Do you still need a CloudFlare contact? I'll intro whenever you're ready.", 
            "markdown_message": "<p>Glad to see Akamai resolved! Do you still need a CloudFlare contact? I&#39;ll intro whenever you&#39;re ready.</p>\n", 
            "type": "Activities::Comment", 
            "id": 3104, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2013-12-14T00:44:20.644Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2013-12-14T00:44:20.644Z", 
            "actor": {
                "username": "adl", 
                "url": "/adl", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "I'm glad Akamai is fixed as well. Who knows who could have exploited this in the past 10 years. I am still interested in a contact at CloudFlare.\n\nAs a bonus, here is a (stupid) attack against Google:\n\n1. User goes to https://www.google.com. Session is created and cached\n2. User searches for \"Kim Jong-un dictator\". The request will look like https://www.google.com/#q=Kim+Jong-un+dictator\n3. In the mean time, attacker points www.google.com to 70.32.146.212 with a TTL of 0\n4. The previous session is resumed and the request redirects to http://www.google.com/doubleclick\n5. Attacker now points www.google.com to his own server and returns a page that reads document.hash\n6. User is executed without trial\n\n", 
            "markdown_message": "<p>I&#39;m glad Akamai is fixed as well. Who knows who could have exploited this in the past 10 years. I am still interested in a contact at CloudFlare.</p>\n\n<p>As a bonus, here is a (stupid) attack against Google:</p>\n\n<ol>\n<li>User goes to <a title=\"https://www.google.com\" href=\"/redirect?signature=79f3a459d963ecc739dc49fefb4790b5bcfb1dcc&amp;url=https%3A%2F%2Fwww.google.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.google.com</span><i class=\"icon-external-link\"></i></a>. Session is created and cached</li>\n<li>User searches for &quot;Kim Jong-un dictator&quot;. The request will look like <a title=\"https://www.google.com/#q=Kim+Jong-un+dictator\" href=\"/redirect?signature=5eb5b2adb379856362d88ae21b6a240d6672c74c&amp;url=https%3A%2F%2Fwww.google.com%2F%23q%3DKim%2BJong-un%2Bdictator\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.google.com/#q=Kim+Jong-un+dictator</span><i class=\"icon-external-link\"></i></a>\n</li>\n<li>In the mean time, attacker points <a href=\"/redirect?signature=43cd652c2f1835df993825d00bed0660f498fc42&amp;url=http%3A%2F%2Fwww.google.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>www.google.com</span><i class=\"icon-external-link\"></i></a> to 70.32.146.212 with a TTL of 0</li>\n<li>The previous session is resumed and the request redirects to <a title=\"http://www.google.com/doubleclick\" href=\"/redirect?signature=0fbd171f8acebff2a256707e8e723d436f28ea6a&amp;url=http%3A%2F%2Fwww.google.com%2Fdoubleclick\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://www.google.com/doubleclick</span><i class=\"icon-external-link\"></i></a>\n</li>\n<li>Attacker now points <a href=\"/redirect?signature=43cd652c2f1835df993825d00bed0660f498fc42&amp;url=http%3A%2F%2Fwww.google.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>www.google.com</span><i class=\"icon-external-link\"></i></a> to his own server and returns a page that reads document.hash</li>\n<li>User is executed without trial</li>\n</ol>\n", 
            "type": "Activities::Comment", 
            "id": 3105, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2013-12-16T17:22:13.871Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2013-12-16T17:22:13.871Z", 
            "actor": {
                "username": "agl", 
                "url": "/agl", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "I'll sort out a contact at CloudFlare for you.\n\nr.e. your Google attack: there are some cases where our session cache and routing could be tighter but I don't think you're specific example works. The Doubleclick servers (e.g. 70.32.146.212) do not have a certificate for www.google.com and don't share a session cache.\n\nAlthough, on the other hand, it's much worse than that because we have a documented method for downgrading HTTPS connections to www.google.com: https://support.google.com/websearch/answer/186669?hl=en (see Option 3).", 
            "markdown_message": "<p>I&#39;ll sort out a contact at CloudFlare for you.</p>\n\n<p>r.e. your Google attack: there are some cases where our session cache and routing could be tighter but I don&#39;t think you&#39;re specific example works. The Doubleclick servers (e.g. 70.32.146.212) do not have a certificate for <a href=\"/redirect?signature=43cd652c2f1835df993825d00bed0660f498fc42&amp;url=http%3A%2F%2Fwww.google.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>www.google.com</span><i class=\"icon-external-link\"></i></a> and don&#39;t share a session cache.</p>\n\n<p>Although, on the other hand, it&#39;s much worse than that because we have a documented method for downgrading HTTPS connections to <a href=\"/redirect?signature=43cd652c2f1835df993825d00bed0660f498fc42&amp;url=http%3A%2F%2Fwww.google.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>www.google.com:</span><i class=\"icon-external-link\"></i></a> <a title=\"https://support.google.com/websearch/answer/186669?hl=en\" href=\"/redirect?signature=c0a2a70c4502c755fe15e7a1cc31430f2fd8831c&amp;url=https%3A%2F%2Fsupport.google.com%2Fwebsearch%2Fanswer%2F186669%3Fhl%3Den\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://support.google.com/websearch/answer/186669?hl=en</span><i class=\"icon-external-link\"></i></a> (see Option 3).</p>\n", 
            "type": "Activities::Comment", 
            "id": 3130, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2013-12-16T17:31:06.622Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2013-12-16T17:31:06.622Z", 
            "actor": {
                "username": "adl", 
                "url": "/adl", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "Thank you for your contact at CloudFlare. You are right about my previous message, this doubleclick.net server does not share cache with other Google services, unlike www.doubleclick.net somehow. Still, the idea is interesting and it does apply to Mozilla and Amazon, which we contacted.", 
            "markdown_message": "<p>Thank you for your contact at CloudFlare. You are right about my previous message, this doubleclick.net server does not share cache with other Google services, unlike <a href=\"/redirect?signature=fd76156c6612d4bcb7b35cf8c000fd95cae8199d&amp;url=http%3A%2F%2Fwww.doubleclick.net\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>www.doubleclick.net</span><i class=\"icon-external-link\"></i></a> somehow. Still, the idea is interesting and it does apply to Mozilla and Amazon, which we contacted.</p>\n", 
            "type": "Activities::Comment", 
            "id": 3131, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2013-12-16T18:17:01.723Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2013-12-16T18:17:01.723Z", 
            "actor": {
                "username": "adl", 
                "url": "/adl", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "P.S. the downgrade to HTTP \"feature\" on nosslsearch.google.com is simply shocking. It means that the attack above is essentially built into Google. Surely, someone must have realized that the DNS change could be done on a malicious network? Is it OK if I point out that one's search terms on Google can be exposed to an attacker controlling the DNS for the sake of controlling the use of Google at school in our Usenix paper?", 
            "markdown_message": "<p>P.S. the downgrade to HTTP &quot;feature&quot; on nosslsearch.google.com is simply shocking. It means that the attack above is essentially built into Google. Surely, someone must have realized that the DNS change could be done on a malicious network? Is it OK if I point out that one&#39;s search terms on Google can be exposed to an attacker controlling the DNS for the sake of controlling the use of Google at school in our Usenix paper?</p>\n", 
            "type": "Activities::Comment", 
            "id": 3133, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2013-12-16T18:24:38.354Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2013-12-16T18:24:38.354Z", 
            "actor": {
                "username": "arice", 
                "url": "/arice", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/74e2a8a31fee27a0c9b3d1d90dd64f4e38b2fb1c_medium.jpeg?1466604112"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "adl - just sent you a CloudFlare intro.", 
            "markdown_message": "<p>adl - just sent you a CloudFlare intro.</p>\n", 
            "type": "Activities::Comment", 
            "id": 3134, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2013-12-16T18:46:54.105Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2013-12-16T18:46:54.105Z", 
            "actor": {
                "username": "agl", 
                "url": "/agl", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "The nosslsearch option is publicly documented - there's nothing secret about it. (You can imagine how security folks at Google feel about it.)", 
            "markdown_message": "<p>The nosslsearch option is publicly documented - there&#39;s nothing secret about it. (You can imagine how security folks at Google feel about it.)</p>\n", 
            "type": "Activities::Comment", 
            "id": 3135, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-01-09T17:06:07.772Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-01-09T17:06:07.772Z", 
            "actor": {
                "username": "adl", 
                "url": "/adl", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "I think I am done notifying all of the Alexa top 50 websites that I found were vulnerable to some flavor of the attack. Interestingly, there are many cases where I found a redirect-to-HTTP vulnerability but didn't report it because the website is not using TLS well enough for it to make any difference. Typically, such websites had registered an OAuth origin over HTTP (e.g. tumblr.com, huffingtonpost.com, imgur.com, imdb.com, etsy.com...), or the TLS pages could be worked around by easier means.", 
            "markdown_message": "<p>I think I am done notifying all of the Alexa top 50 websites that I found were vulnerable to some flavor of the attack. Interestingly, there are many cases where I found a redirect-to-HTTP vulnerability but didn&#39;t report it because the website is not using TLS well enough for it to make any difference. Typically, such websites had registered an OAuth origin over HTTP (e.g. tumblr.com, huffingtonpost.com, imgur.com, imdb.com, etsy.com...), or the TLS pages could be worked around by easier means.</p>\n", 
            "type": "Activities::Comment", 
            "id": 3401, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-04-10T01:54:27.448Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-04-10T01:54:27.448Z", 
            "actor": {
                "username": "arice", 
                "url": "/arice", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/74e2a8a31fee27a0c9b3d1d90dd64f4e38b2fb1c_medium.jpeg?1466604112"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "@adl - has your team finalized plans for public disclosure yet? Still August? I'd like to nominate this research for an IBB reward once it's public, so keep us in the loop. Thanks! ", 
            "markdown_message": "<p><a href=\"/adl\">@adl</a> - has your team finalized plans for public disclosure yet? Still August? I&#39;d like to nominate this research for an IBB reward once it&#39;s public, so keep us in the loop. Thanks! </p>\n", 
            "type": "Activities::Comment", 
            "id": 27646, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-04-12T06:31:32.214Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-04-12T06:31:32.214Z", 
            "actor": {
                "username": "adl", 
                "url": "/adl", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "@arice: yes, as I said in my initial report we've decided that the best venue for this was actually Black Hat, mostly to put some pressure on Apache and Nginx to change the vhost fallback behavior. Academically, it was submitted to ESORICS, you may be interested in looking at my draft:\nhttps://mega.co.nz/#!y1JRyZ6K!5hwL0NBnSyI8l6XRtDmwYh4upKs4t_OnDbOtagMshzk\n\nI would appreciate if you could put some pressure on the websites in my previous post that have registered HTTP token origins with Facebook to change their ways. Both in the paper and presentation, I may have to make some unpleasant comments about the security of OAuth 2.0 and OpenID tokens. I might even consider demonstrating some live demos against websites that showed little interest in fixing the issues we reported.\n", 
            "markdown_message": "<p><a href=\"/arice\">@arice</a>: yes, as I said in my initial report we&#39;ve decided that the best venue for this was actually Black Hat, mostly to put some pressure on Apache and Nginx to change the vhost fallback behavior. Academically, it was submitted to ESORICS, you may be interested in looking at my draft:<br>\n<a title=\"https://mega.co.nz/#!y1JRyZ6K!5hwL0NBnSyI8l6XRtDmwYh4upKs4t_OnDbOtagMshzk\" href=\"/redirect?signature=2d6f373e0c0a1e8d8d5115c95ce7c6e477a9c3cb&amp;url=https%3A%2F%2Fmega.co.nz%2F%23%21y1JRyZ6K%215hwL0NBnSyI8l6XRtDmwYh4upKs4t_OnDbOtagMshzk\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://mega.co.nz/#!y1JRyZ6K!5hwL0NBnSyI8l6XRtDmwYh4upKs4t_OnDbOtagMshzk</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>I would appreciate if you could put some pressure on the websites in my previous post that have registered HTTP token origins with Facebook to change their ways. Both in the paper and presentation, I may have to make some unpleasant comments about the security of OAuth 2.0 and OpenID tokens. I might even consider demonstrating some live demos against websites that showed little interest in fixing the issues we reported.</p>\n", 
            "type": "Activities::Comment", 
            "id": 29207, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-08-06T21:15:31.603Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-08-06T21:15:31.603Z", 
            "actor": {
                "username": "adl", 
                "url": "/adl", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "This can go public now. My slides are at https://bh.ht.vc and the whitepaper will be on the Black Hat website shortly. Thanks for your support getting this fixed guys. I'm relieved a SPDY disaster was narrowly averted.", 
            "markdown_message": "<p>This can go public now. My slides are at <a title=\"https://bh.ht.vc\" href=\"/redirect?signature=56c8e0bd6aeaceffb2aae1f14be11cce9234d8eb&amp;url=https%3A%2F%2Fbh.ht.vc\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://bh.ht.vc</span><i class=\"icon-external-link\"></i></a> and the whitepaper will be on the Black Hat website shortly. Thanks for your support getting this fixed guys. I&#39;m relieved a SPDY disaster was narrowly averted.</p>\n", 
            "type": "Activities::Comment", 
            "id": 101601, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-11-07T12:07:36.339Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-11-07T12:07:36.339Z", 
            "actor": {
                "username": "adl", 
                "url": "/adl", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "Hi Alex, can you please make this public as I do cite this report in a paper that will appear soon. Thanks!", 
            "markdown_message": "<p>Hi Alex, can you please make this public as I do cite this report in a paper that will appear soon. Thanks!</p>\n", 
            "type": "Activities::Comment", 
            "id": 156730, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-11-07T19:05:22.358Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-11-07T19:05:22.358Z", 
            "actor": {
                "username": "arice", 
                "url": "/arice", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/74e2a8a31fee27a0c9b3d1d90dd64f4e38b2fb1c_medium.jpeg?1466604112"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "Ouch. I dropped the ball by missing your last comment - my inbox was a bit crazy the week of August 6th. I'll get this up for a panel vote and made public ASAP.", 
            "markdown_message": "<p>Ouch. I dropped the ball by missing your last comment - my inbox was a bit crazy the week of August 6th. I&#39;ll get this up for a panel vote and made public ASAP.</p>\n", 
            "type": "Activities::Comment", 
            "id": 157012, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-11-07T19:05:31.619Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-11-07T19:05:31.619Z", 
            "actor": {
                "username": "arice", 
                "url": "/arice", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/74e2a8a31fee27a0c9b3d1d90dd64f4e38b2fb1c_medium.jpeg?1466604112"
                }, 
                "hackerone_triager": false
            }, 
            "additional_data": {
                "new_title": "TLS Virtual Host Confusion", 
                "old_title": "DNS rebinding attacks against TLS"
            }, 
            "team_handle": "internet", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportTitleUpdated", 
            "id": 157013, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-11-08T10:49:06.889Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-11-08T10:49:06.889Z", 
            "actor": {
                "username": "adl", 
                "url": "/adl", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "No worries, I should have insisted back then but I too was of course busy with other things.", 
            "markdown_message": "<p>No worries, I should have insisted back then but I too was of course busy with other things.</p>\n", 
            "type": "Activities::Comment", 
            "id": 157367, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "adl", 
                "url": "/adl"
            }, 
            "created_at": "2014-11-10T17:57:01.965Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-11-10T17:57:01.965Z", 
            "actor": {
                "username": "arice", 
                "url": "/arice", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/74e2a8a31fee27a0c9b3d1d90dd64f4e38b2fb1c_medium.jpeg?1466604112"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugResolved", 
            "id": 158048, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2014-11-10T17:57:13.849Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-11-10T17:57:13.849Z", 
            "actor": {
                "url": "/internet", 
                "profile": {
                    "name": "The Internet"
                }, 
                "ibb": true, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/38e952fcff2c0aae0d011d5cecd07e5f62ecbd63_medium.png?1383767658"
                }
            }, 
            "team_handle": "internet", 
            "bounty_amount": "7500.0", 
            "collaborator": {
                "username": "adl", 
                "url": "/adl"
            }, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BountyAwarded", 
            "id": 158049, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-11-10T17:57:50.867Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-11-10T17:57:50.867Z", 
            "actor": {
                "username": "arice", 
                "url": "/arice", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/74e2a8a31fee27a0c9b3d1d90dd64f4e38b2fb1c_medium.jpeg?1466604112"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 158051, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-11-10T17:57:51.123Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-11-10T17:57:51.123Z", 
            "actor": {
                "username": "arice", 
                "url": "/arice", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/74e2a8a31fee27a0c9b3d1d90dd64f4e38b2fb1c_medium.jpeg?1466604112"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 158052, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "adl", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/adl", 
        "profile_picture_urls": {
            "small": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
        }, 
        "is_me?": false
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -128495116.29659633, 
    "disclosed_at": "2014-11-10T17:57:51.107Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/501", 
    "created_at": "2013-12-04T14:17:56.532Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>I am a security researcher at INRIA Paris in team PROSECCO (<a title=\"http://prosecco.inria.fr\" href=\"/redirect?signature=169d714c845b3a3b597c07057e6e23f6d49ec71c&amp;url=http%3A%2F%2Fprosecco.inria.fr\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://prosecco.inria.fr</span><i class=\"icon-external-link\"></i></a>)</p>\n\n<p>We have been investigating a new class of attacks against the deployment of TLS on the Web. The main idea behind these attacks is that when two servers host different domains but share the same certificate (which covers both), an attacker that controls the DNS can redirect the first domain to the second server.</p>\n\n<p>If the second server does not reject the unrecognized request meant for the first domain, there is a risk that the two domains may be confused. For instance, if the server treats the request as if it was meant for the second domain, and the adversary controls at least part of this domain, he may be able to completely impersonate the first domain (at the HTTP level, which is much stronger than an XSS attack).</p>\n\n<p>The main issue is the behavior of all HTTP servers when they receive a request with an unrecognized Host header. If there one of the virtual hosts is marked as default in the configuration, it will be used (even if it doesn&#39;t match the configured domain). We argue that this behavior is too dangerous when the server is used for HTTPS with a certificate that may cover names that are not served by this  server (including wildcard certificates, which may cover unknown domains).</p>\n\n<p>Whether an attack is possible depends on the default virtual host. We found several possible scenarios with different impact levels:</p>\n\n<ol>\n<li><p>If the second server is controlled by the attacker (who doesn&#39;t have the private key of the certificate), it is possible to completely impersonate other domains in the certificate. This may seem like an unlikely scenario, but it does occur in practice for content delivery networks. In particular, we found that the fallback host for all Akamai servers allow proxying to attacker servers. This leads to complete HTTP-level impersonation of many high-profile websites. We show in the attached video how to impersonate and steal secure/httpOnly cookies from Twitter, LinkedIn, PayPal, CNN, Microsoft, Apple... Because of the particular severity of the attack against Akamai we have contacted them directly about the problem.</p></li>\n<li><p>If the default host of the second server contains a page controlled by the attacker (or vulnerable to an XSS). Then, it can be translated to an Origin hijack/XSS attack on the other domain. Again, this may seem like an unlikely scenario. However, even if the attacker controlled page or XSS is only present on the attacker&#39;s account, a DNS attacker can always force his session on the client before sending him to his malicious page. We found several instances of this attack, most notably on websites that allow user to store files on their accounts. We made a proof of concept video against Dropbox, which is attached to this report.</p></li>\n<li><p>If the default host on the second server redirects unrecognized requests to HTTP, an attacker is able to access any URI that the user tries to access over HTTPS on the first domain. This is by far the most widespread behavior - we found several thousand such servers by sending requests to web servers for hosts covered by their certificate but not served locally. A typical way to exploit this attack is to target OAuth tokens. We made two proofs of concept of this attack: the first against Pinterest and the second against CloudFlare. It is worth mentioning that most often, the HTTP redirection points to the second domain (which the attacker can redirect to his own server by DNS) - even if the first domain is protected by HSTS, the redirection may proceed when the second domain isn&#39;t. The case of CloudFlare is interesting because they issue certificates valid for 20+ domains of their customers, and even if they cancel the service, their domain can remain in a CloudFlare certificate for months (or years). Furthermore, CloudFlare always redirects requests for former customers to HTTP - thus honest and well configured websites that are no longer served by CloudFlare can be compromised.</p></li>\n</ol>\n\n<p>All of the attacks above only assume that the attacker controls the DNS, which is well within the threat model of TLS. There exists a variant for servers configured with SNI-based virtual hosts: a network attacker can downgrade a connection to SSL3 which causes the SNI to be removed. The request will go to the default virtual host with the same potential attacks as above. Because SNI is not widely used, we did not find a real-world example of this variant.</p>\n\n<p>The difficult question is how to prevent this class of attacks. Configuring a default virtual host that only returns an HTTP error does prevent the attacks, but there are thousands of vulnerable servers and it is not reasonable to assume that webmasters will configure their servers correctly.</p>\n\n<p>Instead, I propose a coordinated change in HTTP server behavior. By default, a request received over TLS with an unrecognized Host header should be immediately rejected. There would be an option to enable the previous behavior, but it should precisely document the risks of allowing arbitrary Host values, in particular when they are covered by the TLS certificate.</p>\n", 
    "vulnerability_information": "I am a security researcher at INRIA Paris in team PROSECCO (http://prosecco.inria.fr)\r\n\r\nWe have been investigating a new class of attacks against the deployment of TLS on the Web. The main idea behind these attacks is that when two servers host different domains but share the same certificate (which covers both), an attacker that controls the DNS can redirect the first domain to the second server.\r\n\r\nIf the second server does not reject the unrecognized request meant for the first domain, there is a risk that the two domains may be confused. For instance, if the server treats the request as if it was meant for the second domain, and the adversary controls at least part of this domain, he may be able to completely impersonate the first domain (at the HTTP level, which is much stronger than an XSS attack).\r\n\r\nThe main issue is the behavior of all HTTP servers when they receive a request with an unrecognized Host header. If there one of the virtual hosts is marked as default in the configuration, it will be used (even if it doesn't match the configured domain). We argue that this behavior is too dangerous when the server is used for HTTPS with a certificate that may cover names that are not served by this  server (including wildcard certificates, which may cover unknown domains).\r\n\r\nWhether an attack is possible depends on the default virtual host. We found several possible scenarios with different impact levels:\r\n\r\n1. If the second server is controlled by the attacker (who doesn't have the private key of the certificate), it is possible to completely impersonate other domains in the certificate. This may seem like an unlikely scenario, but it does occur in practice for content delivery networks. In particular, we found that the fallback host for all Akamai servers allow proxying to attacker servers. This leads to complete HTTP-level impersonation of many high-profile websites. We show in the attached video how to impersonate and steal secure/httpOnly cookies from Twitter, LinkedIn, PayPal, CNN, Microsoft, Apple... Because of the particular severity of the attack against Akamai we have contacted them directly about the problem.\r\n\r\n2. If the default host of the second server contains a page controlled by the attacker (or vulnerable to an XSS). Then, it can be translated to an Origin hijack/XSS attack on the other domain. Again, this may seem like an unlikely scenario. However, even if the attacker controlled page or XSS is only present on the attacker's account, a DNS attacker can always force his session on the client before sending him to his malicious page. We found several instances of this attack, most notably on websites that allow user to store files on their accounts. We made a proof of concept video against Dropbox, which is attached to this report.\r\n\r\n3. If the default host on the second server redirects unrecognized requests to HTTP, an attacker is able to access any URI that the user tries to access over HTTPS on the first domain. This is by far the most widespread behavior - we found several thousand such servers by sending requests to web servers for hosts covered by their certificate but not served locally. A typical way to exploit this attack is to target OAuth tokens. We made two proofs of concept of this attack: the first against Pinterest and the second against CloudFlare. It is worth mentioning that most often, the HTTP redirection points to the second domain (which the attacker can redirect to his own server by DNS) - even if the first domain is protected by HSTS, the redirection may proceed when the second domain isn't. The case of CloudFlare is interesting because they issue certificates valid for 20+ domains of their customers, and even if they cancel the service, their domain can remain in a CloudFlare certificate for months (or years). Furthermore, CloudFlare always redirects requests for former customers to HTTP - thus honest and well configured websites that are no longer served by CloudFlare can be compromised.\r\n\r\nAll of the attacks above only assume that the attacker controls the DNS, which is well within the threat model of TLS. There exists a variant for servers configured with SNI-based virtual hosts: a network attacker can downgrade a connection to SSL3 which causes the SNI to be removed. The request will go to the default virtual host with the same potential attacks as above. Because SNI is not widely used, we did not find a real-world example of this variant.\r\n\r\nThe difficult question is how to prevent this class of attacks. Configuring a default virtual host that only returns an HTTP error does prevent the attacks, but there are thousands of vulnerable servers and it is not reasonable to assume that webmasters will configure their servers correctly.\r\n\r\nInstead, I propose a coordinated change in HTTP server behavior. By default, a request received over TLS with an unrecognized Host header should be immediately rejected. There would be an option to enable the previous behavior, but it should precisely document the risks of allowing arbitrary Host values, in particular when they are covered by the TLS certificate.\r\n\r\n\r\n\r\n\r\n\r\n", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "", 
            "about": "Hack all the things.", 
            "twitter_handle": null, 
            "name": "The Internet"
        }, 
        "handle": "internet", 
        "url": "https://hackerone.com/internet", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/020/b94983d2ec09553c3e08f98cc718cb17e01112e6_small.png?1383767658", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/38e952fcff2c0aae0d011d5cecd07e5f62ecbd63_medium.png?1383767658"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 20, 
        "default_currency": "usd"
    }, 
    "is_published": false
}