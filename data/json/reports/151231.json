{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2016-07-14T00:40:34.208Z", 
    "voters": [
        "lukasreschke", 
        "wkcaj", 
        "rubyroobs", 
        "skansing", 
        "ras-it", 
        "xsam", 
        "tbehroz", 
        "gopi", 
        "demo--hacker", 
        "spetr0x", 
        "and 3 more..."
    ], 
    "facebook_team?": false, 
    "has_bounty?": false, 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 151231, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2016-07-14T00:40:24.235Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "Content-type sniffing leads to stored XSS in CMS Airship on Internet Explorer ", 
    "is_member_of_team?": null, 
    "vote_count": 13, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2016-08-13T00:40:24.334Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "attachments": [
        {
            "file_name": "xss-in-action.png", 
            "type": "image/png", 
            "id": 104815, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/104/815/fc726415281b370aacb0ab3a872965cae8a4a9fa/xss-in-action.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQVHWOGSNR%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T225149Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEBAaDNyA%2BB7EVws6w20xiyK3AzcCTkx0GnZzVQ6TwXkp44%2Ff6M7%2FsO19EHzsTJXAjGqGadXUwBewmY%2FA3saLwd8Xt%2FLbqrBXnPVBmQqsNFRuZECDCBvLhSnrZ0V6VgN9XIGcsvjdqc1keY1F5jqudqF9DVlIY8TMvC8HZK%2B7Q1nt4NsrhczyPwsxABuLuXRQ9jz342kfr6jcg4V0RDeoTmkF41Ft6RtUq0hmoAqdCx1%2Fz70xB4R7l69zShPP7HLfYHPPTt8XR1Db%2BqWNJQckpie0NnlFKA6ZUTMDBoFCJMNlSMrC8fe4WfzeCwJzHJRBg8PuHWSmO%2BotEruefTqBjLBoXXi34gvMNLGz%2F2UMbXN0CJxslsSVQ1hVUGyCtMe0w9EsQpL39cO7khz0GcmiaRxiDS26USPGfQCc9lffeZFTxh4so1l02filHtFdYLVvAvgjiOYt2Mz5u6lBhccM0iI2WWXmcjR%2FS%2BkxYva3%2BrEYrii1%2BMbFzOhDKAxYvafuSoo%2BiLMqIErMru4lSMvT6Hdl0F7q6ar9ursg2xy2ld%2BSsM1Ffwx%2FIlTxlx%2Fk5K%2BKS4mgc5N3QgLYcjLnqKIjMyLCEr%2FVbmVxbtUo%2B7qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=24e0ded9b782b7986bdf6aaa5e691f378536b3f99390264a2c1f741086146be7"
        }, 
        {
            "file_name": "xss.html", 
            "type": "application/zip", 
            "id": 104817, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/104/817/94d2d4b53e09e4de708203458b6f0eee4aa967df/xss.html?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQVHWOGSNR%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T225149Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEBAaDNyA%2BB7EVws6w20xiyK3AzcCTkx0GnZzVQ6TwXkp44%2Ff6M7%2FsO19EHzsTJXAjGqGadXUwBewmY%2FA3saLwd8Xt%2FLbqrBXnPVBmQqsNFRuZECDCBvLhSnrZ0V6VgN9XIGcsvjdqc1keY1F5jqudqF9DVlIY8TMvC8HZK%2B7Q1nt4NsrhczyPwsxABuLuXRQ9jz342kfr6jcg4V0RDeoTmkF41Ft6RtUq0hmoAqdCx1%2Fz70xB4R7l69zShPP7HLfYHPPTt8XR1Db%2BqWNJQckpie0NnlFKA6ZUTMDBoFCJMNlSMrC8fe4WfzeCwJzHJRBg8PuHWSmO%2BotEruefTqBjLBoXXi34gvMNLGz%2F2UMbXN0CJxslsSVQ1hVUGyCtMe0w9EsQpL39cO7khz0GcmiaRxiDS26USPGfQCc9lffeZFTxh4so1l02filHtFdYLVvAvgjiOYt2Mz5u6lBhccM0iI2WWXmcjR%2FS%2BkxYva3%2BrEYrii1%2BMbFzOhDKAxYvafuSoo%2BiLMqIErMru4lSMvT6Hdl0F7q6ar9ursg2xy2ld%2BSsM1Ffwx%2FIlTxlx%2Fk5K%2BKS4mgc5N3QgLYcjLnqKIjMyLCEr%2FVbmVxbtUo%2B7qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=0cc6d2de1f79839aceb6ab2c97ce95e6f78ccc0804a3baf7bde2671e11ab1867"
        }, 
        {
            "file_name": "payload-hex.png", 
            "type": "image/png", 
            "id": 104818, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/104/818/e16132682bcfe9eac608b67a992758aaea0966be/payload-hex.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQVHWOGSNR%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T225149Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEBAaDNyA%2BB7EVws6w20xiyK3AzcCTkx0GnZzVQ6TwXkp44%2Ff6M7%2FsO19EHzsTJXAjGqGadXUwBewmY%2FA3saLwd8Xt%2FLbqrBXnPVBmQqsNFRuZECDCBvLhSnrZ0V6VgN9XIGcsvjdqc1keY1F5jqudqF9DVlIY8TMvC8HZK%2B7Q1nt4NsrhczyPwsxABuLuXRQ9jz342kfr6jcg4V0RDeoTmkF41Ft6RtUq0hmoAqdCx1%2Fz70xB4R7l69zShPP7HLfYHPPTt8XR1Db%2BqWNJQckpie0NnlFKA6ZUTMDBoFCJMNlSMrC8fe4WfzeCwJzHJRBg8PuHWSmO%2BotEruefTqBjLBoXXi34gvMNLGz%2F2UMbXN0CJxslsSVQ1hVUGyCtMe0w9EsQpL39cO7khz0GcmiaRxiDS26USPGfQCc9lffeZFTxh4so1l02filHtFdYLVvAvgjiOYt2Mz5u6lBhccM0iI2WWXmcjR%2FS%2BkxYva3%2BrEYrii1%2BMbFzOhDKAxYvafuSoo%2BiLMqIErMru4lSMvT6Hdl0F7q6ar9ursg2xy2ld%2BSsM1Ffwx%2FIlTxlx%2Fk5K%2BKS4mgc5N3QgLYcjLnqKIjMyLCEr%2FVbmVxbtUo%2B7qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5aebb895462c44c6e314c9f3d0d9d68026819654c51cb90b2faca2d9c50258e3"
        }
    ], 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2016-07-13T23:02:07.095Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-07-13T23:02:07.095Z", 
            "actor": {
                "username": "paragonie-scott", 
                "url": "/paragonie-scott", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/051/441/e8c4034a4e3ed3d486883ffc34b95daa43a499d2_medium.png?1453933942"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "paragonie", 
            "message": "Thanks for the report. Given that this only affects one browser, I'm inclined to say \"this isn't a vulnerability in Airship, this is a vulnerability in Internet Explorer\".", 
            "markdown_message": "<p>Thanks for the report. Given that this only affects one browser, I&#39;m inclined to say &quot;this isn&#39;t a vulnerability in Airship, this is a vulnerability in Internet Explorer&quot;.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1067876, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-07-13T23:07:35.917Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-07-13T23:08:08.657Z", 
            "actor": {
                "username": "lukasreschke", 
                "url": "/lukasreschke", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/037/891/0ddfc05411893988a0d2794cd70d5dc221729713_medium.png?1438782834"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "paragonie", 
            "message": ">  I'm inclined to say \"this isn't a vulnerability in Airship, this is a vulnerability in Internet Explorer\".\n\nThat probably depends on your definition of vulnerability. Most people (including MITRE) will go with something along the lines of: If it is documented behaviour then it's not a vulnerability.\n\nIn this case, this is clearly documented behaviour by Microsoft and it is common practice to protect against it.\n\nJust check the Wordpress source code as example: https://github.com/WordPress/WordPress/blob/3a7137a7a554e0883ddc1b13389899907c5a85d2/wp-includes/functions.php#L4770-L4780 or the one from Drupal: https://github.com/drupal/drupal/blob/3e04617d2e6ecd9c87f9c23593179aa84eb6f002/core/lib/Drupal/Core/EventSubscriber/FinishResponseSubscriber.php#L112-L116 or just about every other widely deployed PHP software\n\nConsidering something not a vulnerability while also praising [oneself to be more secure than Wordpress](https://paragonie.com/blog/2016/06/php-security-platinum-standard-raising-bar-cms-airship) is a rather questionable thing from my opinion then.", 
            "markdown_message": "<blockquote>\n<p>I&#39;m inclined to say &quot;this isn&#39;t a vulnerability in Airship, this is a vulnerability in Internet Explorer&quot;.</p>\n</blockquote>\n\n<p>That probably depends on your definition of vulnerability. Most people (including MITRE) will go with something along the lines of: If it is documented behaviour then it&#39;s not a vulnerability.</p>\n\n<p>In this case, this is clearly documented behaviour by Microsoft and it is common practice to protect against it.</p>\n\n<p>Just check the Wordpress source code as example: <a title=\"https://github.com/WordPress/WordPress/blob/3a7137a7a554e0883ddc1b13389899907c5a85d2/wp-includes/functions.php#L4770-L4780\" href=\"/redirect?signature=6bcb61955fd04f2351ec93ec2791289d4d6635e8&amp;url=https%3A%2F%2Fgithub.com%2FWordPress%2FWordPress%2Fblob%2F3a7137a7a554e0883ddc1b13389899907c5a85d2%2Fwp-includes%2Ffunctions.php%23L4770-L4780\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/WordPress/WordPress/blob/3a7137a7a554e0883ddc1b13389899907c5a85d2/wp-includes/functions.php#L4770-L4780</span><i class=\"icon-external-link\"></i></a> or the one from Drupal: <a title=\"https://github.com/drupal/drupal/blob/3e04617d2e6ecd9c87f9c23593179aa84eb6f002/core/lib/Drupal/Core/EventSubscriber/FinishResponseSubscriber.php#L112-L116\" href=\"/redirect?signature=fa39185c612aabfc8eea944bf673591a255ec71e&amp;url=https%3A%2F%2Fgithub.com%2Fdrupal%2Fdrupal%2Fblob%2F3e04617d2e6ecd9c87f9c23593179aa84eb6f002%2Fcore%2Flib%2FDrupal%2FCore%2FEventSubscriber%2FFinishResponseSubscriber.php%23L112-L116\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/drupal/drupal/blob/3e04617d2e6ecd9c87f9c23593179aa84eb6f002/core/lib/Drupal/Core/EventSubscriber/FinishResponseSubscriber.php#L112-L116</span><i class=\"icon-external-link\"></i></a> or just about every other widely deployed PHP software</p>\n\n<p>Considering something not a vulnerability while also praising <a href=\"/redirect?signature=e0d48559e76094427f25a5d4f1af0a99b5607ee5&amp;url=https%3A%2F%2Fparagonie.com%2Fblog%2F2016%2F06%2Fphp-security-platinum-standard-raising-bar-cms-airship\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>oneself to be more secure than Wordpress</span><i class=\"icon-external-link\"></i></a> is a rather questionable thing from my opinion then.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1067880, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-07-14T00:07:41.401Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-07-14T00:07:41.401Z", 
            "actor": {
                "username": "paragonie-scott", 
                "url": "/paragonie-scott", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/051/441/e8c4034a4e3ed3d486883ffc34b95daa43a499d2_medium.png?1453933942"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "paragonie", 
            "message": "The reason for my personal inclination is that this misbehavior exclusively impacts a Microsoft product.\n\nDocumented or otherwise, this doesn't happen in Firefox, Chrome, Safari, Opera, or any of the minority web browsers. Given that we already make no pains to support any version of IE (to the point of using jQuery 3.x instead of 1.x), paying a bug bounty for an IE-only bug would set an odd precedent that I'm not comfortable committing to.\n\nIn the same avenue, Content-Security-Policy headers aren't supported by Internet Explorer either. Does that defiicit qualify as an \"XSS mitigation bypass\" vulnerability in CMS Airship?\n\nTo be clear: I'm not saying I won't apply the suggested patch. I'm just not willing to accept responsibility for a deficit in the design or implementation of a multi-billion dollar company's product (even if they documented it). Especially not if it means paying a bug bounty for a problem they created, whilst said company isn't one of my clients.\n\nTo the best of your knowledge: is this design flaw present in Microsoft Edge too? Or is it an exclusively-IE bug, not just a Microsoft product bug?", 
            "markdown_message": "<p>The reason for my personal inclination is that this misbehavior exclusively impacts a Microsoft product.</p>\n\n<p>Documented or otherwise, this doesn&#39;t happen in Firefox, Chrome, Safari, Opera, or any of the minority web browsers. Given that we already make no pains to support any version of IE (to the point of using jQuery 3.x instead of 1.x), paying a bug bounty for an IE-only bug would set an odd precedent that I&#39;m not comfortable committing to.</p>\n\n<p>In the same avenue, Content-Security-Policy headers aren&#39;t supported by Internet Explorer either. Does that defiicit qualify as an &quot;XSS mitigation bypass&quot; vulnerability in CMS Airship?</p>\n\n<p>To be clear: I&#39;m not saying I won&#39;t apply the suggested patch. I&#39;m just not willing to accept responsibility for a deficit in the design or implementation of a multi-billion dollar company&#39;s product (even if they documented it). Especially not if it means paying a bug bounty for a problem they created, whilst said company isn&#39;t one of my clients.</p>\n\n<p>To the best of your knowledge: is this design flaw present in Microsoft Edge too? Or is it an exclusively-IE bug, not just a Microsoft product bug?</p>\n", 
            "type": "Activities::Comment", 
            "id": 1067920, 
            "genius_execution_id": null
        }, 
        {
            "attachments": [
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/104/827/7572baeb9b45eac66e6fc165eb53ed0941cce10a/2016-07-14_02-33-15.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQVHWOGSNR%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T225149Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEBAaDNyA%2BB7EVws6w20xiyK3AzcCTkx0GnZzVQ6TwXkp44%2Ff6M7%2FsO19EHzsTJXAjGqGadXUwBewmY%2FA3saLwd8Xt%2FLbqrBXnPVBmQqsNFRuZECDCBvLhSnrZ0V6VgN9XIGcsvjdqc1keY1F5jqudqF9DVlIY8TMvC8HZK%2B7Q1nt4NsrhczyPwsxABuLuXRQ9jz342kfr6jcg4V0RDeoTmkF41Ft6RtUq0hmoAqdCx1%2Fz70xB4R7l69zShPP7HLfYHPPTt8XR1Db%2BqWNJQckpie0NnlFKA6ZUTMDBoFCJMNlSMrC8fe4WfzeCwJzHJRBg8PuHWSmO%2BotEruefTqBjLBoXXi34gvMNLGz%2F2UMbXN0CJxslsSVQ1hVUGyCtMe0w9EsQpL39cO7khz0GcmiaRxiDS26USPGfQCc9lffeZFTxh4so1l02filHtFdYLVvAvgjiOYt2Mz5u6lBhccM0iI2WWXmcjR%2FS%2BkxYva3%2BrEYrii1%2BMbFzOhDKAxYvafuSoo%2BiLMqIErMru4lSMvT6Hdl0F7q6ar9ursg2xy2ld%2BSsM1Ffwx%2FIlTxlx%2Fk5K%2BKS4mgc5N3QgLYcjLnqKIjMyLCEr%2FVbmVxbtUo%2B7qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=3b83cf33a9dea3a39896505ad686d29c5aeb630229f4188773c802f11b8ac1a1", 
                    "type": "image/png", 
                    "id": 104827, 
                    "filename": "2016-07-14_02-33-15.png"
                }
            ], 
            "automated_response": false, 
            "created_at": "2016-07-14T00:35:55.211Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-07-14T00:37:32.117Z", 
            "actor": {
                "username": "lukasreschke", 
                "url": "/lukasreschke", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/037/891/0ddfc05411893988a0d2794cd70d5dc221729713_medium.png?1438782834"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "paragonie", 
            "message": "> In the same avenue, Content-Security-Policy headers aren't supported by Internet Explorer either. Does that defiicit qualify as an \"XSS mitigation bypass\" vulnerability in CMS Airship?\n\nThere certainly is a difference between \"unsupported hardening feature\" and \"widely known implementation detail\". This vulnerability being part of the latter.\n\nAlso certainly there is another big difference between a mitigation bypass and an actual vulnerability, such as this XSS.\n\n> To the best of your knowledge: is this design flaw present in Microsoft Edge too? Or is it an exclusively-IE bug, not just a Microsoft product bug?\n\nThe flaw itself isn't really \"exclusively-IE\". It's just the easiest to exploit in IE and the mitigation measures are pretty similar. Plus the bounties amount aren't that gigantic here that I'd dig into every small bug for hours. (especially since I donate all my bounties, so there is no real personal benefit here\u2026)\n\nBut if we want to play the \"Let's prove that this is really bad\" game, then I'm happy to do that. ;-)\n\nSince you're missing the \"Content-Disposition\" header this can also be abused for a generic XSS attack using Flash. Of course, you should be able to say now \"Oh! But this is another thing I don't have influence on! I don't consider this a vulnerability per se\". But then again please tell your users that you don't care about any XSS attack vectors. Every software that handles user data securely will set these headers.\n\nA super easy way to reproduce is using https://github.com/nccgroup/CrossSiteContentHijacking\n\n1. Upload http://0me.me/ContentHijacking/objects/ContentHijacking.swf\n2. Configure links to the SWF and your Target Page in http://15.rs/ContentHijacking/ContentHijackingLoader.html\n3. Press retrieve content, or check the attachment\n\nThis will also work in the newest Chrome. Writing and compiling a Flash file that is doing all this automatically and executes arbitrary JS is left as exercise to the reader ;-)\n\n\u2026 and also there you will find the mitigation advice:\n\n> Adding the \"Content-Disposition: Attachment\" and \"X-Content-Type-Options: nosniff\" headers to the response of static files will secure the website against Flash or PDF-based cross-site content-hijacking attacks. It is recommended that this practice be performed for all of the files that users need to download in all the modules that deal with a file download. Although this method does not fully secure the website against attacks using Silverlight or similar objects, it can mitigate the risk of using Adobe Flash and PDF objects, especially when uploading PDF files is permitted.\n", 
            "markdown_message": "<blockquote>\n<p>In the same avenue, Content-Security-Policy headers aren&#39;t supported by Internet Explorer either. Does that defiicit qualify as an &quot;XSS mitigation bypass&quot; vulnerability in CMS Airship?</p>\n</blockquote>\n\n<p>There certainly is a difference between &quot;unsupported hardening feature&quot; and &quot;widely known implementation detail&quot;. This vulnerability being part of the latter.</p>\n\n<p>Also certainly there is another big difference between a mitigation bypass and an actual vulnerability, such as this XSS.</p>\n\n<blockquote>\n<p>To the best of your knowledge: is this design flaw present in Microsoft Edge too? Or is it an exclusively-IE bug, not just a Microsoft product bug?</p>\n</blockquote>\n\n<p>The flaw itself isn&#39;t really &quot;exclusively-IE&quot;. It&#39;s just the easiest to exploit in IE and the mitigation measures are pretty similar. Plus the bounties amount aren&#39;t that gigantic here that I&#39;d dig into every small bug for hours. (especially since I donate all my bounties, so there is no real personal benefit here\u2026)</p>\n\n<p>But if we want to play the &quot;Let&#39;s prove that this is really bad&quot; game, then I&#39;m happy to do that. ;-)</p>\n\n<p>Since you&#39;re missing the &quot;Content-Disposition&quot; header this can also be abused for a generic XSS attack using Flash. Of course, you should be able to say now &quot;Oh! But this is another thing I don&#39;t have influence on! I don&#39;t consider this a vulnerability per se&quot;. But then again please tell your users that you don&#39;t care about any XSS attack vectors. Every software that handles user data securely will set these headers.</p>\n\n<p>A super easy way to reproduce is using <a title=\"https://github.com/nccgroup/CrossSiteContentHijacking\" href=\"/redirect?signature=d439aafc1fa04c3e063cfa5f8cdf51412c710182&amp;url=https%3A%2F%2Fgithub.com%2Fnccgroup%2FCrossSiteContentHijacking\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/nccgroup/CrossSiteContentHijacking</span><i class=\"icon-external-link\"></i></a></p>\n\n<ol>\n<li>Upload <a title=\"http://0me.me/ContentHijacking/objects/ContentHijacking.swf\" href=\"/redirect?signature=9da28bcb91f235b37bb346180b3f8499c0777d9e&amp;url=http%3A%2F%2F0me.me%2FContentHijacking%2Fobjects%2FContentHijacking.swf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://0me.me/ContentHijacking/objects/ContentHijacking.swf</span><i class=\"icon-external-link\"></i></a>\n</li>\n<li>Configure links to the SWF and your Target Page in <a title=\"http://15.rs/ContentHijacking/ContentHijackingLoader.html\" href=\"/redirect?signature=1f26d3b709663490f699c6c45dc797a766c593d5&amp;url=http%3A%2F%2F15.rs%2FContentHijacking%2FContentHijackingLoader.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://15.rs/ContentHijacking/ContentHijackingLoader.html</span><i class=\"icon-external-link\"></i></a>\n</li>\n<li>Press retrieve content, or check the attachment</li>\n</ol>\n\n<p>This will also work in the newest Chrome. Writing and compiling a Flash file that is doing all this automatically and executes arbitrary JS is left as exercise to the reader ;-)</p>\n\n<p>\u2026 and also there you will find the mitigation advice:</p>\n\n<blockquote>\n<p>Adding the &quot;Content-Disposition: Attachment&quot; and &quot;X-Content-Type-Options: nosniff&quot; headers to the response of static files will secure the website against Flash or PDF-based cross-site content-hijacking attacks. It is recommended that this practice be performed for all of the files that users need to download in all the modules that deal with a file download. Although this method does not fully secure the website against attacks using Silverlight or similar objects, it can mitigate the risk of using Adobe Flash and PDF objects, especially when uploading PDF files is permitted.</p>\n</blockquote>\n", 
            "type": "Activities::Comment", 
            "id": 1067943, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "lukasreschke", 
                "url": "/lukasreschke"
            }, 
            "created_at": "2016-07-14T00:40:02.330Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-07-14T00:40:02.330Z", 
            "actor": {
                "username": "paragonie-scott", 
                "url": "/paragonie-scott", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/051/441/e8c4034a4e3ed3d486883ffc34b95daa43a499d2_medium.png?1453933942"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "paragonie", 
            "message": "See https://github.com/paragonie/airship/commit/df20edff8794f6b36047422ec97daeed844b1b7c (I'm leaving the commit unlocked for public comment, since the public cannot comment on H1 issues, even when published under full disclosure.)", 
            "markdown_message": "<p>See <a title=\"https://github.com/paragonie/airship/commit/df20edff8794f6b36047422ec97daeed844b1b7c\" href=\"/redirect?signature=459e458dd1941901c3909acd1c1a1fc1622a56a9&amp;url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fcommit%2Fdf20edff8794f6b36047422ec97daeed844b1b7c\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/paragonie/airship/commit/df20edff8794f6b36047422ec97daeed844b1b7c</span><i class=\"icon-external-link\"></i></a> (I&#39;m leaving the commit unlocked for public comment, since the public cannot comment on H1 issues, even when published under full disclosure.)</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 1067946, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-07-14T00:40:24.262Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-07-14T00:40:24.262Z", 
            "actor": {
                "username": "paragonie-scott", 
                "url": "/paragonie-scott", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/051/441/e8c4034a4e3ed3d486883ffc34b95daa43a499d2_medium.png?1453933942"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "paragonie", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1067949, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-07-14T00:40:34.301Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-07-14T00:40:34.301Z", 
            "actor": {
                "username": "lukasreschke", 
                "url": "/lukasreschke", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/037/891/0ddfc05411893988a0d2794cd70d5dc221729713_medium.png?1438782834"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "paragonie", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1067950, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-07-14T00:40:34.430Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-07-14T00:40:34.430Z", 
            "actor": {
                "username": "lukasreschke", 
                "url": "/lukasreschke", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/037/891/0ddfc05411893988a0d2794cd70d5dc221729713_medium.png?1438782834"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "paragonie", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 1067951, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-07-14T01:00:06.477Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-07-14T01:00:06.477Z", 
            "actor": {
                "username": "lukasreschke", 
                "url": "/lukasreschke", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/037/891/0ddfc05411893988a0d2794cd70d5dc221729713_medium.png?1438782834"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "paragonie", 
            "message": "THX for applying the patch upstream.", 
            "markdown_message": "<p>THX for applying the patch upstream.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1067972, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-07-14T01:11:18.110Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-07-14T01:11:18.110Z", 
            "actor": {
                "username": "paragonie-scott", 
                "url": "/paragonie-scott", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/051/441/e8c4034a4e3ed3d486883ffc34b95daa43a499d2_medium.png?1453933942"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "paragonie", 
            "message": "Thanks for providing the patch. :)", 
            "markdown_message": "<p>Thanks for providing the patch. :)</p>\n", 
            "type": "Activities::Comment", 
            "id": 1067981, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-05-04T14:26:27.849Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-05-04T14:26:27.849Z", 
            "actor": {
                "url": "/paragonie", 
                "profile": {
                    "name": "Paragon Initiative Enterprises"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/008/539/17d54b48e116d815fd72bc29f2cd71df6b3659ad_medium.?1453010804"
                }
            }, 
            "team_handle": "paragonie", 
            "message": "HackerOne changed its workflow a little; setting an award (or marking an issue as ineligible) is now mandatory.", 
            "markdown_message": "<p>HackerOne changed its workflow a little; setting an award (or marking an issue as ineligible) is now mandatory.</p>\n", 
            "type": "Activities::NotEligibleForBounty", 
            "id": 1653870, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "lukasreschke", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/lukasreschke", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/037/891/8666abeffab5fc62fe0b8cad0965e5727894b1b2_small.png?1438782834"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 60, 
        "name": "Cross-site Scripting (XSS) - Generic"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -73087884.88975729, 
    "disclosed_at": "2016-07-14T00:40:34.379Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/151231", 
    "created_at": "2016-07-13T22:59:29.698Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<h1 id=\"description\">Description</h1>\n\n<p>Internet Explorer has the nasty habit to perform Content-Type sniffing on delivered resources if the content-type is not known to it. Since the software isn&#39;t instructing Internet Explorer to disable content-type sniffing this leads to a stored XSS.  </p>\n\n<p>In a nutshell, it is possible to trick Internet Explorer in executing arbitrary files. A more in-detail description about Internet Explorers&#39; mimetype handling can be found at <a title=\"https://msdn.microsoft.com/en-us/library/ms775147(v=vs.85).aspx\" href=\"/redirect?signature=fc86cd381366f8462b7cb9b45683889afcfbfdec&amp;url=https%3A%2F%2Fmsdn.microsoft.com%2Fen-us%2Flibrary%2Fms775147%28v%3Dvs.85%29.aspx\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://msdn.microsoft.com/en-us/library/ms775147(v=vs.85).aspx</span><i class=\"icon-external-link\"></i></a>. Let&#39;s just phrase it as: The length to what Microsoft goes to guess the file content is insane.</p>\n\n<h1 id=\"exploitation\">Exploitation</h1>\n\n<p>To exploit this in this case we need to:</p>\n\n<ul>\n<li>Craft the file in a way that Internet Explorer sniffs it&#39;s content</li>\n<li>Control the file name delivered to Internet Explorer</li>\n</ul>\n\n<p>This is actually a pretty easy thing to achieve, I&#39;ve attached <a href=\"#\" class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"xss.html\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/104/817/94d2d4b53e09e4de708203458b6f0eee4aa967df/xss.html?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQVHWOGSNR%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T225149Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEBAaDNyA%2BB7EVws6w20xiyK3AzcCTkx0GnZzVQ6TwXkp44%2Ff6M7%2FsO19EHzsTJXAjGqGadXUwBewmY%2FA3saLwd8Xt%2FLbqrBXnPVBmQqsNFRuZECDCBvLhSnrZ0V6VgN9XIGcsvjdqc1keY1F5jqudqF9DVlIY8TMvC8HZK%2B7Q1nt4NsrhczyPwsxABuLuXRQ9jz342kfr6jcg4V0RDeoTmkF41Ft6RtUq0hmoAqdCx1%2Fz70xB4R7l69zShPP7HLfYHPPTt8XR1Db%2BqWNJQckpie0NnlFKA6ZUTMDBoFCJMNlSMrC8fe4WfzeCwJzHJRBg8PuHWSmO%2BotEruefTqBjLBoXXi34gvMNLGz%2F2UMbXN0CJxslsSVQ1hVUGyCtMe0w9EsQpL39cO7khz0GcmiaRxiDS26USPGfQCc9lffeZFTxh4so1l02filHtFdYLVvAvgjiOYt2Mz5u6lBhccM0iI2WWXmcjR%2FS%2BkxYva3%2BrEYrii1%2BMbFzOhDKAxYvafuSoo%2BiLMqIErMru4lSMvT6Hdl0F7q6ar9ursg2xy2ld%2BSsM1Ffwx%2FIlTxlx%2Fk5K%2BKS4mgc5N3QgLYcjLnqKIjMyLCEr%2FVbmVxbtUo%2B7qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=0cc6d2de1f79839aceb6ab2c97ce95e6f78ccc0804a3baf7bde2671e11ab1867\" data-attachment-type=\"application/zip\">xss.html (F104817)</a> which is a file with ZIP header that then contains a malicious HTML payload:</p>\n\n<p><a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"payload-hex.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/104/818/e16132682bcfe9eac608b67a992758aaea0966be/payload-hex.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQVHWOGSNR%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T225149Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEBAaDNyA%2BB7EVws6w20xiyK3AzcCTkx0GnZzVQ6TwXkp44%2Ff6M7%2FsO19EHzsTJXAjGqGadXUwBewmY%2FA3saLwd8Xt%2FLbqrBXnPVBmQqsNFRuZECDCBvLhSnrZ0V6VgN9XIGcsvjdqc1keY1F5jqudqF9DVlIY8TMvC8HZK%2B7Q1nt4NsrhczyPwsxABuLuXRQ9jz342kfr6jcg4V0RDeoTmkF41Ft6RtUq0hmoAqdCx1%2Fz70xB4R7l69zShPP7HLfYHPPTt8XR1Db%2BqWNJQckpie0NnlFKA6ZUTMDBoFCJMNlSMrC8fe4WfzeCwJzHJRBg8PuHWSmO%2BotEruefTqBjLBoXXi34gvMNLGz%2F2UMbXN0CJxslsSVQ1hVUGyCtMe0w9EsQpL39cO7khz0GcmiaRxiDS26USPGfQCc9lffeZFTxh4so1l02filHtFdYLVvAvgjiOYt2Mz5u6lBhccM0iI2WWXmcjR%2FS%2BkxYva3%2BrEYrii1%2BMbFzOhDKAxYvafuSoo%2BiLMqIErMru4lSMvT6Hdl0F7q6ar9ursg2xy2ld%2BSsM1Ffwx%2FIlTxlx%2Fk5K%2BKS4mgc5N3QgLYcjLnqKIjMyLCEr%2FVbmVxbtUo%2B7qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=5aebb895462c44c6e314c9f3d0d9d68026819654c51cb90b2faca2d9c50258e3\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/104/818/e16132682bcfe9eac608b67a992758aaea0966be/payload-hex.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQVHWOGSNR%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T225149Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEBAaDNyA%2BB7EVws6w20xiyK3AzcCTkx0GnZzVQ6TwXkp44%2Ff6M7%2FsO19EHzsTJXAjGqGadXUwBewmY%2FA3saLwd8Xt%2FLbqrBXnPVBmQqsNFRuZECDCBvLhSnrZ0V6VgN9XIGcsvjdqc1keY1F5jqudqF9DVlIY8TMvC8HZK%2B7Q1nt4NsrhczyPwsxABuLuXRQ9jz342kfr6jcg4V0RDeoTmkF41Ft6RtUq0hmoAqdCx1%2Fz70xB4R7l69zShPP7HLfYHPPTt8XR1Db%2BqWNJQckpie0NnlFKA6ZUTMDBoFCJMNlSMrC8fe4WfzeCwJzHJRBg8PuHWSmO%2BotEruefTqBjLBoXXi34gvMNLGz%2F2UMbXN0CJxslsSVQ1hVUGyCtMe0w9EsQpL39cO7khz0GcmiaRxiDS26USPGfQCc9lffeZFTxh4so1l02filHtFdYLVvAvgjiOYt2Mz5u6lBhccM0iI2WWXmcjR%2FS%2BkxYva3%2BrEYrii1%2BMbFzOhDKAxYvafuSoo%2BiLMqIErMru4lSMvT6Hdl0F7q6ar9ursg2xy2ld%2BSsM1Ffwx%2FIlTxlx%2Fk5K%2BKS4mgc5N3QgLYcjLnqKIjMyLCEr%2FVbmVxbtUo%2B7qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=5aebb895462c44c6e314c9f3d0d9d68026819654c51cb90b2faca2d9c50258e3\" class=\"markdown-inline-image\"></a></p>\n\n<p>It is now sufficient to upload the file as authenticated user and make another person using Internet Explorer make open the URL to said file. This will even work in IE 11 on Windows 8.1:</p>\n\n<p><a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"xss-in-action.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/104/815/fc726415281b370aacb0ab3a872965cae8a4a9fa/xss-in-action.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQVHWOGSNR%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T225149Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEBAaDNyA%2BB7EVws6w20xiyK3AzcCTkx0GnZzVQ6TwXkp44%2Ff6M7%2FsO19EHzsTJXAjGqGadXUwBewmY%2FA3saLwd8Xt%2FLbqrBXnPVBmQqsNFRuZECDCBvLhSnrZ0V6VgN9XIGcsvjdqc1keY1F5jqudqF9DVlIY8TMvC8HZK%2B7Q1nt4NsrhczyPwsxABuLuXRQ9jz342kfr6jcg4V0RDeoTmkF41Ft6RtUq0hmoAqdCx1%2Fz70xB4R7l69zShPP7HLfYHPPTt8XR1Db%2BqWNJQckpie0NnlFKA6ZUTMDBoFCJMNlSMrC8fe4WfzeCwJzHJRBg8PuHWSmO%2BotEruefTqBjLBoXXi34gvMNLGz%2F2UMbXN0CJxslsSVQ1hVUGyCtMe0w9EsQpL39cO7khz0GcmiaRxiDS26USPGfQCc9lffeZFTxh4so1l02filHtFdYLVvAvgjiOYt2Mz5u6lBhccM0iI2WWXmcjR%2FS%2BkxYva3%2BrEYrii1%2BMbFzOhDKAxYvafuSoo%2BiLMqIErMru4lSMvT6Hdl0F7q6ar9ursg2xy2ld%2BSsM1Ffwx%2FIlTxlx%2Fk5K%2BKS4mgc5N3QgLYcjLnqKIjMyLCEr%2FVbmVxbtUo%2B7qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=24e0ded9b782b7986bdf6aaa5e691f378536b3f99390264a2c1f741086146be7\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/104/815/fc726415281b370aacb0ab3a872965cae8a4a9fa/xss-in-action.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQVHWOGSNR%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T225149Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEBAaDNyA%2BB7EVws6w20xiyK3AzcCTkx0GnZzVQ6TwXkp44%2Ff6M7%2FsO19EHzsTJXAjGqGadXUwBewmY%2FA3saLwd8Xt%2FLbqrBXnPVBmQqsNFRuZECDCBvLhSnrZ0V6VgN9XIGcsvjdqc1keY1F5jqudqF9DVlIY8TMvC8HZK%2B7Q1nt4NsrhczyPwsxABuLuXRQ9jz342kfr6jcg4V0RDeoTmkF41Ft6RtUq0hmoAqdCx1%2Fz70xB4R7l69zShPP7HLfYHPPTt8XR1Db%2BqWNJQckpie0NnlFKA6ZUTMDBoFCJMNlSMrC8fe4WfzeCwJzHJRBg8PuHWSmO%2BotEruefTqBjLBoXXi34gvMNLGz%2F2UMbXN0CJxslsSVQ1hVUGyCtMe0w9EsQpL39cO7khz0GcmiaRxiDS26USPGfQCc9lffeZFTxh4so1l02filHtFdYLVvAvgjiOYt2Mz5u6lBhccM0iI2WWXmcjR%2FS%2BkxYva3%2BrEYrii1%2BMbFzOhDKAxYvafuSoo%2BiLMqIErMru4lSMvT6Hdl0F7q6ar9ursg2xy2ld%2BSsM1Ffwx%2FIlTxlx%2Fk5K%2BKS4mgc5N3QgLYcjLnqKIjMyLCEr%2FVbmVxbtUo%2B7qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=24e0ded9b782b7986bdf6aaa5e691f378536b3f99390264a2c1f741086146be7\" class=\"markdown-inline-image\"></a></p>\n\n<h1 id=\"mitigation\">Mitigation</h1>\n\n<p>The most reliable mitigation would be to use a sandboxed domain for user-uploaded content. So files would only be served from that origin and the Same-Origin-Policy would prevent this problem. </p>\n\n<p>Since this may not be possible in every case to enforce to users, setting the following headers in combination will mitigate content-type sniffing related problems:</p>\n\n<ul>\n<li>\n<code>X-Content-Type-Options: nosniff</code> </li>\n<li>\n<code>X-Download-Options: noopen</code> </li>\n<li><code>Content-Disposition: attachment; filename=&quot;filename.ext&quot;&#39;</code></li>\n</ul>\n\n<p>One patch for <a href=\"/redirect?signature=f520ee201efe60c457b091b7ce3395887d0f863a&amp;url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2F316a90803e6666befbee04c0a81d75abd0fc5319%2Fsrc%2FCabin%2FHull%2FLanding%2FPublicFiles.php%23L90\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>/src/Cabin/Hull/Landing/PublicFiles.php</span><i class=\"icon-external-link\"></i></a> could look like the following:</p>\n<pre class=\"highlight plaintext\"><code>From 42bc1760453fbfed004072929d99d9c397ab3f77 Mon Sep 17 00:00:00 2001\nFrom: Lukas Reschke &lt;lukas@statuscode.ch&gt;\nDate: Thu, 14 Jul 2016 00:57:26 +0200\nSubject: [PATCH] Prevent Mime Sniffing in Internet Explorer\n\n---\n src/Cabin/Hull/Landing/PublicFiles.php | 3 +++\n 1 file changed, 3 insertions(+)\n\ndiff --git a/src/Cabin/Hull/Landing/PublicFiles.php b/src/Cabin/Hull/Landing/PublicFiles.php\nindex 9fc9b1b..80ba6fa 100755\n--- a/src/Cabin/Hull/Landing/PublicFiles.php\n+++ b/src/Cabin/Hull/Landing/PublicFiles.php\n@@ -92,6 +92,9 @@ class PublicFiles extends LandingGear\n             }\n\n             // Serve the file\n+            \\header(&#39;Content-Disposition: attachment; filename=&quot;&#39;.urlencode($fileData[&#39;filename&#39;]).&#39;&quot;&#39;);\n+            \\header(&#39;X-Content-Type-Options: nosniff&#39;);\n+            \\header(&#39;X-Download-Options: noopen&#39;);\n             \\header(&#39;Content-Type: &#39; . $fileData[&#39;type&#39;]);\n             $this-&gt;airship_lens_object-&gt;sendStandardHeaders($fileData[&#39;type&#39;]);\n             \\readfile($realPath);\n--\n2.7.4 (Apple Git-66)\n</code></pre>\n<p>There may be other occurrences in the code that have the same issue. Generally speaking. There is no harm in adding the <code>X-Content-Type-Options: nosniff</code> header globally over the whole web application.</p>\n\n<hr>\n\n<p>In case you need testing VMs from Microsoft, you can get them from free at <a title=\"http://modern.ie\" href=\"/redirect?signature=6525fc3e7e5518ffef5a4bc8e0bc3314c6915ab1&amp;url=http%3A%2F%2Fmodern.ie\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://modern.ie</span><i class=\"icon-external-link\"></i></a></p>\n", 
    "vulnerability_information": "# Description\nInternet Explorer has the nasty habit to perform Content-Type sniffing on delivered resources if the content-type is not known to it. Since the software isn't instructing Internet Explorer to disable content-type sniffing this leads to a stored XSS.  \n\nIn a nutshell, it is possible to trick Internet Explorer in executing arbitrary files. A more in-detail description about Internet Explorers' mimetype handling can be found at https://msdn.microsoft.com/en-us/library/ms775147(v=vs.85).aspx. Let's just phrase it as: The length to what Microsoft goes to guess the file content is insane.\n\n# Exploitation\nTo exploit this in this case we need to:\n\n- Craft the file in a way that Internet Explorer sniffs it's content\n- Control the file name delivered to Internet Explorer\n\nThis is actually a pretty easy thing to achieve, I've attached {F104817} which is a file with ZIP header that then contains a malicious HTML payload:\n\n{F104818}\n\nIt is now sufficient to upload the file as authenticated user and make another person using Internet Explorer make open the URL to said file. This will even work in IE 11 on Windows 8.1:\n\n{F104815}\n\n# Mitigation\nThe most reliable mitigation would be to use a sandboxed domain for user-uploaded content. So files would only be served from that origin and the Same-Origin-Policy would prevent this problem. \n\nSince this may not be possible in every case to enforce to users, setting the following headers in combination will mitigate content-type sniffing related problems:\n\n- `X-Content-Type-Options: nosniff` \n- `X-Download-Options: noopen` \n- `Content-Disposition: attachment; filename=\"filename.ext\"'`\n\nOne patch for [/src/Cabin/Hull/Landing/PublicFiles.php](https://github.com/paragonie/airship/blob/316a90803e6666befbee04c0a81d75abd0fc5319/src/Cabin/Hull/Landing/PublicFiles.php#L90) could look like the following:\n\n```\nFrom 42bc1760453fbfed004072929d99d9c397ab3f77 Mon Sep 17 00:00:00 2001\nFrom: Lukas Reschke <lukas@statuscode.ch>\nDate: Thu, 14 Jul 2016 00:57:26 +0200\nSubject: [PATCH] Prevent Mime Sniffing in Internet Explorer\n\n---\n src/Cabin/Hull/Landing/PublicFiles.php | 3 +++\n 1 file changed, 3 insertions(+)\n\ndiff --git a/src/Cabin/Hull/Landing/PublicFiles.php b/src/Cabin/Hull/Landing/PublicFiles.php\nindex 9fc9b1b..80ba6fa 100755\n--- a/src/Cabin/Hull/Landing/PublicFiles.php\n+++ b/src/Cabin/Hull/Landing/PublicFiles.php\n@@ -92,6 +92,9 @@ class PublicFiles extends LandingGear\n             }\n\n             // Serve the file\n+            \\header('Content-Disposition: attachment; filename=\"'.urlencode($fileData['filename']).'\"');\n+            \\header('X-Content-Type-Options: nosniff');\n+            \\header('X-Download-Options: noopen');\n             \\header('Content-Type: ' . $fileData['type']);\n             $this->airship_lens_object->sendStandardHeaders($fileData['type']);\n             \\readfile($realPath);\n--\n2.7.4 (Apple Git-66)\n```\n\nThere may be other occurrences in the code that have the same issue. Generally speaking. There is no harm in adding the `X-Content-Type-Options: nosniff` header globally over the whole web application.\n\n---\n\nIn case you need testing VMs from Microsoft, you can get them from free at http://modern.ie", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://github.com/paragonie", 
            "about": "Cryptography and Application Security Consultants - We Produce Various Open Source Libraries", 
            "twitter_handle": "ParagonIE", 
            "name": "Paragon Initiative Enterprises"
        }, 
        "handle": "paragonie", 
        "url": "https://hackerone.com/paragonie", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/008/539/a041268a04bb7a5c3d3a88a9dccc6b5955eff4d7_small.?1453010804", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/008/539/17d54b48e116d815fd72bc29f2cd71df6b3659ad_medium.?1453010804"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 8539, 
        "default_currency": "usd"
    }, 
    "is_published": false
}