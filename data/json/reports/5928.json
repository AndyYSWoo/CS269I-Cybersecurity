{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": null, 
    "voters": [], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "500.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 5928, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2014-04-20T21:15:34.698Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "Uncontrolled Resource Consumption with XMPP-Layer Compression", 
    "is_member_of_team?": null, 
    "vote_count": 0, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2014-04-20T21:15:22.836Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$500", 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2014-04-05T07:27:23.896Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-04-05T07:27:23.896Z", 
            "actor": {
                "username": "gianko", 
                "url": "/gianko", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/807/de8119205f461456edfb6383d95d2b652c26f351_medium.png?1405671588"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "The current status of these bugs: *public*. It has been already triaged, solved, and close.\n\nThe chronological events of the disclosure are the following and they can be confirmed by the XMPP Standards Foundation:\n\n1) After the confirmation of the issue I contacted each vendor indipendently\n2) I was put in touch with Peter Saint-Andre from XMPP Standards Foundation and he invited me in a private ML disclosing vulnerabilities to the community in a coordinated way\n4) I shared the details, proofs of concept, and my solutions both at code level and at the specification level\n5) I acted as coordinator de-facto and I was supported by Peter: set deadlines, kept track of the global status of each vendor\n6) After 4 days that all the affected vendors published a patch, Peter published the security notice on xmpp.org", 
            "markdown_message": "<p>The current status of these bugs: <em>public</em>. It has been already triaged, solved, and close.</p>\n\n<p>The chronological events of the disclosure are the following and they can be confirmed by the XMPP Standards Foundation:</p>\n\n<p>1) After the confirmation of the issue I contacted each vendor indipendently<br>\n2) I was put in touch with Peter Saint-Andre from XMPP Standards Foundation and he invited me in a private ML disclosing vulnerabilities to the community in a coordinated way<br>\n4) I shared the details, proofs of concept, and my solutions both at code level and at the specification level<br>\n5) I acted as coordinator de-facto and I was supported by Peter: set deadlines, kept track of the global status of each vendor<br>\n6) After 4 days that all the affected vendors published a patch, Peter published the security notice on xmpp.org</p>\n", 
            "type": "Activities::Comment", 
            "id": 24361, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-04-10T01:39:31.257Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-04-10T01:39:31.257Z", 
            "actor": {
                "username": "arice", 
                "url": "/arice", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/74e2a8a31fee27a0c9b3d1d90dd64f4e38b2fb1c_medium.jpeg?1466604112"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "@gianko - thanks for the detailed write-up. Denial of Service class issues don't really fit the \"severe\" criteria of this program, but this might be an unusual case given the number of applications involved here. I'll get a verdict from the panel and update shortly.", 
            "markdown_message": "<p><a href=\"/gianko\">@gianko</a> - thanks for the detailed write-up. Denial of Service class issues don&#39;t really fit the &quot;severe&quot; criteria of this program, but this might be an unusual case given the number of applications involved here. I&#39;ll get a verdict from the panel and update shortly.</p>\n", 
            "type": "Activities::Comment", 
            "id": 27634, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-04-17T13:14:51.229Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-04-17T13:14:51.229Z", 
            "actor": {
                "username": "gianko", 
                "url": "/gianko", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/807/de8119205f461456edfb6383d95d2b652c26f351_medium.png?1405671588"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "hi @arice, any updates to share with me on that? ", 
            "markdown_message": "<p>hi <a href=\"/arice\">@arice</a>, any updates to share with me on that? </p>\n", 
            "type": "Activities::Comment", 
            "id": 31719, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "gianko", 
                "url": "/gianko"
            }, 
            "created_at": "2014-04-20T21:14:55.286Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-04-20T21:14:55.286Z", 
            "actor": {
                "username": "arice", 
                "url": "/arice", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/74e2a8a31fee27a0c9b3d1d90dd64f4e38b2fb1c_medium.jpeg?1466604112"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugResolved", 
            "id": 33573, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2014-04-20T21:15:06.914Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-04-20T21:15:06.914Z", 
            "actor": {
                "url": "/internet", 
                "profile": {
                    "name": "The Internet"
                }, 
                "ibb": true, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/38e952fcff2c0aae0d011d5cecd07e5f62ecbd63_medium.png?1383767658"
                }
            }, 
            "team_handle": "internet", 
            "bounty_amount": "500.0", 
            "collaborator": {
                "username": "gianko", 
                "url": "/gianko"
            }, 
            "message": "Thanks for being patient with us. Denial of Service isn't what we really designed this bounty program for, but this issue had particularly widespread impact. We're breaking with the scope we set to make an exception here. This was a good find and handled very responsibly, thanks for the effort here!", 
            "markdown_message": "<p>Thanks for being patient with us. Denial of Service isn&#39;t what we really designed this bounty program for, but this issue had particularly widespread impact. We&#39;re breaking with the scope we set to make an exception here. This was a good find and handled very responsibly, thanks for the effort here!</p>\n", 
            "type": "Activities::BountyAwarded", 
            "id": 33574, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-04-20T21:15:34.711Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-04-20T21:15:34.711Z", 
            "actor": {
                "username": "arice", 
                "url": "/arice", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/74e2a8a31fee27a0c9b3d1d90dd64f4e38b2fb1c_medium.jpeg?1466604112"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 33575, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-04-20T21:15:34.851Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-04-20T21:15:34.851Z", 
            "actor": {
                "username": "arice", 
                "url": "/arice", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/74e2a8a31fee27a0c9b3d1d90dd64f4e38b2fb1c_medium.jpeg?1466604112"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 33576, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-05-15T18:08:46.046Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-05-15T18:08:46.046Z", 
            "actor": {
                "username": "arice", 
                "url": "/arice", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/74e2a8a31fee27a0c9b3d1d90dd64f4e38b2fb1c_medium.jpeg?1466604112"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "This bounty was donated to the [EFF](https://www.eff.org/) at the request of @gianko. Thanks again @gianko!", 
            "markdown_message": "<p>This bounty was donated to the <a href=\"/redirect?signature=1d63e8fc7303c95d4108c92cc6af44a20d9c352f&amp;url=https%3A%2F%2Fwww.eff.org%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>EFF</span><i class=\"icon-external-link\"></i></a> at the request of <a href=\"/gianko\">@gianko</a>. Thanks again <a href=\"/gianko\">@gianko</a>!</p>\n", 
            "type": "Activities::Comment", 
            "id": 51792, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "gianko", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/gianko", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/002/807/cead35cf28177590a21959b5b3cf1bbad853deff_small.png?1405671588"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 48, 
        "name": "Denial of Service"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -146109043.79600313, 
    "disclosed_at": "2014-04-20T21:15:34.837Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/5928", 
    "created_at": "2014-04-05T07:14:39.739Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>The bug information described below is based on a publicly available security notice here <a title=\"http://xmpp.org/resources/security-notices/uncontrolled-resource-consumption-with-highly-compressed-xmpp-stanzas/\" href=\"/redirect?signature=a6c7afdf137341dc8dd08c4c8f36e810d4f55494&amp;url=http%3A%2F%2Fxmpp.org%2Fresources%2Fsecurity-notices%2Funcontrolled-resource-consumption-with-highly-compressed-xmpp-stanzas%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://xmpp.org/resources/security-notices/uncontrolled-resource-consumption-with-highly-compressed-xmpp-stanzas/</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>These discoveries are part of the results of my research activities.</p>\n\n<h2 id=\"overview\">OVERVIEW</h2>\n\n<p>Several XMPP server implementations that support application-layer compression (XEP-0138) suffer from an uncontrolled resource consumption vulnerability (CWE-400). This vulnerability can be remotely exploited by attackers to mount Denial-of-Service attacks by sending highly-compressed XML elements over XMPP streams.</p>\n\n<p>In addition to that, the XMPP Standards Foundation committed into changing the XEP-0138 in or</p>\n\n<h2 id=\"description\">DESCRIPTION</h2>\n\n<p>XMPP stream compression is a desirable feature that reduces the amount of data transferred between the protocol principals. In XMPP, compression can be negotiated at the TLS layer (as described in RFC 6120) or at the application layer (as described in XEP-0138). The vulnerability that has been discovered applies specifically to application-layer compression; such compression is negotiated between an XMPP client and server (or two servers). After a successful negotiation, all the protocol messages are compressed.</p>\n\n<p>When decompressing XMPP stanzas, an XMPP server must limit the resources allocated to this task. If the server fails to do that, it can monopolize the CPU usage and allocate all the available memory. As a result, remote attackers can exploit this vulnerability to mount a Denial of Service attack (DoS) by submitting highly-compressed XML elements over an XMPP stream (we call these \u201cxmppbombs\u201d for short).</p>\n\n<p>An \u201cxmppbomb\u201d is a valid XML element sent over an XML stream but containing a huge number of white spaces. See for example the following element sent during stream negotiation:</p>\n\n<p>&lt;?xml version=&#39;1.0&#39; ?&gt;<br>\n   &lt;stream:stream $SPACES to=&#39;$SERVER&#39;<br>\n           xmlns=&#39;jabber:client&#39;<br>\n           xmlns:stream=&#39;http://etherx.jabber.org/streams&#39;<br>\n           version=&#39;1.0&#39;&gt;<br>\nwhere $SPACES is a 4GB long string of spaces and $SERVER is the server domain name. By using the zlib compression algorithm, it is possible to compress the above message to 4MB (compression ratio of ~1:1000).</p>\n\n<p>XEP-0170 on \u201cRecommended Order of Stream Feature Negotiation\u201d suggests to negotiate stream compression after the authentication of the principals. This suggests that xmppbombs can be used only after the user authentication. However, it has been reported that some implementations allow the use of compression before the authentication phase therefore opening up this vulnerability to unknown attackers.</p>\n\n<h2 id=\"impact\">IMPACT</h2>\n\n<p>Affected servers are reported to:<br>\n1) Consume the virtual memory; in certain cases, it has been reported that servers are terminated by the operating system for out of memory conditions;<br>\n2) Monopolize the use of the CPU;<br>\n3) In certain cases, not allow administrators to disable stream compression.</p>\n\n<h2 id=\"solution\">SOLUTION</h2>\n\n<p>It is best to upgrade to corrected server code. An alternative, temporary workaround is to disable XMPP-level compression.</p>\n\n<h2 id=\"proofs-of-concept\">PROOFS OF CONCEPT</h2>\n\n<p>Two proofs of concept are available here <a title=\"http://trouge.net/misc/xmppbomb_exploit.tar.bz2\" href=\"/redirect?signature=800973607e37f9c028b602659a55009c03ffa2eb&amp;url=http%3A%2F%2Ftrouge.net%2Fmisc%2Fxmppbomb_exploit.tar.bz2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://trouge.net/misc/xmppbomb_exploit.tar.bz2</span><i class=\"icon-external-link\"></i></a> (don&#39;t worry, no zipbombs here :) ).  Please refer to the README file for more information.</p>\n\n<p>It contains two attacks: #1 before the principal authentication and #2 after. I used these two attacks  to confirm the vulnerability on 3 implementations: Prosody 0.9.3, Openfire 3.9.1, and Tigase server 5.2.0.  The vulnerability and the DoS has been monitored in a black-box settings by monitoring the resources consumed (i.e., CPU usage, RSS/VSZ memory, and disk I/O). In addition, we measured the availability of the XMPP server under test as the number of (honest) requests processed per second during the attack and compared when not under attack.</p>\n\n<p>The code and the explanation below has been shared with the XMPP community (vendors and admin). </p>\n\n<p>The list of affected vendors can be found here <a title=\"http://xmpp.org/resources/security-notices/uncontrolled-resource-consumption-with-highly-compressed-xmpp-stanzas/\" href=\"/redirect?signature=a6c7afdf137341dc8dd08c4c8f36e810d4f55494&amp;url=http%3A%2F%2Fxmpp.org%2Fresources%2Fsecurity-notices%2Funcontrolled-resource-consumption-with-highly-compressed-xmpp-stanzas%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://xmpp.org/resources/security-notices/uncontrolled-resource-consumption-with-highly-compressed-xmpp-stanzas/</span><i class=\"icon-external-link\"></i></a></p>\n\n<h2 id=\"preliminaries\">PRELIMINARIES</h2>\n\n<p>xmppbombs can be generated with XMPPBombGen.java. In all our tests, we used xmppbombs of the size of 4MB that amounts to 4GB of uncompressed XMPP message each.</p>\n\n<h2 id=\"attack-1-xmppbomb-before-authentication\">ATTACK #1: xmppbomb before authentication</h2>\n\n<p>An example of this attack is in XMPPBombNoAuth.java. The attack is the following:</p>\n\n<p>1) the attacker prepares offline a xmppbomb</p>\n\n<p>2) the attacker then starts the XMPP protocol with the target by sending:<br>\n&lt;?xml version=&#39;1.0&#39;?&gt;&lt;stream:stream to=&#39;server&#39; xmlns=&#39;jabber:client&#39; xmlns:stream=&#39;http://etherx.jabber.org/streams&#39; version=&#39;1.0&#39;&gt;</p>\n\n<p>3) afterwards, the attacker requests to enable on the DEFLATE compression:<br>\n&lt;compress xmlns=&#39;http://jabber.org/protocol/compress&#39;&gt;&lt;method&gt;zlib&lt;/method&gt;&lt;/compress&gt;</p>\n\n<p>4) finally, the attacker sends the xmppbomb</p>\n\n<p>The steps 2-4 can be executed concurrently (e.g., by colluded attackers, or with a botnet).</p>\n\n<p>We found out that Prosody and Openfire are vulnerable to this attack. Prosody allocates up to 7GB of physical memory (RSS memory) with a single xmppbomb with 4GB of payload. The process is finally killed by the kernel due to an out of memory. Openfire uses instead 100% of the CPU and a bit less memory than Prosody (3GB) plus it writes to disk about 400 MB of data. We monitored delays on the availability of the service from x100 times to x10000 with parallel xmppbombs (12 or 24 parallel bombs).</p>\n\n<h2 id=\"attack-2-xmppbomb-after-authentication\">ATTACK #2: xmppbomb after authentication:</h2>\n\n<p>An example of this attack is in XMPPBombAuth.java. The attack is the following:</p>\n\n<p>1) the attacker prepares offline an xmppbomb</p>\n\n<p>2) the attacker then starts the XMPP protocol (see step 2 in Attack #1)</p>\n\n<p>3) the attacker logs in:<br>\n&lt;auth xmlns=&#39;urn:ietf:params:xml:ns:xmpp-sasl&#39; mechanism=&#39;PLAIN&#39; client-uses-full-bind-result=&#39;true&#39;&gt;$TOKEN&lt;/auth&gt;</p>\n\n<p>where $TOKEN is the base 64 of the user name and password.</p>\n\n<p>The attack then continues with step 3 and 4 of the attack #1.</p>\n\n<p>Tigase is vulnerable to this attack and one 4GB xmppbomb pushes the CPU usage up to 100% for about 10 minutes.</p>\n\n<h2 id=\"other-relevant-information\">OTHER RELEVANT INFORMATION</h2>\n\n<p>During the coordination process, I suggested the XMPP community to review the specifications. <br>\nThis is part of my suggestions :</p>\n\n<p>&quot;<br>\n[...]<br>\nI think that also the specs may warn developers on the risk of DoS via xmppbombs. The points 4 and 6 of Section 13.12 of RFC 6120 are SHOULDs rather than MUSTs and they refer only to uncompressed data. Then, XEP-0138 doesn&#39;t mention any XMPP-specific security consideration and it refers to the security consideration of TLS (See <a title=\"https://tools.ietf.org/html/rfc3749#page-5\" href=\"/redirect?signature=f03f96598a48af9a213ca21ede537bc4acbf1e22&amp;url=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc3749%23page-5\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://tools.ietf.org/html/rfc3749#page-5</span><i class=\"icon-external-link\"></i></a>) that addresses (1) a binary-oriented protocol (2) concerns when combining compression and encryption and (3) risk of data size expansion. I think that this left a grey area in which developers took different decisions leading to these vulnerabilities. IMHO, XEP-0138 should be amended with a subsection inside Section 7 saying that if points 4 and 6 of Section 13.12 of RFC 6120 are not implemented then the implementation may be vulnerable to DoS via xmppbombs.<br>\n[...]&quot;</p>\n\n<p>The community agreed on that and the corrected version of XEP0138 is on his way however I am not aware of a publication date.</p>\n\n<h2 id=\"vendor-information\">VENDOR INFORMATION</h2>\n\n<p>The list of affected vendors can be found here <a title=\"http://xmpp.org/resources/security-notices/uncontrolled-resource-consumption-with-highly-compressed-xmpp-stanzas/\" href=\"/redirect?signature=a6c7afdf137341dc8dd08c4c8f36e810d4f55494&amp;url=http%3A%2F%2Fxmpp.org%2Fresources%2Fsecurity-notices%2Funcontrolled-resource-consumption-with-highly-compressed-xmpp-stanzas%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://xmpp.org/resources/security-notices/uncontrolled-resource-consumption-with-highly-compressed-xmpp-stanzas/</span><i class=\"icon-external-link\"></i></a></p>\n", 
    "vulnerability_information": "The bug information described below is based on a publicly available security notice here http://xmpp.org/resources/security-notices/uncontrolled-resource-consumption-with-highly-compressed-xmpp-stanzas/\r\n\r\nThese discoveries are part of the results of my research activities.\r\n\r\n\r\nOVERVIEW\r\n---------------------\r\n\r\nSeveral XMPP server implementations that support application-layer compression (XEP-0138) suffer from an uncontrolled resource consumption vulnerability (CWE-400). This vulnerability can be remotely exploited by attackers to mount Denial-of-Service attacks by sending highly-compressed XML elements over XMPP streams.\r\n\r\nIn addition to that, the XMPP Standards Foundation committed into changing the XEP-0138 in or\r\n\r\n\r\nDESCRIPTION\r\n---------------------\r\n\r\nXMPP stream compression is a desirable feature that reduces the amount of data transferred between the protocol principals. In XMPP, compression can be negotiated at the TLS layer (as described in RFC 6120) or at the application layer (as described in XEP-0138). The vulnerability that has been discovered applies specifically to application-layer compression; such compression is negotiated between an XMPP client and server (or two servers). After a successful negotiation, all the protocol messages are compressed.\r\n\r\nWhen decompressing XMPP stanzas, an XMPP server must limit the resources allocated to this task. If the server fails to do that, it can monopolize the CPU usage and allocate all the available memory. As a result, remote attackers can exploit this vulnerability to mount a Denial of Service attack (DoS) by submitting highly-compressed XML elements over an XMPP stream (we call these \u201cxmppbombs\u201d for short).\r\n\r\nAn \u201cxmppbomb\u201d is a valid XML element sent over an XML stream but containing a huge number of white spaces. See for example the following element sent during stream negotiation:\r\n\r\n<?xml version='1.0' ?>\r\n   <stream:stream $SPACES to='$SERVER'\r\n           xmlns='jabber:client'\r\n           xmlns:stream='http://etherx.jabber.org/streams'\r\n           version='1.0'>\r\nwhere $SPACES is a 4GB long string of spaces and $SERVER is the server domain name. By using the zlib compression algorithm, it is possible to compress the above message to 4MB (compression ratio of ~1:1000).\r\n\r\nXEP-0170 on \u201cRecommended Order of Stream Feature Negotiation\u201d suggests to negotiate stream compression after the authentication of the principals. This suggests that xmppbombs can be used only after the user authentication. However, it has been reported that some implementations allow the use of compression before the authentication phase therefore opening up this vulnerability to unknown attackers.\r\n\r\n\r\nIMPACT\r\n---------------------\r\n\r\nAffected servers are reported to:\r\n1) Consume the virtual memory; in certain cases, it has been reported that servers are terminated by the operating system for out of memory conditions;\r\n2) Monopolize the use of the CPU;\r\n3) In certain cases, not allow administrators to disable stream compression.\r\n\r\n\r\nSOLUTION\r\n---------------------\r\n\r\nIt is best to upgrade to corrected server code. An alternative, temporary workaround is to disable XMPP-level compression.\r\n\r\n\r\nPROOFS OF CONCEPT\r\n---------------------\r\n\r\nTwo proofs of concept are available here http://trouge.net/misc/xmppbomb_exploit.tar.bz2 (don't worry, no zipbombs here :) ).  Please refer to the README file for more information.\r\n\r\nIt contains two attacks: #1 before the principal authentication and #2 after. I used these two attacks  to confirm the vulnerability on 3 implementations: Prosody 0.9.3, Openfire 3.9.1, and Tigase server 5.2.0.  The vulnerability and the DoS has been monitored in a black-box settings by monitoring the resources consumed (i.e., CPU usage, RSS/VSZ memory, and disk I/O). In addition, we measured the availability of the XMPP server under test as the number of (honest) requests processed per second during the attack and compared when not under attack.\r\n\r\nThe code and the explanation below has been shared with the XMPP community (vendors and admin). \r\n\r\nThe list of affected vendors can be found here http://xmpp.org/resources/security-notices/uncontrolled-resource-consumption-with-highly-compressed-xmpp-stanzas/\r\n\r\n\r\nPRELIMINARIES\r\n---------------------\r\nxmppbombs can be generated with XMPPBombGen.java. In all our tests, we used xmppbombs of the size of 4MB that amounts to 4GB of uncompressed XMPP message each.\r\n\r\n\r\nATTACK #1: xmppbomb before authentication\r\n---------------------\r\n\r\nAn example of this attack is in XMPPBombNoAuth.java. The attack is the following:\r\n\r\n1) the attacker prepares offline a xmppbomb\r\n\r\n2) the attacker then starts the XMPP protocol with the target by sending:\r\n<?xml version='1.0'?><stream:stream to='server' xmlns='jabber:client' xmlns:stream='http://etherx.jabber.org/streams' version='1.0'>\r\n\r\n3) afterwards, the attacker requests to enable on the DEFLATE compression:\r\n<compress xmlns='http://jabber.org/protocol/compress'><method>zlib</method></compress>\r\n\r\n4) finally, the attacker sends the xmppbomb\r\n\r\nThe steps 2-4 can be executed concurrently (e.g., by colluded attackers, or with a botnet).\r\n\r\nWe found out that Prosody and Openfire are vulnerable to this attack. Prosody allocates up to 7GB of physical memory (RSS memory) with a single xmppbomb with 4GB of payload. The process is finally killed by the kernel due to an out of memory. Openfire uses instead 100% of the CPU and a bit less memory than Prosody (3GB) plus it writes to disk about 400 MB of data. We monitored delays on the availability of the service from x100 times to x10000 with parallel xmppbombs (12 or 24 parallel bombs).\r\n\r\n\r\nATTACK #2: xmppbomb after authentication:\r\n---------------------\r\n\r\nAn example of this attack is in XMPPBombAuth.java. The attack is the following:\r\n\r\n1) the attacker prepares offline an xmppbomb\r\n\r\n2) the attacker then starts the XMPP protocol (see step 2 in Attack #1)\r\n\r\n3) the attacker logs in:\r\n<auth xmlns='urn:ietf:params:xml:ns:xmpp-sasl' mechanism='PLAIN' client-uses-full-bind-result='true'>$TOKEN</auth>\r\n\r\nwhere $TOKEN is the base 64 of the user name and password.\r\n\r\nThe attack then continues with step 3 and 4 of the attack #1.\r\n\r\nTigase is vulnerable to this attack and one 4GB xmppbomb pushes the CPU usage up to 100% for about 10 minutes.\r\n\r\n\r\nOTHER RELEVANT INFORMATION\r\n---------------------\r\n\r\nDuring the coordination process, I suggested the XMPP community to review the specifications. \r\nThis is part of my suggestions :\r\n\r\n\"\r\n[...]\r\nI think that also the specs may warn developers on the risk of DoS via xmppbombs. The points 4 and 6 of Section 13.12 of RFC 6120 are SHOULDs rather than MUSTs and they refer only to uncompressed data. Then, XEP-0138 doesn't mention any XMPP-specific security consideration and it refers to the security consideration of TLS (See https://tools.ietf.org/html/rfc3749#page-5) that addresses (1) a binary-oriented protocol (2) concerns when combining compression and encryption and (3) risk of data size expansion. I think that this left a grey area in which developers took different decisions leading to these vulnerabilities. IMHO, XEP-0138 should be amended with a subsection inside Section 7 saying that if points 4 and 6 of Section 13.12 of RFC 6120 are not implemented then the implementation may be vulnerable to DoS via xmppbombs.\r\n[...]\"\r\n\r\nThe community agreed on that and the corrected version of XEP0138 is on his way however I am not aware of a publication date.\r\n\r\n\r\nVENDOR INFORMATION\r\n---------------------\r\n\r\nThe list of affected vendors can be found here http://xmpp.org/resources/security-notices/uncontrolled-resource-consumption-with-highly-compressed-xmpp-stanzas/", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "", 
            "about": "Hack all the things.", 
            "twitter_handle": null, 
            "name": "The Internet"
        }, 
        "handle": "internet", 
        "url": "https://hackerone.com/internet", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/020/b94983d2ec09553c3e08f98cc718cb17e01112e6_small.png?1383767658", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/38e952fcff2c0aae0d011d5cecd07e5f62ecbd63_medium.png?1383767658"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 20, 
        "default_currency": "usd"
    }, 
    "is_published": false
}