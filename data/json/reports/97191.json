{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2015-11-14T14:47:09.494Z", 
    "voters": [
        "spam404", 
        "vraj", 
        "fantam1", 
        "dyabla"
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "2500.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 97191, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2015-11-14T02:15:17.784Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "Send AJAX request to external domain", 
    "is_member_of_team?": null, 
    "vote_count": 4, 
    "summaries": [
        {
            "category": "team", 
            "can_view?": true, 
            "can_edit?": false, 
            "id": 1017, 
            "content": "If the following conditions are met\u2026\n\n* You are an admin of a demo team\n* And you click a malicious link provided by an attacker\n* And you are social engineered into interacting with the displayed dialog\n* And you are using a browser that doesn't support `Content Security Policy` (such as Internet Explorer)\n\n\u2026 then a same-origin policy violation could occur.", 
            "content_html": "<p>If the following conditions are met\u2026</p>\n\n<ul>\n<li>You are an admin of a demo team</li>\n<li>And you click a malicious link provided by an attacker</li>\n<li>And you are social engineered into interacting with the displayed dialog</li>\n<li>And you are using a browser that doesn&#39;t support <code>Content Security Policy</code> (such as Internet Explorer)</li>\n</ul>\n\n<p>\u2026 then a same-origin policy violation could occur.</p>\n"
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2015-12-14T02:15:18.168Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$2,500", 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2015-11-02T08:59:23.643Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-11-02T08:59:23.643Z", 
            "actor": {
                "username": "rso", 
                "url": "/rso", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/031/6f31586cafb38ae28f4ac169afd949040502485f_medium.jpg?1404415166"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "1. We have a strongly enforced CSP policy, which means that we don't allow visits from browsers that don't have support for CSP.\n2. I booted up a Windows VM with Internet Explorer 11, but could not reproduce your issue. Are you sure that you don't have some browser extension enabled that does the fetching?\n\nPlease provide specific version numbers and steps to reproduce.", 
            "markdown_message": "<ol>\n<li>We have a strongly enforced CSP policy, which means that we don&#39;t allow visits from browsers that don&#39;t have support for CSP.</li>\n<li>I booted up a Windows VM with Internet Explorer 11, but could not reproduce your issue. Are you sure that you don&#39;t have some browser extension enabled that does the fetching?</li>\n</ol>\n\n<p>Please provide specific version numbers and steps to reproduce.</p>\n", 
            "type": "Activities::BugNeedsMoreInfo", 
            "id": 640756, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-11-02T13:38:03.808Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-11-02T13:38:03.808Z", 
            "actor": {
                "username": "r0x33d", 
                "url": "/r0x33d", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/902/f66675c055545d0fa09c52bf4ba7f6beaf5cfc41_medium.php?1394007758"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "@rso\n\n1) Yes, You have nice `Content-Security-Policy` header but Internet Explorer uses experimental `X-Content-Security-Policy` header according to Wikipedia info (https://en.wikipedia.org/wiki/Content_Security_Policy#Status)\n\nOther proofs: \nhttp://www.sitepoint.com/improving-web-security-with-the-content-security-policy/#browser-support\nhttp://www.w3.org/TR/2012/WD-CSP11-20121213/.\n\nAlso `Feature request` for `Content-Security-Policy` header on `connect.microsoft.com` still has `Active` status (not `Closed`) here https://connect.microsoft.com/IE/feedback/details/793746/ie11-feature-request-support-for-the-content-security-policy-header\n\n2) I have tested it in Internet Explorer 11.0.9600.17126, Windows 7\n\nHere is video PoC: https://www.dropbox.com/s/5rh7cv97gy3hece/h1_2.avi?dl=0", 
            "markdown_message": "<p><a href=\"/rso\">@rso</a></p>\n\n<p>1) Yes, You have nice <code>Content-Security-Policy</code> header but Internet Explorer uses experimental <code>X-Content-Security-Policy</code> header according to Wikipedia info (<a title=\"https://en.wikipedia.org/wiki/Content_Security_Policy#Status\" href=\"/redirect?signature=2a0c9549d5bdca6e0e602a36d9e958ae832cf1b3&amp;url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FContent_Security_Policy%23Status\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://en.wikipedia.org/wiki/Content_Security_Policy#Status</span><i class=\"icon-external-link\"></i></a>)</p>\n\n<p>Other proofs: <br>\n<a title=\"http://www.sitepoint.com/improving-web-security-with-the-content-security-policy/#browser-support\" href=\"/redirect?signature=90298768b49a3d2801c22ffd934114a124ad8556&amp;url=http%3A%2F%2Fwww.sitepoint.com%2Fimproving-web-security-with-the-content-security-policy%2F%23browser-support\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://www.sitepoint.com/improving-web-security-with-the-content-security-policy/#browser-support</span><i class=\"icon-external-link\"></i></a><br>\n<a title=\"http://www.w3.org/TR/2012/WD-CSP11-20121213/\" href=\"/redirect?signature=04b4fd30a04f5918483e3bc444e7caaf9183ee17&amp;url=http%3A%2F%2Fwww.w3.org%2FTR%2F2012%2FWD-CSP11-20121213%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://www.w3.org/TR/2012/WD-CSP11-20121213/</span><i class=\"icon-external-link\"></i></a>.</p>\n\n<p>Also <code>Feature request</code> for <code>Content-Security-Policy</code> header on <code>connect.microsoft.com</code> still has <code>Active</code> status (not <code>Closed</code>) here <a title=\"https://connect.microsoft.com/IE/feedback/details/793746/ie11-feature-request-support-for-the-content-security-policy-header\" href=\"/redirect?signature=e7dc6046c807a139de5e060908d339f5b2aaa1f1&amp;url=https%3A%2F%2Fconnect.microsoft.com%2FIE%2Ffeedback%2Fdetails%2F793746%2Fie11-feature-request-support-for-the-content-security-policy-header\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://connect.microsoft.com/IE/feedback/details/793746/ie11-feature-request-support-for-the-content-security-policy-header</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>2) I have tested it in Internet Explorer 11.0.9600.17126, Windows 7</p>\n\n<p>Here is video PoC: <a title=\"https://www.dropbox.com/s/5rh7cv97gy3hece/h1_2.avi?dl=0\" href=\"/redirect?signature=ac7174e56ff5016ba348ef84402681fc8fcea26d&amp;url=https%3A%2F%2Fwww.dropbox.com%2Fs%2F5rh7cv97gy3hece%2Fh1_2.avi%3Fdl%3D0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.dropbox.com/s/5rh7cv97gy3hece/h1_2.avi?dl=0</span><i class=\"icon-external-link\"></i></a></p>\n", 
            "type": "Activities::BugNew", 
            "id": 640934, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-11-02T13:59:14.315Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-11-02T13:59:14.315Z", 
            "actor": {
                "username": "r0x33d", 
                "url": "/r0x33d", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/902/f66675c055545d0fa09c52bf4ba7f6beaf5cfc41_medium.php?1394007758"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "@rso Can You, please, check Your console (F12) in IE11 for errors when You visit PoC?", 
            "markdown_message": "<p><a href=\"/rso\">@rso</a> Can You, please, check Your console (F12) in IE11 for errors when You visit PoC?</p>\n", 
            "type": "Activities::Comment", 
            "id": 640955, 
            "genius_execution_id": null
        }, 
        {
            "attachments": [
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/059/961/333456821fb15668cc1deb345fa2c773499827ed/h1_xss.jpg?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ74T23ZH2%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T225812Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDKP8gtonlolbwRCFkSK3A8zRiM4XrfrPxhuRQyPzGewY%2F8%2BrZubJgueFivdcxl7%2F3iKHqTcriXEfjKl%2BSTmdTrFI3DombVHMKOYwlG1hM21jXAfSh72gDN%2BHds5TF5Hko27v6DRiCzuemhdgF47giYHnyCL3NCtcZ280H43hMDk8jiMZIUa5jSGS%2FYM0UQD2eITjNKscKu9Fg3jnQOs%2FtI0LbTq4ZOYkHzJsx3Gx5wmY15OB78PVb%2FoanvGsdZ1G6JLoOvoTJtP%2BBGbZSfLbuJ1WmFVnDe95bwaZBXmmNFIwMDxV%2BIfpWj4A6egpifpz3xxmRRWcE1dqWPIhLKaatOintqSYA20U00rLoCNdGd9IKmu0qa6%2B8Nt35qrWRxLjUKFoVkfzI8plSmUmq%2B7hZ71fbl9wB5sUhWpjZP521spZTb6QY8FJEa8S3BRJSDNUSr0ecK5GZt3wvmq5ONCWAeZbidiSFNHoYpY72e9tiuClRIfQzkSOa7JE0OSN9ATAt8rjzLAGibK5D8CP7%2F23wI%2Fce9%2BQ7jYxhSDeUleT1ird2slt6z2voHzFGPzgGkupeiNthV4QvkyXxyIQFGYYyeRDJ%2FnjD%2Boo666m4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=1a24cc2ccea646541fe7f609974b37f02fee632b09fd64ff01cb1905e456aa73", 
                    "type": "image/jpeg", 
                    "id": 59961, 
                    "filename": "h1_xss.jpg"
                }
            ], 
            "automated_response": false, 
            "created_at": "2015-11-03T01:07:21.338Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-11-03T01:09:25.059Z", 
            "actor": {
                "username": "r0x33d", 
                "url": "/r0x33d", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/902/f66675c055545d0fa09c52bf4ba7f6beaf5cfc41_medium.php?1394007758"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "Speaking about XSS, I still look. Now I have only XSS with user interaction. If You visit https://hackerone.com/bugs?subject=%2Fbigbob.lv%2F1338.php%3Fdata%3D - You can see there some message about policy asking to click green button. Then, there is some error which asks to go to `Settings` page and `Settings` page URL is `javascript:alert(document.domain);`. If I get invitation-only program JSON file, maybe I would be lucky to find XSS without user interaction.\n\nBy the way, have You been able to reproduce the first PoC in Internet Explorer?", 
            "markdown_message": "<p>Speaking about XSS, I still look. Now I have only XSS with user interaction. If You visit <a title=\"https://hackerone.com/bugs?subject=%2Fbigbob.lv%2F1338.php%3Fdata%3D\" href=\"https://hackerone.com/bugs?subject=%2Fbigbob.lv%2F1338.php%3Fdata%3D\">https://hackerone.com/bugs?subject=%2Fbigbob.lv%2F1338.php%3Fdata%3D</a> - You can see there some message about policy asking to click green button. Then, there is some error which asks to go to <code>Settings</code> page and <code>Settings</code> page URL is <code>javascript:alert(document.domain);</code>. If I get invitation-only program JSON file, maybe I would be lucky to find XSS without user interaction.</p>\n\n<p>By the way, have You been able to reproduce the first PoC in Internet Explorer?</p>\n", 
            "type": "Activities::Comment", 
            "id": 642031, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-11-03T03:12:10.799Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-11-03T03:12:10.799Z", 
            "actor": {
                "username": "ebrynne", 
                "url": "/ebrynne", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/017/191/caa360ba5182e4fd7930e394d9fa654d468e6a20_medium.?1461015075"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "Hey @killr0x33d,\n\nThanks for the kickass report! It took a while to replicate this because it took a little extra magic to get working in development (and we couldn't test your links because they linked to your sandboxed program), but I believe I understand it now and we'll start patching. Here are the components of your exploit as I understand them:\n\n1) We weren't using the `X-Content-Security-Policy` header, which we need to be using for IE 10/11. We just added that header which should fix the vulnerability, so if you could verify for us that you now get CSP violation errors instead of being able to load the content, that would be fantastic.\n2) There's something weird about the way we handle an escaped leading slash in a team name, so when you use a team name like `%2Fbigbob.lv%2F1337.php%3Fdata%3D`, we end up requesting data from `http://bigbob.lv/1337.php?data=/reporters` instead of `http://hackerone.com/%2Fbigbob.lv%2F1337.php%3Fdata%3D/reporters`.\n3) I don't fully understand yet how you produced the alert in the screenshot attached to your most recent comment. Having examined the data you're injecting from `http://bigbob.lv/` (from `/`, `/reporters` and `/team_members`), there doesn't appear to be any code that would alter the contents of the demo banner or inject an alert with that content. Could you clarify where that content is being injected from? I'll be super impressed if there's another entirely distinct component to this exploit.\n\nAs I mentioned above the first issue should be fixed now so we should be safe, and I'm opening a task for the second issue. Please let me know if I missed a component of the third\n\nThanks again for the report, we'll keep you posted as our solution progresses.\n\n \n \n-Evan", 
            "markdown_message": "<p>Hey <a href=\"/killr0x33d\">@killr0x33d</a>,</p>\n\n<p>Thanks for the kickass report! It took a while to replicate this because it took a little extra magic to get working in development (and we couldn&#39;t test your links because they linked to your sandboxed program), but I believe I understand it now and we&#39;ll start patching. Here are the components of your exploit as I understand them:</p>\n\n<p>1) We weren&#39;t using the <code>X-Content-Security-Policy</code> header, which we need to be using for IE 10/11. We just added that header which should fix the vulnerability, so if you could verify for us that you now get CSP violation errors instead of being able to load the content, that would be fantastic.<br>\n2) There&#39;s something weird about the way we handle an escaped leading slash in a team name, so when you use a team name like <code>%2Fbigbob.lv%2F1337.php%3Fdata%3D</code>, we end up requesting data from <code>http://bigbob.lv/1337.php?data=/reporters</code> instead of <code>http://hackerone.com/%2Fbigbob.lv%2F1337.php%3Fdata%3D/reporters</code>.<br>\n3) I don&#39;t fully understand yet how you produced the alert in the screenshot attached to your most recent comment. Having examined the data you&#39;re injecting from <code>http://bigbob.lv/</code> (from <code>/</code>, <code>/reporters</code> and <code>/team_members</code>), there doesn&#39;t appear to be any code that would alter the contents of the demo banner or inject an alert with that content. Could you clarify where that content is being injected from? I&#39;ll be super impressed if there&#39;s another entirely distinct component to this exploit.</p>\n\n<p>As I mentioned above the first issue should be fixed now so we should be safe, and I&#39;m opening a task for the second issue. Please let me know if I missed a component of the third</p>\n\n<p>Thanks again for the report, we&#39;ll keep you posted as our solution progresses.</p>\n\n<p>-Evan</p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 642094, 
            "genius_execution_id": null
        }, 
        {
            "attachments": [
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/059/990/b54ad0780836360e0c0c475081c466efee7a16ee/h1_js.jpg?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ74T23ZH2%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T225812Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDKP8gtonlolbwRCFkSK3A8zRiM4XrfrPxhuRQyPzGewY%2F8%2BrZubJgueFivdcxl7%2F3iKHqTcriXEfjKl%2BSTmdTrFI3DombVHMKOYwlG1hM21jXAfSh72gDN%2BHds5TF5Hko27v6DRiCzuemhdgF47giYHnyCL3NCtcZ280H43hMDk8jiMZIUa5jSGS%2FYM0UQD2eITjNKscKu9Fg3jnQOs%2FtI0LbTq4ZOYkHzJsx3Gx5wmY15OB78PVb%2FoanvGsdZ1G6JLoOvoTJtP%2BBGbZSfLbuJ1WmFVnDe95bwaZBXmmNFIwMDxV%2BIfpWj4A6egpifpz3xxmRRWcE1dqWPIhLKaatOintqSYA20U00rLoCNdGd9IKmu0qa6%2B8Nt35qrWRxLjUKFoVkfzI8plSmUmq%2B7hZ71fbl9wB5sUhWpjZP521spZTb6QY8FJEa8S3BRJSDNUSr0ecK5GZt3wvmq5ONCWAeZbidiSFNHoYpY72e9tiuClRIfQzkSOa7JE0OSN9ATAt8rjzLAGibK5D8CP7%2F23wI%2Fce9%2BQ7jYxhSDeUleT1ird2slt6z2voHzFGPzgGkupeiNthV4QvkyXxyIQFGYYyeRDJ%2FnjD%2Boo666m4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=4baaa951a5e313035ffa77d401d3584017ecef8846682942c4c193a1ff903608", 
                    "type": "image/jpeg", 
                    "id": 59990, 
                    "filename": "h1_js.jpg"
                }, 
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/059/991/9e63a8da61d3bba01dad57534675425ded161da7/1338.php?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ74T23ZH2%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T225812Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDKP8gtonlolbwRCFkSK3A8zRiM4XrfrPxhuRQyPzGewY%2F8%2BrZubJgueFivdcxl7%2F3iKHqTcriXEfjKl%2BSTmdTrFI3DombVHMKOYwlG1hM21jXAfSh72gDN%2BHds5TF5Hko27v6DRiCzuemhdgF47giYHnyCL3NCtcZ280H43hMDk8jiMZIUa5jSGS%2FYM0UQD2eITjNKscKu9Fg3jnQOs%2FtI0LbTq4ZOYkHzJsx3Gx5wmY15OB78PVb%2FoanvGsdZ1G6JLoOvoTJtP%2BBGbZSfLbuJ1WmFVnDe95bwaZBXmmNFIwMDxV%2BIfpWj4A6egpifpz3xxmRRWcE1dqWPIhLKaatOintqSYA20U00rLoCNdGd9IKmu0qa6%2B8Nt35qrWRxLjUKFoVkfzI8plSmUmq%2B7hZ71fbl9wB5sUhWpjZP521spZTb6QY8FJEa8S3BRJSDNUSr0ecK5GZt3wvmq5ONCWAeZbidiSFNHoYpY72e9tiuClRIfQzkSOa7JE0OSN9ATAt8rjzLAGibK5D8CP7%2F23wI%2Fce9%2BQ7jYxhSDeUleT1ird2slt6z2voHzFGPzgGkupeiNthV4QvkyXxyIQFGYYyeRDJ%2FnjD%2Boo666m4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=11ea97f0e9dfc3876e74f952c3686439565086fe35abadc9ff0ebdf93abea5e7", 
                    "type": "text/x-php", 
                    "id": 59991, 
                    "filename": "1338.php"
                }, 
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/059/992/e6e0e8518c6ace2e318d9f24887d2692fcc100e8/h1_settings.jpg?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ74T23ZH2%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T225812Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDKP8gtonlolbwRCFkSK3A8zRiM4XrfrPxhuRQyPzGewY%2F8%2BrZubJgueFivdcxl7%2F3iKHqTcriXEfjKl%2BSTmdTrFI3DombVHMKOYwlG1hM21jXAfSh72gDN%2BHds5TF5Hko27v6DRiCzuemhdgF47giYHnyCL3NCtcZ280H43hMDk8jiMZIUa5jSGS%2FYM0UQD2eITjNKscKu9Fg3jnQOs%2FtI0LbTq4ZOYkHzJsx3Gx5wmY15OB78PVb%2FoanvGsdZ1G6JLoOvoTJtP%2BBGbZSfLbuJ1WmFVnDe95bwaZBXmmNFIwMDxV%2BIfpWj4A6egpifpz3xxmRRWcE1dqWPIhLKaatOintqSYA20U00rLoCNdGd9IKmu0qa6%2B8Nt35qrWRxLjUKFoVkfzI8plSmUmq%2B7hZ71fbl9wB5sUhWpjZP521spZTb6QY8FJEa8S3BRJSDNUSr0ecK5GZt3wvmq5ONCWAeZbidiSFNHoYpY72e9tiuClRIfQzkSOa7JE0OSN9ATAt8rjzLAGibK5D8CP7%2F23wI%2Fce9%2BQ7jYxhSDeUleT1ird2slt6z2voHzFGPzgGkupeiNthV4QvkyXxyIQFGYYyeRDJ%2FnjD%2Boo666m4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=3e41b8b8b21b619b17676f6d7e19d1495982ca07424e7c3a32dea64bd3c20c2b", 
                    "type": "image/jpeg", 
                    "id": 59992, 
                    "filename": "h1_settings.jpg"
                }
            ], 
            "automated_response": false, 
            "created_at": "2015-11-03T09:06:37.026Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-11-03T09:10:41.849Z", 
            "actor": {
                "username": "r0x33d", 
                "url": "/r0x33d", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/902/f66675c055545d0fa09c52bf4ba7f6beaf5cfc41_medium.php?1394007758"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "Hey @ebrynne,\n\nThanks for triaging!\n\n1) Hmm... I'm still able to connect to `https://bigbob.lv` in AJAX from `https://hackerone.com`. Maybe IE doesn't support `connect-src` attribute in CSP header? Or it is some IE bug for me. I see `X-Content-Security-Policy` header in response which is identical with `Content-Security-Policy` header and should work fine.\n\n2) It doesn't matter what team name You have. If You put `/google.com` into `subject` GET param: https://hackerone.com/bugs?subject=/google.com - You will see requests to `https://google.com`.  \n\nIt happens because of JS code `return \"/\" + this.bugs_filter_state.get(\"subject\") + \"/team_members\"` in https://hackerone.com/assets/frontend-d35701f7.js for `/team_members` request (the same for other requests). When You put `/` slash in start of `subject` GET param, this JS line returns string which starts with `//`. Then script makes AJAX request to this returned string but `//` means external URL for browsers. So, there is no need for attacker's victim to create custom team which name starts with `%2F`, just go to `/bugs` page with attacker's custom `subject` GET parameter value.\n\n3) Yes, there doesn't appear any code with alert because it appears only when You click `Leave demo` button. Your JavaScript code creates modal box using JSON data received before from `https://bigbob.lv`. \n\nI attach this `1338.php` file from `https://bigbob.lv`. It handles all these 3 requests differently. \n\nIf You check `ELSE` block in `1338.php` (it happens when `$data` is empty, request `https://bigbob.lv/1338.php?data=`), You can see that JSON `settings_link` has value `javascript:alert(document.domain);`. Your JavaScript code uses this `settings_link` in order to create modal box shown on `h1_settings.jpg`. It sets `Settings` URL `href` attribute to `settings_link` value.\n\nIf You click `Settings` in modal box shown on `h1_settings.jpg`, You will get alert executed. You can see also that this is `Sandboxed` program and think that it won't work for `Public` program but it will because all this data depends on JSON returned from these 3 requests which can be formed to be sent to external domain. For example, `state` value in returned JSON determines current program status and all handling of rendered page happens in Your JavaScript code, not on Your server-side. You can change `has_avatar?` value to `false` and You will see one more error when You click `Leave demo` button. You can change `has_policy?` to `true` and error shown on `h1_settings.jpg` will disappear there because all is based on returned JSON.\n\nBy the way, if You go to `Dashboard` in menu after visiting PoC, it will request statistics and all team data from external domain, because `subject` saves in session.", 
            "markdown_message": "<p>Hey <a href=\"/ebrynne\">@ebrynne</a>,</p>\n\n<p>Thanks for triaging!</p>\n\n<p>1) Hmm... I&#39;m still able to connect to <code>https://bigbob.lv</code> in AJAX from <code>https://hackerone.com</code>. Maybe IE doesn&#39;t support <code>connect-src</code> attribute in CSP header? Or it is some IE bug for me. I see <code>X-Content-Security-Policy</code> header in response which is identical with <code>Content-Security-Policy</code> header and should work fine.</p>\n\n<p>2) It doesn&#39;t matter what team name You have. If You put <code>/google.com</code> into <code>subject</code> GET param: <a title=\"https://hackerone.com/bugs?subject=/google.com\" href=\"https://hackerone.com/bugs?subject=/google.com\">https://hackerone.com/bugs?subject=/google.com</a> - You will see requests to <code>https://google.com</code>.  </p>\n\n<p>It happens because of JS code <code>return &quot;/&quot; + this.bugs_filter_state.get(&quot;subject&quot;) + &quot;/team_members&quot;</code> in <a title=\"https://hackerone.com/assets/frontend-d35701f7.js\" href=\"https://hackerone.com/assets/frontend-d35701f7.js\">https://hackerone.com/assets/frontend-d35701f7.js</a> for <code>/team_members</code> request (the same for other requests). When You put <code>/</code> slash in start of <code>subject</code> GET param, this JS line returns string which starts with <code>//</code>. Then script makes AJAX request to this returned string but <code>//</code> means external URL for browsers. So, there is no need for attacker&#39;s victim to create custom team which name starts with <code>%2F</code>, just go to <code>/bugs</code> page with attacker&#39;s custom <code>subject</code> GET parameter value.</p>\n\n<p>3) Yes, there doesn&#39;t appear any code with alert because it appears only when You click <code>Leave demo</code> button. Your JavaScript code creates modal box using JSON data received before from <code>https://bigbob.lv</code>. </p>\n\n<p>I attach this <code>1338.php</code> file from <code>https://bigbob.lv</code>. It handles all these 3 requests differently. </p>\n\n<p>If You check <code>ELSE</code> block in <code>1338.php</code> (it happens when <code>$data</code> is empty, request <code>https://bigbob.lv/1338.php?data=</code>), You can see that JSON <code>settings_link</code> has value <code>javascript:alert(document.domain);</code>. Your JavaScript code uses this <code>settings_link</code> in order to create modal box shown on <code>h1_settings.jpg</code>. It sets <code>Settings</code> URL <code>href</code> attribute to <code>settings_link</code> value.</p>\n\n<p>If You click <code>Settings</code> in modal box shown on <code>h1_settings.jpg</code>, You will get alert executed. You can see also that this is <code>Sandboxed</code> program and think that it won&#39;t work for <code>Public</code> program but it will because all this data depends on JSON returned from these 3 requests which can be formed to be sent to external domain. For example, <code>state</code> value in returned JSON determines current program status and all handling of rendered page happens in Your JavaScript code, not on Your server-side. You can change <code>has_avatar?</code> value to <code>false</code> and You will see one more error when You click <code>Leave demo</code> button. You can change <code>has_policy?</code> to <code>true</code> and error shown on <code>h1_settings.jpg</code> will disappear there because all is based on returned JSON.</p>\n\n<p>By the way, if You go to <code>Dashboard</code> in menu after visiting PoC, it will request statistics and all team data from external domain, because <code>subject</code> saves in session.</p>\n", 
            "type": "Activities::Comment", 
            "id": 642344, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-11-03T09:29:38.527Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-11-03T09:29:38.527Z", 
            "actor": {
                "username": "reed", 
                "url": "/reed", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/132/5781ea1c43c5c7680dd145226b86348a8d6ed085_medium.jpg?1394062279"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "Note that the known issues section of http://caniuse.com/#feat=contentsecuritypolicy states \"Partial support in Internet Explorer 10-11 refers to the browser only supporting the 'sandbox' directive by using the X-Content-Security-Policy header.\"\n\nIn fact, https://dev.windows.com/en-us/microsoft-edge/platform/status/contentsecuritypolicy states that CSP is not supported by IE at all (and only supported by Microsoft Edge).\n\nSo, seems that the X-CSP header isn't actually useful at all. As such, we'll likely remove it unless there is really some significant reason to keep it.", 
            "markdown_message": "<p>Note that the known issues section of <a title=\"http://caniuse.com/#feat=contentsecuritypolicy\" href=\"/redirect?signature=b0ddd0ea1bcbfb1f92ca5c373e8b3573449f7c38&amp;url=http%3A%2F%2Fcaniuse.com%2F%23feat%3Dcontentsecuritypolicy\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://caniuse.com/#feat=contentsecuritypolicy</span><i class=\"icon-external-link\"></i></a> states &quot;Partial support in Internet Explorer 10-11 refers to the browser only supporting the &#39;sandbox&#39; directive by using the X-Content-Security-Policy header.&quot;</p>\n\n<p>In fact, <a title=\"https://dev.windows.com/en-us/microsoft-edge/platform/status/contentsecuritypolicy\" href=\"/redirect?signature=7b1dbc1e70c956a6906a6102fa02f1652d470077&amp;url=https%3A%2F%2Fdev.windows.com%2Fen-us%2Fmicrosoft-edge%2Fplatform%2Fstatus%2Fcontentsecuritypolicy\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://dev.windows.com/en-us/microsoft-edge/platform/status/contentsecuritypolicy</span><i class=\"icon-external-link\"></i></a> states that CSP is not supported by IE at all (and only supported by Microsoft Edge).</p>\n\n<p>So, seems that the X-CSP header isn&#39;t actually useful at all. As such, we&#39;ll likely remove it unless there is really some significant reason to keep it.</p>\n", 
            "type": "Activities::Comment", 
            "id": 642364, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-11-03T22:16:43.137Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-11-03T22:16:43.137Z", 
            "actor": {
                "username": "ebrynne", 
                "url": "/ebrynne", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/017/191/caa360ba5182e4fd7930e394d9fa654d468e6a20_medium.?1461015075"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "Hey @killr0x33d \n\nThanks for your patience, we've rolled out a more comprehensive fix that's a little more aggressive. Would you be able to confirm for me again that it's fixed?\n\nThanks!\n\n\nEvan", 
            "markdown_message": "<p>Hey <a href=\"/killr0x33d\">@killr0x33d</a> </p>\n\n<p>Thanks for your patience, we&#39;ve rolled out a more comprehensive fix that&#39;s a little more aggressive. Would you be able to confirm for me again that it&#39;s fixed?</p>\n\n<p>Thanks!</p>\n\n<p>Evan</p>\n", 
            "type": "Activities::Comment", 
            "id": 643561, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-11-04T08:11:29.859Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-11-04T08:11:29.859Z", 
            "actor": {
                "username": "r0x33d", 
                "url": "/r0x33d", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/902/f66675c055545d0fa09c52bf4ba7f6beaf5cfc41_medium.php?1394007758"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "Hey @ebrynne \n\nYes, it is fixed now!", 
            "markdown_message": "<p>Hey <a href=\"/ebrynne\">@ebrynne</a> </p>\n\n<p>Yes, it is fixed now!</p>\n", 
            "type": "Activities::Comment", 
            "id": 644758, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "r0x33d", 
                "url": "/r0x33d"
            }, 
            "created_at": "2015-11-04T09:39:59.468Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-11-04T09:39:59.468Z", 
            "actor": {
                "username": "rso", 
                "url": "/rso", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/031/6f31586cafb38ae28f4ac169afd949040502485f_medium.jpg?1404415166"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "Thank you for your patience, and thanks again for reporting this vulnerability. Please be patient while we decide on a reward for your efforts.", 
            "markdown_message": "<p>Thank you for your patience, and thanks again for reporting this vulnerability. Please be patient while we decide on a reward for your efforts.</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 644834, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2015-11-14T02:08:59.998Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-11-14T02:08:59.998Z", 
            "actor": {
                "url": "/security", 
                "profile": {
                    "name": "HackerOne"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/013/28af2ada2cc00aa9427504fc5a14f587362df84b_medium.png?1445331713"
                }
            }, 
            "team_handle": "security", 
            "bounty_amount": "2500.0", 
            "collaborator": {
                "username": "r0x33d", 
                "url": "/r0x33d"
            }, 
            "message": "Thank you again for your submission. We appreciate the excellent report, and we look forward to future reports from you.", 
            "markdown_message": "<p>Thank you again for your submission. We appreciate the excellent report, and we look forward to future reports from you.</p>\n", 
            "type": "Activities::BountyAwarded", 
            "id": 657489, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-11-14T02:15:17.815Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-11-14T02:15:17.815Z", 
            "actor": {
                "username": "reed", 
                "url": "/reed", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/132/5781ea1c43c5c7680dd145226b86348a8d6ed085_medium.jpg?1394062279"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 657497, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-11-14T14:44:39.480Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-11-14T14:46:55.420Z", 
            "actor": {
                "username": "r0x33d", 
                "url": "/r0x33d", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/902/f66675c055545d0fa09c52bf4ba7f6beaf5cfc41_medium.php?1394007758"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "Wow! Thanks a lot for the bounty! By the way, the first condition in summary isn't necessary to be met because it depends from JSON which was outputed from external domain. If `status` param's value in JSON was `sandbox` then any user would see that notification where text is from JSON `name` attribute value. Also, user wasn't supposed to be team member.", 
            "markdown_message": "<p>Wow! Thanks a lot for the bounty! By the way, the first condition in summary isn&#39;t necessary to be met because it depends from JSON which was outputed from external domain. If <code>status</code> param&#39;s value in JSON was <code>sandbox</code> then any user would see that notification where text is from JSON <code>name</code> attribute value. Also, user wasn&#39;t supposed to be team member.</p>\n", 
            "type": "Activities::Comment", 
            "id": 657869, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-11-14T14:47:09.527Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-11-14T14:47:09.527Z", 
            "actor": {
                "username": "r0x33d", 
                "url": "/r0x33d", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/902/f66675c055545d0fa09c52bf4ba7f6beaf5cfc41_medium.php?1394007758"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 657870, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-11-14T14:47:09.925Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-11-14T14:47:09.925Z", 
            "actor": {
                "username": "r0x33d", 
                "url": "/r0x33d", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/902/f66675c055545d0fa09c52bf4ba7f6beaf5cfc41_medium.php?1394007758"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "security", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 657871, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "r0x33d", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/r0x33d", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/002/902/90b3373f5bfdcb3e4478799db21ae1f2f8fd0d73_small.php?1394007758"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 60, 
        "name": "Cross-site Scripting (XSS) - Generic"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -94077774.25346614, 
    "disclosed_at": "2015-11-14T14:47:09.895Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/97191", 
    "created_at": "2015-11-02T01:07:39.782Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>Hello!</p>\n\n<p>I would like to report about ability to send AJAX request from <code>hackerone.com</code> to external domain.</p>\n\n<p>Here is PoC for the last version of Internet Explorer: <a title=\"https://hackerone.com/bugs?subject=%2Fbigbob.lv%2F1337.php%3Fdata%3D\" href=\"https://hackerone.com/bugs?subject=%2Fbigbob.lv%2F1337.php%3Fdata%3D\">https://hackerone.com/bugs?subject=%2Fbigbob.lv%2F1337.php%3Fdata%3D</a></p>\n\n<p>If You visit it, You can see <code>Hello! This is custom text from external domain</code> text which is from JSON here <a title=\"https://bigbob.lv/1337.php\" href=\"/redirect?signature=fba3d0a1641534aca1e0da7b427bd5a3bba4b7a8&amp;url=https%3A%2F%2Fbigbob.lv%2F1337.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://bigbob.lv/1337.php</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>You can check console and see there 3 AJAX requests sent from <code>hackerone.com</code> to <code>bigbob.lv</code>.</p>\n\n<p>It is possible because there is no filtration of <code>/</code> slash in JavaScript when it handles <code>subject</code> GET param. So, it allows to send AJAX requests to external domain because of <code>//</code>.</p>\n\n<p>This PoC will work in old versions of popular browsers which don&#39;t support CSP (<a title=\"http://caniuse.com/#feat=contentsecuritypolicy\" href=\"/redirect?signature=b0ddd0ea1bcbfb1f92ca5c373e8b3573449f7c38&amp;url=http%3A%2F%2Fcaniuse.com%2F%23feat%3Dcontentsecuritypolicy\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://caniuse.com/#feat=contentsecuritypolicy</span><i class=\"icon-external-link\"></i></a>).</p>\n\n<p>I will try to achieve XSS.</p>\n\n<p>Thanks!</p>\n", 
    "vulnerability_information": "Hello!\n\nI would like to report about ability to send AJAX request from `hackerone.com` to external domain.\n\nHere is PoC for the last version of Internet Explorer: https://hackerone.com/bugs?subject=%2Fbigbob.lv%2F1337.php%3Fdata%3D\n\nIf You visit it, You can see `Hello! This is custom text from external domain` text which is from JSON here https://bigbob.lv/1337.php\n\nYou can check console and see there 3 AJAX requests sent from `hackerone.com` to `bigbob.lv`.\n\nIt is possible because there is no filtration of `/` slash in JavaScript when it handles `subject` GET param. So, it allows to send AJAX requests to external domain because of `//`.\n\nThis PoC will work in old versions of popular browsers which don't support CSP (http://caniuse.com/#feat=contentsecuritypolicy).\n\nI will try to achieve XSS.\n\nThanks!", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://hackerone.com", 
            "about": "Vulnerability disclosure should be safe, transparent, and rewarding.", 
            "twitter_handle": "Hacker0x01", 
            "name": "HackerOne"
        }, 
        "handle": "security", 
        "url": "https://hackerone.com/security", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/013/68fea1fe00dc833f4109e015738af4b374727e56_small.png?1445331713", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/013/28af2ada2cc00aa9427504fc5a14f587362df84b_medium.png?1445331713"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 13, 
        "default_currency": "usd"
    }, 
    "is_published": false
}