{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2018-05-16T08:37:41.399Z", 
    "voters": [
        "jokebookservice1", 
        "mvc", 
        "sp1d3rs", 
        "bl4de", 
        "osintopsec", 
        "spam404", 
        "bogdantcaciuc", 
        "w2w", 
        "eveeez", 
        "idem", 
        "and 17 more..."
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "750.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 351171, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2018-05-24T21:57:17.350Z", 
    "vulnerability_information": "Dear Valve security staff,\n\n\nShort description\n---------------------\n\nThere is a stored cross-site-scripting vulnerability present at the user search endpoint which can be exploited by modifying profile name of the would be attacking account. See POC picture.\n\n\nSteps to reproduce\n---------------------\n\n1. Obtain a account to act as a attacker and log in\n2. Go to https://steamcommunity.com/profiles/PROFILE_NUMBER/edit\n3. Edit field \"Profile Name\" to contain short name, and the payload. For example: \"__NAME'); alert(document.cookie+'__\", without the outermost double quotes\n4. With another browser or session, obtain a account to act as a victim and log in\n5. Navigate to https://steamcommunity.com/search/users/#text=\n6. Using the search field, search for the attacking account \"__NAME'); alert(document.cookie+'__\" without the outermost double quotes\n7. Click \"ADD AS FRIEND\" button next to the profile name\n8. Verify that clicking the button launches the payload and pops an alert dialog\n\n\nWhy is it there\n---------------------\n\nAll culminates on AddFriend-function call on the following line of code in user search html and the fact, that the function call can be escaped. The payload is \"__NAME'); alert(document.cookie+'__\" without the outermost quotes in the snippet.\n```\n<a href=\"#\" onclick=\"AddFriend(false,'PROFILE_NUMBER','NAME'); alert(document.cookie+''); $J(this).hide(); return false;\" class=\"btnv6_blue_hoverfade btn_small btn_uppercase\" style=\"display: none;\">\n    <span>Add as friend</span>\n</a>\n```\n\nImpact and assesment\n---------------------\n\nAs on any cross-site-scripting vulnerability. The top line would be that the attacker might steals cookies to abuse users session. For this particular vulnerability only by it self, successful exploiting is a bit more tricky, as currently the Profile Name -field only accepts 32 characters and it requires the victim to click on the button. Payloads can also utilize jQuery on the domain context.\n\nAs a mitigation of this, and vulnerabilities like this: addition to <, > and &, characters such as ' ; $ ( and ) should also be encoded when retrieved from the database, or even better, could be stored encoded.\n\nPS. It was funny to see that many users had tried to exploit the Profile Name -field previously, as they show on the search when searching for \"__alert(...)__\". I hope I'm in time not to be on the duplicate pool!\n\n## Impact\n\nAs on any cross-site-scripting vulnerability. The top line would be that the attacker might steals cookies to abuse users session. For this particular vulnerability only by it self, successful exploiting is a bit more tricky, as currently the Profile Name -field only accepts 32 characters and it requires the victim to click on the button.\n\nAs a mitigation of this, and vulnerabilities like this: characters such as ' ; $ ( and ) should also be encoded when retrieved from the database, or even better, could be stored encoded.\n\nThe hacker selected the **Cross-site Scripting (XSS) - Stored** weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\n\n**URL**\nhttps://steamcommunity.com/search/users/#text=\n\n**Verified**\nYes\n\n", 
    "activity_page_count": 1, 
    "severity": {
        "metrics": {
            "confidentiality": "low", 
            "privileges_required": "low", 
            "user_interaction": "required", 
            "attack_vector": "network", 
            "attack_complexity": "low", 
            "scope": "unchanged", 
            "integrity": "low", 
            "availability": "low"
        }, 
        "rating": "medium", 
        "score": 5.5, 
        "author_type": "User"
    }, 
    "title": "Stored XXS @ https://steamcommunity.com/search/users/#text= via Profile Name", 
    "is_member_of_team?": null, 
    "vote_count": 27, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": {
        "asset_identifier": "steamcommunity.com", 
        "max_severity": "critical", 
        "databaseId": 2430, 
        "asset_type": "URL"
    }, 
    "allow_singular_disclosure_at": null, 
    "state": "Closed", 
    "cve_ids": [], 
    "activity_page_number": 1, 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$750", 
    "attachments": [
        {
            "file_name": "alert_document_cookie.png", 
            "type": "image/png", 
            "id": 296949, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/296/949/eecd9c5627906ed263bab2e1e9b3ed8c195992af/alert_document_cookie.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5B43OTPE%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T222337Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDCiDARkX3ArKGaO7%2ByK3A39tqjzyooRkX4qPdNM7MkAemep3r5%2Fh%2B11ZdH6KbZ8q2cgU%2FRMODKRq75fJ6sn%2FkR1fBrPaMFfKsP%2BSLpkSrkbyi968FqbmO6yo59Heb3d1kDMwzaNShj3ou%2Fq9qAc5NWgXlxJtABJqkgxPd5NovxMOsASin8kfBjU8OhOOEnonvd2t16oF509MVoA81P%2Frmr4njIb3UfHzYyccuDQNjHM0qV7B57bCKQeIuO%2FzLl7au%2FWR2v6R6bwK6fGUYVbcnAam9GqobWJnMl6NFbipNSdmUzB5%2BglRYaYeGXxbgxseM7SSFeehfzbywUoHEf4Ve61V1e90uyx3M0Krbm5QjS5gNgwErj0g2rC2mkrl2q%2B9ADfOzgMAX8fUODFalEv4gZf0ZKuLhpmAzEapJE5f%2BarcSkdn5b0ddy4Wa2vdsZ6lQ5NOez8qkcnaBEJZLnv3YGHyInLrIaUkqlq4iavZpr4f5Al5PueqIzLuItn5ztJjfvCu5dDIplWP0eo6r%2BIUCKsDwUNkRSgWCtJbCfl%2BPF3PKHjvnmVEBawLZlpXvaOGUvA%2FKYb2cGGXn89CPjYlwpWCj2J8Z%2B0okbim4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=d36bbf1609634c73c9bc0ef4e8d01a13c89be6970bc9fa69177844f179fd4848"
        }
    ], 
    "singular_disclosure_disabled": true, 
    "activities": [
        {
            "attachments": [
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/297/556/4b6261e51404faff8f358e00e3a4c080d3a4da8a/script_injected.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5B43OTPE%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T222337Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDCiDARkX3ArKGaO7%2ByK3A39tqjzyooRkX4qPdNM7MkAemep3r5%2Fh%2B11ZdH6KbZ8q2cgU%2FRMODKRq75fJ6sn%2FkR1fBrPaMFfKsP%2BSLpkSrkbyi968FqbmO6yo59Heb3d1kDMwzaNShj3ou%2Fq9qAc5NWgXlxJtABJqkgxPd5NovxMOsASin8kfBjU8OhOOEnonvd2t16oF509MVoA81P%2Frmr4njIb3UfHzYyccuDQNjHM0qV7B57bCKQeIuO%2FzLl7au%2FWR2v6R6bwK6fGUYVbcnAam9GqobWJnMl6NFbipNSdmUzB5%2BglRYaYeGXxbgxseM7SSFeehfzbywUoHEf4Ve61V1e90uyx3M0Krbm5QjS5gNgwErj0g2rC2mkrl2q%2B9ADfOzgMAX8fUODFalEv4gZf0ZKuLhpmAzEapJE5f%2BarcSkdn5b0ddy4Wa2vdsZ6lQ5NOez8qkcnaBEJZLnv3YGHyInLrIaUkqlq4iavZpr4f5Al5PueqIzLuItn5ztJjfvCu5dDIplWP0eo6r%2BIUCKsDwUNkRSgWCtJbCfl%2BPF3PKHjvnmVEBawLZlpXvaOGUvA%2FKYb2cGGXn89CPjYlwpWCj2J8Z%2B0okbim4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=b2df9a8d6cf82a7d1200587f3e043c7128d0ab5367977d8e45f8c3bab11eb648", 
                    "type": "image/png", 
                    "id": 297556, 
                    "filename": "script_injected.png"
                }, 
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/297/552/5db9733615dc443f6647e78a200292f35e8f84d2/eval_payload_executed.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5B43OTPE%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T222337Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDCiDARkX3ArKGaO7%2ByK3A39tqjzyooRkX4qPdNM7MkAemep3r5%2Fh%2B11ZdH6KbZ8q2cgU%2FRMODKRq75fJ6sn%2FkR1fBrPaMFfKsP%2BSLpkSrkbyi968FqbmO6yo59Heb3d1kDMwzaNShj3ou%2Fq9qAc5NWgXlxJtABJqkgxPd5NovxMOsASin8kfBjU8OhOOEnonvd2t16oF509MVoA81P%2Frmr4njIb3UfHzYyccuDQNjHM0qV7B57bCKQeIuO%2FzLl7au%2FWR2v6R6bwK6fGUYVbcnAam9GqobWJnMl6NFbipNSdmUzB5%2BglRYaYeGXxbgxseM7SSFeehfzbywUoHEf4Ve61V1e90uyx3M0Krbm5QjS5gNgwErj0g2rC2mkrl2q%2B9ADfOzgMAX8fUODFalEv4gZf0ZKuLhpmAzEapJE5f%2BarcSkdn5b0ddy4Wa2vdsZ6lQ5NOez8qkcnaBEJZLnv3YGHyInLrIaUkqlq4iavZpr4f5Al5PueqIzLuItn5ztJjfvCu5dDIplWP0eo6r%2BIUCKsDwUNkRSgWCtJbCfl%2BPF3PKHjvnmVEBawLZlpXvaOGUvA%2FKYb2cGGXn89CPjYlwpWCj2J8Z%2B0okbim4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=bf71523c6e7bc950c45ff8a9bf014a844e3f8b9fe543b663722bc8b877c05994", 
                    "type": "image/png", 
                    "id": 297552, 
                    "filename": "eval_payload_executed.png"
                }
            ], 
            "automated_response": false, 
            "created_at": "2018-05-14T20:09:24.838Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-05-17T21:47:28.560Z", 
            "actor": {
                "username": "osintopsec", 
                "url": "/osintopsec", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "valve", 
            "message": "Dear Valve security staff,\n\nAfter a good nights sleep and a fresh mind, I would like to update my vision on the exploitation of this vulnerability a little. On the initial report I wrote:\n\n>For this particular vulnerability only by it self, successful exploiting is a bit more tricky, as currently the Profile Name -field only accepts 32 characters and it requires the victim to click on the button.\n\nExploitation with 32 character limitation bypass\n---------------------\n\nOn more testing I found out, that the attacker can bypass the character length limitation of 32 characters by a simple yet effective manner by utilizing redirecting html-page as on following code:\n\n```\n<!DOCTYPE html>\n<html>\n    <body>\n        <script>\n            // Setting payload\n            window.name =\"console.log('This is console logging cookie: ' + document.cookie); alert('This is alert dialog with cookie: ' + document.cookie);\";\n            // Redirecting...\n            window.location.replace(\"https://steamcommunity.com/search/users/#text=NAME'); eval(event.view.name\");\n        </script>\n    </body>\n</html>\n```\n\nWhen the victim browser hits the redirect page (I'm thinking of a \"hey send me a friend request on Steam, here's a link, my account is the uppermost\"-pretext*), it stores the actual payload into the persistent window.name-property and proceeds to redirect the victim to the Steam community user search. When the victim presses the __ADD AS FRIEND__-button, payload is retrieved and executed by calling javascript eval()-function with the window.name-property (now reflected to event.view.name since we're firing a onclick-event) which is now injected inside the AddFriend()-function.\n\nPicture: Script injected inside the AddFriend()-function {F297556}\nPicture: Script executed via eval() {F297552}\nUtilizing javascript eval()-function is possible as Steam community site dictates Content Security Policy \"unsafe-eval\" regarding scripts.\n\nSteps to reproduce\n---------------------\n\nEither:\n1. Obtain an account to act as a attacker and log in\n2. Navigate to https://steamcommunity.com/profiles/PROFILE_NUMBER/edit\n3. Edit field \"Profile Name to contain short name, and the payload. (Eg. \"__NAME'); eval(event.view.name+'__\", without the outermost double quotes). Save the edited profile\n4. Obtain a web server to host the redirecting html page and set it up to serve the page. Customize the code to hold correct Steam community user search URL.\n5. With another browser or session, obtain an account to act as a victim and log in\n6. Navigate to the redirecting html page\n7. Click \"__ADD AS FRIEND__\"-button next to the attacking profile name\n8. Verify that clicking the button executes the payload, writes into the log and pops an alert dialog\n\nOr:\n1. Obtain an account to act as a victim and log in\n2. Navigate to this link http://\u2588\u2588\u2588\u2588\u2588\n3. Click \"__ADD AS FRIEND__\"-button next to the attacking profile name (uppermost)\n4. Verify that clicking the button executes the payload, writes into the log and pops an alert dialog\n\nI will leave the POC redirect page and the POC Profile Name up for couple of days for you to verify.\n\nImpact\n---------------------\nBypassing the 32 character limitation was in the end rather easy, and it was possible to escalate a limited coverage cross-site-scripting vulnerability into a far more dangerous semi-full-blown stored cross-site-scripting vulnerability, with more severe consequences if exploited. Fortunately as far as I see, for full effect the would-be attacker would have to lure the victim to perform steps (open a link and want to be friends). Unfortunately, the event-sequence necessary would be within the norms of online behavior and as such the attack would be easy to perform.\n\nThe most severe XSS attacks involve disclosure of the user\u2019s session cookie, allowing an attacker to hijack the user\u2019s session and take over the account. Other damaging attacks include the disclosure of end user files, installation of Trojan horse programs, redirect the user to some other page or site, or modify presentation of content.\n\nPlease let me know if I can be of any help!\n\n*Phishing is out-of-scope, but since this is a technical vulnerability, I feel confident that I can use the example since it gives the vulnerability some beef over it's bones, making it realistic and plausible attack vector.\n\nEdit: opsec on the steam account id in a picture\n\n", 
            "markdown_message": "<p>Dear Valve security staff,</p>\n\n<p>After a good nights sleep and a fresh mind, I would like to update my vision on the exploitation of this vulnerability a little. On the initial report I wrote:</p>\n\n<blockquote>\n<p>For this particular vulnerability only by it self, successful exploiting is a bit more tricky, as currently the Profile Name -field only accepts 32 characters and it requires the victim to click on the button.</p>\n</blockquote>\n\n<h2 id=\"exploitation-with-32-character-limitation-bypass\">Exploitation with 32 character limitation bypass</h2>\n\n<p>On more testing I found out, that the attacker can bypass the character length limitation of 32 characters by a simple yet effective manner by utilizing redirecting html-page as on following code:</p>\n<pre class=\"highlight html\"><code><span class=\"cp\">&lt;!DOCTYPE html&gt;</span>\n<span class=\"nt\">&lt;html&gt;</span>\n    <span class=\"nt\">&lt;body&gt;</span>\n        <span class=\"nt\">&lt;script&gt;</span>\n            <span class=\"c1\">// Setting payload</span>\n            <span class=\"nb\">window</span><span class=\"p\">.</span><span class=\"nx\">name</span> <span class=\"o\">=</span><span class=\"s2\">&quot;console.log(&#39;This is console logging cookie: &#39; + document.cookie); alert(&#39;This is alert dialog with cookie: &#39; + document.cookie);&quot;</span><span class=\"p\">;</span>\n            <span class=\"c1\">// Redirecting...</span>\n            <span class=\"nb\">window</span><span class=\"p\">.</span><span class=\"nx\">location</span><span class=\"p\">.</span><span class=\"nx\">replace</span><span class=\"p\">(</span><span class=\"s2\">&quot;https://steamcommunity.com/search/users/#text=NAME&#39;); eval(event.view.name&quot;</span><span class=\"p\">);</span>\n        <span class=\"nt\">&lt;/script&gt;</span>\n    <span class=\"nt\">&lt;/body&gt;</span>\n<span class=\"nt\">&lt;/html&gt;</span>\n</code></pre>\n<p>When the victim browser hits the redirect page (I&#39;m thinking of a &quot;hey send me a friend request on Steam, here&#39;s a link, my account is the uppermost&quot;-pretext*), it stores the actual payload into the persistent window.name-property and proceeds to redirect the victim to the Steam community user search. When the victim presses the <strong>ADD AS FRIEND</strong>-button, payload is retrieved and executed by calling javascript eval()-function with the window.name-property (now reflected to event.view.name since we&#39;re firing a onclick-event) which is now injected inside the AddFriend()-function.</p>\n\n<p>Picture: Script injected inside the AddFriend()-function <a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"script_injected.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/297/556/4b6261e51404faff8f358e00e3a4c080d3a4da8a/script_injected.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ5B43OTPE%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T222337Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDCiDARkX3ArKGaO7%2ByK3A39tqjzyooRkX4qPdNM7MkAemep3r5%2Fh%2B11ZdH6KbZ8q2cgU%2FRMODKRq75fJ6sn%2FkR1fBrPaMFfKsP%2BSLpkSrkbyi968FqbmO6yo59Heb3d1kDMwzaNShj3ou%2Fq9qAc5NWgXlxJtABJqkgxPd5NovxMOsASin8kfBjU8OhOOEnonvd2t16oF509MVoA81P%2Frmr4njIb3UfHzYyccuDQNjHM0qV7B57bCKQeIuO%2FzLl7au%2FWR2v6R6bwK6fGUYVbcnAam9GqobWJnMl6NFbipNSdmUzB5%2BglRYaYeGXxbgxseM7SSFeehfzbywUoHEf4Ve61V1e90uyx3M0Krbm5QjS5gNgwErj0g2rC2mkrl2q%2B9ADfOzgMAX8fUODFalEv4gZf0ZKuLhpmAzEapJE5f%2BarcSkdn5b0ddy4Wa2vdsZ6lQ5NOez8qkcnaBEJZLnv3YGHyInLrIaUkqlq4iavZpr4f5Al5PueqIzLuItn5ztJjfvCu5dDIplWP0eo6r%2BIUCKsDwUNkRSgWCtJbCfl%2BPF3PKHjvnmVEBawLZlpXvaOGUvA%2FKYb2cGGXn89CPjYlwpWCj2J8Z%2B0okbim4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=b2df9a8d6cf82a7d1200587f3e043c7128d0ab5367977d8e45f8c3bab11eb648\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/297/556/4b6261e51404faff8f358e00e3a4c080d3a4da8a/script_injected.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ5B43OTPE%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T222337Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDCiDARkX3ArKGaO7%2ByK3A39tqjzyooRkX4qPdNM7MkAemep3r5%2Fh%2B11ZdH6KbZ8q2cgU%2FRMODKRq75fJ6sn%2FkR1fBrPaMFfKsP%2BSLpkSrkbyi968FqbmO6yo59Heb3d1kDMwzaNShj3ou%2Fq9qAc5NWgXlxJtABJqkgxPd5NovxMOsASin8kfBjU8OhOOEnonvd2t16oF509MVoA81P%2Frmr4njIb3UfHzYyccuDQNjHM0qV7B57bCKQeIuO%2FzLl7au%2FWR2v6R6bwK6fGUYVbcnAam9GqobWJnMl6NFbipNSdmUzB5%2BglRYaYeGXxbgxseM7SSFeehfzbywUoHEf4Ve61V1e90uyx3M0Krbm5QjS5gNgwErj0g2rC2mkrl2q%2B9ADfOzgMAX8fUODFalEv4gZf0ZKuLhpmAzEapJE5f%2BarcSkdn5b0ddy4Wa2vdsZ6lQ5NOez8qkcnaBEJZLnv3YGHyInLrIaUkqlq4iavZpr4f5Al5PueqIzLuItn5ztJjfvCu5dDIplWP0eo6r%2BIUCKsDwUNkRSgWCtJbCfl%2BPF3PKHjvnmVEBawLZlpXvaOGUvA%2FKYb2cGGXn89CPjYlwpWCj2J8Z%2B0okbim4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=b2df9a8d6cf82a7d1200587f3e043c7128d0ab5367977d8e45f8c3bab11eb648\" class=\"markdown-inline-image\"></a><br>\nPicture: Script executed via eval() <a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"eval_payload_executed.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/297/552/5db9733615dc443f6647e78a200292f35e8f84d2/eval_payload_executed.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ5B43OTPE%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T222337Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDCiDARkX3ArKGaO7%2ByK3A39tqjzyooRkX4qPdNM7MkAemep3r5%2Fh%2B11ZdH6KbZ8q2cgU%2FRMODKRq75fJ6sn%2FkR1fBrPaMFfKsP%2BSLpkSrkbyi968FqbmO6yo59Heb3d1kDMwzaNShj3ou%2Fq9qAc5NWgXlxJtABJqkgxPd5NovxMOsASin8kfBjU8OhOOEnonvd2t16oF509MVoA81P%2Frmr4njIb3UfHzYyccuDQNjHM0qV7B57bCKQeIuO%2FzLl7au%2FWR2v6R6bwK6fGUYVbcnAam9GqobWJnMl6NFbipNSdmUzB5%2BglRYaYeGXxbgxseM7SSFeehfzbywUoHEf4Ve61V1e90uyx3M0Krbm5QjS5gNgwErj0g2rC2mkrl2q%2B9ADfOzgMAX8fUODFalEv4gZf0ZKuLhpmAzEapJE5f%2BarcSkdn5b0ddy4Wa2vdsZ6lQ5NOez8qkcnaBEJZLnv3YGHyInLrIaUkqlq4iavZpr4f5Al5PueqIzLuItn5ztJjfvCu5dDIplWP0eo6r%2BIUCKsDwUNkRSgWCtJbCfl%2BPF3PKHjvnmVEBawLZlpXvaOGUvA%2FKYb2cGGXn89CPjYlwpWCj2J8Z%2B0okbim4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=bf71523c6e7bc950c45ff8a9bf014a844e3f8b9fe543b663722bc8b877c05994\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/297/552/5db9733615dc443f6647e78a200292f35e8f84d2/eval_payload_executed.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ5B43OTPE%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T222337Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDCiDARkX3ArKGaO7%2ByK3A39tqjzyooRkX4qPdNM7MkAemep3r5%2Fh%2B11ZdH6KbZ8q2cgU%2FRMODKRq75fJ6sn%2FkR1fBrPaMFfKsP%2BSLpkSrkbyi968FqbmO6yo59Heb3d1kDMwzaNShj3ou%2Fq9qAc5NWgXlxJtABJqkgxPd5NovxMOsASin8kfBjU8OhOOEnonvd2t16oF509MVoA81P%2Frmr4njIb3UfHzYyccuDQNjHM0qV7B57bCKQeIuO%2FzLl7au%2FWR2v6R6bwK6fGUYVbcnAam9GqobWJnMl6NFbipNSdmUzB5%2BglRYaYeGXxbgxseM7SSFeehfzbywUoHEf4Ve61V1e90uyx3M0Krbm5QjS5gNgwErj0g2rC2mkrl2q%2B9ADfOzgMAX8fUODFalEv4gZf0ZKuLhpmAzEapJE5f%2BarcSkdn5b0ddy4Wa2vdsZ6lQ5NOez8qkcnaBEJZLnv3YGHyInLrIaUkqlq4iavZpr4f5Al5PueqIzLuItn5ztJjfvCu5dDIplWP0eo6r%2BIUCKsDwUNkRSgWCtJbCfl%2BPF3PKHjvnmVEBawLZlpXvaOGUvA%2FKYb2cGGXn89CPjYlwpWCj2J8Z%2B0okbim4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=bf71523c6e7bc950c45ff8a9bf014a844e3f8b9fe543b663722bc8b877c05994\" class=\"markdown-inline-image\"></a><br>\nUtilizing javascript eval()-function is possible as Steam community site dictates Content Security Policy &quot;unsafe-eval&quot; regarding scripts.</p>\n\n<h2 id=\"steps-to-reproduce\">Steps to reproduce</h2>\n\n<p>Either:</p>\n\n<ol>\n<li>Obtain an account to act as a attacker and log in</li>\n<li>Navigate to <a title=\"https://steamcommunity.com/profiles/PROFILE_NUMBER/edit\" href=\"/redirect?signature=f49f2e0f0066c9756a1f57915eab5d1023bec8ec&amp;url=https%3A%2F%2Fsteamcommunity.com%2Fprofiles%2FPROFILE_NUMBER%2Fedit\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://steamcommunity.com/profiles/PROFILE_NUMBER/edit</span><i class=\"icon-external-link\"></i></a>\n</li>\n<li>Edit field &quot;Profile Name to contain short name, and the payload. (Eg. &quot;<strong>NAME&#39;); eval(event.view.name+&#39;</strong>&quot;, without the outermost double quotes). Save the edited profile</li>\n<li>Obtain a web server to host the redirecting html page and set it up to serve the page. Customize the code to hold correct Steam community user search URL.</li>\n<li>With another browser or session, obtain an account to act as a victim and log in</li>\n<li>Navigate to the redirecting html page</li>\n<li>Click &quot;<strong>ADD AS FRIEND</strong>&quot;-button next to the attacking profile name</li>\n<li>Verify that clicking the button executes the payload, writes into the log and pops an alert dialog</li>\n</ol>\n\n<p>Or:</p>\n\n<ol>\n<li>Obtain an account to act as a victim and log in</li>\n<li>Navigate to this link http://\u2588\u2588\u2588\u2588\u2588</li>\n<li>Click &quot;<strong>ADD AS FRIEND</strong>&quot;-button next to the attacking profile name (uppermost)</li>\n<li>Verify that clicking the button executes the payload, writes into the log and pops an alert dialog</li>\n</ol>\n\n<p>I will leave the POC redirect page and the POC Profile Name up for couple of days for you to verify.</p>\n\n<h2 id=\"impact\">Impact</h2>\n\n<p>Bypassing the 32 character limitation was in the end rather easy, and it was possible to escalate a limited coverage cross-site-scripting vulnerability into a far more dangerous semi-full-blown stored cross-site-scripting vulnerability, with more severe consequences if exploited. Fortunately as far as I see, for full effect the would-be attacker would have to lure the victim to perform steps (open a link and want to be friends). Unfortunately, the event-sequence necessary would be within the norms of online behavior and as such the attack would be easy to perform.</p>\n\n<p>The most severe XSS attacks involve disclosure of the user\u2019s session cookie, allowing an attacker to hijack the user\u2019s session and take over the account. Other damaging attacks include the disclosure of end user files, installation of Trojan horse programs, redirect the user to some other page or site, or modify presentation of content.</p>\n\n<p>Please let me know if I can be of any help!</p>\n\n<p>*Phishing is out-of-scope, but since this is a technical vulnerability, I feel confident that I can use the example since it gives the vulnerability some beef over it&#39;s bones, making it realistic and plausible attack vector.</p>\n\n<p>Edit: opsec on the steam account id in a picture</p>\n", 
            "type": "Activities::Comment", 
            "id": 2741358, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-05-14T20:23:03.133Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-05-14T20:23:03.133Z", 
            "actor": {
                "username": "jacobu", 
                "url": "/jacobu", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/222/964/4bcada255e568d575fb71c55960ef2a8d76d0796_medium.jpg?1542741831"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "valve", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugTriaged", 
            "id": 2742591, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-05-15T23:32:56.112Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-05-15T23:32:56.112Z", 
            "actor": {
                "username": "jacobu", 
                "url": "/jacobu", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/222/964/4bcada255e568d575fb71c55960ef2a8d76d0796_medium.jpg?1542741831"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "valve", 
            "message": "We have deployed a fix to our production systems. Can you please confirm that this is resolved?", 
            "markdown_message": "<p>We have deployed a fix to our production systems. Can you please confirm that this is resolved?</p>\n", 
            "type": "Activities::Comment", 
            "id": 2748840, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2018-05-15T23:49:55.233Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-05-15T23:49:55.233Z", 
            "actor": {
                "url": "/valve", 
                "profile": {
                    "name": "Valve"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/023/363/108249db69174477f86300d445fc8f4cb3ab98d2_medium.png?1504915279"
                }
            }, 
            "team_handle": "valve", 
            "bonus_amount": "0.0", 
            "bounty_amount": "750.0", 
            "collaborator": {
                "username": "osintopsec", 
                "url": "/osintopsec"
            }, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BountyAwarded", 
            "id": 2748892, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "osintopsec", 
                "url": "/osintopsec"
            }, 
            "created_at": "2018-05-15T23:50:09.951Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-05-15T23:50:09.951Z", 
            "actor": {
                "username": "jonp", 
                "url": "/jonp", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "valve", 
            "message": "Thanks again for the report!", 
            "markdown_message": "<p>Thanks again for the report!</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 2748893, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-05-16T08:34:47.995Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-05-16T08:35:21.106Z", 
            "actor": {
                "username": "osintopsec", 
                "url": "/osintopsec", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "valve", 
            "message": "@jacobu Resolved! I'm not able to reproduce due to added quotes, and user input quotes are properly escaped. Thank you very much for the quickest time-to-resolve (and for the bounty)! Shall we disclose?", 
            "markdown_message": "<p><a href=\"/jacobu\">@jacobu</a> Resolved! I&#39;m not able to reproduce due to added quotes, and user input quotes are properly escaped. Thank you very much for the quickest time-to-resolve (and for the bounty)! Shall we disclose?</p>\n", 
            "type": "Activities::Comment", 
            "id": 2750125, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-05-16T08:37:41.447Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-05-16T08:37:41.447Z", 
            "actor": {
                "username": "osintopsec", 
                "url": "/osintopsec", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "valve", 
            "first_to_agree": true, 
            "message": "I'll just need to hide my server IP - otherwise it should be opsec already!", 
            "markdown_message": "<p>I&#39;ll just need to hide my server IP - otherwise it should be opsec already!</p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 2750278, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-05-24T21:57:17.383Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-05-24T21:57:17.383Z", 
            "actor": {
                "username": "jonp", 
                "url": "/jonp", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "valve", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 2793914, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-05-24T21:57:17.473Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-05-24T21:57:17.473Z", 
            "actor": {
                "username": "jonp", 
                "url": "/jonp", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "valve", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 2793915, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "reporter": {
        "username": "osintopsec", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/osintopsec", 
        "profile_picture_urls": {
            "small": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 62, 
        "name": "Cross-site Scripting (XSS) - Stored"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "disclosed_at": "2018-05-24T21:57:17.440Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/351171", 
    "created_at": "2018-05-13T17:41:15.480Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>Dear Valve security staff,</p>\n\n<h2 id=\"short-description\">Short description</h2>\n\n<p>There is a stored cross-site-scripting vulnerability present at the user search endpoint which can be exploited by modifying profile name of the would be attacking account. See POC picture.</p>\n\n<h2 id=\"steps-to-reproduce\">Steps to reproduce</h2>\n\n<ol>\n<li>Obtain a account to act as a attacker and log in</li>\n<li>Go to <a title=\"https://steamcommunity.com/profiles/PROFILE_NUMBER/edit\" href=\"/redirect?signature=f49f2e0f0066c9756a1f57915eab5d1023bec8ec&amp;url=https%3A%2F%2Fsteamcommunity.com%2Fprofiles%2FPROFILE_NUMBER%2Fedit\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://steamcommunity.com/profiles/PROFILE_NUMBER/edit</span><i class=\"icon-external-link\"></i></a>\n</li>\n<li>Edit field &quot;Profile Name&quot; to contain short name, and the payload. For example: &quot;<strong>NAME&#39;); alert(document.cookie+&#39;</strong>&quot;, without the outermost double quotes</li>\n<li>With another browser or session, obtain a account to act as a victim and log in</li>\n<li>Navigate to <a title=\"https://steamcommunity.com/search/users/#text=\" href=\"/redirect?signature=df57ff84cebae53be073f61fd6cdbb1dd538024b&amp;url=https%3A%2F%2Fsteamcommunity.com%2Fsearch%2Fusers%2F%23text%3D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://steamcommunity.com/search/users/#text=</span><i class=\"icon-external-link\"></i></a>\n</li>\n<li>Using the search field, search for the attacking account &quot;<strong>NAME&#39;); alert(document.cookie+&#39;</strong>&quot; without the outermost double quotes</li>\n<li>Click &quot;ADD AS FRIEND&quot; button next to the profile name</li>\n<li>Verify that clicking the button launches the payload and pops an alert dialog</li>\n</ol>\n\n<h2 id=\"why-is-it-there\">Why is it there</h2>\n\n<p>All culminates on AddFriend-function call on the following line of code in user search html and the fact, that the function call can be escaped. The payload is &quot;<strong>NAME&#39;); alert(document.cookie+&#39;</strong>&quot; without the outermost quotes in the snippet.</p>\n<pre class=\"highlight plaintext\"><code>&lt;a href=&quot;#&quot; onclick=&quot;AddFriend(false,&#39;PROFILE_NUMBER&#39;,&#39;NAME&#39;); alert(document.cookie+&#39;&#39;); $J(this).hide(); return false;&quot; class=&quot;btnv6_blue_hoverfade btn_small btn_uppercase&quot; style=&quot;display: none;&quot;&gt;\n    &lt;span&gt;Add as friend&lt;/span&gt;\n&lt;/a&gt;\n</code></pre>\n<h2 id=\"impact-and-assesment\">Impact and assesment</h2>\n\n<p>As on any cross-site-scripting vulnerability. The top line would be that the attacker might steals cookies to abuse users session. For this particular vulnerability only by it self, successful exploiting is a bit more tricky, as currently the Profile Name -field only accepts 32 characters and it requires the victim to click on the button. Payloads can also utilize jQuery on the domain context.</p>\n\n<p>As a mitigation of this, and vulnerabilities like this: addition to &lt;, &gt; and &amp;, characters such as &#39; ; $ ( and ) should also be encoded when retrieved from the database, or even better, could be stored encoded.</p>\n\n<p>PS. It was funny to see that many users had tried to exploit the Profile Name -field previously, as they show on the search when searching for &quot;<strong>alert(...)</strong>&quot;. I hope I&#39;m in time not to be on the duplicate pool!</p>\n\n<h2 id=\"impact\">Impact</h2>\n\n<p>As on any cross-site-scripting vulnerability. The top line would be that the attacker might steals cookies to abuse users session. For this particular vulnerability only by it self, successful exploiting is a bit more tricky, as currently the Profile Name -field only accepts 32 characters and it requires the victim to click on the button.</p>\n\n<p>As a mitigation of this, and vulnerabilities like this: characters such as &#39; ; $ ( and ) should also be encoded when retrieved from the database, or even better, could be stored encoded.</p>\n\n<p>The hacker selected the <strong>Cross-site Scripting (XSS) - Stored</strong> weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:</p>\n\n<p><strong>URL</strong><br>\n<a title=\"https://steamcommunity.com/search/users/#text=\" href=\"/redirect?signature=df57ff84cebae53be073f61fd6cdbb1dd538024b&amp;url=https%3A%2F%2Fsteamcommunity.com%2Fsearch%2Fusers%2F%23text%3D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://steamcommunity.com/search/users/#text=</span><i class=\"icon-external-link\"></i></a></p>\n\n<p><strong>Verified</strong><br>\nYes</p>\n", 
    "severity_rating": "medium", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "http://www.valvesoftware.com", 
            "about": "", 
            "twitter_handle": "", 
            "name": "Valve"
        }, 
        "handle": "valve", 
        "url": "https://hackerone.com/valve", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/023/363/70bcb701fe28ae1bbc98b28ce88a5dd98e38a6b6_small.png?1504915279", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/023/363/108249db69174477f86300d445fc8f4cb3ab98d2_medium.png?1504915279"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 23363, 
        "default_currency": "usd"
    }, 
    "is_published": false
}