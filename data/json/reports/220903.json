{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2017-10-19T15:26:20.826Z", 
    "voters": [
        "jokebookservice1", 
        "jensec", 
        "eveeez", 
        "axolotl", 
        "sup3r-b0y", 
        "craxerbikash", 
        "tanzanian__hacker", 
        "japz", 
        "yeahyeah", 
        "kinso", 
        "and 4 more..."
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "350.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 220903, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": null, 
    "vulnerability_information": "###Explanation\nDuring my research on latest WordPress I found that `$file_description`  and `$description` from `wp-admin/theme-editor.php`  are not filtering name of the template allowing attacker to do XSS attack.\n\n```\n...\n\t\t$file_description = get_file_description( $filename );\n\n\t\tif ( $filename !== basename( $absolute_filename ) || $file_description !== $filename ) {\n\t\t\t$file_description .= '<br /><span class=\"nonessential\">(' . $filename . ')</span>';\n\n\t\t}\n\n\t\tif ( $absolute_filename === $file ) {\n\t\t\t$file_description = '<span class=\"highlight\">' . $file_description . '</span>';\n\n\t\t}\n\n\t\t$previous_file_type = $file_type;\n?>\n\t\t<li><a href=\"theme-editor.php?file=<?php echo urlencode( $filename ) ?>&amp;theme=<?php echo urlencode( $stylesheet ) ?>\"><?php echo $file_description; ?></a></li>\n<?php\n\tendforeach;\n?>\n```\nFrom this code we can see that `$file_description = get_file_description( $filename );` is getting declared and later on under <li><a> tags template name is printed on the page `...<?php echo $file_description; ?></a></li>`\n\n`$file_description` variable should be filtered before displayed to the user. For example using `htmlspecialchars()` function (example:  F175759 )\n\nHowever, if victim click on the file that contain XSS payload, XSS will be executed because `$description = get_file_description( $relative_file );` is displaying name of the active file you are editing.\n\n###Steps to replicate\n1. Go to Appearance > Editor\n2. Select file you want to edit (don't select files that already have name - Archives, Theme Footer for example). I used \"back-compat.php\" F175758\n3. At the very top of the file add following comment:\n```/* Template Name: <script>confirm(document.cookie);</script> */``` Like this: F175758\n4. Click on Update File.\n5. XSS Popup will be prompted. F175757\n\n###Technology used: \nGoogle Chrome 57.0.2987.133 (64-bit) - Latest", 
    "activity_page_count": 1, 
    "severity": {
        "metrics": {
            "confidentiality": "low", 
            "privileges_required": "high", 
            "user_interaction": "required", 
            "attack_vector": "local", 
            "attack_complexity": "low", 
            "scope": "unchanged", 
            "integrity": "high", 
            "availability": "high"
        }, 
        "rating": "medium", 
        "score": 6.1, 
        "author_type": "User"
    }, 
    "title": "Authenticated Cross-site Scripting in Template Name", 
    "is_member_of_team?": null, 
    "vote_count": 14, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2017-11-18T15:26:20.890Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "activity_page_number": 1, 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$350", 
    "attachments": [
        {
            "file_name": "Wordpress_1.png", 
            "type": "image/png", 
            "id": 175757, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/175/757/76774aabff1b7d779c0c93fa67532048e38abdba/Wordpress_1.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSGAJTS7X%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T222928Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDNv1JJkb2JCBJezLRSK3A3HLsRbM1N2dJQCs3cdkO9DdSlu97QyvuTWjB9TDM0zF0K5xYiGpDCZFKPrax%2BsFz5KI1WenrJdfAQhjK2VjV8ng750HOo6R9QtyoSkXqJSITk3z0sX6u%2BaGuR53DR1SgrXgU4%2BZj3kzVsOKKtd61G%2BDZP2N3q%2FR9lSxtCBWOIkOltAHyGZcqelOD%2BNHIXr08GPe3urs8MfpCWN12Uc98ELvbzHllGEdfFgQzzzB%2Fh03QvsfmUHldJCz%2F09ZO2mOXeVGvvhGa6P439ow0kmfHorCf2l49cQlp550RAVCceslQNRsIpjs%2FscvNzwUdv1wSWwe0IojrRDLG4nQFwiQ1K3a1GlpxXYzTv176jcnZhJdyzHXn0aNVd3n2yu6QXF1RyrednAqH6GTeLsY%2BmFdJvs1E%2FSPzNOEj5naR190ChZbKYdPEncIwhYy7S7R055CIUnAzUObhGpKBIz%2FL7hX57SOAVB8Fp6J9NWYxxkcT1Ux5M8TRdPzjlD4gsEW3VAWt2ylLrHUu11rkw%2BhgkA7Cbe4vsOk6sYBm%2BDSV9vvQVz42kWGtRMos%2BFMKzKt4FX3akfBm1nwEgIo656m4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=02e4c76cbac6079320d8e18e12134dcf4a01fb9f005b3fe2e7803f2c31362e28"
        }, 
        {
            "file_name": "Wordpress_2.png", 
            "type": "image/png", 
            "id": 175758, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/175/758/1a089e1196f783390fdfef948789635acc3012f2/Wordpress_2.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSGAJTS7X%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T222928Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDNv1JJkb2JCBJezLRSK3A3HLsRbM1N2dJQCs3cdkO9DdSlu97QyvuTWjB9TDM0zF0K5xYiGpDCZFKPrax%2BsFz5KI1WenrJdfAQhjK2VjV8ng750HOo6R9QtyoSkXqJSITk3z0sX6u%2BaGuR53DR1SgrXgU4%2BZj3kzVsOKKtd61G%2BDZP2N3q%2FR9lSxtCBWOIkOltAHyGZcqelOD%2BNHIXr08GPe3urs8MfpCWN12Uc98ELvbzHllGEdfFgQzzzB%2Fh03QvsfmUHldJCz%2F09ZO2mOXeVGvvhGa6P439ow0kmfHorCf2l49cQlp550RAVCceslQNRsIpjs%2FscvNzwUdv1wSWwe0IojrRDLG4nQFwiQ1K3a1GlpxXYzTv176jcnZhJdyzHXn0aNVd3n2yu6QXF1RyrednAqH6GTeLsY%2BmFdJvs1E%2FSPzNOEj5naR190ChZbKYdPEncIwhYy7S7R055CIUnAzUObhGpKBIz%2FL7hX57SOAVB8Fp6J9NWYxxkcT1Ux5M8TRdPzjlD4gsEW3VAWt2ylLrHUu11rkw%2BhgkA7Cbe4vsOk6sYBm%2BDSV9vvQVz42kWGtRMos%2BFMKzKt4FX3akfBm1nwEgIo656m4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=f6c3e34f7a989aea0f9adeea3738ff42322f5165e4dae5c8be9d91b05c4c08fd"
        }, 
        {
            "file_name": "Wordpress_3.png", 
            "type": "image/png", 
            "id": 175759, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/175/759/cf3d9e476255edcfc539e411d223ccff37ecf147/Wordpress_3.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSGAJTS7X%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T222928Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDNv1JJkb2JCBJezLRSK3A3HLsRbM1N2dJQCs3cdkO9DdSlu97QyvuTWjB9TDM0zF0K5xYiGpDCZFKPrax%2BsFz5KI1WenrJdfAQhjK2VjV8ng750HOo6R9QtyoSkXqJSITk3z0sX6u%2BaGuR53DR1SgrXgU4%2BZj3kzVsOKKtd61G%2BDZP2N3q%2FR9lSxtCBWOIkOltAHyGZcqelOD%2BNHIXr08GPe3urs8MfpCWN12Uc98ELvbzHllGEdfFgQzzzB%2Fh03QvsfmUHldJCz%2F09ZO2mOXeVGvvhGa6P439ow0kmfHorCf2l49cQlp550RAVCceslQNRsIpjs%2FscvNzwUdv1wSWwe0IojrRDLG4nQFwiQ1K3a1GlpxXYzTv176jcnZhJdyzHXn0aNVd3n2yu6QXF1RyrednAqH6GTeLsY%2BmFdJvs1E%2FSPzNOEj5naR190ChZbKYdPEncIwhYy7S7R055CIUnAzUObhGpKBIz%2FL7hX57SOAVB8Fp6J9NWYxxkcT1Ux5M8TRdPzjlD4gsEW3VAWt2ylLrHUu11rkw%2BhgkA7Cbe4vsOk6sYBm%2BDSV9vvQVz42kWGtRMos%2BFMKzKt4FX3akfBm1nwEgIo656m4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=9a953d945e43453cb569462949e4ffdd0012ba0c802120eab53217397084ecd6"
        }
    ], 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2017-04-17T22:52:52.065Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-04-17T22:52:52.065Z", 
            "actor": {
                "username": "vortfu", 
                "url": "/vortfu", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/004/982/b80411c54ee08b9579811d3427a54368f8d03d09_medium.png?1422255349"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "wordpress", 
            "message": "Thanks for the report, I'll forward this to the WordPress security team for review.", 
            "markdown_message": "<p>Thanks for the report, I&#39;ll forward this to the WordPress security team for review.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1616744, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-04-17T23:37:21.639Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-04-17T23:37:21.639Z", 
            "actor": {
                "username": "yeahyeah", 
                "url": "/yeahyeah", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/196/d57c042600c6062b07435e04ac77b421dd42dd37_medium.jpg?1508100969"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "wordpress", 
            "message": "Alright, thank you!", 
            "markdown_message": "<p>Alright, thank you!</p>\n", 
            "type": "Activities::Comment", 
            "id": 1616806, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-04-26T10:31:07.773Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-04-26T10:31:07.773Z", 
            "actor": {
                "username": "yeahyeah", 
                "url": "/yeahyeah", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/196/d57c042600c6062b07435e04ac77b421dd42dd37_medium.jpg?1508100969"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "wordpress", 
            "message": "Any updates on this one?", 
            "markdown_message": "<p>Any updates on this one?</p>\n", 
            "type": "Activities::Comment", 
            "id": 1637106, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-05-02T13:32:05.184Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-05-02T13:32:05.184Z", 
            "actor": {
                "username": "iandunn", 
                "url": "/iandunn", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/974/4a74c8e7efc3996e6fff3f72ddccc09ab92986a2_medium.jpg?1506561124"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "wordpress", 
            "message": "Hi, sorry for the delay, we're still reviewing this one. We'll let you know once we've had a chance to dig into it.", 
            "markdown_message": "<p>Hi, sorry for the delay, we&#39;re still reviewing this one. We&#39;ll let you know once we&#39;ve had a chance to dig into it.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1648826, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-05-03T14:09:53.134Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-05-03T14:09:53.134Z", 
            "actor": {
                "username": "iandunn", 
                "url": "/iandunn", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/974/4a74c8e7efc3996e6fff3f72ddccc09ab92986a2_medium.jpg?1506561124"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "wordpress", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugTriaged", 
            "id": 1651431, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-05-21T20:17:00.196Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-05-21T20:17:00.196Z", 
            "actor": {
                "username": "yeahyeah", 
                "url": "/yeahyeah", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/196/d57c042600c6062b07435e04ac77b421dd42dd37_medium.jpg?1508100969"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "wordpress", 
            "message": "Hi. did you got a chance to dig into it? Just a gentle reminder.", 
            "markdown_message": "<p>Hi. did you got a chance to dig into it? Just a gentle reminder.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1690145, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-05-23T06:32:07.093Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-05-23T06:32:07.093Z", 
            "actor": {
                "username": "swissspidy", 
                "url": "/swissspidy", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/087/939/4bcc4ab2a5c49d7408453dc1e4d969e30a656d07_medium.jpeg?1469385964"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "wordpress", 
            "message": "Hi there,\n\nThank you for your patience. Although we have created a first patch that should fix the issue you reported, we're still looking into it as we want to make sure we don't miss any similar issues.", 
            "markdown_message": "<p>Hi there,</p>\n\n<p>Thank you for your patience. Although we have created a first patch that should fix the issue you reported, we&#39;re still looking into it as we want to make sure we don&#39;t miss any similar issues.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1694014, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-05-23T06:57:26.749Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-05-23T06:57:26.749Z", 
            "actor": {
                "username": "yeahyeah", 
                "url": "/yeahyeah", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/196/d57c042600c6062b07435e04ac77b421dd42dd37_medium.jpg?1508100969"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "wordpress", 
            "message": "Thank you for this update.", 
            "markdown_message": "<p>Thank you for this update.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1694055, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-06-04T21:39:04.638Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-04T21:39:04.638Z", 
            "actor": {
                "username": "yeahyeah", 
                "url": "/yeahyeah", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/196/d57c042600c6062b07435e04ac77b421dd42dd37_medium.jpg?1508100969"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "wordpress", 
            "message": "Hi,\nSorry for bothering you guys, is there any updates regarding this report?", 
            "markdown_message": "<p>Hi,<br>\nSorry for bothering you guys, is there any updates regarding this report?</p>\n", 
            "type": "Activities::Comment", 
            "id": 1729271, 
            "genius_execution_id": null
        }, 
        {
            "attachments": [
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/195/209/4f27e6f2315af1d35b8d2aa77e8341cc836a4e5f/220903.diff?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSGAJTS7X%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T222928Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDNv1JJkb2JCBJezLRSK3A3HLsRbM1N2dJQCs3cdkO9DdSlu97QyvuTWjB9TDM0zF0K5xYiGpDCZFKPrax%2BsFz5KI1WenrJdfAQhjK2VjV8ng750HOo6R9QtyoSkXqJSITk3z0sX6u%2BaGuR53DR1SgrXgU4%2BZj3kzVsOKKtd61G%2BDZP2N3q%2FR9lSxtCBWOIkOltAHyGZcqelOD%2BNHIXr08GPe3urs8MfpCWN12Uc98ELvbzHllGEdfFgQzzzB%2Fh03QvsfmUHldJCz%2F09ZO2mOXeVGvvhGa6P439ow0kmfHorCf2l49cQlp550RAVCceslQNRsIpjs%2FscvNzwUdv1wSWwe0IojrRDLG4nQFwiQ1K3a1GlpxXYzTv176jcnZhJdyzHXn0aNVd3n2yu6QXF1RyrednAqH6GTeLsY%2BmFdJvs1E%2FSPzNOEj5naR190ChZbKYdPEncIwhYy7S7R055CIUnAzUObhGpKBIz%2FL7hX57SOAVB8Fp6J9NWYxxkcT1Ux5M8TRdPzjlD4gsEW3VAWt2ylLrHUu11rkw%2BhgkA7Cbe4vsOk6sYBm%2BDSV9vvQVz42kWGtRMos%2BFMKzKt4FX3akfBm1nwEgIo656m4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=b011f87616646d56ff99662b719effb79f3f2a2ae9e58b1e34d11c945cc0b287", 
                    "type": "text/x-diff", 
                    "id": 195209, 
                    "filename": "220903.diff"
                }
            ], 
            "automated_response": false, 
            "created_at": "2017-06-18T10:19:54.115Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-18T10:19:54.115Z", 
            "actor": {
                "username": "swissspidy", 
                "url": "/swissspidy", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/087/939/4bcc4ab2a5c49d7408453dc1e4d969e30a656d07_medium.jpeg?1469385964"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "wordpress", 
            "message": "Hi there,\n\nWe're currently working through a large backlog, so it took us a little longer to respond. We definitely haven't forgotten about this though.\n\nI just realised I didn't attach the patch I mentioned last time. Can you please test it to see if it resolves the issue? Again, we want to make sure we don't miss any similar issues as well.", 
            "markdown_message": "<p>Hi there,</p>\n\n<p>We&#39;re currently working through a large backlog, so it took us a little longer to respond. We definitely haven&#39;t forgotten about this though.</p>\n\n<p>I just realised I didn&#39;t attach the patch I mentioned last time. Can you please test it to see if it resolves the issue? Again, we want to make sure we don&#39;t miss any similar issues as well.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1763869, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-06-18T11:31:31.745Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-06-18T11:31:31.745Z", 
            "actor": {
                "username": "yeahyeah", 
                "url": "/yeahyeah", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/196/d57c042600c6062b07435e04ac77b421dd42dd37_medium.jpg?1508100969"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "wordpress", 
            "message": "Hi @swissspidy ,\nThanks for the patch, I just updated my testing environment and I can confirm this patched it, also tried different payloads to bypass the filter, but no luck. Nice job, I can confirm the patch from my side.", 
            "markdown_message": "<p>Hi <a href=\"/swissspidy\">@swissspidy</a> ,<br>\nThanks for the patch, I just updated my testing environment and I can confirm this patched it, also tried different payloads to bypass the filter, but no luck. Nice job, I can confirm the patch from my side.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1763893, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-07-19T12:19:43.608Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-07-19T12:19:43.608Z", 
            "actor": {
                "username": "yeahyeah", 
                "url": "/yeahyeah", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/196/d57c042600c6062b07435e04ac77b421dd42dd37_medium.jpg?1508100969"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "wordpress", 
            "message": "Hi guys, any update(s) regarding this issue? ", 
            "markdown_message": "<p>Hi guys, any update(s) regarding this issue? </p>\n", 
            "type": "Activities::Comment", 
            "id": 1849567, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-08-14T10:24:48.602Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-08-14T10:24:48.602Z", 
            "actor": {
                "username": "swissspidy", 
                "url": "/swissspidy", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/087/939/4bcc4ab2a5c49d7408453dc1e4d969e30a656d07_medium.jpeg?1469385964"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "wordpress", 
            "message": "Hi @sikic,\n\nApparently this issue was publicly reported [7 years ago](https://core.trac.wordpress.org/ticket/13377). There wasn't much traction because template names are set by themes and themes can do much worse stuff than that.\n\nThis fix for extra hardening is now considered for the next security and maintenance release, which has no date set yet. We'll keep you posted when there's any news about the fix, possible bounties, etc.", 
            "markdown_message": "<p>Hi <a href=\"/sikic\">@sikic</a>,</p>\n\n<p>Apparently this issue was publicly reported <a href=\"/redirect?signature=798f655f92a60c195b9c4969ae00d43834d6a0ba&amp;url=https%3A%2F%2Fcore.trac.wordpress.org%2Fticket%2F13377\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>7 years ago</span><i class=\"icon-external-link\"></i></a>. There wasn&#39;t much traction because template names are set by themes and themes can do much worse stuff than that.</p>\n\n<p>This fix for extra hardening is now considered for the next security and maintenance release, which has no date set yet. We&#39;ll keep you posted when there&#39;s any news about the fix, possible bounties, etc.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1926042, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-08-14T17:05:30.077Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-08-14T17:05:30.077Z", 
            "actor": {
                "username": "yeahyeah", 
                "url": "/yeahyeah", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/196/d57c042600c6062b07435e04ac77b421dd42dd37_medium.jpg?1508100969"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "wordpress", 
            "message": "Just perfect! \ud83d\ude44", 
            "markdown_message": "<p>Just perfect! \ud83d\ude44</p>\n", 
            "type": "Activities::Comment", 
            "id": 1927337, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-09-19T14:54:33.778Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-09-19T14:54:33.778Z", 
            "actor": {
                "username": "johnbillion", 
                "url": "/johnbillion", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/014/083/d2aa5d94732da736a08f022dba3f393e01312ee6_medium.jpg?1484683288"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "wordpress", 
            "message": "Hello again @sikic .\n\nJust to let you know that this is due to be fixed in WordPress 4.8.2 which is scheduled for release within the next 24 hours.\n\nWe'll close this ticket and arrange for a bounty in due course.\n\nRegards\nJohn", 
            "markdown_message": "<p>Hello again <a href=\"/sikic\">@sikic</a> .</p>\n\n<p>Just to let you know that this is due to be fixed in WordPress 4.8.2 which is scheduled for release within the next 24 hours.</p>\n\n<p>We&#39;ll close this ticket and arrange for a bounty in due course.</p>\n\n<p>Regards<br>\nJohn</p>\n", 
            "type": "Activities::Comment", 
            "id": 2006066, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-09-19T15:11:12.639Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-09-19T15:11:12.639Z", 
            "actor": {
                "username": "yeahyeah", 
                "url": "/yeahyeah", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/196/d57c042600c6062b07435e04ac77b421dd42dd37_medium.jpg?1508100969"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "wordpress", 
            "message": "Hello @johnbillion .\nI'm glad to hear that!\n\nCheers,\nLuka.", 
            "markdown_message": "<p>Hello <a href=\"/johnbillion\">@johnbillion</a> .<br>\nI&#39;m glad to hear that!</p>\n\n<p>Cheers,<br>\nLuka.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2006109, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "yeahyeah", 
                "url": "/yeahyeah"
            }, 
            "created_at": "2017-09-20T12:08:40.074Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-09-20T12:08:40.074Z", 
            "actor": {
                "username": "johnbillion", 
                "url": "/johnbillion", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/014/083/d2aa5d94732da736a08f022dba3f393e01312ee6_medium.jpg?1484683288"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "wordpress", 
            "message": "Fixed in WordPress 4.8.2 and backported to all branches.", 
            "markdown_message": "<p>Fixed in WordPress 4.8.2 and backported to all branches.</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 2008432, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2017-10-13T22:25:08.966Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-13T22:25:08.966Z", 
            "actor": {
                "url": "/wordpress", 
                "profile": {
                    "name": "WordPress"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/055/a7e722c23dedc020ade3b6e7f1a96baa455f86d8_medium.jpg?1392934661"
                }
            }, 
            "team_handle": "wordpress", 
            "bonus_amount": "50.0", 
            "bounty_amount": "300.0", 
            "collaborator": {
                "username": "yeahyeah", 
                "url": "/yeahyeah"
            }, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BountyAwarded", 
            "id": 2065226, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-19T15:26:20.851Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-19T15:26:20.851Z", 
            "actor": {
                "username": "yeahyeah", 
                "url": "/yeahyeah", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/196/d57c042600c6062b07435e04ac77b421dd42dd37_medium.jpg?1508100969"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "wordpress", 
            "first_to_agree": true, 
            "message": "Thanks for the bounty, can we do public disclosure with hidden comments? :)", 
            "markdown_message": "<p>Thanks for the bounty, can we do public disclosure with hidden comments? :)</p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 2084714, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-18T15:26:23.076Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-18T15:26:23.076Z", 
            "actor": {
                "url": "/wordpress", 
                "profile": {
                    "name": "WordPress"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/055/a7e722c23dedc020ade3b6e7f1a96baa455f86d8_medium.jpg?1392934661"
                }
            }, 
            "team_handle": "wordpress", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 2167453, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "yeahyeah", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/yeahyeah", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/002/196/a6a6c9e08fb1c833f0a78ac9a3767cfa71857b69_small.jpg?1508100969"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 62, 
        "name": "Cross-site Scripting (XSS) - Stored"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -33116587.713346098, 
    "disclosed_at": "2017-11-18T15:26:23.050Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/220903", 
    "created_at": "2017-04-14T02:10:04.808Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<h3 id=\"explanation\">Explanation</h3>\n\n<p>During my research on latest WordPress I found that <code>$file_description</code>  and <code>$description</code> from <code>wp-admin/theme-editor.php</code>  are not filtering name of the template allowing attacker to do XSS attack.</p>\n<pre class=\"highlight plaintext\"><code>...\n        $file_description = get_file_description( $filename );\n\n        if ( $filename !== basename( $absolute_filename ) || $file_description !== $filename ) {\n            $file_description .= &#39;&lt;br /&gt;&lt;span class=&quot;nonessential&quot;&gt;(&#39; . $filename . &#39;)&lt;/span&gt;&#39;;\n\n        }\n\n        if ( $absolute_filename === $file ) {\n            $file_description = &#39;&lt;span class=&quot;highlight&quot;&gt;&#39; . $file_description . &#39;&lt;/span&gt;&#39;;\n\n        }\n\n        $previous_file_type = $file_type;\n?&gt;\n        &lt;li&gt;&lt;a href=&quot;theme-editor.php?file=&lt;?php echo urlencode( $filename ) ?&gt;&amp;amp;theme=&lt;?php echo urlencode( $stylesheet ) ?&gt;&quot;&gt;&lt;?php echo $file_description; ?&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;?php\n    endforeach;\n?&gt;\n</code></pre>\n<p>From this code we can see that <code>$file_description = get_file_description( $filename );</code> is getting declared and later on under &lt;li&gt;&lt;a&gt; tags template name is printed on the page <code>...&lt;?php echo $file_description; ?&gt;&lt;/a&gt;&lt;/li&gt;</code></p>\n\n<p><code>$file_description</code> variable should be filtered before displayed to the user. For example using <code>htmlspecialchars()</code> function (example:  <a href=\"#\" class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"Wordpress_3.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/175/759/cf3d9e476255edcfc539e411d223ccff37ecf147/Wordpress_3.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQSGAJTS7X%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T222928Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDNv1JJkb2JCBJezLRSK3A3HLsRbM1N2dJQCs3cdkO9DdSlu97QyvuTWjB9TDM0zF0K5xYiGpDCZFKPrax%2BsFz5KI1WenrJdfAQhjK2VjV8ng750HOo6R9QtyoSkXqJSITk3z0sX6u%2BaGuR53DR1SgrXgU4%2BZj3kzVsOKKtd61G%2BDZP2N3q%2FR9lSxtCBWOIkOltAHyGZcqelOD%2BNHIXr08GPe3urs8MfpCWN12Uc98ELvbzHllGEdfFgQzzzB%2Fh03QvsfmUHldJCz%2F09ZO2mOXeVGvvhGa6P439ow0kmfHorCf2l49cQlp550RAVCceslQNRsIpjs%2FscvNzwUdv1wSWwe0IojrRDLG4nQFwiQ1K3a1GlpxXYzTv176jcnZhJdyzHXn0aNVd3n2yu6QXF1RyrednAqH6GTeLsY%2BmFdJvs1E%2FSPzNOEj5naR190ChZbKYdPEncIwhYy7S7R055CIUnAzUObhGpKBIz%2FL7hX57SOAVB8Fp6J9NWYxxkcT1Ux5M8TRdPzjlD4gsEW3VAWt2ylLrHUu11rkw%2BhgkA7Cbe4vsOk6sYBm%2BDSV9vvQVz42kWGtRMos%2BFMKzKt4FX3akfBm1nwEgIo656m4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=9a953d945e43453cb569462949e4ffdd0012ba0c802120eab53217397084ecd6\" data-attachment-type=\"image/png\">Wordpress_3.png (F175759)</a> )</p>\n\n<p>However, if victim click on the file that contain XSS payload, XSS will be executed because <code>$description = get_file_description( $relative_file );</code> is displaying name of the active file you are editing.</p>\n\n<h3 id=\"steps-to-replicate\">Steps to replicate</h3>\n\n<ol>\n<li>Go to Appearance &gt; Editor</li>\n<li>Select file you want to edit (don&#39;t select files that already have name - Archives, Theme Footer for example). I used &quot;back-compat.php&quot; <a href=\"#\" class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"Wordpress_2.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/175/758/1a089e1196f783390fdfef948789635acc3012f2/Wordpress_2.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQSGAJTS7X%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T222928Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDNv1JJkb2JCBJezLRSK3A3HLsRbM1N2dJQCs3cdkO9DdSlu97QyvuTWjB9TDM0zF0K5xYiGpDCZFKPrax%2BsFz5KI1WenrJdfAQhjK2VjV8ng750HOo6R9QtyoSkXqJSITk3z0sX6u%2BaGuR53DR1SgrXgU4%2BZj3kzVsOKKtd61G%2BDZP2N3q%2FR9lSxtCBWOIkOltAHyGZcqelOD%2BNHIXr08GPe3urs8MfpCWN12Uc98ELvbzHllGEdfFgQzzzB%2Fh03QvsfmUHldJCz%2F09ZO2mOXeVGvvhGa6P439ow0kmfHorCf2l49cQlp550RAVCceslQNRsIpjs%2FscvNzwUdv1wSWwe0IojrRDLG4nQFwiQ1K3a1GlpxXYzTv176jcnZhJdyzHXn0aNVd3n2yu6QXF1RyrednAqH6GTeLsY%2BmFdJvs1E%2FSPzNOEj5naR190ChZbKYdPEncIwhYy7S7R055CIUnAzUObhGpKBIz%2FL7hX57SOAVB8Fp6J9NWYxxkcT1Ux5M8TRdPzjlD4gsEW3VAWt2ylLrHUu11rkw%2BhgkA7Cbe4vsOk6sYBm%2BDSV9vvQVz42kWGtRMos%2BFMKzKt4FX3akfBm1nwEgIo656m4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=f6c3e34f7a989aea0f9adeea3738ff42322f5165e4dae5c8be9d91b05c4c08fd\" data-attachment-type=\"image/png\">Wordpress_2.png (F175758)</a>\n</li>\n<li>At the very top of the file add following comment:\n<code>/* Template Name: &lt;script&gt;confirm(document.cookie);&lt;/script&gt; */</code> Like this: <a href=\"#\" class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"Wordpress_2.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/175/758/1a089e1196f783390fdfef948789635acc3012f2/Wordpress_2.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQSGAJTS7X%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T222928Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDNv1JJkb2JCBJezLRSK3A3HLsRbM1N2dJQCs3cdkO9DdSlu97QyvuTWjB9TDM0zF0K5xYiGpDCZFKPrax%2BsFz5KI1WenrJdfAQhjK2VjV8ng750HOo6R9QtyoSkXqJSITk3z0sX6u%2BaGuR53DR1SgrXgU4%2BZj3kzVsOKKtd61G%2BDZP2N3q%2FR9lSxtCBWOIkOltAHyGZcqelOD%2BNHIXr08GPe3urs8MfpCWN12Uc98ELvbzHllGEdfFgQzzzB%2Fh03QvsfmUHldJCz%2F09ZO2mOXeVGvvhGa6P439ow0kmfHorCf2l49cQlp550RAVCceslQNRsIpjs%2FscvNzwUdv1wSWwe0IojrRDLG4nQFwiQ1K3a1GlpxXYzTv176jcnZhJdyzHXn0aNVd3n2yu6QXF1RyrednAqH6GTeLsY%2BmFdJvs1E%2FSPzNOEj5naR190ChZbKYdPEncIwhYy7S7R055CIUnAzUObhGpKBIz%2FL7hX57SOAVB8Fp6J9NWYxxkcT1Ux5M8TRdPzjlD4gsEW3VAWt2ylLrHUu11rkw%2BhgkA7Cbe4vsOk6sYBm%2BDSV9vvQVz42kWGtRMos%2BFMKzKt4FX3akfBm1nwEgIo656m4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=f6c3e34f7a989aea0f9adeea3738ff42322f5165e4dae5c8be9d91b05c4c08fd\" data-attachment-type=\"image/png\">Wordpress_2.png (F175758)</a>\n</li>\n<li>Click on Update File.</li>\n<li>XSS Popup will be prompted. <a href=\"#\" class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"Wordpress_1.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/175/757/76774aabff1b7d779c0c93fa67532048e38abdba/Wordpress_1.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQSGAJTS7X%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T222928Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDNv1JJkb2JCBJezLRSK3A3HLsRbM1N2dJQCs3cdkO9DdSlu97QyvuTWjB9TDM0zF0K5xYiGpDCZFKPrax%2BsFz5KI1WenrJdfAQhjK2VjV8ng750HOo6R9QtyoSkXqJSITk3z0sX6u%2BaGuR53DR1SgrXgU4%2BZj3kzVsOKKtd61G%2BDZP2N3q%2FR9lSxtCBWOIkOltAHyGZcqelOD%2BNHIXr08GPe3urs8MfpCWN12Uc98ELvbzHllGEdfFgQzzzB%2Fh03QvsfmUHldJCz%2F09ZO2mOXeVGvvhGa6P439ow0kmfHorCf2l49cQlp550RAVCceslQNRsIpjs%2FscvNzwUdv1wSWwe0IojrRDLG4nQFwiQ1K3a1GlpxXYzTv176jcnZhJdyzHXn0aNVd3n2yu6QXF1RyrednAqH6GTeLsY%2BmFdJvs1E%2FSPzNOEj5naR190ChZbKYdPEncIwhYy7S7R055CIUnAzUObhGpKBIz%2FL7hX57SOAVB8Fp6J9NWYxxkcT1Ux5M8TRdPzjlD4gsEW3VAWt2ylLrHUu11rkw%2BhgkA7Cbe4vsOk6sYBm%2BDSV9vvQVz42kWGtRMos%2BFMKzKt4FX3akfBm1nwEgIo656m4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=02e4c76cbac6079320d8e18e12134dcf4a01fb9f005b3fe2e7803f2c31362e28\" data-attachment-type=\"image/png\">Wordpress_1.png (F175757)</a>\n</li>\n</ol>\n\n<h3 id=\"technology-used\">Technology used:</h3>\n\n<p>Google Chrome 57.0.2987.133 (64-bit) - Latest</p>\n", 
    "severity_rating": "medium", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://wordpress.org/", 
            "about": "Beautiful sites of any kind.", 
            "twitter_handle": "wordpress", 
            "name": "WordPress"
        }, 
        "handle": "wordpress", 
        "url": "https://hackerone.com/wordpress", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/055/2ded484d947025dc191342c9ccdcf00effc53ff6_small.jpg?1392934661", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/055/a7e722c23dedc020ade3b6e7f1a96baa455f86d8_medium.jpg?1392934661"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 55, 
        "default_currency": "usd"
    }, 
    "is_published": false
}