{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2018-03-18T15:55:49.142Z", 
    "voters": [
        "jokebookservice1", 
        "foobar7", 
        "spam404", 
        "avlidienbrunn", 
        "inhibitor181", 
        "abr1k0s", 
        "bugdiscloseguys", 
        "eveeez", 
        "luckydivino", 
        "c1231665", 
        "and 9 more..."
    ], 
    "facebook_team?": false, 
    "has_bounty?": false, 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 24684, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": null, 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "Potential XSS vulnerability to HTML minification", 
    "is_member_of_team?": null, 
    "vote_count": 19, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2018-04-17T15:55:49.229Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2014-08-20T16:35:55.496Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-08-20T16:35:55.496Z", 
            "actor": {
                "username": "justin", 
                "url": "/justin", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/714/2eebae8eb32960de24af801c8d5ad15051291cf0_medium.png?1395966322"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "cloudflare", 
            "message": "Thank you for submission. I have escalated your report to our engineers for review.", 
            "markdown_message": "<p>Thank you for submission. I have escalated your report to our engineers for review.</p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 112661, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-09-18T10:33:04.412Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-09-18T10:33:04.412Z", 
            "actor": {
                "username": "filedescriptor", 
                "url": "/filedescriptor", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "cloudflare", 
            "message": "Any update? It seems the bug was fixed.", 
            "markdown_message": "<p>Any update? It seems the bug was fixed.</p>\n", 
            "type": "Activities::Comment", 
            "id": 129061, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-09-18T17:20:15.290Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-09-18T17:20:15.290Z", 
            "actor": {
                "username": "dngo", 
                "url": "/dngo", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/008/378/cd6cfea4313a2f67c6783f95d6edd21600abc88c_medium.png?1406909319"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "cloudflare", 
            "message": "Hi,\n\nOur engineers is reviewing the bug and we should have an update soon.", 
            "markdown_message": "<p>Hi,</p>\n\n<p>Our engineers is reviewing the bug and we should have an update soon.</p>\n", 
            "type": "Activities::Comment", 
            "id": 129236, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-10-10T16:54:30.772Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-10-10T16:54:30.772Z", 
            "actor": {
                "username": "matthewgall", 
                "url": "/matthewgall", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/012/593/48b584be922404fda5ea8ee6fe87b6d38fd92894_medium.png?1412116653"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "cloudflare", 
            "message": "Hello,\n\nApologies for the delay in updating you. Our engineers are still working on this and once a fix hits production, we will endeavour to update you.", 
            "markdown_message": "<p>Hello,</p>\n\n<p>Apologies for the delay in updating you. Our engineers are still working on this and once a fix hits production, we will endeavour to update you.</p>\n", 
            "type": "Activities::Comment", 
            "id": 140266, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-12-13T04:08:55.464Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-12-13T04:08:55.464Z", 
            "actor": {
                "username": "filedescriptor", 
                "url": "/filedescriptor", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "cloudflare", 
            "message": "I do believe the fix has already hit production, just wondering is there any update?", 
            "markdown_message": "<p>I do believe the fix has already hit production, just wondering is there any update?</p>\n", 
            "type": "Activities::Comment", 
            "id": 177833, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-03-12T09:28:40.728Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-03-12T09:28:40.728Z", 
            "actor": {
                "username": "filedescriptor", 
                "url": "/filedescriptor", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "cloudflare", 
            "message": "Hello there, any updates on this issue?", 
            "markdown_message": "<p>Hello there, any updates on this issue?</p>\n", 
            "type": "Activities::Comment", 
            "id": 351959, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-04-15T10:02:46.743Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-04-15T10:02:46.743Z", 
            "actor": {
                "username": "matthewgall", 
                "url": "/matthewgall", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/012/593/48b584be922404fda5ea8ee6fe87b6d38fd92894_medium.png?1412116653"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "cloudflare", 
            "message": "We believe this issue has been resolved. Please take a moment to reassess and let us know if you disagree.", 
            "markdown_message": "<p>We believe this issue has been resolved. Please take a moment to reassess and let us know if you disagree.</p>\n", 
            "type": "Activities::BugNeedsMoreInfo", 
            "id": 380416, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-04-15T10:11:26.801Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-04-15T10:11:26.801Z", 
            "actor": {
                "username": "filedescriptor", 
                "url": "/filedescriptor", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "cloudflare", 
            "message": "I can confirm this is fixed.", 
            "markdown_message": "<p>I can confirm this is fixed.</p>\n", 
            "type": "Activities::BugNew", 
            "id": 380428, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "filedescriptor", 
                "url": "/filedescriptor"
            }, 
            "created_at": "2015-06-09T21:51:56.212Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-06-09T21:51:56.212Z", 
            "actor": {
                "username": "cjunky", 
                "url": "/cjunky", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "cloudflare", 
            "message": "Hello,\n\nThanks - This is a case where the bug was already being addressed and the fix was already on the roadmap. Thank-you however for your submission!\n\nMarc", 
            "markdown_message": "<p>Hello,</p>\n\n<p>Thanks - This is a case where the bug was already being addressed and the fix was already on the roadmap. Thank-you however for your submission!</p>\n\n<p>Marc</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 448243, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-06-10T02:14:06.591Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-06-10T02:14:06.591Z", 
            "actor": {
                "username": "filedescriptor", 
                "url": "/filedescriptor", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "cloudflare", 
            "message": "Hey thanks for fixing it. Any chance to get a T-shirt or something?", 
            "markdown_message": "<p>Hey thanks for fixing it. Any chance to get a T-shirt or something?</p>\n", 
            "type": "Activities::Comment", 
            "id": 448563, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-06-10T02:50:09.460Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-06-10T02:50:09.460Z", 
            "actor": {
                "username": "cjunky", 
                "url": "/cjunky", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "cloudflare", 
            "message": "Sure, I dont see why not :)\n\nSend me your name, address and T-shirt size, and I will get one shipped out to you.\n\nCheers!\n\nMarc", 
            "markdown_message": "<p>Sure, I dont see why not :)</p>\n\n<p>Send me your name, address and T-shirt size, and I will get one shipped out to you.</p>\n\n<p>Cheers!</p>\n\n<p>Marc</p>\n", 
            "type": "Activities::Comment", 
            "id": 448592, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-06-10T03:41:40.293Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-06-10T03:42:16.344Z", 
            "actor": {
                "username": "filedescriptor", 
                "url": "/filedescriptor", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "cloudflare", 
            "message": "How should I send you the information? I don't feel like posting it here is an option (public disclosure will leak it).", 
            "markdown_message": "<p>How should I send you the information? I don&#39;t feel like posting it here is an option (public disclosure will leak it).</p>\n", 
            "type": "Activities::Comment", 
            "id": 448621, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2015-06-10T04:27:22.524Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-06-10T04:27:22.524Z", 
            "actor": {
                "username": "cjunky", 
                "url": "/cjunky", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "cloudflare", 
            "message": "If you want, send it directly to my company email - marc@cloudflare.com\nIf you are feeling particularly paranoid, ping me tomorrow and I will send you my work PGP key.\n\nMarc", 
            "markdown_message": "<p>If you want, send it directly to my company email - <a title=\"marc@cloudflare.com\" href=\"mailto:marc@cloudflare.com\" rel=\"nofollow noopener noreferrer\">marc@cloudflare.com</a><br>\nIf you are feeling particularly paranoid, ping me tomorrow and I will send you my work PGP key.</p>\n\n<p>Marc</p>\n", 
            "type": "Activities::Comment", 
            "id": 448665, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "filedescriptor", 
                "url": "/filedescriptor"
            }, 
            "created_at": "2015-06-10T05:26:10.343Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-06-10T05:26:10.343Z", 
            "actor": {
                "url": "/cloudflare", 
                "profile": {
                    "name": "Cloudflare"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/041/d2c3c5a370ea69f13c0c96e2a2498501429e6b30_medium.png?1480719394"
                }
            }, 
            "team_handle": "cloudflare", 
            "message": "Thanks for your valid bug report, we'll follow up with you in the near future regarding reward fulfilment. Thank you!", 
            "markdown_message": "<p>Thanks for your valid bug report, we&#39;ll follow up with you in the near future regarding reward fulfilment. Thank you!</p>\n", 
            "type": "Activities::SwagAwarded", 
            "id": 448703, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-18T15:55:49.184Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-18T15:55:49.184Z", 
            "actor": {
                "username": "filedescriptor", 
                "url": "/filedescriptor", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "cloudflare", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 2503655, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-04-17T15:55:59.437Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-04-17T15:55:59.437Z", 
            "actor": {
                "url": "/cloudflare", 
                "profile": {
                    "name": "Cloudflare"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/041/d2c3c5a370ea69f13c0c96e2a2498501429e6b30_medium.png?1480719394"
                }
            }, 
            "team_handle": "cloudflare", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 2625044, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "filedescriptor", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/filedescriptor", 
        "profile_picture_urls": {
            "small": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 60, 
        "name": "Cross-site Scripting (XSS) - Generic"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -20154573.621631775, 
    "disclosed_at": "2018-04-17T15:55:59.407Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/24684", 
    "created_at": "2014-08-17T04:09:46.269Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>I have already reported it through email but I was advised to post it here.</p>\n\n<p>Original request: <a title=\"https://support.cloudflare.com/hc/requests/166005\" href=\"/redirect?signature=a986815960e94c7efb4d1bdbbbbe9a064d7237df&amp;url=https%3A%2F%2Fsupport.cloudflare.com%2Fhc%2Frequests%2F166005\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://support.cloudflare.com/hc/requests/166005</span><i class=\"icon-external-link\"></i></a></p>\n\n<h2 id=\"the-issue\">The issue</h2>\n\n<p>The HTML minification function optimizes the HTML content without validating the HTML syntax. In particular circumstances this may lead to XSS vulnerability.</p>\n\n<h2 id=\"details\">Details</h2>\n\n<p>The HTML minification strips off any space between an less than sign(&lt;) and an element name, making every XSS prevention that relies on tag stripping mechanism vulnerable.</p>\n\n<p>For example, PHP&#39;s strip_tags() function is one of them. The way it handles malicious text is to remove complete tags, so if it encounters anything other than a valid tag it will do nothing.</p>\n\n<p>Now, if I am going to input the following secquence: <u>a less than sign(&lt;) followed by a space, followed by an element name, followed by a greater than sign(&gt;)</u>, e.g.<code>&lt; img&gt;</code>, the function will ignore it since it is not a valid tag according to HTML specification, and browsers will not parse it so the output remains safe.</p>\n\n<p>However, when HTML minification comes to play, it strips off the space between the less than sign and the element name, turning the safe text into a tag, which is unexpected to the function&#39;s intention.</p>\n\n<p>Needless to say, it is not limited to the particular function or language.</p>\n\n<h2 id=\"poc\">PoC</h2>\n<pre class=\"highlight php\"><code><span class=\"cp\">&lt;?php</span> <span class=\"k\">echo</span> <span class=\"nb\">strip_tags</span><span class=\"p\">(</span><span class=\"s1\">&#39;&lt; svg onload=alert(1)&gt;&#39;</span><span class=\"p\">);</span> <span class=\"cp\">?&gt;</span>\n</code></pre>\n<p>Comparing the results:</p>\n\n<p>Normal: </p>\n<pre class=\"highlight html\"><code><span class=\"nt\">&lt; svg</span> <span class=\"na\">onload=</span><span class=\"s\">alert(1)</span><span class=\"nt\">&gt;</span>\n</code></pre>\n<p>Minified: </p>\n<pre class=\"highlight html\"><code><span class=\"nt\">&lt;svg</span> <span class=\"na\">onload=</span><span class=\"s\">alert(1)</span><span class=\"nt\">&gt;</span>\n</code></pre>", 
    "vulnerability_information": "I have already reported it through email but I was advised to post it here.\r\n\r\nOriginal request: https://support.cloudflare.com/hc/requests/166005\r\n\r\nThe issue\r\n---------\r\n\r\nThe HTML minification function optimizes the HTML content without validating the HTML syntax. In particular circumstances this may lead to XSS vulnerability.\r\n\r\nDetails\r\n-------\r\n\r\nThe HTML minification strips off any space between an less than sign(<) and an element name, making every XSS prevention that relies on tag stripping mechanism vulnerable.\r\n\r\nFor example, PHP's strip_tags() function is one of them. The way it handles malicious text is to remove complete tags, so if it encounters anything other than a valid tag it will do nothing.\r\n\r\nNow, if I am going to input the following secquence: _a less than sign(<) followed by a space, followed by an element name, followed by a greater than sign(>)_, e.g.```< img>```, the function will ignore it since it is not a valid tag according to HTML specification, and browsers will not parse it so the output remains safe.\r\n\r\nHowever, when HTML minification comes to play, it strips off the space between the less than sign and the element name, turning the safe text into a tag, which is unexpected to the function's intention.\r\n\r\nNeedless to say, it is not limited to the particular function or language.\r\n\r\nPoC\r\n---\r\n```php\r\n<?php echo strip_tags('< svg onload=alert(1)>'); ?>\r\n```\r\n\r\nComparing the results:\r\n\r\nNormal: \r\n```html\r\n< svg onload=alert(1)>\r\n```\r\n\r\nMinified: \r\n```html\r\n<svg onload=alert(1)>\r\n```", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://www.cloudflare.com/disclosure", 
            "about": "", 
            "twitter_handle": "cloudflare", 
            "name": "Cloudflare"
        }, 
        "handle": "cloudflare", 
        "url": "https://hackerone.com/cloudflare", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/041/b9941bf2330424daec112aade53c7f8c19708cac_small.png?1480719394", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/041/d2c3c5a370ea69f13c0c96e2a2498501429e6b30_medium.png?1480719394"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 41, 
        "default_currency": "usd"
    }, 
    "is_published": false
}