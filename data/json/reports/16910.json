{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2018-08-13T02:21:51.742Z", 
    "voters": [
        "mattaustin", 
        "eveeez", 
        "zemnmez", 
        "mygf", 
        "0x08", 
        "spetr0x", 
        "cryptographer", 
        "khashaab", 
        "bdkarimul"
    ], 
    "facebook_team?": false, 
    "has_bounty?": false, 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 16910, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2018-09-05T02:23:53.999Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "Cross-site information assertion leak via Content Security Policy", 
    "is_member_of_team?": null, 
    "vote_count": 9, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2018-09-12T02:21:51.826Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2014-07-19T22:57:10.673Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-07-19T22:57:10.673Z", 
            "actor": {
                "username": "arice", 
                "url": "/arice", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/74e2a8a31fee27a0c9b3d1d90dd64f4e38b2fb1c_medium.jpeg?1466604112"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "hey @zemnmez - Sorry about the delay, catching up on a bit of a backlog here.\n\nThis is quite interesting, although I'm not sure the implications quite meet he bar we've set for this program. We'd be interested in hearing what the browser vendors and the CSP authors have to say about this. Have you attempted to disclose the issue to Firefox, Chrome, or W3C spec editors (Mike/Adam)? If not, could you please send it there way and report back if a fix is appropriate?", 
            "markdown_message": "<p>hey <a href=\"/zemnmez\">@zemnmez</a> - Sorry about the delay, catching up on a bit of a backlog here.</p>\n\n<p>This is quite interesting, although I&#39;m not sure the implications quite meet he bar we&#39;ve set for this program. We&#39;d be interested in hearing what the browser vendors and the CSP authors have to say about this. Have you attempted to disclose the issue to Firefox, Chrome, or W3C spec editors (Mike/Adam)? If not, could you please send it there way and report back if a fix is appropriate?</p>\n", 
            "type": "Activities::BugNeedsMoreInfo", 
            "id": 92137, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-07-20T01:38:46.482Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-07-20T01:38:57.185Z", 
            "actor": {
                "username": "zemnmez", 
                "url": "/zemnmez", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/005/901/d0f1a7ab58def5e85df8a0bdd84b8f95347c391c_medium.jpg?1526048598"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "I did a write up of my experience with this exploit: http://words.zemn.me/csp", 
            "markdown_message": "<p>I did a write up of my experience with this exploit: <a title=\"http://words.zemn.me/csp\" href=\"/redirect?signature=988131f9a4ab0971334e41edc1017ca69b5d78ca&amp;url=http%3A%2F%2Fwords.zemn.me%2Fcsp\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://words.zemn.me/csp</span><i class=\"icon-external-link\"></i></a></p>\n", 
            "type": "Activities::BugNew", 
            "id": 92181, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2014-08-25T15:40:45.555Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2014-08-25T15:40:45.555Z", 
            "actor": {
                "username": "zemnmez", 
                "url": "/zemnmez", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/005/901/d0f1a7ab58def5e85df8a0bdd84b8f95347c391c_medium.jpg?1526048598"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "Just FYI efficient de-anonymization attacks on social networks have been shown based on this exploit http://www.myseosolution.de/deanonymizing-facebook-users-by-csp-bruteforcing http://sakurity.com/profiledetector probably going to put one together myself", 
            "markdown_message": "<p>Just FYI efficient de-anonymization attacks on social networks have been shown based on this exploit <a title=\"http://www.myseosolution.de/deanonymizing-facebook-users-by-csp-bruteforcing\" href=\"/redirect?signature=db6a45bca06b2bed3bcd6882fefeecd6ff4245ad&amp;url=http%3A%2F%2Fwww.myseosolution.de%2Fdeanonymizing-facebook-users-by-csp-bruteforcing\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://www.myseosolution.de/deanonymizing-facebook-users-by-csp-bruteforcing</span><i class=\"icon-external-link\"></i></a> <a title=\"http://sakurity.com/profiledetector\" href=\"/redirect?signature=3abb2a1a99f9a474b731ad716c38ff1bb134a35d&amp;url=http%3A%2F%2Fsakurity.com%2Fprofiledetector\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://sakurity.com/profiledetector</span><i class=\"icon-external-link\"></i></a> probably going to put one together myself</p>\n", 
            "type": "Activities::Comment", 
            "id": 115029, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-05-30T14:40:10.463Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-05-30T14:40:10.463Z", 
            "actor": {
                "url": "/internet", 
                "profile": {
                    "name": "The Internet"
                }, 
                "ibb": true, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/38e952fcff2c0aae0d011d5cecd07e5f62ecbd63_medium.png?1383767658"
                }
            }, 
            "team_handle": "internet", 
            "message": "This finding was part of a large batch we were keeping track of as candidates for retroactive award based on the hope that we'd be able further increase the scope & funding of the IBB. But that turned out to be overly optimistic on our part as we weren't able to cover the entire range of submissions. Going forward, we aim to eliminate this ambiguity by applying the bulk of the IBB's resources towards more focused programs - a few new ones coming up shortly!\n\nBelated thank you for the work you invested into this finding.", 
            "markdown_message": "<p>This finding was part of a large batch we were keeping track of as candidates for retroactive award based on the hope that we&#39;d be able further increase the scope &amp; funding of the IBB. But that turned out to be overly optimistic on our part as we weren&#39;t able to cover the entire range of submissions. Going forward, we aim to eliminate this ambiguity by applying the bulk of the IBB&#39;s resources towards more focused programs - a few new ones coming up shortly!</p>\n\n<p>Belated thank you for the work you invested into this finding.</p>\n", 
            "type": "Activities::NotEligibleForBounty", 
            "id": 1709677, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "zemnmez", 
                "url": "/zemnmez"
            }, 
            "created_at": "2017-05-30T14:40:16.458Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-05-30T14:40:16.458Z", 
            "actor": {
                "username": "arice", 
                "url": "/arice", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/74e2a8a31fee27a0c9b3d1d90dd64f4e38b2fb1c_medium.jpeg?1466604112"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugResolved", 
            "id": 1709678, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-05-24T02:15:38.396Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-05-24T02:15:38.396Z", 
            "actor": {
                "username": "zemnmez", 
                "url": "/zemnmez", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/005/901/d0f1a7ab58def5e85df8a0bdd84b8f95347c391c_medium.jpg?1526048598"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "public disclosure?", 
            "markdown_message": "<p>public disclosure?</p>\n", 
            "type": "Activities::Comment", 
            "id": 2789452, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-13T02:21:51.769Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-13T02:21:51.769Z", 
            "actor": {
                "username": "zemnmez", 
                "url": "/zemnmez", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/005/901/d0f1a7ab58def5e85df8a0bdd84b8f95347c391c_medium.jpg?1526048598"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "first_to_agree": true, 
            "message": "public disclosure?", 
            "markdown_message": "<p>public disclosure?</p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 3184612, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-09-05T02:23:54.038Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-09-05T02:23:54.038Z", 
            "actor": {
                "username": "reed", 
                "url": "/reed", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/132/5781ea1c43c5c7680dd145226b86348a8d6ed085_medium.jpg?1394062279"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 3293837, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-09-05T02:23:54.142Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-09-05T02:23:54.142Z", 
            "actor": {
                "username": "reed", 
                "url": "/reed", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/132/5781ea1c43c5c7680dd145226b86348a8d6ed085_medium.jpg?1394062279"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 3293838, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "zemnmez", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/zemnmez", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/005/901/f0f3afc251604a256a377bbb620b3be24e1a41b6_small.jpg?1526048598"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 18, 
        "name": "Information Disclosure"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -7415724.365296907, 
    "disclosed_at": "2018-09-05T02:23:54.114Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/16910", 
    "created_at": "2014-06-18T22:31:04.534Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>It is possible to test for the satisfaction of certain assertions across origins by abuse of Content Security Policy. These could be assertions such as &#39;is the client logged into this website&#39;, or &#39;is the client logged in as this user&#39;, or &#39;does the client have access to these panels&#39;. This general exploit affects a very large portion of non-static websites.</p>\n\n<p>Content Security Policy allows an endpoint to define certain controls on where specific kinds of content can be located, and most importantly allows the endpoint to define an endpoint where trespasses should be reported.</p>\n\n<p>Here is an example, to leak the result of the assertion &#39;is the user logged in as X&#39; on Google Plus:</p>\n\n<p>Here is an example exploit flow to work out if the current user is &#39;Zemnmez&#39;, <a title=\"https://plus.google.com/106624718886599931522/\" href=\"/redirect?signature=538976ddda1df66579ede4d7dd6c48c48bee0083&amp;url=https%3A%2F%2Fplus.google.com%2F106624718886599931522%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://plus.google.com/106624718886599931522/</span><i class=\"icon-external-link\"></i></a>.</p>\n\n<p>The user is directed to an endpoint (ib) returning Content-Type text/html, an HTML image tag of src: <a title=\"https://plus.google.com/me/posts\" href=\"/redirect?signature=9f3b1f62432361355b16fb5acfa16ec7d97dee5a&amp;url=https%3A%2F%2Fplus.google.com%2Fme%2Fposts\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://plus.google.com/me/posts</span><i class=\"icon-external-link\"></i></a> and a header:</p>\n\n<p>Content-Security-Policy:default-src *; img-src <a title=\"https://plus.google.com/me/posts\" href=\"/redirect?signature=9f3b1f62432361355b16fb5acfa16ec7d97dee5a&amp;url=https%3A%2F%2Fplus.google.com%2Fme%2Fposts\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://plus.google.com/me/posts</span><i class=\"icon-external-link\"></i></a> <a title=\"https://plus.google.com/106624718886599931522/posts\" href=\"/redirect?signature=aae1b2b1efafeb412b3f9464583962465e5b27e1&amp;url=https%3A%2F%2Fplus.google.com%2F106624718886599931522%2Fposts\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://plus.google.com/106624718886599931522/posts</span><i class=\"icon-external-link\"></i></a>; report-uri ib</p>\n\n<p>If the user is Zemnmez, the assertion does not fail and no report is generated since the image resolves to <a title=\"https://plus.google.com/106624718886599931522/posts\" href=\"/redirect?signature=aae1b2b1efafeb412b3f9464583962465e5b27e1&amp;url=https%3A%2F%2Fplus.google.com%2F106624718886599931522%2Fposts\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://plus.google.com/106624718886599931522/posts</span><i class=\"icon-external-link\"></i></a> which passes the Content Security Policy. If the user is not Zemnmez, the Content Security Policy sends a report back to the endpoint indicating that the policy was violated.</p>\n\n<p>The report is sent back to &#39;ib&#39; and looks like this:</p>\n\n<p>blocked-uri: &quot;<a title=\"https://plus.google.com\" href=\"/redirect?signature=b26781f198318e0d5864f8c5d16b607811191d5e&amp;url=https%3A%2F%2Fplus.google.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://plus.google.com</span><i class=\"icon-external-link\"></i></a>&quot;<br>\ndocument-uri: &quot;[...]&quot;<br>\noriginal-policy: &quot;default-src *; img-src <a title=\"https://plus.google.com/me/posts\" href=\"/redirect?signature=9f3b1f62432361355b16fb5acfa16ec7d97dee5a&amp;url=https%3A%2F%2Fplus.google.com%2Fme%2Fposts\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://plus.google.com/me/posts</span><i class=\"icon-external-link\"></i></a> <a title=\"https://plus.google.com/106624718886599931522/posts\" href=\"/redirect?signature=aae1b2b1efafeb412b3f9464583962465e5b27e1&amp;url=https%3A%2F%2Fplus.google.com%2F106624718886599931522%2Fposts\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://plus.google.com/106624718886599931522/posts</span><i class=\"icon-external-link\"></i></a>; report-uri ib&quot;<br>\nreferrer: &quot;&quot;<br>\nstatus-code: 200<br>\nviolated-directive: &quot;img-src <a title=\"https://plus.google.com/me/posts\" href=\"/redirect?signature=9f3b1f62432361355b16fb5acfa16ec7d97dee5a&amp;url=https%3A%2F%2Fplus.google.com%2Fme%2Fposts\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://plus.google.com/me/posts</span><i class=\"icon-external-link\"></i></a> <a title=\"https://plus.google.com/106624718886599931522/posts\" href=\"/redirect?signature=aae1b2b1efafeb412b3f9464583962465e5b27e1&amp;url=https%3A%2F%2Fplus.google.com%2F106624718886599931522%2Fposts\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://plus.google.com/106624718886599931522/posts</span><i class=\"icon-external-link\"></i></a>&quot;</p>\n\n<p>A similar exploit can be demonstrated for YouTube:</p>\n\n<p>Youtube exposes a video enhancement interface for videos at: <a title=\"https://www.youtube.com/enhance?feature=vm&amp;v=%5Bvideoid%5D\" href=\"/redirect?signature=c01bb4777a96991e147f7cfd77a2803aaf527334&amp;url=https%3A%2F%2Fwww.youtube.com%2Fenhance%3Ffeature%3Dvm%26v%3D%255Bvideoid%255D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.youtube.com/enhance?feature=vm&amp;v=%5Bvideoid%5D</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>If the current account accessing the video is not the owner of the video, they are directed to /oops.</p>\n\n<p>Here is a video owned by me:</p>\n\n<p><a title=\"https://www.youtube.com/watch?v=G_bnKTH3Lts\" href=\"/redirect?signature=2a4355963e05df6f02cc9c57a281c0dd23c8148d&amp;url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DG_bnKTH3Lts\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.youtube.com/watch?v=G_bnKTH3Lts</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>The corresponding enhancement URL would be: <a title=\"https://www.youtube.com/enhance?feature=vm&amp;v=G_bnKTH3Lts\" href=\"/redirect?signature=8e8583c7055081974154bca85cd68d268d982379&amp;url=https%3A%2F%2Fwww.youtube.com%2Fenhance%3Ffeature%3Dvm%26v%3DG_bnKTH3Lts\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.youtube.com/enhance?feature=vm&amp;v=G_bnKTH3Lts</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>Given the CSP header:</p>\n\n<p>Content-Security-Policy:default-src *; img-src <a title=\"https://www.youtube.com/enhance?feature=vm&amp;v=G_bnKTH3Lts\" href=\"/redirect?signature=8e8583c7055081974154bca85cd68d268d982379&amp;url=https%3A%2F%2Fwww.youtube.com%2Fenhance%3Ffeature%3Dvm%26v%3DG_bnKTH3Lts\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.youtube.com/enhance?feature=vm&amp;v=G_bnKTH3Lts</span><i class=\"icon-external-link\"></i></a>; report-uri ib</p>\n\n<p>If the user is not logged in as me, this breaks the content security policy when &quot;<a title=\"https://www.youtube.com/enhance?feature=vm&amp;v=G_bnKTH3Lts\" href=\"/redirect?signature=8e8583c7055081974154bca85cd68d268d982379&amp;url=https%3A%2F%2Fwww.youtube.com%2Fenhance%3Ffeature%3Dvm%26v%3DG_bnKTH3Lts\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.youtube.com/enhance?feature=vm&amp;v=G_bnKTH3Lts</span><i class=\"icon-external-link\"></i></a>&quot; is embedded as an image, notifying the attacker that the assertion is false.</p>\n\n<p>As another example, here is an exploit flow for the assertion &#39;is the user logged in on Google&#39;:</p>\n\n<p>When the user is not logged in, <a title=\"http://calendar.google.com\" href=\"/redirect?signature=93746b413a6adda2b387ae0d65feb55ee798156f&amp;url=http%3A%2F%2Fcalendar.google.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://calendar.google.com</span><i class=\"icon-external-link\"></i></a> redirects to <a title=\"http://accounts.google.com\" href=\"/redirect?signature=cfcc982263c169605ad2f7de625e099c545d5d45&amp;url=http%3A%2F%2Faccounts.google.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://accounts.google.com</span><i class=\"icon-external-link\"></i></a>.</p>\n\n<p>An attacker can load a webpage with a Content-Security-Policy header whitelisting calendar.google.com, google.com and <a href=\"/redirect?signature=43cd652c2f1835df993825d00bed0660f498fc42&amp;url=http%3A%2F%2Fwww.google.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>www.google.com</span><i class=\"icon-external-link\"></i></a> but not accounts.google.com, and specifying that incidents should be reported.</p>\n\n<p>By embedding an image with the URL <a title=\"http://calendar.google.com\" href=\"/redirect?signature=93746b413a6adda2b387ae0d65feb55ee798156f&amp;url=http%3A%2F%2Fcalendar.google.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://calendar.google.com</span><i class=\"icon-external-link\"></i></a>, the attacker can detect if the user is logged into Google or not.</p>\n\n<p>This can be exploited by an endpoint with the image and this header:</p>\n\n<p>Content-Security-Policy:default-src *; img-src calendar.google.com google.com <a href=\"/redirect?signature=43cd652c2f1835df993825d00bed0660f498fc42&amp;url=http%3A%2F%2Fwww.google.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>www.google.com</span><i class=\"icon-external-link\"></i></a>; report-uri ib</p>\n\n<p>Where /ib is the relative URL of the endpoint. When not logged into Google, this request payload was sent to my server:</p>\n\n<p>blocked-uri: &quot;<a title=\"https://accounts.google.com\" href=\"/redirect?signature=9ffc2f9928bf4f691b53aa7d8c5ed2fd145d4b66&amp;url=https%3A%2F%2Faccounts.google.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://accounts.google.com</span><i class=\"icon-external-link\"></i></a>&quot;<br>\ndocument-uri: &quot;http://[...]/ib&quot;<br>\noriginal-policy: &quot;default-src *; img-src calendar.google.com google.com <a href=\"/redirect?signature=43cd652c2f1835df993825d00bed0660f498fc42&amp;url=http%3A%2F%2Fwww.google.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>www.google.com</span><i class=\"icon-external-link\"></i></a>; report-uri ib&quot;<br>\nreferrer: &quot;&quot;<br>\nstatus-code: 200<br>\nviolated-directive: &quot;img-src calendar.google.com google.com <a href=\"/redirect?signature=43cd652c2f1835df993825d00bed0660f498fc42&amp;url=http%3A%2F%2Fwww.google.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>www.google.com</span><i class=\"icon-external-link\"></i></a>&quot;</p>\n\n<p>The general modus is to not whitelist an endpoint that may occur as the result of some action, and use the report feature to detect what path was taken by the action. To assert that a user has access to a control panel, a CSP can be set up that specifies only the control panel is an allowed image. For most control panels, inadequate privileges cause a Location header to be sent to a login page or other endpoint. This is detected and sent back to the server as a report.</p>\n", 
    "vulnerability_information": "It is possible to test for the satisfaction of certain assertions across origins by abuse of Content Security Policy. These could be assertions such as 'is the client logged into this website', or 'is the client logged in as this user', or 'does the client have access to these panels'. This general exploit affects a very large portion of non-static websites.\r\n\r\nContent Security Policy allows an endpoint to define certain controls on where specific kinds of content can be located, and most importantly allows the endpoint to define an endpoint where trespasses should be reported.\r\n\r\nHere is an example, to leak the result of the assertion 'is the user logged in as X' on Google Plus:\r\n\r\nHere is an example exploit flow to work out if the current user is 'Zemnmez', https://plus.google.com/106624718886599931522/.\r\n\r\nThe user is directed to an endpoint (ib) returning Content-Type text/html, an HTML image tag of src: https://plus.google.com/me/posts and a header:\r\n\r\nContent-Security-Policy:default-src *; img-src https://plus.google.com/me/posts https://plus.google.com/106624718886599931522/posts; report-uri ib\r\n\r\nIf the user is Zemnmez, the assertion does not fail and no report is generated since the image resolves to https://plus.google.com/106624718886599931522/posts which passes the Content Security Policy. If the user is not Zemnmez, the Content Security Policy sends a report back to the endpoint indicating that the policy was violated.\r\n\r\nThe report is sent back to 'ib' and looks like this:\r\n\r\nblocked-uri: \"https://plus.google.com\"\r\ndocument-uri: \"[...]\"\r\noriginal-policy: \"default-src *; img-src https://plus.google.com/me/posts https://plus.google.com/106624718886599931522/posts; report-uri ib\"\r\nreferrer: \"\"\r\nstatus-code: 200\r\nviolated-directive: \"img-src https://plus.google.com/me/posts https://plus.google.com/106624718886599931522/posts\"\r\n\r\nA similar exploit can be demonstrated for YouTube:\r\n\r\nYoutube exposes a video enhancement interface for videos at: https://www.youtube.com/enhance?feature=vm&v=[videoid]\r\n\r\nIf the current account accessing the video is not the owner of the video, they are directed to /oops.\r\n\r\nHere is a video owned by me:\r\n\r\nhttps://www.youtube.com/watch?v=G_bnKTH3Lts\r\n\r\nThe corresponding enhancement URL would be: https://www.youtube.com/enhance?feature=vm&v=G_bnKTH3Lts\r\n\r\nGiven the CSP header:\r\n\r\nContent-Security-Policy:default-src *; img-src https://www.youtube.com/enhance?feature=vm&v=G_bnKTH3Lts; report-uri ib\r\n\r\nIf the user is not logged in as me, this breaks the content security policy when \"https://www.youtube.com/enhance?feature=vm&v=G_bnKTH3Lts\" is embedded as an image, notifying the attacker that the assertion is false.\r\n\r\nAs another example, here is an exploit flow for the assertion 'is the user logged in on Google':\r\n\r\n When the user is not logged in, http://calendar.google.com redirects to http://accounts.google.com.\r\n\r\nAn attacker can load a webpage with a Content-Security-Policy header whitelisting calendar.google.com, google.com and www.google.com but not accounts.google.com, and specifying that incidents should be reported.\r\n\r\nBy embedding an image with the URL http://calendar.google.com, the attacker can detect if the user is logged into Google or not.\r\n\r\nThis can be exploited by an endpoint with the image and this header:\r\n\r\nContent-Security-Policy:default-src *; img-src calendar.google.com google.com www.google.com; report-uri ib\r\n\r\nWhere /ib is the relative URL of the endpoint. When not logged into Google, this request payload was sent to my server:\r\n\r\nblocked-uri: \"https://accounts.google.com\"\r\ndocument-uri: \"http://[...]/ib\"\r\noriginal-policy: \"default-src *; img-src calendar.google.com google.com www.google.com; report-uri ib\"\r\nreferrer: \"\"\r\nstatus-code: 200\r\nviolated-directive: \"img-src calendar.google.com google.com www.google.com\"\r\n\r\n\r\nThe general modus is to not whitelist an endpoint that may occur as the result of some action, and use the report feature to detect what path was taken by the action. To assert that a user has access to a control panel, a CSP can be set up that specifies only the control panel is an allowed image. For most control panels, inadequate privileges cause a Location header to be sent to a login page or other endpoint. This is detected and sent back to the server as a report.", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "", 
            "about": "Hack all the things.", 
            "twitter_handle": null, 
            "name": "The Internet"
        }, 
        "handle": "internet", 
        "url": "https://hackerone.com/internet", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/020/b94983d2ec09553c3e08f98cc718cb17e01112e6_small.png?1383767658", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/38e952fcff2c0aae0d011d5cecd07e5f62ecbd63_medium.png?1383767658"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 20, 
        "default_currency": "usd"
    }, 
    "is_published": false
}