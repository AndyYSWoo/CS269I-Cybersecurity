{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": null, 
    "voters": [
        "bl4de", 
        "bagipro", 
        "eveeez", 
        "apapedulimu", 
        "japz"
    ], 
    "facebook_team?": false, 
    "has_bounty?": false, 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 319593, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2018-04-04T21:04:43.570Z", 
    "vulnerability_information": "I would like to report a ReDoS in `sshpk`\nIt allows to cause Denial of Service by trying to parse a crafted public key.\n\n# Module\n\n**module name:** sshpk\n**version:** 1.13.1\n**npm page:** `https://www.npmjs.com/package/sshpk`\n\n## Module Description\n\n> Parse, convert, fingerprint and use SSH keys (both public and private) in pure node -- no ssh-keygen or other external dependencies.\n\n## Module Stats\n\n320 485 downloads in the last day\n4 709 033 downloads in the last week\n19 365 516 downloads in the last month\n\n~232 386 192 estimated downloads per year\n\n# Vulnerability\n\n## Vulnerability Description\n\nReDoS.\n\n- regex: /^([a-z0-9-]+)[ \\t]+([a-zA-Z0-9+\\/]+[=]*)([\\n \\t]+([^\\n]+))?$/\n- evil string: `ssh-rsa a${Array(200000).join(' ')}x\\nx` (~200 KB, unwrap js template string)\n- file: https://github.com/joyent/node-sshpk/blob/v1.13.1/lib/formats/ssh.js#L17\n\nThe testcase uses ~200 KB string to demonstrate long unavailability period, but parsing is also considerably slow on shorter strings.\n\n## Steps To Reproduce:\n\n```js\nvar keyPub = `ssh-rsa a${Array(200000).join(' ')}x\\nx`;\nvar key = require('sshpk').parseKey(keyPub, 'ssh');\n```\n\n## Supporting Material/References:\n\n- Arch Linux Current\n- Node.js 9.5.0\n- npm 5.6.0\n\n# Wrap up\n\n- I contacted the maintainer to let him know: N \n- I opened an issue in the related repository: N\n\n## Impact\n\nCause denial of service by parsing a crafted public key file.", 
    "activity_page_count": 1, 
    "severity": {
        "metrics": {
            "confidentiality": "none", 
            "privileges_required": "none", 
            "user_interaction": "none", 
            "attack_vector": "network", 
            "attack_complexity": "low", 
            "scope": "unchanged", 
            "integrity": "none", 
            "availability": "high"
        }, 
        "rating": "high", 
        "score": 7.5, 
        "author_type": "Team"
    }, 
    "title": "`sshpk` is vulnerable to ReDoS when parsing crafted invalid public keys", 
    "is_member_of_team?": null, 
    "vote_count": 5, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": {
        "asset_identifier": "sshpk", 
        "max_severity": "critical", 
        "databaseId": 6410, 
        "asset_type": "SOURCE_CODE"
    }, 
    "allow_singular_disclosure_at": "2018-05-04T21:04:43.681Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "activity_page_number": 1, 
    "readable_substate": "Resolved", 
    "public": true, 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2018-02-26T07:24:09.159Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-02-26T07:24:09.159Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugTriaged", 
            "id": 2432833, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-02-26T07:24:43.223Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-02-26T07:24:43.223Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "Hi\u00a0@chalker,\n\nThanks for reporting this issue.\n\nI was able to reproduce and confirm the issue as you described and will triage this report as vulnerability.\nI will invite the package maintainer to this issue.\n", 
            "markdown_message": "<p>Hi\u00a0@chalker,</p>\n\n<p>Thanks for reporting this issue.</p>\n\n<p>I was able to reproduce and confirm the issue as you described and will triage this report as vulnerability.<br>\nI will invite the package maintainer to this issue.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2432836, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "old_scope": "Other module", 
            "created_at": "2018-02-26T07:26:08.783Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-02-26T07:26:08.783Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "new_scope": "sshpk", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ChangedScope", 
            "id": 2432838, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-02-26T07:36:11.757Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-02-26T07:36:11.757Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "additional_data": {
                "new_severity": "High (7.5)", 
                "old_severity": "Medium"
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportSeverityUpdated", 
            "id": 2432856, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-02-27T23:12:07.947Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-02-27T23:12:07.947Z", 
            "actor": {
                "username": "davisjam", 
                "url": "/davisjam", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ExternalUserJoined", 
            "id": 2440708, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-03T11:05:47.463Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-03T11:05:47.463Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@davisjam did you contact the maintainers on this report?\n\nI have invited them but no response so far and I want to file a generic security issue in the repo. Are you both ok with this?", 
            "markdown_message": "<p><a href=\"/davisjam\">@davisjam</a> did you contact the maintainers on this report?</p>\n\n<p>I have invited them but no response so far and I want to file a generic security issue in the repo. Are you both ok with this?</p>\n", 
            "type": "Activities::Comment", 
            "id": 2452788, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-03T11:46:10.265Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-03T11:46:10.265Z", 
            "actor": {
                "username": "chalker", 
                "url": "/chalker", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/068/907/8d96ee4e93e21e566a3d51e2746ad4df2e53256a_medium.png?1490131885"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@lirantal Afaik this one wasn't in @davisjam data, so I guess you shouldn't assume that the maintainers were contacted from his side.", 
            "markdown_message": "<p><a href=\"/lirantal\">@lirantal</a> Afaik this one wasn&#39;t in <a href=\"/davisjam\">@davisjam</a> data, so I guess you shouldn&#39;t assume that the maintainers were contacted from his side.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2452833, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-03T12:53:32.534Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-03T12:53:32.534Z", 
            "actor": {
                "username": "davisjam", 
                "url": "/davisjam", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "I did not report this myself. I think a generic issue should be OK.", 
            "markdown_message": "<p>I did not report this myself. I think a generic issue should be OK.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2452931, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-03T20:39:58.063Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-03T20:39:58.063Z", 
            "actor": {
                "username": "chalker", 
                "url": "/chalker", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/068/907/8d96ee4e93e21e566a3d51e2746ad4df2e53256a_medium.png?1490131885"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@lirantal This looks to be a joyent-managed library, their security contact is security@joyent.com.", 
            "markdown_message": "<p><a href=\"/lirantal\">@lirantal</a> This looks to be a joyent-managed library, their security contact is <a title=\"security@joyent.com\" href=\"mailto:security@joyent.com\" rel=\"nofollow noopener noreferrer\">security@joyent.com</a>.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2453554, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-03T20:55:25.135Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-03T20:55:25.135Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "Thanks. I reached out before to Cody Mello from joyent who has participated in this module, but will also send an e-mail to the security inbox.", 
            "markdown_message": "<p>Thanks. I reached out before to Cody Mello from joyent who has participated in this module, but will also send an e-mail to the security inbox.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2453583, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-09T21:20:11.129Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-09T21:20:11.129Z", 
            "actor": {
                "username": "joysec", 
                "url": "/joysec", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ExternalUserJoined", 
            "id": 2478150, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-09T21:31:24.929Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-09T21:31:24.929Z", 
            "actor": {
                "username": "joysec", 
                "url": "/joysec", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "Sorry for the delay on this one. We've confirmed the report at our end and have started working on a fix. Thanks!", 
            "markdown_message": "<p>Sorry for the delay on this one. We&#39;ve confirmed the report at our end and have started working on a fix. Thanks!</p>\n", 
            "type": "Activities::Comment", 
            "id": 2478160, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-10T09:06:39.521Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-10T09:08:02.037Z", 
            "actor": {
                "username": "chalker", 
                "url": "/chalker", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/068/907/8d96ee4e93e21e566a3d51e2746ad4df2e53256a_medium.png?1490131885"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@joysec Here is an (untested) fix for you:\n\n```diff\n- var SSHKEY_RE = /^([a-z0-9-]+)[ \\t]+([a-zA-Z0-9+\\/]+[=]*)([\\n \\t]+([^\\n]+))?$/;\n+ var SSHKEY_RE = /^([a-z0-9-]+)[ \\t]+([a-zA-Z0-9+\\/]+[=]*)([\\n \\t]+([^\\n \\t][^\\n]*))?$/;\n\n- var SSHKEY_RE2 = /^([a-z0-9-]+)[ \\t]+([a-zA-Z0-9+\\/ \\t\\n]+[=]*)(.*)$/;\n+ var SSHKEY_RE2 = /^([a-z0-9-]+)[ \\t]+([a-zA-Z0-9+\\/\\n][a-zA-Z0-9+\\/ \\t\\n]*[=]*)([^a-zA-Z0-9+\\/ \\t\\n=].*|)$/;\n```\n\nIt should produce the same results but removes ambiguity, and passes through the Weideman's toll check.", 
            "markdown_message": "<p><a href=\"/joysec\">@joysec</a> Here is an (untested) fix for you:</p>\n<pre class=\"highlight diff\"><code><span class=\"gd\">- var SSHKEY_RE = /^([a-z0-9-]+)[ \\t]+([a-zA-Z0-9+\\/]+[=]*)([\\n \\t]+([^\\n]+))?$/;\n</span><span class=\"gi\">+ var SSHKEY_RE = /^([a-z0-9-]+)[ \\t]+([a-zA-Z0-9+\\/]+[=]*)([\\n \\t]+([^\\n \\t][^\\n]*))?$/;\n</span>\n<span class=\"gd\">- var SSHKEY_RE2 = /^([a-z0-9-]+)[ \\t]+([a-zA-Z0-9+\\/ \\t\\n]+[=]*)(.*)$/;\n</span><span class=\"gi\">+ var SSHKEY_RE2 = /^([a-z0-9-]+)[ \\t]+([a-zA-Z0-9+\\/\\n][a-zA-Z0-9+\\/ \\t\\n]*[=]*)([^a-zA-Z0-9+\\/ \\t\\n=].*|)$/;\n</span></code></pre>\n<p>It should produce the same results but removes ambiguity, and passes through the Weideman&#39;s toll check.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2479220, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-10T10:06:32.091Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-10T10:06:32.091Z", 
            "actor": {
                "username": "davisjam", 
                "url": "/davisjam", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@chalker Your regexes are safe according to Weideman and the other detectors.", 
            "markdown_message": "<p><a href=\"/chalker\">@chalker</a> Your regexes are safe according to Weideman and the other detectors.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2479279, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-10T15:00:36.868Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-10T15:00:36.868Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@davisjam will you be able to continue with publishing a version fix and let us know so we can close the disclose the report?", 
            "markdown_message": "<p><a href=\"/davisjam\">@davisjam</a> will you be able to continue with publishing a version fix and let us know so we can close the disclose the report?</p>\n", 
            "type": "Activities::Comment", 
            "id": 2479561, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-10T15:44:31.076Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-10T15:44:31.076Z", 
            "actor": {
                "username": "chalker", 
                "url": "/chalker", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/068/907/8d96ee4e93e21e566a3d51e2746ad4df2e53256a_medium.png?1490131885"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@lirantal I suppose you meant to ask @joysec?", 
            "markdown_message": "<p><a href=\"/lirantal\">@lirantal</a> I suppose you meant to ask <a href=\"/joysec\">@joysec</a>?</p>\n", 
            "type": "Activities::Comment", 
            "id": 2479598, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-10T16:29:27.338Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-10T16:29:27.338Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "oh yes, my bad! didn't mean to ping Jamie :-)\nthanks for catching it.", 
            "markdown_message": "<p>oh yes, my bad! didn&#39;t mean to ping Jamie :-)<br>\nthanks for catching it.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2479651, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-12T19:38:00.034Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-12T19:40:54.640Z", 
            "actor": {
                "username": "joysec", 
                "url": "/joysec", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@chalker / @lirantal Do these proposed regexes look good to you? The ones you suggested don't quite work, but these pass all our tests (after one tiny change further down, since this does change the meaning of the first one a little):\n\n```diff\n /*JSSTYLED*/\n-var SSHKEY_RE = /^([a-z0-9-]+)[ \\t]+([a-zA-Z0-9+\\/]+[=]*)([\\n \\t]+([^\\n]+))?$/;\n+var SSHKEY_RE = /^([a-z0-9-]+)[ \\t]+([a-zA-Z0-9+\\/]+[=]*)[\\n \\t]+()([^\\n \\t][^\\n]*)?$/;\n /*JSSTYLED*/\n-var SSHKEY_RE2 = /^([a-z0-9-]+)[ \\t]+([a-zA-Z0-9+\\/ \\t\\n]+[=]*)(.*)$/;\n+var SSHKEY_RE2 = /^([a-z0-9-]+)[ \\t\\n]+([a-zA-Z0-9+\\/][a-zA-Z0-9+\\/ \\t\\n=]*)([^a-zA-Z0-9+\\/ \\t\\n=].*)?$/;\n```\n\nHow do you want us to deal with committing the fix for this? Is it ok if I make an empty bug with a title like \"performance issues parsing long SSH public keys\" to use for it and fill in the details after disclosure?", 
            "markdown_message": "<p><a href=\"/chalker\">@chalker</a> / <a href=\"/lirantal\">@lirantal</a> Do these proposed regexes look good to you? The ones you suggested don&#39;t quite work, but these pass all our tests (after one tiny change further down, since this does change the meaning of the first one a little):</p>\n<pre class=\"highlight diff\"><code> /*JSSTYLED*/\n<span class=\"gd\">-var SSHKEY_RE = /^([a-z0-9-]+)[ \\t]+([a-zA-Z0-9+\\/]+[=]*)([\\n \\t]+([^\\n]+))?$/;\n</span><span class=\"gi\">+var SSHKEY_RE = /^([a-z0-9-]+)[ \\t]+([a-zA-Z0-9+\\/]+[=]*)[\\n \\t]+()([^\\n \\t][^\\n]*)?$/;\n</span> /*JSSTYLED*/\n<span class=\"gd\">-var SSHKEY_RE2 = /^([a-z0-9-]+)[ \\t]+([a-zA-Z0-9+\\/ \\t\\n]+[=]*)(.*)$/;\n</span><span class=\"gi\">+var SSHKEY_RE2 = /^([a-z0-9-]+)[ \\t\\n]+([a-zA-Z0-9+\\/][a-zA-Z0-9+\\/ \\t\\n=]*)([^a-zA-Z0-9+\\/ \\t\\n=].*)?$/;\n</span></code></pre>\n<p>How do you want us to deal with committing the fix for this? Is it ok if I make an empty bug with a title like &quot;performance issues parsing long SSH public keys&quot; to use for it and fill in the details after disclosure?</p>\n", 
            "type": "Activities::Comment", 
            "id": 2485263, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-12T20:55:23.189Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-12T20:55:41.807Z", 
            "actor": {
                "username": "chalker", 
                "url": "/chalker", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/068/907/8d96ee4e93e21e566a3d51e2746ad4df2e53256a_medium.png?1490131885"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@joysec Yeah, my second regex seems to have broken things.\n\nThose in your patch seem safe, but the new `SSHKEY_RE2` seems to split `ssh-rsa AAAA=foo@example.org` differently than the old one.", 
            "markdown_message": "<p><a href=\"/joysec\">@joysec</a> Yeah, my second regex seems to have broken things.</p>\n\n<p>Those in your patch seem safe, but the new <code>SSHKEY_RE2</code> seems to split <code>ssh-rsa AAAA=foo@example.org</code> differently than the old one.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2485459, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-12T21:16:10.680Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-12T21:16:10.680Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@joysec yes, that sounds good.\nOnce you release a fix we'll confirm it and then request a full public disclosure if that would be ok with you.", 
            "markdown_message": "<p><a href=\"/joysec\">@joysec</a> yes, that sounds good.<br>\nOnce you release a fix we&#39;ll confirm it and then request a full public disclosure if that would be ok with you.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2485519, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-12T21:18:00.217Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-12T21:18:00.217Z", 
            "actor": {
                "username": "joysec", 
                "url": "/joysec", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@chalker Yeah, it does, but the logic further down picks up the slack by realising that the key didn't use up all those bytes when it parsed it, and stuffs them back into the comment field later.\n\n@lirantal Ok, I'll add another comment here when the release is out. Thanks!", 
            "markdown_message": "<p><a href=\"/chalker\">@chalker</a> Yeah, it does, but the logic further down picks up the slack by realising that the key didn&#39;t use up all those bytes when it parsed it, and stuffs them back into the comment field later.</p>\n\n<p><a href=\"/lirantal\">@lirantal</a> Ok, I&#39;ll add another comment here when the release is out. Thanks!</p>\n", 
            "type": "Activities::Comment", 
            "id": 2485521, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-12T21:55:18.071Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-12T21:55:18.071Z", 
            "actor": {
                "username": "davisjam", 
                "url": "/davisjam", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@joysec The new regexes are safe according to my analyses as well.", 
            "markdown_message": "<p><a href=\"/joysec\">@joysec</a> The new regexes are safe according to my analyses as well.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2485571, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-13T00:32:46.903Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-13T00:32:46.903Z", 
            "actor": {
                "username": "joysec", 
                "url": "/joysec", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "Release v1.14.1 of the module is on npm now (and tagged on github), with the fix in it. Ready for public disclosure.", 
            "markdown_message": "<p>Release v1.14.1 of the module is on npm now (and tagged on github), with the fix in it. Ready for public disclosure.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2486301, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-13T21:05:44.747Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-13T21:05:44.747Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "Thanks @joysec \n@chalker can you please confirm the fix is indeed working as expected with 1.14.1?", 
            "markdown_message": "<p>Thanks <a href=\"/joysec\">@joysec</a> <br>\n<a href=\"/chalker\">@chalker</a> can you please confirm the fix is indeed working as expected with 1.14.1?</p>\n", 
            "type": "Activities::Comment", 
            "id": 2489798, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "chalker", 
                "url": "/chalker"
            }, 
            "created_at": "2018-03-14T19:07:22.515Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-14T19:07:22.515Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugResolved", 
            "id": 2492876, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-19T12:48:38.867Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-19T12:48:38.867Z", 
            "actor": {
                "username": "chalker", 
                "url": "/chalker", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/068/907/8d96ee4e93e21e566a3d51e2746ad4df2e53256a_medium.png?1490131885"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@lirantal I can confirm that the ReDoS issue is fixed, but I did not test the generic behaviour of sshpk itself.\nCI should handle that.", 
            "markdown_message": "<p><a href=\"/lirantal\">@lirantal</a> I can confirm that the ReDoS issue is fixed, but I did not test the generic behaviour of sshpk itself.<br>\nCI should handle that.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2506086, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-19T21:44:47.365Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-19T21:44:47.365Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "Thanks.\nI'll proceed with a public disclosure once we have a CVE assigned.", 
            "markdown_message": "<p>Thanks.<br>\nI&#39;ll proceed with a public disclosure once we have a CVE assigned.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2507789, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-21T17:03:29.267Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-21T17:03:29.267Z", 
            "actor": {
                "username": "chalker", 
                "url": "/chalker", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/068/907/8d96ee4e93e21e566a3d51e2746ad4df2e53256a_medium.png?1490131885"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@joysec On a side note, I just filed two unrelated pull requests to https://github.com/joyent/node-sshpk/pulls that fix issues of `sshpk` on current and next Node.js versions. Sorry for pinging here, but given the popularity of `sshpk` and the fact that it's used as a dependency of `npm`, I think that this is important.", 
            "markdown_message": "<p><a href=\"/joysec\">@joysec</a> On a side note, I just filed two unrelated pull requests to <a title=\"https://github.com/joyent/node-sshpk/pulls\" href=\"/redirect?signature=f4caddd1f155977390ffe2d60ef319f5de534c60&amp;url=https%3A%2F%2Fgithub.com%2Fjoyent%2Fnode-sshpk%2Fpulls\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/joyent/node-sshpk/pulls</span><i class=\"icon-external-link\"></i></a> that fix issues of <code>sshpk</code> on current and next Node.js versions. Sorry for pinging here, but given the popularity of <code>sshpk</code> and the fact that it&#39;s used as a dependency of <code>npm</code>, I think that this is important.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2515200, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-04-04T21:04:43.612Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-04-04T21:04:43.612Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 2565940, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-04-04T21:06:23.062Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-04-04T21:06:23.062Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "@joysec, @chalker, since we have a known delay in CVE assignment, I will go ahead and proceed with a full public disclosure.", 
            "markdown_message": "<p><a href=\"/joysec\">@joysec</a>, <a href=\"/chalker\">@chalker</a>, since we have a known delay in CVE assignment, I will go ahead and proceed with a full public disclosure.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2565945, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-04-04T21:26:06.718Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-04-04T21:26:06.718Z", 
            "actor": {
                "username": "lirantal", 
                "url": "/lirantal", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/096/045/01f6fd0d814d80d025eb8a0dcb5292f042739569_medium.jpeg?1515169110"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "nodejs-ecosystem", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ManuallyDisclosed", 
            "id": 2566007, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "chalker", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/chalker", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/068/907/f597f5ffcdc20460ef54feffb26e20d03f4d2421_small.png?1490131885"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 48, 
        "name": "Denial of Service"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -18667261.423789464, 
    "disclosed_at": "2018-04-04T21:26:06.821Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/319593", 
    "created_at": "2018-02-25T19:14:42.891Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>I would like to report a ReDoS in <code>sshpk</code><br>\nIt allows to cause Denial of Service by trying to parse a crafted public key.</p>\n\n<h1 id=\"module\">Module</h1>\n\n<p><strong>module name:</strong> sshpk<br>\n<strong>version:</strong> 1.13.1<br>\n<strong>npm page:</strong> <code>https://www.npmjs.com/package/sshpk</code></p>\n\n<h2 id=\"module-description\">Module Description</h2>\n\n<blockquote>\n<p>Parse, convert, fingerprint and use SSH keys (both public and private) in pure node -- no ssh-keygen or other external dependencies.</p>\n</blockquote>\n\n<h2 id=\"module-stats\">Module Stats</h2>\n\n<p>320 485 downloads in the last day<br>\n4 709 033 downloads in the last week<br>\n19 365 516 downloads in the last month</p>\n\n<p>~232 386 192 estimated downloads per year</p>\n\n<h1 id=\"vulnerability\">Vulnerability</h1>\n\n<h2 id=\"vulnerability-description\">Vulnerability Description</h2>\n\n<p>ReDoS.</p>\n\n<ul>\n<li>regex: /^([a-z0-9-]+)[ \\t]+([a-zA-Z0-9+\\/]+[=]*)([\\n \\t]+([^\\n]+))?$/</li>\n<li>evil string: <code>ssh-rsa a${Array(200000).join(&#39; &#39;)}x\\nx</code> (~200 KB, unwrap js template string)</li>\n<li>file: <a title=\"https://github.com/joyent/node-sshpk/blob/v1.13.1/lib/formats/ssh.js#L17\" href=\"/redirect?signature=90520dd8c5c652de7b3c48eb257f683e77f621fb&amp;url=https%3A%2F%2Fgithub.com%2Fjoyent%2Fnode-sshpk%2Fblob%2Fv1.13.1%2Flib%2Fformats%2Fssh.js%23L17\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/joyent/node-sshpk/blob/v1.13.1/lib/formats/ssh.js#L17</span><i class=\"icon-external-link\"></i></a>\n</li>\n</ul>\n\n<p>The testcase uses ~200 KB string to demonstrate long unavailability period, but parsing is also considerably slow on shorter strings.</p>\n\n<h2 id=\"steps-to-reproduce\">Steps To Reproduce:</h2>\n<pre class=\"highlight javascript\"><code><span class=\"kd\">var</span> <span class=\"nx\">keyPub</span> <span class=\"o\">=</span> <span class=\"s2\">`ssh-rsa a</span><span class=\"p\">${</span><span class=\"nb\">Array</span><span class=\"p\">(</span><span class=\"mi\">200000</span><span class=\"p\">).</span><span class=\"nx\">join</span><span class=\"p\">(</span><span class=\"s1\">&#39; &#39;</span><span class=\"p\">)}</span><span class=\"s2\">x\\nx`</span><span class=\"p\">;</span>\n<span class=\"kd\">var</span> <span class=\"nx\">key</span> <span class=\"o\">=</span> <span class=\"nx\">require</span><span class=\"p\">(</span><span class=\"s1\">&#39;sshpk&#39;</span><span class=\"p\">).</span><span class=\"nx\">parseKey</span><span class=\"p\">(</span><span class=\"nx\">keyPub</span><span class=\"p\">,</span> <span class=\"s1\">&#39;ssh&#39;</span><span class=\"p\">);</span>\n</code></pre>\n<h2 id=\"supporting-material-references\">Supporting Material/References:</h2>\n\n<ul>\n<li>Arch Linux Current</li>\n<li>Node.js 9.5.0</li>\n<li>npm 5.6.0</li>\n</ul>\n\n<h1 id=\"wrap-up\">Wrap up</h1>\n\n<ul>\n<li>I contacted the maintainer to let him know: N </li>\n<li>I opened an issue in the related repository: N</li>\n</ul>\n\n<h2 id=\"impact\">Impact</h2>\n\n<p>Cause denial of service by parsing a crafted public key file.</p>\n", 
    "severity_rating": "high", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://nodejs.org/en/security/", 
            "about": "This program is used to handle vulnerabilities in the Node.js ecosystem.", 
            "twitter_handle": "", 
            "name": "Node.js third-party modules"
        }, 
        "handle": "nodejs-ecosystem", 
        "url": "https://hackerone.com/nodejs-ecosystem", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/023/949/309112251b444244d95977d1299148aae6482789_small.?1508679627", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/023/949/c1f5f15ac094c1327c13dd19f55dbcb7411272bd_medium.?1508679627"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 23949, 
        "default_currency": "usd"
    }, 
    "is_published": false
}