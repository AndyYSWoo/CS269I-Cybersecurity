{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2017-02-07T01:23:21.000Z", 
    "voters": [
        "titanous", 
        "eveeez", 
        "mpz", 
        "icanthack", 
        "spetr0x"
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "800.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 194906, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2017-02-07T01:23:00.006Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "Heap overflow due to off-by-one when expanding stack", 
    "is_member_of_team?": null, 
    "vote_count": 5, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2017-03-09T01:23:00.051Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$800", 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": true, 
            "created_at": "2016-12-31T02:16:16.830Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-12-31T02:16:16.830Z", 
            "actor": {
                "url": "/shopify-scripts", 
                "profile": {
                    "name": "shopify-scripts"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/015/668/b50db49e93f656e202ae6f94b4c0821d1184134b_medium.jpg?1475592254"
                }
            }, 
            "team_handle": "shopify-scripts", 
            "message": "Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\n\nDue to the holiday period and the large volume of reports we have received, it may take us up to three weeks to respond. Thank you for your patience!", 
            "markdown_message": "<p>Thank you for reporting this bug! This is an automated response to let you know that we&#39;ve received your issue, and we&#39;ll process it as soon as possible.</p>\n\n<p>Due to the holiday period and the large volume of reports we have received, it may take us up to three weeks to respond. Thank you for your patience!</p>\n", 
            "type": "Activities::Comment", 
            "id": 1392833, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-01-10T21:52:11.110Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-01-10T21:52:11.110Z", 
            "actor": {
                "username": "clayton", 
                "url": "/clayton", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/019/166/6d366b567e9fef1c476c1505c0016e3031a74a34_medium.jpg?1493127129"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify-scripts", 
            "message": "Thank you for your report. We've reproduced the issue, and opened an issue upstream: https://github.com/mruby/mruby/issues/3391", 
            "markdown_message": "<p>Thank you for your report. We&#39;ve reproduced the issue, and opened an issue upstream: <a title=\"https://github.com/mruby/mruby/issues/3391\" href=\"/redirect?signature=469f9f73a958397c2e7e0578b80681af169b5680&amp;url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fissues%2F3391\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/mruby/mruby/issues/3391</span><i class=\"icon-external-link\"></i></a></p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 1412380, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "titanous", 
                "url": "/titanous"
            }, 
            "created_at": "2017-01-23T16:03:19.246Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-01-23T16:03:19.246Z", 
            "actor": {
                "username": "clayton", 
                "url": "/clayton", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/019/166/6d366b567e9fef1c476c1505c0016e3031a74a34_medium.jpg?1493127129"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify-scripts", 
            "message": "Thanks again for your report. This issue has been addressed upstream in https://github.com/mruby/mruby/commit/c48aef0b653ba83452c97b1d1017869de2a846b9\n\nOur next round of bounty decisions will take place within two weeks, so we'll be in touch with you again soon.", 
            "markdown_message": "<p>Thanks again for your report. This issue has been addressed upstream in <a title=\"https://github.com/mruby/mruby/commit/c48aef0b653ba83452c97b1d1017869de2a846b9\" href=\"/redirect?signature=da86da723a8fb5e11c236bf4b1388e1d08ffc9a5&amp;url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fcommit%2Fc48aef0b653ba83452c97b1d1017869de2a846b9\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/mruby/mruby/commit/c48aef0b653ba83452c97b1d1017869de2a846b9</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>Our next round of bounty decisions will take place within two weeks, so we&#39;ll be in touch with you again soon.</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 1438503, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2017-02-07T01:22:54.476Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-02-07T01:22:54.476Z", 
            "actor": {
                "url": "/shopify-scripts", 
                "profile": {
                    "name": "shopify-scripts"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/015/668/b50db49e93f656e202ae6f94b4c0821d1184134b_medium.jpg?1475592254"
                }
            }, 
            "team_handle": "shopify-scripts", 
            "bonus_amount": "0.0", 
            "bounty_amount": "800.0", 
            "collaborator": {
                "username": "titanous", 
                "url": "/titanous"
            }, 
            "message": "Thanks for helping improve the security of Mruby and Shopify Scripts!", 
            "markdown_message": "<p>Thanks for helping improve the security of Mruby and Shopify Scripts!</p>\n", 
            "type": "Activities::BountyAwarded", 
            "id": 1467320, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-02-07T01:23:00.025Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-02-07T01:23:00.025Z", 
            "actor": {
                "username": "andrewdunbar", 
                "url": "/andrewdunbar", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/019/164/cd46f5270ea41c5f0da3bea93e2eca7a95858caf_medium.jpg?1427927985"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify-scripts", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1467321, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-02-07T01:23:21.020Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-02-07T01:23:21.020Z", 
            "actor": {
                "username": "titanous", 
                "url": "/titanous", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/226/e2bc42703cd2cad3643045e96f47ddc568e8d9d2_medium.jpg?1470155631"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify-scripts", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1467324, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-02-07T01:23:21.057Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-02-07T01:23:21.057Z", 
            "actor": {
                "username": "titanous", 
                "url": "/titanous", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/226/e2bc42703cd2cad3643045e96f47ddc568e8d9d2_medium.jpg?1470155631"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify-scripts", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 1467325, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "titanous", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/titanous", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/002/226/220acb1d8d3aaa8d2039ba55e1ca23e17f46af30_small.jpg?1470155631"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 2, 
        "name": "Memory Corruption - Generic"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -55113664.65874905, 
    "disclosed_at": "2017-02-07T01:23:21.041Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/194906", 
    "created_at": "2016-12-31T02:16:16.664Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>This program triggers a heap buffer overflow while zeroing a new stack allocation due to an off-by-one while expanding the stack. It doesn&#39;t appear to be exploitable and the fix is extremely simple so I didn&#39;t try to simplify the failing test case too much:</p>\n<pre class=\"highlight ruby\"><code><span class=\"k\">class</span> <span class=\"nc\">A</span>\n<span class=\"k\">yield</span> <span class=\"k\">ensure</span> <span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span>\n<span class=\"k\">end</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"n\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"n\">s0</span><span class=\"o\">&gt;&gt;=</span><span class=\"n\">e</span><span class=\"o\">=</span><span class=\"n\">_</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"o\">&gt;</span><span class=\"nb\">p</span><span class=\"o\">&gt;&gt;=</span><span class=\"n\">sg</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">.</span><span class=\"mi\">0</span><span class=\"o\">&gt;</span><span class=\"n\">u</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">.</span><span class=\"mi\">0</span><span class=\"o\">&gt;</span><span class=\"n\">a</span><span class=\"o\">&gt;&gt;=</span><span class=\"n\">ab</span><span class=\"o\">|=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">.</span><span class=\"mi\">0</span><span class=\"o\">&gt;</span><span class=\"n\">r</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"o\">&gt;</span><span class=\"n\">e0</span><span class=\"o\">&gt;&gt;=</span><span class=\"n\">i</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">.</span><span class=\"mi\">0</span><span class=\"o\">&gt;</span><span class=\"n\">r0</span><span class=\"o\">&gt;&gt;=</span><span class=\"n\">a00</span><span class=\"o\">&gt;</span><span class=\"n\">ry</span><span class=\"o\">&gt;&gt;=</span><span class=\"n\">u0</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">.</span><span class=\"mi\">0</span><span class=\"o\">&gt;</span><span class=\"n\">x</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"o\">&gt;</span><span class=\"mi\">0</span><span class=\"o\">|</span><span class=\"err\">\u00fc</span><span class=\"o\">|=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">.</span><span class=\"mi\">0</span><span class=\"o\">&gt;</span><span class=\"n\">r00</span><span class=\"o\">&gt;&gt;=</span><span class=\"n\">y</span><span class=\"o\">&gt;&gt;=</span><span class=\"n\">t</span><span class=\"o\">&gt;&gt;=</span><span class=\"n\">up</span><span class=\"o\">=</span><span class=\"n\">sy</span><span class=\"o\">&gt;&gt;=</span><span class=\"n\">s00</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">.</span><span class=\"mi\">0</span><span class=\"o\">&gt;</span><span class=\"n\">ug</span><span class=\"o\">&gt;&gt;=</span><span class=\"n\">f</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"o\">&gt;</span><span class=\"mi\">0</span><span class=\"o\">&gt;&gt;</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"o\">&gt;</span><span class=\"n\">a0</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"o\">&gt;</span><span class=\"n\">s</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">.</span><span class=\"mi\">0</span><span class=\"o\">&gt;</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"mi\">0</span><span class=\"o\">&gt;</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"o\">&gt;&gt;=</span><span class=\"k\">super</span>\n</code></pre>\n<p>ASAN report:</p>\n<pre class=\"highlight plaintext\"><code>=================================================================\n==7397==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x621000017900 at pc 0x0000004ae8ac bp 0x7fff42c9a9d0 sp 0x7fff42c9a180\nWRITE of size 16 at 0x621000017900 thread T0\n    #0 0x4ae8ab in __asan_memcpy (/vagrant/bin/mruby+0x4ae8ab)\n    #1 0x64b513 in stack_clear /vagrant/src/vm.c:68:15\n    #2 0x64b1ea in init_new_stack_space /vagrant/src/vm.c:127:5\n    #3 0x617dc0 in stack_extend /vagrant/src/vm.c:174:3\n    #4 0x61e214 in mrb_vm_run /vagrant/src/vm.c:770:3\n    #5 0x618344 in mrb_run /vagrant/src/vm.c:2481:10\n    #6 0x647f5b in ecall /vagrant/src/vm.c:297:3\n    #7 0x62f830 in mrb_vm_exec /vagrant/src/vm.c:1561:15\n    #8 0x61e2eb in mrb_vm_run /vagrant/src/vm.c:772:10\n    #9 0x64a628 in mrb_top_run /vagrant/src/vm.c:2491:12\n    #10 0x674229 in mrb_load_exec /vagrant/mrbgems/mruby-compiler/core/parse.y:5755:7\n    #11 0x674ec5 in mrb_load_file_cxt /vagrant/mrbgems/mruby-compiler/core/parse.y:5764:10\n    #12 0x4f3af5 in main /vagrant/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:232:11\n    #13 0x7f2d32996f44 in __libc_start_main /build/eglibc-oGUzwX/eglibc-2.19/csu/libc-start.c:287\n    #14 0x41a505 in _start (/vagrant/bin/mruby+0x41a505)\n\n0x621000017900 is located 0 bytes to the right of 4096-byte region [0x621000016900,0x621000017900)\nallocated by thread T0 here:\n    #0 0x4c4c0d in realloc (/vagrant/bin/mruby+0x4c4c0d)\n    #1 0x5bfde5 in mrb_default_allocf /vagrant/src/state.c:60:12\n    #2 0x550396 in mrb_realloc_simple /vagrant/src/gc.c:201:8\n    #3 0x5509e4 in mrb_realloc /vagrant/src/gc.c:215:8\n    #4 0x64ade2 in stack_extend_alloc /vagrant/src/vm.c:155:33\n    #5 0x617db1 in stack_extend /vagrant/src/vm.c:172:5\n    #6 0x61e214 in mrb_vm_run /vagrant/src/vm.c:770:3\n    #7 0x618344 in mrb_run /vagrant/src/vm.c:2481:10\n    #8 0x647f5b in ecall /vagrant/src/vm.c:297:3\n    #9 0x62f830 in mrb_vm_exec /vagrant/src/vm.c:1561:15\n    #10 0x61e2eb in mrb_vm_run /vagrant/src/vm.c:772:10\n    #11 0x64a628 in mrb_top_run /vagrant/src/vm.c:2491:12\n    #12 0x674229 in mrb_load_exec /vagrant/mrbgems/mruby-compiler/core/parse.y:5755:7\n    #13 0x674ec5 in mrb_load_file_cxt /vagrant/mrbgems/mruby-compiler/core/parse.y:5764:10\n    #14 0x4f3af5 in main /vagrant/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:232:11\n    #15 0x7f2d32996f44 in __libc_start_main /build/eglibc-oGUzwX/eglibc-2.19/csu/libc-start.c:287\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow (/vagrant/bin/mruby+0x4ae8ab) in __asan_memcpy\nShadow bytes around the buggy address:\n  0x0c427fffaed0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c427fffaee0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c427fffaef0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c427fffaf00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c427fffaf10: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n=&gt;0x0c427fffaf20:[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c427fffaf30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c427fffaf40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c427fffaf50: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c427fffaf60: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c427fffaf70: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07\n  Heap left redzone:       fa\n  Heap right redzone:      fb\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack partial redzone:   f4\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n==7397==ABORTING\n</code></pre>\n<p>Patch:</p>\n<pre class=\"highlight diff\"><code>From 7a197ff7c87a4c1db1a686bad49c5d42f9044c12 Mon Sep 17 00:00:00 2001\nFrom: Jonathan Rudenberg &lt;jonathan@titanous.com&gt;\nDate: Fri, 30 Dec 2016 21:15:23 -0500\nSubject: [PATCH] Fix off-by-one when expanding stack with keep&gt;0\n\n---\n src/vm.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n<span class=\"gh\">diff --git a/src/vm.c b/src/vm.c\nindex 368b75a9..051c3b83 100644\n</span><span class=\"gd\">--- a/src/vm.c\n</span><span class=\"gi\">+++ b/src/vm.c\n</span><span class=\"gu\">@@ -124,7 +124,7 @@ init_new_stack_space(mrb_state *mrb, int room, int keep)\n</span> {\n   if (room &gt; keep) {\n     /* do not leave uninitialized malloc region */\n<span class=\"gd\">-    stack_clear(&amp;(mrb-&gt;c-&gt;stack[keep]), room - keep);\n</span><span class=\"gi\">+    stack_clear(&amp;(mrb-&gt;c-&gt;stack[keep]), room - keep - 1);\n</span>   }\n }\n\n<span class=\"gd\">-- \n</span>2.11.0\n\n\n</code></pre>", 
    "vulnerability_information": "This program triggers a heap buffer overflow while zeroing a new stack allocation due to an off-by-one while expanding the stack. It doesn't appear to be exploitable and the fix is extremely simple so I didn't try to simplify the failing test case too much:\n\n```ruby\nclass A\nyield ensure 0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g>>=0.g\nend.g>>=g>>=s0>>=e=_=0.g>>=0>p>>=sg>>=0..0>u>>=0..0>a>>=ab|=0..0>r>>=0>e0>>=i>>=0..0>r0>>=a00>ry>>=u0>>=0..0>x>>=0.g>>=0>0|\u00fc|=0..0>r00>>=y>>=t>>=up=sy>>=s00>>=0..0>ug>>=f>>=0>0>>0.g>>=0>a0>>=0.g>>=0>s>>=0..0>0.g>>=0>0.g>>=super\n```\n\nASAN report:\n\n```text\n=================================================================\n==7397==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x621000017900 at pc 0x0000004ae8ac bp 0x7fff42c9a9d0 sp 0x7fff42c9a180\nWRITE of size 16 at 0x621000017900 thread T0\n    #0 0x4ae8ab in __asan_memcpy (/vagrant/bin/mruby+0x4ae8ab)\n    #1 0x64b513 in stack_clear /vagrant/src/vm.c:68:15\n    #2 0x64b1ea in init_new_stack_space /vagrant/src/vm.c:127:5\n    #3 0x617dc0 in stack_extend /vagrant/src/vm.c:174:3\n    #4 0x61e214 in mrb_vm_run /vagrant/src/vm.c:770:3\n    #5 0x618344 in mrb_run /vagrant/src/vm.c:2481:10\n    #6 0x647f5b in ecall /vagrant/src/vm.c:297:3\n    #7 0x62f830 in mrb_vm_exec /vagrant/src/vm.c:1561:15\n    #8 0x61e2eb in mrb_vm_run /vagrant/src/vm.c:772:10\n    #9 0x64a628 in mrb_top_run /vagrant/src/vm.c:2491:12\n    #10 0x674229 in mrb_load_exec /vagrant/mrbgems/mruby-compiler/core/parse.y:5755:7\n    #11 0x674ec5 in mrb_load_file_cxt /vagrant/mrbgems/mruby-compiler/core/parse.y:5764:10\n    #12 0x4f3af5 in main /vagrant/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:232:11\n    #13 0x7f2d32996f44 in __libc_start_main /build/eglibc-oGUzwX/eglibc-2.19/csu/libc-start.c:287\n    #14 0x41a505 in _start (/vagrant/bin/mruby+0x41a505)\n\n0x621000017900 is located 0 bytes to the right of 4096-byte region [0x621000016900,0x621000017900)\nallocated by thread T0 here:\n    #0 0x4c4c0d in realloc (/vagrant/bin/mruby+0x4c4c0d)\n    #1 0x5bfde5 in mrb_default_allocf /vagrant/src/state.c:60:12\n    #2 0x550396 in mrb_realloc_simple /vagrant/src/gc.c:201:8\n    #3 0x5509e4 in mrb_realloc /vagrant/src/gc.c:215:8\n    #4 0x64ade2 in stack_extend_alloc /vagrant/src/vm.c:155:33\n    #5 0x617db1 in stack_extend /vagrant/src/vm.c:172:5\n    #6 0x61e214 in mrb_vm_run /vagrant/src/vm.c:770:3\n    #7 0x618344 in mrb_run /vagrant/src/vm.c:2481:10\n    #8 0x647f5b in ecall /vagrant/src/vm.c:297:3\n    #9 0x62f830 in mrb_vm_exec /vagrant/src/vm.c:1561:15\n    #10 0x61e2eb in mrb_vm_run /vagrant/src/vm.c:772:10\n    #11 0x64a628 in mrb_top_run /vagrant/src/vm.c:2491:12\n    #12 0x674229 in mrb_load_exec /vagrant/mrbgems/mruby-compiler/core/parse.y:5755:7\n    #13 0x674ec5 in mrb_load_file_cxt /vagrant/mrbgems/mruby-compiler/core/parse.y:5764:10\n    #14 0x4f3af5 in main /vagrant/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:232:11\n    #15 0x7f2d32996f44 in __libc_start_main /build/eglibc-oGUzwX/eglibc-2.19/csu/libc-start.c:287\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow (/vagrant/bin/mruby+0x4ae8ab) in __asan_memcpy\nShadow bytes around the buggy address:\n  0x0c427fffaed0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c427fffaee0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c427fffaef0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c427fffaf00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c427fffaf10: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n=>0x0c427fffaf20:[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c427fffaf30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c427fffaf40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c427fffaf50: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c427fffaf60: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c427fffaf70: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07\n  Heap left redzone:       fa\n  Heap right redzone:      fb\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack partial redzone:   f4\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n==7397==ABORTING\n```\n\nPatch:\n\n```patch\nFrom 7a197ff7c87a4c1db1a686bad49c5d42f9044c12 Mon Sep 17 00:00:00 2001\nFrom: Jonathan Rudenberg <jonathan@titanous.com>\nDate: Fri, 30 Dec 2016 21:15:23 -0500\nSubject: [PATCH] Fix off-by-one when expanding stack with keep>0\n\n---\n src/vm.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a/src/vm.c b/src/vm.c\nindex 368b75a9..051c3b83 100644\n--- a/src/vm.c\n+++ b/src/vm.c\n@@ -124,7 +124,7 @@ init_new_stack_space(mrb_state *mrb, int room, int keep)\n {\n   if (room > keep) {\n     /* do not leave uninitialized malloc region */\n-    stack_clear(&(mrb->c->stack[keep]), room - keep);\n+    stack_clear(&(mrb->c->stack[keep]), room - keep - 1);\n   }\n }\n \n-- \n2.11.0\n\n\n```", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://www.mruby.science", 
            "about": "", 
            "twitter_handle": "", 
            "name": "shopify-scripts"
        }, 
        "handle": "shopify-scripts", 
        "url": "https://hackerone.com/shopify-scripts", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/015/668/9f47d94cbd9e4311b57f1ab05f67fb5c26fd2e78_small.jpg?1475592254", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/015/668/b50db49e93f656e202ae6f94b4c0821d1184134b_medium.jpg?1475592254"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 15668, 
        "default_currency": "usd"
    }, 
    "is_published": false
}