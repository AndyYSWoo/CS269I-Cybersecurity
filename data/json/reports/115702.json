{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2017-10-19T10:15:46.733Z", 
    "voters": [
        "sp1d3rs", 
        "eveeez", 
        "geeknik", 
        "xiaoyinl", 
        "mr_r3boot", 
        "spetr0x", 
        "hthomison1078"
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "200.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 115702, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2017-10-19T09:36:32.722Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "[tor] libevent dns OOB read", 
    "is_member_of_team?": null, 
    "vote_count": 7, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2017-11-18T09:36:32.866Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$200", 
    "attachments": [
        {
            "file_name": "resolv.conf", 
            "type": "text/plain", 
            "id": 72902, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/072/902/baee457cdd269e35bc84db5711c42fc37a196dbe/resolv.conf?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQVHWOGSNR%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T223117Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEBAaDNyA%2BB7EVws6w20xiyK3AzcCTkx0GnZzVQ6TwXkp44%2Ff6M7%2FsO19EHzsTJXAjGqGadXUwBewmY%2FA3saLwd8Xt%2FLbqrBXnPVBmQqsNFRuZECDCBvLhSnrZ0V6VgN9XIGcsvjdqc1keY1F5jqudqF9DVlIY8TMvC8HZK%2B7Q1nt4NsrhczyPwsxABuLuXRQ9jz342kfr6jcg4V0RDeoTmkF41Ft6RtUq0hmoAqdCx1%2Fz70xB4R7l69zShPP7HLfYHPPTt8XR1Db%2BqWNJQckpie0NnlFKA6ZUTMDBoFCJMNlSMrC8fe4WfzeCwJzHJRBg8PuHWSmO%2BotEruefTqBjLBoXXi34gvMNLGz%2F2UMbXN0CJxslsSVQ1hVUGyCtMe0w9EsQpL39cO7khz0GcmiaRxiDS26USPGfQCc9lffeZFTxh4so1l02filHtFdYLVvAvgjiOYt2Mz5u6lBhccM0iI2WWXmcjR%2FS%2BkxYva3%2BrEYrii1%2BMbFzOhDKAxYvafuSoo%2BiLMqIErMru4lSMvT6Hdl0F7q6ar9ursg2xy2ld%2BSsM1Ffwx%2FIlTxlx%2Fk5K%2BKS4mgc5N3QgLYcjLnqKIjMyLCEr%2FVbmVxbtUo%2B7qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=17b21c698b4ffcce675080135b7fd4493a15a0a7ed52457b99ed5b63f7dd21b5"
        }, 
        {
            "file_name": "poc.c", 
            "type": "text/x-c", 
            "id": 72903, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/072/903/3fa201f32bd9240fd74e4bbe3c74ca5661dbd46f/poc.c?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQVHWOGSNR%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T223117Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEBAaDNyA%2BB7EVws6w20xiyK3AzcCTkx0GnZzVQ6TwXkp44%2Ff6M7%2FsO19EHzsTJXAjGqGadXUwBewmY%2FA3saLwd8Xt%2FLbqrBXnPVBmQqsNFRuZECDCBvLhSnrZ0V6VgN9XIGcsvjdqc1keY1F5jqudqF9DVlIY8TMvC8HZK%2B7Q1nt4NsrhczyPwsxABuLuXRQ9jz342kfr6jcg4V0RDeoTmkF41Ft6RtUq0hmoAqdCx1%2Fz70xB4R7l69zShPP7HLfYHPPTt8XR1Db%2BqWNJQckpie0NnlFKA6ZUTMDBoFCJMNlSMrC8fe4WfzeCwJzHJRBg8PuHWSmO%2BotEruefTqBjLBoXXi34gvMNLGz%2F2UMbXN0CJxslsSVQ1hVUGyCtMe0w9EsQpL39cO7khz0GcmiaRxiDS26USPGfQCc9lffeZFTxh4so1l02filHtFdYLVvAvgjiOYt2Mz5u6lBhccM0iI2WWXmcjR%2FS%2BkxYva3%2BrEYrii1%2BMbFzOhDKAxYvafuSoo%2BiLMqIErMru4lSMvT6Hdl0F7q6ar9ursg2xy2ld%2BSsM1Ffwx%2FIlTxlx%2Fk5K%2BKS4mgc5N3QgLYcjLnqKIjMyLCEr%2FVbmVxbtUo%2B7qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c03cbce244e992b0cee2af307ee89acb20f92e5a80a2a23ad8dfac190c72add5"
        }
    ], 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2016-02-18T11:40:20.446Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-02-18T11:40:20.446Z", 
            "actor": {
                "url": "/torproject", 
                "profile": {
                    "name": "Tor"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/800/f60c4e0509668a31fcd9604fc653ef8a43f2e5c4_medium.jpg?1453239375"
                }
            }, 
            "team_handle": "torproject", 
            "bounty_amount": "200.0", 
            "collaborator": {
                "username": "guido", 
                "url": "/guido"
            }, 
            "message": "Seems like a real bug that can be triggered in Tor if the `ServerDNSSearchDomains` option is set to 1.\n\nWe are awarding $200 for this bug because it might be a DoS threat for relays with that option enabled, and because it's an obvious libevent bug as well.\n\nLet me know if something is not right. Thanks!", 
            "markdown_message": "<p>Seems like a real bug that can be triggered in Tor if the <code>ServerDNSSearchDomains</code> option is set to 1.</p>\n\n<p>We are awarding $200 for this bug because it might be a DoS threat for relays with that option enabled, and because it&#39;s an obvious libevent bug as well.</p>\n\n<p>Let me know if something is not right. Thanks!</p>\n", 
            "type": "Activities::BountyAwarded", 
            "id": 802690, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-02-18T21:41:51.470Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-02-18T21:41:51.470Z", 
            "actor": {
                "username": "guido", 
                "url": "/guido", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/983/055f2e31c3b25e230eeb37461df974006ba7b0bd_medium.jpg?1403536399"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "message": "Thank you!", 
            "markdown_message": "<p>Thank you!</p>\n", 
            "type": "Activities::Comment", 
            "id": 803455, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-03-03T15:00:35.028Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-03-03T15:00:35.028Z", 
            "actor": {
                "username": "asn", 
                "url": "/asn", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "message": "Filed this under https://github.com/libevent/libevent/issues/332 .\n\nThanks!", 
            "markdown_message": "<p>Filed this under <a title=\"https://github.com/libevent/libevent/issues/332\" href=\"/redirect?signature=036345956dc2a60d9e296f8ad22d30087d3b021a&amp;url=https%3A%2F%2Fgithub.com%2Flibevent%2Flibevent%2Fissues%2F332\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/libevent/libevent/issues/332</span><i class=\"icon-external-link\"></i></a> .</p>\n\n<p>Thanks!</p>\n", 
            "type": "Activities::Comment", 
            "id": 822650, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-03-23T08:59:52.884Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-03-23T08:59:52.884Z", 
            "actor": {
                "username": "geko", 
                "url": "/geko", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugTriaged", 
            "id": 864322, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-31T00:44:18.014Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-31T00:44:18.014Z", 
            "actor": {
                "username": "guido", 
                "url": "/guido", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/983/055f2e31c3b25e230eeb37461df974006ba7b0bd_medium.jpg?1403536399"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "message": "You can close this one too if you're ready for it.", 
            "markdown_message": "<p>You can close this one too if you&#39;re ready for it.</p>\n", 
            "type": "Activities::Comment", 
            "id": 991612, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "guido", 
                "url": "/guido"
            }, 
            "created_at": "2016-05-31T16:03:26.561Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-31T16:03:26.561Z", 
            "actor": {
                "username": "asn", 
                "url": "/asn", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "message": "Done.", 
            "markdown_message": "<p>Done.</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 992846, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-19T09:36:32.800Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-19T09:36:32.800Z", 
            "actor": {
                "username": "geko", 
                "url": "/geko", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 2083670, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-19T10:15:46.751Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-19T10:15:46.751Z", 
            "actor": {
                "username": "guido", 
                "url": "/guido", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/983/055f2e31c3b25e230eeb37461df974006ba7b0bd_medium.jpg?1403536399"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 2083739, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-19T10:15:46.813Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-19T10:15:46.813Z", 
            "actor": {
                "username": "guido", 
                "url": "/guido", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/983/055f2e31c3b25e230eeb37461df974006ba7b0bd_medium.jpg?1403536399"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 2083740, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "guido", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/guido", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/002/983/bc1fffcbbb736a8fa94816a1961b7b76725881eb_small.jpg?1403536399"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 2, 
        "name": "Memory Corruption - Generic"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -33137684.421503726, 
    "disclosed_at": "2017-10-19T10:15:46.793Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/115702", 
    "created_at": "2016-02-10T14:43:24.014Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>The DNS code of Libevent contains this rather obvious OOB read:</p>\n<pre class=\"highlight c\"><code><span class=\"mi\">3122</span> <span class=\"k\">static</span> <span class=\"kt\">char</span> <span class=\"o\">*</span>\n<span class=\"mi\">3123</span> <span class=\"nf\">search_make_new</span><span class=\"p\">(</span><span class=\"k\">const</span> <span class=\"k\">struct</span> <span class=\"n\">search_state</span> <span class=\"o\">*</span><span class=\"k\">const</span> <span class=\"n\">state</span><span class=\"p\">,</span> <span class=\"kt\">int</span> <span class=\"n\">n</span><span class=\"p\">,</span> <span class=\"k\">const</span> <span class=\"kt\">char</span> <span class=\"o\">*</span><span class=\"k\">const</span> <span class=\"n\">base_name</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n<span class=\"mi\">3124</span>     <span class=\"k\">const</span> <span class=\"kt\">size_t</span> <span class=\"n\">base_len</span> <span class=\"o\">=</span> <span class=\"n\">strlen</span><span class=\"p\">(</span><span class=\"n\">base_name</span><span class=\"p\">);</span>\n<span class=\"mi\">3125</span>     <span class=\"k\">const</span> <span class=\"kt\">char</span> <span class=\"n\">need_to_append_dot</span> <span class=\"o\">=</span> <span class=\"n\">base_name</span><span class=\"p\">[</span><span class=\"n\">base_len</span> <span class=\"o\">-</span> <span class=\"mi\">1</span><span class=\"p\">]</span> <span class=\"o\">==</span> <span class=\"sc\">&#39;.&#39;</span> <span class=\"o\">?</span> <span class=\"mi\">0</span> <span class=\"o\">:</span> <span class=\"mi\">1</span><span class=\"p\">;</span>\n</code></pre>\n<p>If the length of <code>base_name</code> is 0, then line 3125 reads 1 byte before the buffer. This will trigger a crash on ASAN-protected builds.</p>\n\n<p>To reproduce:</p>\n\n<p>Build libevent with ASAN:</p>\n<pre class=\"highlight plaintext\"><code>$ CFLAGS=&#39;-fomit-frame-pointer -fsanitize=address&#39; ./configure &amp;&amp; make -j4\n</code></pre>\n<p>Put the attached <code>resolv.conf</code> and <code>poc.c</code> in the source directory and then do:</p>\n<pre class=\"highlight plaintext\"><code>$ gcc -fsanitize=address -fomit-frame-pointer poc.c .libs/libevent.a\n$ ./a.out\n=================================================================\n==22201== ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60060000efdf at pc 0x4429da bp 0x7ffe1ed47300 sp 0x7ffe1ed472f8\nREAD of size 1 at 0x60060000efdf thread T0\n</code></pre>\n<p>This happens because I create a zero-length string in <code>poc.c</code>:</p>\n<pre class=\"highlight c\"><code>    <span class=\"kt\">char</span><span class=\"o\">*</span> <span class=\"n\">hostname</span> <span class=\"o\">=</span> <span class=\"n\">malloc</span><span class=\"p\">(</span><span class=\"mi\">32</span><span class=\"p\">);</span>\n    <span class=\"n\">memset</span><span class=\"p\">(</span><span class=\"n\">hostname</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">32</span><span class=\"p\">);</span>\n    <span class=\"c1\">//hostname[0] = &#39;x&#39;;\n</span></code></pre>\n<p>If you uncomment the last line, it will not crash.</p>\n\n<p>Guido</p>\n", 
    "vulnerability_information": "The DNS code of Libevent contains this rather obvious OOB read:\n\n```c\n3122 static char *\n3123 search_make_new(const struct search_state *const state, int n, const char *const base_name) {\n3124     const size_t base_len = strlen(base_name);\n3125     const char need_to_append_dot = base_name[base_len - 1] == '.' ? 0 : 1;\n```\n\nIf the length of ```base_name``` is 0, then line 3125 reads 1 byte before the buffer. This will trigger a crash on ASAN-protected builds.\n\nTo reproduce:\n\nBuild libevent with ASAN:\n```\n$ CFLAGS='-fomit-frame-pointer -fsanitize=address' ./configure && make -j4\n```\nPut the attached ```resolv.conf``` and ```poc.c``` in the source directory and then do:\n\n```\n$ gcc -fsanitize=address -fomit-frame-pointer poc.c .libs/libevent.a\n$ ./a.out\n=================================================================\n==22201== ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60060000efdf at pc 0x4429da bp 0x7ffe1ed47300 sp 0x7ffe1ed472f8\nREAD of size 1 at 0x60060000efdf thread T0\n```\n\nThis happens because I create a zero-length string in ```poc.c```:\n```c\n    char* hostname = malloc(32);\n    memset(hostname, 0, 32);\n    //hostname[0] = 'x';\n```\n\nIf you uncomment the last line, it will not crash.\n\nGuido", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://www.torproject.org/", 
            "about": "Anonymity Online", 
            "twitter_handle": "torproject", 
            "name": "Tor"
        }, 
        "handle": "torproject", 
        "url": "https://hackerone.com/torproject", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/001/800/fe36670e5f7b7381549279801c447ae8a3ee12b0_small.jpg?1453239375", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/001/800/f60c4e0509668a31fcd9604fc653ef8a43f2e5c4_medium.jpg?1453239375"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 1800, 
        "default_currency": "usd"
    }, 
    "is_published": false
}