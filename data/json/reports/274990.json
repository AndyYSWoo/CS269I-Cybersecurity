{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2017-11-09T05:56:39.096Z", 
    "voters": [
        "sp1d3rs", 
        "michiel", 
        "rhynorater", 
        "bl4de", 
        "hunter", 
        "surfrdan", 
        "cablej", 
        "nahamsec", 
        "coldd", 
        "bogdantcaciuc", 
        "and 38 more..."
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "1500.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 274990, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2017-10-11T04:23:15.459Z", 
    "vulnerability_information": "When parsing a gem POSTed to the `/api/v1/gems` endpoint, the rubygems.org application immediately calls `Gem::Package.new(body).spec` inside `app/models/pusher.rb`. The authors of the application correctly observed that parsing untrusted YAML is dangerous (since it can serialize more or less arbitrary objects), so they monkey-patched the spec parser to use `Psych.safe_load` set from `config/initializers/forbidden_yaml.rb`.\n\nHowever, `YAML.load` is called directly when parsing the gem's checksum file in `Gem::Package#read_checksums`. Using classes accessible within the application, I was able to turn this into a call to `Marshal.load` on attacker-controlled data. From there, I was able to use known Marshal exploitation techniques to achieve code execution on the server (I'm omitting some details here for brevity so that I can submit this report right away).\n\nA proof of concept, `poc.gem`, is attached. Run the exploit with the following command:\n`cat poc.gem | curl -H 'Content-Type: application/gzip' --data-binary @- -H 'Authorization: \u2588\u2588\u2588\u2588\u2588' https://rubygems.org/api/v1/gems`\n\nI ran the attached PoC twice. It just does a `wget` to my server.\n\nPlease let me know if I should clarify anything! Thanks for running this program.", 
    "activity_page_count": 1, 
    "severity": {
        "rating": "critical", 
        "author_type": "User"
    }, 
    "title": "Remote code execution on rubygems.org", 
    "is_member_of_team?": null, 
    "vote_count": 48, 
    "summaries": [
        {
            "category": "team", 
            "can_view?": true, 
            "can_edit?": false, 
            "id": 5576, 
            "content": "An unsafe object deserialization vulnerability was found in RubyGems. Unfortunately this vulnerability can be used as a way to escalate to a remote code execution exploit.", 
            "content_html": "<p>An unsafe object deserialization vulnerability was found in RubyGems. Unfortunately this vulnerability can be used as a way to escalate to a remote code execution exploit.</p>\n"
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": {
        "asset_identifier": "rubygems.org", 
        "max_severity": "critical", 
        "databaseId": 2042, 
        "asset_type": "URL"
    }, 
    "allow_singular_disclosure_at": "2017-11-10T04:23:15.519Z", 
    "state": "Closed", 
    "cve_ids": [
        "CVE-2017-0903"
    ], 
    "activity_page_number": 1, 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$1,500", 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": true, 
            "created_at": "2017-10-06T08:49:52.993Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-06T08:49:52.993Z", 
            "actor": {
                "url": "/rubygems", 
                "profile": {
                    "name": "RubyGems"
                }, 
                "ibb": true, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/008/212/fb193d1c05feff770bc8d4a69e09613b5f9f4c3d_medium.png?1469676240"
                }
            }, 
            "team_handle": "rubygems", 
            "message": "Thanks for submitting this report to RubyGems. Our team will review and investigate the issue. Please note that only issues in the rubygems library are eligible for our bug bounty program.", 
            "markdown_message": "<p>Thanks for submitting this report to RubyGems. Our team will review and investigate the issue. Please note that only issues in the rubygems library are eligible for our bug bounty program.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2048472, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-06T08:57:39.930Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-06T08:57:39.930Z", 
            "actor": {
                "username": "max", 
                "url": "/max", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/005/692/6983eb7b4bc51ba70dbda4754a7d663940672125_medium.jpg?1421539600"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "message": "Attached is the `checksums.yaml` contained within that gem.", 
            "markdown_message": "<p>Attached is the <code>checksums.yaml</code> contained within that gem.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2048494, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-06T09:02:25.124Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-06T09:02:25.124Z", 
            "actor": {
                "username": "max", 
                "url": "/max", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/005/692/6983eb7b4bc51ba70dbda4754a7d663940672125_medium.jpg?1421539600"
                }, 
                "hackerone_triager": false
            }, 
            "additional_data": {
                "new_title": "Remote code execution on rubygems.org", 
                "old_title": "Remote Code Execution on rubygems.org"
            }, 
            "team_handle": "rubygems", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportTitleUpdated", 
            "id": 2048510, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-06T09:03:24.936Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-06T09:03:24.936Z", 
            "actor": {
                "username": "max", 
                "url": "/max", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/005/692/6983eb7b4bc51ba70dbda4754a7d663940672125_medium.jpg?1421539600"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "message": "Ugh, HackerOne really logs an event when I change the title? Well now I just look silly...", 
            "markdown_message": "<p>Ugh, HackerOne really logs an event when I change the title? Well now I just look silly...</p>\n", 
            "type": "Activities::Comment", 
            "id": 2048518, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-06T11:02:03.598Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-06T11:02:03.598Z", 
            "actor": {
                "username": "dwradcliffe", 
                "url": "/dwradcliffe", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/082/355/07db8e99faeb44440568e404ca1e1e7e6372f28f_medium.png?1469678829"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "message": "Hi max,\nThanks for sending this in. At first glance it looks like you're report is correct. To help me debug can you clarify what file the `wget` downloaded? (Your server isn't running anymore) Also would be helpful to know what your IP address is so I can look at our logs.\nThanks!", 
            "markdown_message": "<p>Hi max,<br>\nThanks for sending this in. At first glance it looks like you&#39;re report is correct. To help me debug can you clarify what file the <code>wget</code> downloaded? (Your server isn&#39;t running anymore) Also would be helpful to know what your IP address is so I can look at our logs.<br>\nThanks!</p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 2048720, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-06T11:20:49.513Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-06T02:45:38.914Z", 
            "actor": {
                "username": "max", 
                "url": "/max", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/005/692/6983eb7b4bc51ba70dbda4754a7d663940672125_medium.jpg?1421539600"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "message": "The `wget` didn\u2019t download anything; I was just listening with netcat on my server (`\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588`) to make sure the payload executed. The `wget` then failed and fell through once I closed the connection from the server\u2019s side. I\u2019m not sure what my IP address was, but all of my requests were made with the API key from the first post.", 
            "markdown_message": "<p>The <code>wget</code> didn\u2019t download anything; I was just listening with netcat on my server (<code>\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588</code>) to make sure the payload executed. The <code>wget</code> then failed and fell through once I closed the connection from the server\u2019s side. I\u2019m not sure what my IP address was, but all of my requests were made with the API key from the first post.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2048739, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-06T11:27:51.171Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-06T11:27:51.171Z", 
            "actor": {
                "username": "max", 
                "url": "/max", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/005/692/6983eb7b4bc51ba70dbda4754a7d663940672125_medium.jpg?1421539600"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "message": "(I should add that you'll see some failed attempts at executing the payload from before I discovered I needed `Content-Type: application/gzip` on the `curl` command. None of those ran because of a weird UTF-8 sanitation thing happening server side.)", 
            "markdown_message": "<p>(I should add that you&#39;ll see some failed attempts at executing the payload from before I discovered I needed <code>Content-Type: application/gzip</code> on the <code>curl</code> command. None of those ran because of a weird UTF-8 sanitation thing happening server side.)</p>\n", 
            "type": "Activities::Comment", 
            "id": 2048742, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-06T17:45:59.183Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-06T17:45:59.183Z", 
            "actor": {
                "username": "dwradcliffe", 
                "url": "/dwradcliffe", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/082/355/07db8e99faeb44440568e404ca1e1e7e6372f28f_medium.png?1469678829"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "message": "Hey max,\nWe have deployed (actually several hours ago) a patch (included below). Could you try your gem push again and see if it has the same behavior or not?\n\n```\nmodule Gem\n  class Package\n    def read_checksums gem\n      Gem.load_yaml\n\n      [@checksums](/checksums) = gem.seek 'checksums.yaml.gz' do |entry|\n        Zlib::GzipReader.wrap entry do |gz_io|\n          Psych.safe_load(gz_io.read, Gem::Specification::WHITELISTED_CLASSES, Gem::Specification::WHITELISTED_SYMBOLS, true)\n        end\n      end\n    end\n  end\nend\n```", 
            "markdown_message": "<p>Hey max,<br>\nWe have deployed (actually several hours ago) a patch (included below). Could you try your gem push again and see if it has the same behavior or not?</p>\n<pre class=\"highlight plaintext\"><code>module Gem\n  class Package\n    def read_checksums gem\n      Gem.load_yaml\n\n      [@checksums](/checksums) = gem.seek &#39;checksums.yaml.gz&#39; do |entry|\n        Zlib::GzipReader.wrap entry do |gz_io|\n          Psych.safe_load(gz_io.read, Gem::Specification::WHITELISTED_CLASSES, Gem::Specification::WHITELISTED_SYMBOLS, true)\n        end\n      end\n    end\n  end\nend\n</code></pre>", 
            "type": "Activities::Comment", 
            "id": 2049923, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-06T18:26:00.154Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-06T18:26:00.154Z", 
            "actor": {
                "username": "max", 
                "url": "/max", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/005/692/6983eb7b4bc51ba70dbda4754a7d663940672125_medium.jpg?1421539600"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "message": "Hm, I just ran the same exploit again and there was still a request made to my server.", 
            "markdown_message": "<p>Hm, I just ran the same exploit again and there was still a request made to my server.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2050012, 
            "genius_execution_id": null
        }, 
        {
            "attachments": [
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/226/958/d4fa73cd9a132be6e70dd0891804077e3c9d9874/generate.rb?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ2G5YP65E%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T223008Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDBU1F5krpICaZ0NqsCK3A6VE3SvOEqtR6mTF0RGsq2RFtP%2BeCnscHc5QWUWgfaEy6uXh0YyE%2Bu%2FBf1bgQOuQySCtb1Z%2BZ6sLON3HRMq%2BgYmhgdN4si0rU1p4nOiBj6crMBDlPKrwCFw0SRWaa%2FeWJtScRo9HMxA318TQuy1cnz2RYUYCxaU0Jci%2BrDGNmR0becuinzwZxwbm9sdysqqkTqFq64D7gI7nTrej5s6rDW11vFWqHpUP2d1FhvBaFOAjy8GP523rvRQSSyFkXe9YJUVlNrSLtqEAenEAnsweq3B3e669G9C%2FHm8G06ThADW69XI9pnMKVDT3FsJRtvkiltR9fsPJGB94knGZqwwdAK33UZ6TzU7QFoNEMoH%2BuvrEkO7SW8nmlfngtoX7AqMEGVMNAktUrQgR3jBfz1AXbDyaVpNINObIwvcxkjAPeH%2BJ9fJANeefQc2S9wtnpHnZGI8bjrMu%2F%2BBZHNLud7642CzhDwWVt363%2B%2B45PABKA6apczYhBSmM6I6woOQCnxMCpcKiqGyhztmN1LCRqv7FY5wPxjrGQArJvuYDfVGrN5Q7QMy6qocAzCdmYXfTag83vWxBpO15sjYooKOm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=01a869ca05f1a164c0fd0396f8f69b0fe387199bdc558a9b4fc5014379c3feef", 
                    "type": "text/x-ruby", 
                    "id": 226958, 
                    "filename": "generate.rb"
                }
            ], 
            "automated_response": false, 
            "created_at": "2017-10-06T18:32:31.928Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-06T18:32:31.928Z", 
            "actor": {
                "username": "max", 
                "url": "/max", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/005/692/6983eb7b4bc51ba70dbda4754a7d663940672125_medium.jpg?1421539600"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "message": "If you would like to test the exploit with your own payload, you can run `ruby generate.rb payload.rb`, where `generate.rb` is attached (adapted from an old rails exploit [here](https://github.com/charliesome/charlie.bz/blob/master/posts/rails-3.2.10-remote-code-execution.md)), and `payload.rb` contains the ruby code you would like to execute. That will output the base64 payload that you insert into the `checksums.yaml` file from my second comment.", 
            "markdown_message": "<p>If you would like to test the exploit with your own payload, you can run <code>ruby generate.rb payload.rb</code>, where <code>generate.rb</code> is attached (adapted from an old rails exploit <a href=\"/redirect?signature=bbb0b8abb49842bdd56c5cd893883db5002eb597&amp;url=https%3A%2F%2Fgithub.com%2Fcharliesome%2Fcharlie.bz%2Fblob%2Fmaster%2Fposts%2Frails-3.2.10-remote-code-execution.md\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>here</span><i class=\"icon-external-link\"></i></a>), and <code>payload.rb</code> contains the ruby code you would like to execute. That will output the base64 payload that you insert into the <code>checksums.yaml</code> file from my second comment.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2050037, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-06T20:54:16.849Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-06T20:54:16.849Z", 
            "actor": {
                "username": "dwradcliffe", 
                "url": "/dwradcliffe", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/082/355/07db8e99faeb44440568e404ca1e1e7e6372f28f_medium.png?1469678829"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "message": "Thanks so much for that generator, I was able to make my own test gem to debug with. I have deployed another change and confirmed with my poc gem that this is no longer vulnerable. Feel free to confirm this yourself. Our team is reviewing the situation and we will get back to you soon with next steps.", 
            "markdown_message": "<p>Thanks so much for that generator, I was able to make my own test gem to debug with. I have deployed another change and confirmed with my poc gem that this is no longer vulnerable. Feel free to confirm this yourself. Our team is reviewing the situation and we will get back to you soon with next steps.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2050290, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-06T22:50:43.933Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-06T22:50:43.933Z", 
            "actor": {
                "username": "tenderlove", 
                "url": "/tenderlove", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/318/4b00c3dfa514b00e4c7c2751c97ca93d0f0d7160_medium.png?1393998446"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "message": "@max how would you like to be credited in the CVE?", 
            "markdown_message": "<p><a href=\"/max\">@max</a> how would you like to be credited in the CVE?</p>\n", 
            "type": "Activities::Comment", 
            "id": 2050473, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-06T22:55:25.475Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-06T22:55:25.475Z", 
            "actor": {
                "username": "max", 
                "url": "/max", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/005/692/6983eb7b4bc51ba70dbda4754a7d663940672125_medium.jpg?1421539600"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "message": "Yup, confirmed that everything looks fixed from here!\n\nAs for CVE credits, please put my name: Max Justicz. If there is a spot for a URL, could it please go to my Mastodon profile [here](https://mastodon.mit.edu/@maxj)?\n\nThanks for the really quick response! Is it cool if I make a blog post about this?", 
            "markdown_message": "<p>Yup, confirmed that everything looks fixed from here!</p>\n\n<p>As for CVE credits, please put my name: Max Justicz. If there is a spot for a URL, could it please go to my Mastodon profile <a href=\"/redirect?signature=c805c9dcf2f902e0fd8621ebb523236903ead9b6&amp;url=https%3A%2F%2Fmastodon.mit.edu%2F%40maxj\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>here</span><i class=\"icon-external-link\"></i></a>?</p>\n\n<p>Thanks for the really quick response! Is it cool if I make a blog post about this?</p>\n", 
            "type": "Activities::Comment", 
            "id": 2050484, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-06T23:03:11.494Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-06T23:03:11.494Z", 
            "actor": {
                "username": "tenderlove", 
                "url": "/tenderlove", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/318/4b00c3dfa514b00e4c7c2751c97ca93d0f0d7160_medium.png?1393998446"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "message": "@max we can put whatever you want in the credits, so I'll add the link.  \ud83d\ude0a\n\nIt's fine to blog about this, but do you mind waiting until after we've announced the CVE?  The plan right now is to patch RubyGems itself so that other folks who are running systems similar to RubyGems.org will be safe as well.  We also need to make some checks on the RubyGems.org back end to make sure nobody has exploited this and used it to alter existing gems.\n\nI think it will only take 24hrs or so to get the CVE (my CVE person might be off for the weekend, so might be Monday), and I'm not sure how long it will take to verify gems (I will help with that this weekend).  I don't want to commit to a specific date, but I think it should be wrapped up early next week. ", 
            "markdown_message": "<p><a href=\"/max\">@max</a> we can put whatever you want in the credits, so I&#39;ll add the link.  \ud83d\ude0a</p>\n\n<p>It&#39;s fine to blog about this, but do you mind waiting until after we&#39;ve announced the CVE?  The plan right now is to patch RubyGems itself so that other folks who are running systems similar to RubyGems.org will be safe as well.  We also need to make some checks on the RubyGems.org back end to make sure nobody has exploited this and used it to alter existing gems.</p>\n\n<p>I think it will only take 24hrs or so to get the CVE (my CVE person might be off for the weekend, so might be Monday), and I&#39;m not sure how long it will take to verify gems (I will help with that this weekend).  I don&#39;t want to commit to a specific date, but I think it should be wrapped up early next week. </p>\n", 
            "type": "Activities::Comment", 
            "id": 2050496, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-06T23:21:09.889Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-06T23:21:09.889Z", 
            "actor": {
                "username": "max", 
                "url": "/max", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/005/692/6983eb7b4bc51ba70dbda4754a7d663940672125_medium.jpg?1421539600"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "message": "Sounds good to me! Patching RubyGems definitely seems like the best way to go.", 
            "markdown_message": "<p>Sounds good to me! Patching RubyGems definitely seems like the best way to go.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2050517, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "max", 
                "url": "/max"
            }, 
            "created_at": "2017-10-10T03:39:03.595Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-10T03:39:03.595Z", 
            "actor": {
                "username": "dwradcliffe", 
                "url": "/dwradcliffe", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/082/355/07db8e99faeb44440568e404ca1e1e7e6372f28f_medium.png?1469678829"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "message": "Hi Max,\nWe've just released a new version of rubygems (2.6.14) and published the CVE announcement.\n\nhttps://groups.google.com/forum/#!topic/ruby-security-ann/i_1Nx25ma9A\nhttp://blog.rubygems.org/2017/10/09/2.6.14-released.html\nhttp://blog.rubygems.org/2017/10/09/unsafe-object-deserialization-vulnerability.html\n\nFeel free to blog about this now.\nThank you very much for reporting and assisting with the process!", 
            "markdown_message": "<p>Hi Max,<br>\nWe&#39;ve just released a new version of rubygems (2.6.14) and published the CVE announcement.</p>\n\n<p><a title=\"https://groups.google.com/forum/#!topic/ruby-security-ann/i_1Nx25ma9A\" href=\"/redirect?signature=3c0b5d8484a1d5a8d146a7eef3d77c18f32f93a5&amp;url=https%3A%2F%2Fgroups.google.com%2Fforum%2F%23%21topic%2Fruby-security-ann%2Fi_1Nx25ma9A\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://groups.google.com/forum/#!topic/ruby-security-ann/i_1Nx25ma9A</span><i class=\"icon-external-link\"></i></a><br>\n<a title=\"http://blog.rubygems.org/2017/10/09/2.6.14-released.html\" href=\"/redirect?signature=b61a1089f72b433c2e36286e612b3be74c641ce0&amp;url=http%3A%2F%2Fblog.rubygems.org%2F2017%2F10%2F09%2F2.6.14-released.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://blog.rubygems.org/2017/10/09/2.6.14-released.html</span><i class=\"icon-external-link\"></i></a><br>\n<a title=\"http://blog.rubygems.org/2017/10/09/unsafe-object-deserialization-vulnerability.html\" href=\"/redirect?signature=f60966d95c5dd624f21be4ab433aa10184e0183d&amp;url=http%3A%2F%2Fblog.rubygems.org%2F2017%2F10%2F09%2Funsafe-object-deserialization-vulnerability.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://blog.rubygems.org/2017/10/09/unsafe-object-deserialization-vulnerability.html</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>Feel free to blog about this now.<br>\nThank you very much for reporting and assisting with the process!</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 2055556, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-10T04:18:06.009Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-10T04:18:06.009Z", 
            "actor": {
                "username": "max", 
                "url": "/max", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/005/692/6983eb7b4bc51ba70dbda4754a7d663940672125_medium.jpg?1421539600"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "message": "Nice, thanks for the quick response! Here's the blog post: https://justi.cz/security/2017/10/07/rubygems-org-rce.html and the post on hacker news: https://news.ycombinator.com/item?id=15439308", 
            "markdown_message": "<p>Nice, thanks for the quick response! Here&#39;s the blog post: <a title=\"https://justi.cz/security/2017/10/07/rubygems-org-rce.html\" href=\"/redirect?signature=478084cecf9ee1f4ff30713dc5a9cb4fac81ced9&amp;url=https%3A%2F%2Fjusti.cz%2Fsecurity%2F2017%2F10%2F07%2Frubygems-org-rce.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://justi.cz/security/2017/10/07/rubygems-org-rce.html</span><i class=\"icon-external-link\"></i></a> and the post on hacker news: <a title=\"https://news.ycombinator.com/item?id=15439308\" href=\"/redirect?signature=13af6281eca88d1e5e68e40d27ef2f6c24149e1a&amp;url=https%3A%2F%2Fnews.ycombinator.com%2Fitem%3Fid%3D15439308\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://news.ycombinator.com/item?id=15439308</span><i class=\"icon-external-link\"></i></a></p>\n", 
            "type": "Activities::Comment", 
            "id": 2055592, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-10T04:23:15.829Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-10T04:23:15.829Z", 
            "actor": {
                "username": "max", 
                "url": "/max", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/005/692/6983eb7b4bc51ba70dbda4754a7d663940672125_medium.jpg?1421539600"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "message": "Oh - I should mention that even though the date on the post says October 7, I only put this online today. I wrote it on the 7th.", 
            "markdown_message": "<p>Oh - I should mention that even though the date on the post says October 7, I only put this online today. I wrote it on the 7th.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2055595, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2017-10-11T04:22:09.053Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-11T04:22:09.053Z", 
            "actor": {
                "url": "/rubygems", 
                "profile": {
                    "name": "RubyGems"
                }, 
                "ibb": true, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/008/212/fb193d1c05feff770bc8d4a69e09613b5f9f4c3d_medium.png?1469676240"
                }
            }, 
            "team_handle": "rubygems", 
            "bonus_amount": "0.0", 
            "bounty_amount": "1500.0", 
            "collaborator": {
                "username": "max", 
                "url": "/max"
            }, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BountyAwarded", 
            "id": 2058076, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-11T04:23:15.485Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-11T04:23:15.485Z", 
            "actor": {
                "username": "claudijd", 
                "url": "/claudijd", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/003/131/80363bc2e114aa297d4a15f2deba7621642c6ec1_medium.jpeg?1491096375"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 2058083, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-11T04:33:01.403Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-11T04:33:01.403Z", 
            "actor": {
                "username": "max", 
                "url": "/max", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/005/692/6983eb7b4bc51ba70dbda4754a7d663940672125_medium.jpg?1421539600"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "message": "Thank you for the bounty!\n\nI'm totally cool with making this public, but I'd like to redact the entries containing information about my server, as well as that API key. Could we please redact the following before disclosing publicly?\n\n 1. API key from the first post (I've reset it anyway, but still seems bad to leave it up)\n 2. Attachment from the first post\n 3. Attachment from the third post\n 4. URL from the sixth post\n 5. This post\n\nThank you,\n\nMax", 
            "markdown_message": "<p>Thank you for the bounty!</p>\n\n<p>I&#39;m totally cool with making this public, but I&#39;d like to redact the entries containing information about my server, as well as that API key. Could we please redact the following before disclosing publicly?</p>\n\n<ol>\n<li>API key from the first post (I&#39;ve reset it anyway, but still seems bad to leave it up)</li>\n<li>Attachment from the first post</li>\n<li>Attachment from the third post</li>\n<li>URL from the sixth post</li>\n<li>This post</li>\n</ol>\n\n<p>Thank you,</p>\n\n<p>Max</p>\n", 
            "type": "Activities::Comment", 
            "id": 2058094, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-16T05:36:42.388Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-16T05:36:42.388Z", 
            "actor": {
                "username": "max", 
                "url": "/max", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/005/692/6983eb7b4bc51ba70dbda4754a7d663940672125_medium.jpg?1421539600"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "message": "Hi all, just wanted to give a ping on the above. Sorry to bother you.", 
            "markdown_message": "<p>Hi all, just wanted to give a ping on the above. Sorry to bother you.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2068105, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-26T04:30:45.191Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-26T04:30:45.191Z", 
            "actor": {
                "username": "max", 
                "url": "/max", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/005/692/6983eb7b4bc51ba70dbda4754a7d663940672125_medium.jpg?1421539600"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "message": "Friendly bump o-o;", 
            "markdown_message": "<p>Friendly bump o-o;</p>\n", 
            "type": "Activities::Comment", 
            "id": 2103873, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-26T04:45:58.796Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-26T04:45:58.796Z", 
            "actor": {
                "username": "indirect", 
                "url": "/indirect", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/097/577/23786b25bd4c9fb25efcb425e5a76b92c052fcef_medium.jpg?1477380547"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "message": "hi max, sorry we haven't gotten back to you yet. we aren't able to redact the ticket ourselves, so we submitted a support request to hacker one asking them to help us out, 14 days ago. as soon as they get back to us, we'll publish the report.", 
            "markdown_message": "<p>hi max, sorry we haven&#39;t gotten back to you yet. we aren&#39;t able to redact the ticket ourselves, so we submitted a support request to hacker one asking them to help us out, 14 days ago. as soon as they get back to us, we&#39;ll publish the report.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2103894, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-26T04:55:00.207Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-26T04:55:00.207Z", 
            "actor": {
                "username": "max", 
                "url": "/max", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/005/692/6983eb7b4bc51ba70dbda4754a7d663940672125_medium.jpg?1421539600"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "message": "Ah gotcha. Thanks for the update.", 
            "markdown_message": "<p>Ah gotcha. Thanks for the update.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2103910, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-05T18:32:39.871Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-05T18:32:39.871Z", 
            "actor": {
                "username": "max", 
                "url": "/max", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/005/692/6983eb7b4bc51ba70dbda4754a7d663940672125_medium.jpg?1421539600"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "message": "Could you please bump your h1 ticket? Sorry, just nervous about this getting auto disclosed before that happens.", 
            "markdown_message": "<p>Could you please bump your h1 ticket? Sorry, just nervous about this getting auto disclosed before that happens.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2135726, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-06T02:43:45.117Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-06T02:43:45.117Z", 
            "actor": {
                "username": "indirect", 
                "url": "/indirect", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/097/577/23786b25bd4c9fb25efcb425e5a76b92c052fcef_medium.jpg?1477380547"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "message": "Ugh, yep, will do. Sorry this is turning into such a hassle.", 
            "markdown_message": "<p>Ugh, yep, will do. Sorry this is turning into such a hassle.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2136117, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-08T20:51:33.628Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-08T20:51:33.628Z", 
            "actor": {
                "username": "indirect", 
                "url": "/indirect", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/097/577/23786b25bd4c9fb25efcb425e5a76b92c052fcef_medium.jpg?1477380547"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "message": "@max done, attachments and sensitive information redacted. Unfortunately we don't have the ability to redact entire posts, but if there is anything else that you feel needs to be removed let us know. Thanks!", 
            "markdown_message": "<p><a href=\"/max\">@max</a> done, attachments and sensitive information redacted. Unfortunately we don&#39;t have the ability to redact entire posts, but if there is anything else that you feel needs to be removed let us know. Thanks!</p>\n", 
            "type": "Activities::Comment", 
            "id": 2144115, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-08T23:26:49.373Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-08T23:26:49.373Z", 
            "actor": {
                "username": "max", 
                "url": "/max", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/005/692/6983eb7b4bc51ba70dbda4754a7d663940672125_medium.jpg?1421539600"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "message": "Thank you!", 
            "markdown_message": "<p>Thank you!</p>\n", 
            "type": "Activities::Comment", 
            "id": 2144461, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-09T05:56:39.130Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-09T05:56:39.130Z", 
            "actor": {
                "username": "max", 
                "url": "/max", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/005/692/6983eb7b4bc51ba70dbda4754a7d663940672125_medium.jpg?1421539600"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 2145021, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-09T05:56:39.212Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-09T05:56:39.212Z", 
            "actor": {
                "username": "max", 
                "url": "/max", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/005/692/6983eb7b4bc51ba70dbda4754a7d663940672125_medium.jpg?1421539600"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rubygems", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 2145022, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "max", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/max", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/005/692/c67f4f87c8b79539ef5bc46ec98c53068b12638a_small.jpg?1421539600"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 52, 
        "name": "Deserialization of Untrusted Data"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -33847612.98133758, 
    "disclosed_at": "2017-11-09T05:56:39.178Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/274990", 
    "created_at": "2017-10-06T08:49:52.800Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>When parsing a gem POSTed to the <code>/api/v1/gems</code> endpoint, the rubygems.org application immediately calls <code>Gem::Package.new(body).spec</code> inside <code>app/models/pusher.rb</code>. The authors of the application correctly observed that parsing untrusted YAML is dangerous (since it can serialize more or less arbitrary objects), so they monkey-patched the spec parser to use <code>Psych.safe_load</code> set from <code>config/initializers/forbidden_yaml.rb</code>.</p>\n\n<p>However, <code>YAML.load</code> is called directly when parsing the gem&#39;s checksum file in <code>Gem::Package#read_checksums</code>. Using classes accessible within the application, I was able to turn this into a call to <code>Marshal.load</code> on attacker-controlled data. From there, I was able to use known Marshal exploitation techniques to achieve code execution on the server (I&#39;m omitting some details here for brevity so that I can submit this report right away).</p>\n\n<p>A proof of concept, <code>poc.gem</code>, is attached. Run the exploit with the following command:<br>\n<code>cat poc.gem | curl -H &#39;Content-Type: application/gzip&#39; --data-binary @- -H &#39;Authorization: \u2588\u2588\u2588\u2588\u2588&#39; https://rubygems.org/api/v1/gems</code></p>\n\n<p>I ran the attached PoC twice. It just does a <code>wget</code> to my server.</p>\n\n<p>Please let me know if I should clarify anything! Thanks for running this program.</p>\n", 
    "severity_rating": "critical", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://rubygems.org", 
            "about": "RubyGems.org is the Ruby community\u2019s gem hosting service.", 
            "twitter_handle": "rubygems_status", 
            "name": "RubyGems"
        }, 
        "handle": "rubygems", 
        "url": "https://hackerone.com/rubygems", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/008/212/0e820a45b51fb96fad86945c67150263527c69ed_small.png?1469676240", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/008/212/fb193d1c05feff770bc8d4a69e09613b5f9f4c3d_medium.png?1469676240"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 8212, 
        "default_currency": "usd"
    }, 
    "is_published": false
}