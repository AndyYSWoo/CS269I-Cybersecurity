{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2018-04-19T19:21:56.798Z", 
    "voters": [
        "flamezzz", 
        "jokebookservice1", 
        "sp1d3rs", 
        "michiel", 
        "danila_xawdxawdx", 
        "spam404", 
        "europa", 
        "hunter", 
        "kapytein", 
        "hackerhero", 
        "and 24 more..."
    ], 
    "facebook_team?": false, 
    "has_bounty?": false, 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 304378, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": null, 
    "vulnerability_information": "The [ACME TLS-SNI-01](https://tools.ietf.org/html/draft-ietf-acme-acme-01#section-7.3) (and [TLS-SNI-02](https://tools.ietf.org/html/draft-ietf-acme-acme-09#section-8.4)) specification assumed wrong in terms of how current major cloud providers routed and validated domains. This was reported earlier this week to Let's Encrypt, and they decided to disable the method. Today Let's Encrypt decided to sunset both TLS-SNI-01 and TLS-SNI-02 due to the vulnerability I found. \n\nA full writeup of the finding and my side of the timeline can be found here:\n\n* [How I exploited ACME TLS-SNI-01 issuing Let's Encrypt SSL-certs for any domain using shared hosting](https://labs.detectify.com/2018/01/12/how-i-exploited-acme-tls-sni-01-issuing-lets-encrypt-ssl-certs-for-any-domain-using-shared-hosting/)\n\nHere is Let's Encrypt first and second announcement about the reported issue:\n\n* [2018.01.09 Issue with TLS-SNI-01 and Shared Hosting Infrastructure](https://community.letsencrypt.org/t/2018-01-09-issue-with-tls-sni-01-and-shared-hosting-infrastructure/49996)\n* [2018.01.11 Update Regarding ACME TLS-SNI and Shared Hosting Infrastructure](https://community.letsencrypt.org/t/2018-01-11-update-regarding-acme-tls-sni-and-shared-hosting-infrastructure/50188)\n\nRegards,\nFrans\n\n## Impact\n\nThe ability to issue SSL-certificates for domains not under the attacker's control but served using the same shared hosting provider.", 
    "activity_page_count": 1, 
    "severity": {
        "metrics": {
            "confidentiality": "high", 
            "privileges_required": "low", 
            "user_interaction": "none", 
            "attack_vector": "network", 
            "attack_complexity": "low", 
            "scope": "changed", 
            "integrity": "high", 
            "availability": "high"
        }, 
        "rating": "critical", 
        "score": 9.9, 
        "author_type": "User"
    }, 
    "title": "ACME TLS-SNI-01/02 challenge vulnerable when combined with shared hosting providers", 
    "is_member_of_team?": null, 
    "vote_count": 34, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2018-05-19T19:21:56.889Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "activity_page_number": 1, 
    "readable_substate": "Resolved", 
    "public": true, 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2018-01-27T01:11:13.641Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-01-27T01:11:13.641Z", 
            "actor": {
                "username": "joystick", 
                "url": "/joystick", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/167/228/b43a55557e4be10a26bd6d77132e2b0f1d35e4e3_medium.jpg?1515271617"
                }, 
                "hackerone_triager": true
            }, 
            "team_handle": "internet", 
            "message": "Hi,\n\nThank you for your submission. We are investigating your report, and will let you know if we have any questions. We appreciate your assistance and cooperation.\n\nRegards.\n@joystick", 
            "markdown_message": "<p>Hi,</p>\n\n<p>Thank you for your submission. We are investigating your report, and will let you know if we have any questions. We appreciate your assistance and cooperation.</p>\n\n<p>Regards.<br>\n<a href=\"/joystick\">@joystick</a></p>\n", 
            "type": "Activities::Comment", 
            "id": 2322693, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-03-14T18:58:49.509Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-03-14T18:58:49.509Z", 
            "actor": {
                "username": "adambacchus", 
                "url": "/adambacchus", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/075/400/37c68ddb1b7105020eb4194b17755ae6a671f19c_medium.jpg?1462911967"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "Hey @fransrosen,\n\nThanks again for your report! I've sent a note to the IBB panel to discuss if this will qualify for a bounty or not, as soon as we've come to a conclusion I'll provide an update here.\n\nThanks,\nAdam Bacchus", 
            "markdown_message": "<p>Hey <a href=\"/fransrosen\">@fransrosen</a>,</p>\n\n<p>Thanks again for your report! I&#39;ve sent a note to the IBB panel to discuss if this will qualify for a bounty or not, as soon as we&#39;ve come to a conclusion I&#39;ll provide an update here.</p>\n\n<p>Thanks,<br>\nAdam Bacchus</p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 2492856, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-04-15T09:08:27.927Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-04-15T09:08:27.927Z", 
            "actor": {
                "username": "thefrog", 
                "url": "/thefrog", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/246/015/804f36c18801d3924ed6e7f6dc7efb8d966f053e_medium.jpg?1529682394"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "Hi Frans,\n\nJust wanted to let you know that we have not forgotten about this report. We are still looking into this report and will update you when we have additional information to share. Thank you for your patience!\n\n\\- @thefrog", 
            "markdown_message": "<p>Hi Frans,</p>\n\n<p>Just wanted to let you know that we have not forgotten about this report. We are still looking into this report and will update you when we have additional information to share. Thank you for your patience!</p>\n\n<p>- <a href=\"/thefrog\">@thefrog</a></p>\n", 
            "type": "Activities::Comment", 
            "id": 2614900, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-04-19T18:09:35.364Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-04-19T18:09:35.364Z", 
            "actor": {
                "username": "adambacchus", 
                "url": "/adambacchus", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/075/400/37c68ddb1b7105020eb4194b17755ae6a671f19c_medium.jpg?1462911967"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "Hey @fransrosen,\n\nThe panel discussed, and unfortunately determined that this report would not meet the bar for a bounty under the Internet program's criteria. I'm marking as `new` for now, can you self-close this report?\n\nThanks,\nAdam Bacchus\nHackerOne", 
            "markdown_message": "<p>Hey <a href=\"/fransrosen\">@fransrosen</a>,</p>\n\n<p>The panel discussed, and unfortunately determined that this report would not meet the bar for a bounty under the Internet program&#39;s criteria. I&#39;m marking as <code>new</code> for now, can you self-close this report?</p>\n\n<p>Thanks,<br>\nAdam Bacchus<br>\nHackerOne</p>\n", 
            "type": "Activities::BugNew", 
            "id": 2638545, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "fransrosen", 
                "url": "/fransrosen"
            }, 
            "created_at": "2018-04-19T18:25:00.072Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-04-19T18:25:00.072Z", 
            "actor": {
                "username": "adambacchus", 
                "url": "/adambacchus", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/075/400/37c68ddb1b7105020eb4194b17755ae6a671f19c_medium.jpg?1462911967"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "Oops, actually marking this as resolved, but will mark as ineligible for bounty. Thanks!", 
            "markdown_message": "<p>Oops, actually marking this as resolved, but will mark as ineligible for bounty. Thanks!</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 2638592, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-04-19T18:25:06.959Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-04-19T18:25:06.959Z", 
            "actor": {
                "url": "/internet", 
                "profile": {
                    "name": "The Internet"
                }, 
                "ibb": true, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/38e952fcff2c0aae0d011d5cecd07e5f62ecbd63_medium.png?1383767658"
                }
            }, 
            "team_handle": "internet", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::NotEligibleForBounty", 
            "id": 2638593, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-04-19T19:21:56.825Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-04-19T19:21:56.825Z", 
            "actor": {
                "username": "fransrosen", 
                "url": "/fransrosen", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/634/56528780ddde67dec2e6f9d1212879ab16bc8f4a_medium.jpg?1396468576"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "first_to_agree": true, 
            "message": "Would be nice with an explanation on why.. :)", 
            "markdown_message": "<p>Would be nice with an explanation on why.. :)</p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 2638773, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-04-19T21:40:42.950Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-04-19T21:40:42.950Z", 
            "actor": {
                "username": "adambacchus", 
                "url": "/adambacchus", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/075/400/37c68ddb1b7105020eb4194b17755ae6a671f19c_medium.jpg?1462911967"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "Hey @fransrosen,\n\nApologies for not including that in my initial response!\n\nIn this case, it appears the vulnerability was bountied separately by another party.\n\nPart of the IBB's charter (https://internetbugbounty.org/charter.html) includes \"Mind the Gap\":\n\n> In order to most efficiently allocate funds, the Panel should be cognizant of what software is already covered by other efforts, and how. For example, if another organization rewards for providing patches to open source projects or funds secure development, the IBB should not duplicate this effort, but instead serve in a complementary fashion by rewarding researchers that identify and disclose vulnerabilities to the maintainers. The IBB should proactively identify software that has a gap in rewards for vulnerability research; in conjunction with other criteria, this is a good indicator that the software should be moved into scope.\n\nIIRC, this bug was bountied via Heroku, so due to our Mind the Gap stipulation, the panel voted to not award this particular issue.\n\nAdditionally, if my understanding of the bug is correct, it was exploitable due to Heroku and Cloudfront's configurations. IBB primarily issues bounties for bugs in open source, non-commercial software; so potentially, the issue within TLS-SNI-01 would have qualified, but the impact of that aspect of the issue in isolation would not meet the bar for a bounty via IBB. The impact when combining the result with Heroku and Cloudfront would potentially meet the bar, but between the \"Mind the Gap\" stipulation, and Heroku and Amazon being for-profit companies, unfortunately this issue cannot be bountied via IBB.\n\nI believe I've captured all of this correctly, but if you think I've missed anything or have any questions, please let me know!\n\nThanks,\nAdam Bacchus", 
            "markdown_message": "<p>Hey <a href=\"/fransrosen\">@fransrosen</a>,</p>\n\n<p>Apologies for not including that in my initial response!</p>\n\n<p>In this case, it appears the vulnerability was bountied separately by another party.</p>\n\n<p>Part of the IBB&#39;s charter (<a title=\"https://internetbugbounty.org/charter.html\" href=\"/redirect?signature=b34b0913c768b82efe61e79908ac47833d4d4a19&amp;url=https%3A%2F%2Finternetbugbounty.org%2Fcharter.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://internetbugbounty.org/charter.html</span><i class=\"icon-external-link\"></i></a>) includes &quot;Mind the Gap&quot;:</p>\n\n<blockquote>\n<p>In order to most efficiently allocate funds, the Panel should be cognizant of what software is already covered by other efforts, and how. For example, if another organization rewards for providing patches to open source projects or funds secure development, the IBB should not duplicate this effort, but instead serve in a complementary fashion by rewarding researchers that identify and disclose vulnerabilities to the maintainers. The IBB should proactively identify software that has a gap in rewards for vulnerability research; in conjunction with other criteria, this is a good indicator that the software should be moved into scope.</p>\n</blockquote>\n\n<p>IIRC, this bug was bountied via Heroku, so due to our Mind the Gap stipulation, the panel voted to not award this particular issue.</p>\n\n<p>Additionally, if my understanding of the bug is correct, it was exploitable due to Heroku and Cloudfront&#39;s configurations. IBB primarily issues bounties for bugs in open source, non-commercial software; so potentially, the issue within TLS-SNI-01 would have qualified, but the impact of that aspect of the issue in isolation would not meet the bar for a bounty via IBB. The impact when combining the result with Heroku and Cloudfront would potentially meet the bar, but between the &quot;Mind the Gap&quot; stipulation, and Heroku and Amazon being for-profit companies, unfortunately this issue cannot be bountied via IBB.</p>\n\n<p>I believe I&#39;ve captured all of this correctly, but if you think I&#39;ve missed anything or have any questions, please let me know!</p>\n\n<p>Thanks,<br>\nAdam Bacchus</p>\n", 
            "type": "Activities::Comment", 
            "id": 2639418, 
            "genius_execution_id": null
        }, 
        {
            "attachments": [
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/289/231/5c4df1d1e34a1f2a227c70b061e9134c43023c32/Screen_Shot_2018-04-22_at_00.00.56.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6DOF4BH7%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T222350Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDAsIeiAo1xTw4kIWniK3AwV1z%2FDNuc2GpLi7AJOEJ0e4NWAql7yl6ReQj30YP2K5FBrc9xv0H8z3PZE4N7C099Z%2FTC7v7C1gzo54Jgi%2FX3cl%2B1K8PJ1QoShLHpAAjRjf5ciIakpyJZtfax9fUrlrfbg93561WLH%2BcAlYZYP%2FDoT4YEiEnKFoc6r1kz0vtgQeOMs4HdHNkjkFGMI77%2BHQkyTCbcJv5zS%2BkPk%2FmeIs5TPwLonNR3KC9vVtG8%2FxH87F2PEClO9BEdrskZjtMWY6P010JBQmt1CorTu4hj%2BXFqvR%2F690HP1hcC8CWJCyppmtZv0XEClGLMVyC6ib3jbvYHrbrPEHfmQP2RQi0FwMeueNkOH5qbyGqwmmxB4agSDiXM3XAl%2BTc87Wf5p1e%2Bc0zjzZ0xQeKM%2F%2B6b6TparaVSEWnYgYleztcjU3fPWHAZNwL16PwqewCVGh0Qp%2BPnUemfdihk3MmFQeIjHmE7sOQgXva7HlIEEEJ1hyrapkEutFP16gxCQzYqmfLGEsK0wbCxHgen0YqfDv81EZR726krPSisHScLMujI0SnwbcN8IyUwIYqnw663l%2FY9Dhpcje1uM19tGvbMUolrmm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=ca6c1a6113981d7b861168b2cbb91728c7eca369add91194fcf49738fcce7115", 
                    "type": "image/png", 
                    "id": 289231, 
                    "filename": "Screen_Shot_2018-04-22_at_00.00.56.png"
                }, 
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/289/230/519866678dd484543e9c942726c960fc6307433a/Screen_Shot_2018-04-22_at_00.00.46.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6DOF4BH7%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T222350Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDAsIeiAo1xTw4kIWniK3AwV1z%2FDNuc2GpLi7AJOEJ0e4NWAql7yl6ReQj30YP2K5FBrc9xv0H8z3PZE4N7C099Z%2FTC7v7C1gzo54Jgi%2FX3cl%2B1K8PJ1QoShLHpAAjRjf5ciIakpyJZtfax9fUrlrfbg93561WLH%2BcAlYZYP%2FDoT4YEiEnKFoc6r1kz0vtgQeOMs4HdHNkjkFGMI77%2BHQkyTCbcJv5zS%2BkPk%2FmeIs5TPwLonNR3KC9vVtG8%2FxH87F2PEClO9BEdrskZjtMWY6P010JBQmt1CorTu4hj%2BXFqvR%2F690HP1hcC8CWJCyppmtZv0XEClGLMVyC6ib3jbvYHrbrPEHfmQP2RQi0FwMeueNkOH5qbyGqwmmxB4agSDiXM3XAl%2BTc87Wf5p1e%2Bc0zjzZ0xQeKM%2F%2B6b6TparaVSEWnYgYleztcjU3fPWHAZNwL16PwqewCVGh0Qp%2BPnUemfdihk3MmFQeIjHmE7sOQgXva7HlIEEEJ1hyrapkEutFP16gxCQzYqmfLGEsK0wbCxHgen0YqfDv81EZR726krPSisHScLMujI0SnwbcN8IyUwIYqnw663l%2FY9Dhpcje1uM19tGvbMUolrmm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=af688d361641c24a7a3636cf1463911f30cb11b78bec0ace17e261b6305c6751", 
                    "type": "image/png", 
                    "id": 289230, 
                    "filename": "Screen_Shot_2018-04-22_at_00.00.46.png"
                }, 
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/289/229/6f120d1e5b7aafc57854e49988b8cdb2a3bd85dc/Screen_Shot_2018-04-22_at_00.00.32.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6DOF4BH7%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T222350Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDAsIeiAo1xTw4kIWniK3AwV1z%2FDNuc2GpLi7AJOEJ0e4NWAql7yl6ReQj30YP2K5FBrc9xv0H8z3PZE4N7C099Z%2FTC7v7C1gzo54Jgi%2FX3cl%2B1K8PJ1QoShLHpAAjRjf5ciIakpyJZtfax9fUrlrfbg93561WLH%2BcAlYZYP%2FDoT4YEiEnKFoc6r1kz0vtgQeOMs4HdHNkjkFGMI77%2BHQkyTCbcJv5zS%2BkPk%2FmeIs5TPwLonNR3KC9vVtG8%2FxH87F2PEClO9BEdrskZjtMWY6P010JBQmt1CorTu4hj%2BXFqvR%2F690HP1hcC8CWJCyppmtZv0XEClGLMVyC6ib3jbvYHrbrPEHfmQP2RQi0FwMeueNkOH5qbyGqwmmxB4agSDiXM3XAl%2BTc87Wf5p1e%2Bc0zjzZ0xQeKM%2F%2B6b6TparaVSEWnYgYleztcjU3fPWHAZNwL16PwqewCVGh0Qp%2BPnUemfdihk3MmFQeIjHmE7sOQgXva7HlIEEEJ1hyrapkEutFP16gxCQzYqmfLGEsK0wbCxHgen0YqfDv81EZR726krPSisHScLMujI0SnwbcN8IyUwIYqnw663l%2FY9Dhpcje1uM19tGvbMUolrmm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=7b31e9914e08794edcbbdbd44f7efb99f391b25052abcb51025cd4ce567cea0a", 
                    "type": "image/png", 
                    "id": 289229, 
                    "filename": "Screen_Shot_2018-04-22_at_00.00.32.png"
                }
            ], 
            "automated_response": false, 
            "created_at": "2018-04-21T22:12:47.874Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-04-21T22:12:47.874Z", 
            "actor": {
                "username": "fransrosen", 
                "url": "/fransrosen", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/634/56528780ddde67dec2e6f9d1212879ab16bc8f4a_medium.jpg?1396468576"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "internet", 
            "message": "Hi,\nThanks for the comments. To bring transparency to what Heroku did I will attach the screenshots showing the interaction I had with the Heroku-team, since they also agreed back then to allow me to share it.\n\n{F289229}\n{F289230}\n{F289231}\n\nYou could argue that they were paying me for letting them know I was going to publish the post, but that's probably up for interpretation (also the reason why I submitted it to their program was that their PGP-key had expired), and I will not complain about your decision, I just want to clarify how it all went down.\n\nIn addition, Heroku and AWS CloudFront were two of the shared hosting environments affected. No \"subdomain takeover\" was needed to issue certs for other domains, they only had to currently use one of the shared hosting providers. Since the TLS-SNI-01/02 specification only used the domain you wanted to validate to resolve the host it should connect to, and as soon as the connection was made, the TLS-SNI-01/02 verification method asked for a `*.acme.invalid`-domain that had nothing to do with the domain being verified. This was the big issue with the validation method.\n\nAs the Let's Encrypt team discovered, the only sane thing was to actually sunset TLS-SNI-01/02 completely. If this would have been an error only for those shared hosting providers, the same resolution would not have been the end result.\n\nI appreciate that you responded to my question about the decision.\n\nRegards,\nFrans\n\n", 
            "markdown_message": "<p>Hi,<br>\nThanks for the comments. To bring transparency to what Heroku did I will attach the screenshots showing the interaction I had with the Heroku-team, since they also agreed back then to allow me to share it.</p>\n\n<p><a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2018-04-22_at_00.00.32.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/289/229/6f120d1e5b7aafc57854e49988b8cdb2a3bd85dc/Screen_Shot_2018-04-22_at_00.00.32.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ6DOF4BH7%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T222350Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDAsIeiAo1xTw4kIWniK3AwV1z%2FDNuc2GpLi7AJOEJ0e4NWAql7yl6ReQj30YP2K5FBrc9xv0H8z3PZE4N7C099Z%2FTC7v7C1gzo54Jgi%2FX3cl%2B1K8PJ1QoShLHpAAjRjf5ciIakpyJZtfax9fUrlrfbg93561WLH%2BcAlYZYP%2FDoT4YEiEnKFoc6r1kz0vtgQeOMs4HdHNkjkFGMI77%2BHQkyTCbcJv5zS%2BkPk%2FmeIs5TPwLonNR3KC9vVtG8%2FxH87F2PEClO9BEdrskZjtMWY6P010JBQmt1CorTu4hj%2BXFqvR%2F690HP1hcC8CWJCyppmtZv0XEClGLMVyC6ib3jbvYHrbrPEHfmQP2RQi0FwMeueNkOH5qbyGqwmmxB4agSDiXM3XAl%2BTc87Wf5p1e%2Bc0zjzZ0xQeKM%2F%2B6b6TparaVSEWnYgYleztcjU3fPWHAZNwL16PwqewCVGh0Qp%2BPnUemfdihk3MmFQeIjHmE7sOQgXva7HlIEEEJ1hyrapkEutFP16gxCQzYqmfLGEsK0wbCxHgen0YqfDv81EZR726krPSisHScLMujI0SnwbcN8IyUwIYqnw663l%2FY9Dhpcje1uM19tGvbMUolrmm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=7b31e9914e08794edcbbdbd44f7efb99f391b25052abcb51025cd4ce567cea0a\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/289/229/6f120d1e5b7aafc57854e49988b8cdb2a3bd85dc/Screen_Shot_2018-04-22_at_00.00.32.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ6DOF4BH7%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T222350Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDAsIeiAo1xTw4kIWniK3AwV1z%2FDNuc2GpLi7AJOEJ0e4NWAql7yl6ReQj30YP2K5FBrc9xv0H8z3PZE4N7C099Z%2FTC7v7C1gzo54Jgi%2FX3cl%2B1K8PJ1QoShLHpAAjRjf5ciIakpyJZtfax9fUrlrfbg93561WLH%2BcAlYZYP%2FDoT4YEiEnKFoc6r1kz0vtgQeOMs4HdHNkjkFGMI77%2BHQkyTCbcJv5zS%2BkPk%2FmeIs5TPwLonNR3KC9vVtG8%2FxH87F2PEClO9BEdrskZjtMWY6P010JBQmt1CorTu4hj%2BXFqvR%2F690HP1hcC8CWJCyppmtZv0XEClGLMVyC6ib3jbvYHrbrPEHfmQP2RQi0FwMeueNkOH5qbyGqwmmxB4agSDiXM3XAl%2BTc87Wf5p1e%2Bc0zjzZ0xQeKM%2F%2B6b6TparaVSEWnYgYleztcjU3fPWHAZNwL16PwqewCVGh0Qp%2BPnUemfdihk3MmFQeIjHmE7sOQgXva7HlIEEEJ1hyrapkEutFP16gxCQzYqmfLGEsK0wbCxHgen0YqfDv81EZR726krPSisHScLMujI0SnwbcN8IyUwIYqnw663l%2FY9Dhpcje1uM19tGvbMUolrmm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=7b31e9914e08794edcbbdbd44f7efb99f391b25052abcb51025cd4ce567cea0a\" class=\"markdown-inline-image\"></a><br>\n<a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2018-04-22_at_00.00.46.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/289/230/519866678dd484543e9c942726c960fc6307433a/Screen_Shot_2018-04-22_at_00.00.46.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ6DOF4BH7%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T222350Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDAsIeiAo1xTw4kIWniK3AwV1z%2FDNuc2GpLi7AJOEJ0e4NWAql7yl6ReQj30YP2K5FBrc9xv0H8z3PZE4N7C099Z%2FTC7v7C1gzo54Jgi%2FX3cl%2B1K8PJ1QoShLHpAAjRjf5ciIakpyJZtfax9fUrlrfbg93561WLH%2BcAlYZYP%2FDoT4YEiEnKFoc6r1kz0vtgQeOMs4HdHNkjkFGMI77%2BHQkyTCbcJv5zS%2BkPk%2FmeIs5TPwLonNR3KC9vVtG8%2FxH87F2PEClO9BEdrskZjtMWY6P010JBQmt1CorTu4hj%2BXFqvR%2F690HP1hcC8CWJCyppmtZv0XEClGLMVyC6ib3jbvYHrbrPEHfmQP2RQi0FwMeueNkOH5qbyGqwmmxB4agSDiXM3XAl%2BTc87Wf5p1e%2Bc0zjzZ0xQeKM%2F%2B6b6TparaVSEWnYgYleztcjU3fPWHAZNwL16PwqewCVGh0Qp%2BPnUemfdihk3MmFQeIjHmE7sOQgXva7HlIEEEJ1hyrapkEutFP16gxCQzYqmfLGEsK0wbCxHgen0YqfDv81EZR726krPSisHScLMujI0SnwbcN8IyUwIYqnw663l%2FY9Dhpcje1uM19tGvbMUolrmm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=af688d361641c24a7a3636cf1463911f30cb11b78bec0ace17e261b6305c6751\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/289/230/519866678dd484543e9c942726c960fc6307433a/Screen_Shot_2018-04-22_at_00.00.46.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ6DOF4BH7%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T222350Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDAsIeiAo1xTw4kIWniK3AwV1z%2FDNuc2GpLi7AJOEJ0e4NWAql7yl6ReQj30YP2K5FBrc9xv0H8z3PZE4N7C099Z%2FTC7v7C1gzo54Jgi%2FX3cl%2B1K8PJ1QoShLHpAAjRjf5ciIakpyJZtfax9fUrlrfbg93561WLH%2BcAlYZYP%2FDoT4YEiEnKFoc6r1kz0vtgQeOMs4HdHNkjkFGMI77%2BHQkyTCbcJv5zS%2BkPk%2FmeIs5TPwLonNR3KC9vVtG8%2FxH87F2PEClO9BEdrskZjtMWY6P010JBQmt1CorTu4hj%2BXFqvR%2F690HP1hcC8CWJCyppmtZv0XEClGLMVyC6ib3jbvYHrbrPEHfmQP2RQi0FwMeueNkOH5qbyGqwmmxB4agSDiXM3XAl%2BTc87Wf5p1e%2Bc0zjzZ0xQeKM%2F%2B6b6TparaVSEWnYgYleztcjU3fPWHAZNwL16PwqewCVGh0Qp%2BPnUemfdihk3MmFQeIjHmE7sOQgXva7HlIEEEJ1hyrapkEutFP16gxCQzYqmfLGEsK0wbCxHgen0YqfDv81EZR726krPSisHScLMujI0SnwbcN8IyUwIYqnw663l%2FY9Dhpcje1uM19tGvbMUolrmm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=af688d361641c24a7a3636cf1463911f30cb11b78bec0ace17e261b6305c6751\" class=\"markdown-inline-image\"></a><br>\n<a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2018-04-22_at_00.00.56.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/289/231/5c4df1d1e34a1f2a227c70b061e9134c43023c32/Screen_Shot_2018-04-22_at_00.00.56.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ6DOF4BH7%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T222350Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDAsIeiAo1xTw4kIWniK3AwV1z%2FDNuc2GpLi7AJOEJ0e4NWAql7yl6ReQj30YP2K5FBrc9xv0H8z3PZE4N7C099Z%2FTC7v7C1gzo54Jgi%2FX3cl%2B1K8PJ1QoShLHpAAjRjf5ciIakpyJZtfax9fUrlrfbg93561WLH%2BcAlYZYP%2FDoT4YEiEnKFoc6r1kz0vtgQeOMs4HdHNkjkFGMI77%2BHQkyTCbcJv5zS%2BkPk%2FmeIs5TPwLonNR3KC9vVtG8%2FxH87F2PEClO9BEdrskZjtMWY6P010JBQmt1CorTu4hj%2BXFqvR%2F690HP1hcC8CWJCyppmtZv0XEClGLMVyC6ib3jbvYHrbrPEHfmQP2RQi0FwMeueNkOH5qbyGqwmmxB4agSDiXM3XAl%2BTc87Wf5p1e%2Bc0zjzZ0xQeKM%2F%2B6b6TparaVSEWnYgYleztcjU3fPWHAZNwL16PwqewCVGh0Qp%2BPnUemfdihk3MmFQeIjHmE7sOQgXva7HlIEEEJ1hyrapkEutFP16gxCQzYqmfLGEsK0wbCxHgen0YqfDv81EZR726krPSisHScLMujI0SnwbcN8IyUwIYqnw663l%2FY9Dhpcje1uM19tGvbMUolrmm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=ca6c1a6113981d7b861168b2cbb91728c7eca369add91194fcf49738fcce7115\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/289/231/5c4df1d1e34a1f2a227c70b061e9134c43023c32/Screen_Shot_2018-04-22_at_00.00.56.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQ6DOF4BH7%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T222350Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDAsIeiAo1xTw4kIWniK3AwV1z%2FDNuc2GpLi7AJOEJ0e4NWAql7yl6ReQj30YP2K5FBrc9xv0H8z3PZE4N7C099Z%2FTC7v7C1gzo54Jgi%2FX3cl%2B1K8PJ1QoShLHpAAjRjf5ciIakpyJZtfax9fUrlrfbg93561WLH%2BcAlYZYP%2FDoT4YEiEnKFoc6r1kz0vtgQeOMs4HdHNkjkFGMI77%2BHQkyTCbcJv5zS%2BkPk%2FmeIs5TPwLonNR3KC9vVtG8%2FxH87F2PEClO9BEdrskZjtMWY6P010JBQmt1CorTu4hj%2BXFqvR%2F690HP1hcC8CWJCyppmtZv0XEClGLMVyC6ib3jbvYHrbrPEHfmQP2RQi0FwMeueNkOH5qbyGqwmmxB4agSDiXM3XAl%2BTc87Wf5p1e%2Bc0zjzZ0xQeKM%2F%2B6b6TparaVSEWnYgYleztcjU3fPWHAZNwL16PwqewCVGh0Qp%2BPnUemfdihk3MmFQeIjHmE7sOQgXva7HlIEEEJ1hyrapkEutFP16gxCQzYqmfLGEsK0wbCxHgen0YqfDv81EZR726krPSisHScLMujI0SnwbcN8IyUwIYqnw663l%2FY9Dhpcje1uM19tGvbMUolrmm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=ca6c1a6113981d7b861168b2cbb91728c7eca369add91194fcf49738fcce7115\" class=\"markdown-inline-image\"></a></p>\n\n<p>You could argue that they were paying me for letting them know I was going to publish the post, but that&#39;s probably up for interpretation (also the reason why I submitted it to their program was that their PGP-key had expired), and I will not complain about your decision, I just want to clarify how it all went down.</p>\n\n<p>In addition, Heroku and AWS CloudFront were two of the shared hosting environments affected. No &quot;subdomain takeover&quot; was needed to issue certs for other domains, they only had to currently use one of the shared hosting providers. Since the TLS-SNI-01/02 specification only used the domain you wanted to validate to resolve the host it should connect to, and as soon as the connection was made, the TLS-SNI-01/02 verification method asked for a <code>*.acme.invalid</code>-domain that had nothing to do with the domain being verified. This was the big issue with the validation method.</p>\n\n<p>As the Let&#39;s Encrypt team discovered, the only sane thing was to actually sunset TLS-SNI-01/02 completely. If this would have been an error only for those shared hosting providers, the same resolution would not have been the end result.</p>\n\n<p>I appreciate that you responded to my question about the decision.</p>\n\n<p>Regards,<br>\nFrans</p>\n", 
            "type": "Activities::Comment", 
            "id": 2650704, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-05-19T19:22:01.174Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-05-19T19:22:01.174Z", 
            "actor": {
                "url": "/internet", 
                "profile": {
                    "name": "The Internet"
                }, 
                "ibb": true, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/38e952fcff2c0aae0d011d5cecd07e5f62ecbd63_medium.png?1383767658"
                }
            }, 
            "team_handle": "internet", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 2766719, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "fransrosen", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/fransrosen", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/001/634/6e02242b5d1d893cef698144faa706fd1d75fea0_small.jpg?1396468576"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 75, 
        "name": "Privilege Escalation"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -17377313.129990924, 
    "disclosed_at": "2018-05-19T19:22:01.149Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/304378", 
    "created_at": "2018-01-12T21:42:47.027Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>The <a href=\"/redirect?signature=b6bd01d9a5d877d9af12492bcc878365748974cc&amp;url=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Fdraft-ietf-acme-acme-01%23section-7.3\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>ACME TLS-SNI-01</span><i class=\"icon-external-link\"></i></a> (and <a href=\"/redirect?signature=dd0905fa04ac7c3f9a9ea127b6f49f9ac963b2fa&amp;url=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Fdraft-ietf-acme-acme-09%23section-8.4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>TLS-SNI-02</span><i class=\"icon-external-link\"></i></a>) specification assumed wrong in terms of how current major cloud providers routed and validated domains. This was reported earlier this week to Let&#39;s Encrypt, and they decided to disable the method. Today Let&#39;s Encrypt decided to sunset both TLS-SNI-01 and TLS-SNI-02 due to the vulnerability I found. </p>\n\n<p>A full writeup of the finding and my side of the timeline can be found here:</p>\n\n<ul>\n<li><a href=\"/redirect?signature=4eb44c63cd8b45a227f37e97922bd80f02a5c036&amp;url=https%3A%2F%2Flabs.detectify.com%2F2018%2F01%2F12%2Fhow-i-exploited-acme-tls-sni-01-issuing-lets-encrypt-ssl-certs-for-any-domain-using-shared-hosting%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>How I exploited ACME TLS-SNI-01 issuing Let&#39;s Encrypt SSL-certs for any domain using shared hosting</span><i class=\"icon-external-link\"></i></a></li>\n</ul>\n\n<p>Here is Let&#39;s Encrypt first and second announcement about the reported issue:</p>\n\n<ul>\n<li><a href=\"/redirect?signature=a34279c742c3a746b70483c2670e563401443343&amp;url=https%3A%2F%2Fcommunity.letsencrypt.org%2Ft%2F2018-01-09-issue-with-tls-sni-01-and-shared-hosting-infrastructure%2F49996\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>2018.01.09 Issue with TLS-SNI-01 and Shared Hosting Infrastructure</span><i class=\"icon-external-link\"></i></a></li>\n<li><a href=\"/redirect?signature=54a19a03f985865d1163d9836955d145b145041f&amp;url=https%3A%2F%2Fcommunity.letsencrypt.org%2Ft%2F2018-01-11-update-regarding-acme-tls-sni-and-shared-hosting-infrastructure%2F50188\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>2018.01.11 Update Regarding ACME TLS-SNI and Shared Hosting Infrastructure</span><i class=\"icon-external-link\"></i></a></li>\n</ul>\n\n<p>Regards,<br>\nFrans</p>\n\n<h2 id=\"impact\">Impact</h2>\n\n<p>The ability to issue SSL-certificates for domains not under the attacker&#39;s control but served using the same shared hosting provider.</p>\n", 
    "severity_rating": "critical", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "", 
            "about": "Hack all the things.", 
            "twitter_handle": null, 
            "name": "The Internet"
        }, 
        "handle": "internet", 
        "url": "https://hackerone.com/internet", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/020/b94983d2ec09553c3e08f98cc718cb17e01112e6_small.png?1383767658", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/020/38e952fcff2c0aae0d011d5cecd07e5f62ecbd63_medium.png?1383767658"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 20, 
        "default_currency": "usd"
    }, 
    "is_published": false
}