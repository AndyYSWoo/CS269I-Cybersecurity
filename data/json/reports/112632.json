{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2017-10-19T10:16:26.676Z", 
    "voters": [
        "eveeez", 
        "geeknik", 
        "mr_r3boot", 
        "japz", 
        "spetr0x", 
        "hthomison1078"
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "500.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 112632, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2017-10-19T09:34:08.728Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "[tor] libevent dns remote stack overread vulnerability", 
    "is_member_of_team?": null, 
    "vote_count": 6, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2017-11-18T09:34:08.767Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$500", 
    "attachments": [
        {
            "file_name": "libevent-poc.py", 
            "type": "text/plain", 
            "id": 70753, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/070/753/f0e7d2a8a55f947329f3935b2547a64de96e082c/libevent-poc.py?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ2G5YP65E%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T223115Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDBU1F5krpICaZ0NqsCK3A6VE3SvOEqtR6mTF0RGsq2RFtP%2BeCnscHc5QWUWgfaEy6uXh0YyE%2Bu%2FBf1bgQOuQySCtb1Z%2BZ6sLON3HRMq%2BgYmhgdN4si0rU1p4nOiBj6crMBDlPKrwCFw0SRWaa%2FeWJtScRo9HMxA318TQuy1cnz2RYUYCxaU0Jci%2BrDGNmR0becuinzwZxwbm9sdysqqkTqFq64D7gI7nTrej5s6rDW11vFWqHpUP2d1FhvBaFOAjy8GP523rvRQSSyFkXe9YJUVlNrSLtqEAenEAnsweq3B3e669G9C%2FHm8G06ThADW69XI9pnMKVDT3FsJRtvkiltR9fsPJGB94knGZqwwdAK33UZ6TzU7QFoNEMoH%2BuvrEkO7SW8nmlfngtoX7AqMEGVMNAktUrQgR3jBfz1AXbDyaVpNINObIwvcxkjAPeH%2BJ9fJANeefQc2S9wtnpHnZGI8bjrMu%2F%2BBZHNLud7642CzhDwWVt363%2B%2B45PABKA6apczYhBSmM6I6woOQCnxMCpcKiqGyhztmN1LCRqv7FY5wPxjrGQArJvuYDfVGrN5Q7QMy6qocAzCdmYXfTag83vWxBpO15sjYooKOm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=3489ef456c0d251db1974641d5b82d3e588ec0b52c1cd24658acbede757b0d23"
        }
    ], 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2016-01-25T10:24:21.171Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-01-25T10:24:21.171Z", 
            "actor": {
                "username": "asn", 
                "url": "/asn", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "message": "Hello and thanks for the bug and the great report!\n\nWe are currently trying to see how this fits into our reward program.\n\nAs you can see in the bug rewards text we were not planning to pay out \"low severity\" vulnerabilities to third party libraries like libevent.\nStill, this seems like a nice bug, so we would like to reward it somehow!\n\nWe also want to check if this can be a DoS vector for Tor relays or dirauths.\n\nWe will get back to you ASAP!\n", 
            "markdown_message": "<p>Hello and thanks for the bug and the great report!</p>\n\n<p>We are currently trying to see how this fits into our reward program.</p>\n\n<p>As you can see in the bug rewards text we were not planning to pay out &quot;low severity&quot; vulnerabilities to third party libraries like libevent.<br>\nStill, this seems like a nice bug, so we would like to reward it somehow!</p>\n\n<p>We also want to check if this can be a DoS vector for Tor relays or dirauths.</p>\n\n<p>We will get back to you ASAP!</p>\n", 
            "type": "Activities::Comment", 
            "id": 770623, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-01-25T18:22:14.639Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-01-25T18:22:14.639Z", 
            "actor": {
                "username": "guido", 
                "url": "/guido", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/983/055f2e31c3b25e230eeb37461df974006ba7b0bd_medium.jpg?1403536399"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "message": "Thanks!\n\nAre you interested in a heap corruption/crash vulnerability in libevent that probably affects tor if it opens a specially crafted /etc/hosts ?\n\nGuido", 
            "markdown_message": "<p>Thanks!</p>\n\n<p>Are you interested in a heap corruption/crash vulnerability in libevent that probably affects tor if it opens a specially crafted /etc/hosts ?</p>\n\n<p>Guido</p>\n", 
            "type": "Activities::Comment", 
            "id": 771222, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-01-25T21:57:34.366Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-01-25T21:57:34.366Z", 
            "actor": {
                "username": "asn", 
                "url": "/asn", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "message": "Hello friend!\n\nWith regards to the /etc/hosts bug, I think such a bug would be out of scope for the bug bounty program, but it would still be a nice bug to fix.\nWe would still be happy to credit you with the discovery of the bug of course :)\n\nComing back to you soon about the reward of this bug.", 
            "markdown_message": "<p>Hello friend!</p>\n\n<p>With regards to the /etc/hosts bug, I think such a bug would be out of scope for the bug bounty program, but it would still be a nice bug to fix.<br>\nWe would still be happy to credit you with the discovery of the bug of course :)</p>\n\n<p>Coming back to you soon about the reward of this bug.</p>\n", 
            "type": "Activities::Comment", 
            "id": 771551, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2016-01-26T14:19:06.276Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-01-26T14:19:06.276Z", 
            "actor": {
                "url": "/torproject", 
                "profile": {
                    "name": "Tor"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/800/f60c4e0509668a31fcd9604fc653ef8a43f2e5c4_medium.jpg?1453239375"
                }
            }, 
            "team_handle": "torproject", 
            "bounty_amount": "500.0", 
            "collaborator": {
                "username": "guido", 
                "url": "/guido"
            }, 
            "message": "Hello friend!\n\nWe decided $500 as the price of this bug. Out-of-bounds bugs are not super dangerous, but the potential of crashing exit nodes (that parse DNS queries with name_parse()) is concerning.\n\nYou are our first bug hunter! Thanks!\nPlease let us know if you would like to not be credited ,or be credited with a special name.\nOtherwise, we will just credit you as \"guido\".\n\nWe will start fixing the bug ASAP. When we do, we will post the patch here, so that you check it out if you want.\n\nCheers!", 
            "markdown_message": "<p>Hello friend!</p>\n\n<p>We decided $500 as the price of this bug. Out-of-bounds bugs are not super dangerous, but the potential of crashing exit nodes (that parse DNS queries with name_parse()) is concerning.</p>\n\n<p>You are our first bug hunter! Thanks!<br>\nPlease let us know if you would like to not be credited ,or be credited with a special name.<br>\nOtherwise, we will just credit you as &quot;guido&quot;.</p>\n\n<p>We will start fixing the bug ASAP. When we do, we will post the patch here, so that you check it out if you want.</p>\n\n<p>Cheers!</p>\n", 
            "type": "Activities::BountyAwarded", 
            "id": 772425, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-01-26T22:00:50.847Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-01-26T22:00:50.847Z", 
            "actor": {
                "username": "guido", 
                "url": "/guido", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/983/055f2e31c3b25e230eeb37461df974006ba7b0bd_medium.jpg?1403536399"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "message": "Thank you very much!\n\nYou may credit me as: Guido Vranken", 
            "markdown_message": "<p>Thank you very much!</p>\n\n<p>You may credit me as: Guido Vranken</p>\n", 
            "type": "Activities::Comment", 
            "id": 773165, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-01-27T15:19:39.204Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-01-27T15:19:39.204Z", 
            "actor": {
                "username": "asn", 
                "url": "/asn", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "message": "Hello. We filed this bug here: https://github.com/libevent/libevent/issues/317\n\nWill close this issue when the patch gets merged.", 
            "markdown_message": "<p>Hello. We filed this bug here: <a title=\"https://github.com/libevent/libevent/issues/317\" href=\"/redirect?signature=d794e3a25cc6aa24abf85c3f0d12e3bb0a8de07e&amp;url=https%3A%2F%2Fgithub.com%2Flibevent%2Flibevent%2Fissues%2F317\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/libevent/libevent/issues/317</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>Will close this issue when the patch gets merged.</p>\n", 
            "type": "Activities::Comment", 
            "id": 773954, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-01-28T13:51:02.436Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-01-28T13:51:02.436Z", 
            "actor": {
                "username": "geko", 
                "url": "/geko", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugTriaged", 
            "id": 775459, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "guido", 
                "url": "/guido"
            }, 
            "created_at": "2016-02-05T16:28:48.034Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-02-05T16:28:48.034Z", 
            "actor": {
                "username": "asn", 
                "url": "/asn", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "message": "This has been handled by the libevent team here:\nhttps://github.com/libevent/libevent/commit/96f64a022014a208105ead6c8a7066018449d86d\n\nPlease let us know if the fix is not sufficient.\n\nThanks!\n", 
            "markdown_message": "<p>This has been handled by the libevent team here:<br>\n<a title=\"https://github.com/libevent/libevent/commit/96f64a022014a208105ead6c8a7066018449d86d\" href=\"/redirect?signature=17fbe4b05ae44cbc79cce3686edb971c6147c950&amp;url=https%3A%2F%2Fgithub.com%2Flibevent%2Flibevent%2Fcommit%2F96f64a022014a208105ead6c8a7066018449d86d\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/libevent/libevent/commit/96f64a022014a208105ead6c8a7066018449d86d</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>Please let us know if the fix is not sufficient.</p>\n\n<p>Thanks!</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 786472, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-19T09:34:08.747Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-19T09:34:08.747Z", 
            "actor": {
                "username": "geko", 
                "url": "/geko", 
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 2083662, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-19T10:16:26.735Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-19T10:16:26.735Z", 
            "actor": {
                "username": "guido", 
                "url": "/guido", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/983/055f2e31c3b25e230eeb37461df974006ba7b0bd_medium.jpg?1403536399"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 2083747, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2017-10-19T10:16:26.818Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2017-10-19T10:16:26.818Z", 
            "actor": {
                "username": "guido", 
                "url": "/guido", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/002/983/055f2e31c3b25e230eeb37461df974006ba7b0bd_medium.jpg?1403536399"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "torproject", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 2083748, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "guido", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/guido", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/002/983/bc1fffcbbb736a8fa94816a1961b7b76725881eb_small.jpg?1403536399"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 2, 
        "name": "Memory Corruption - Generic"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -33137827.11022799, 
    "disclosed_at": "2017-10-19T10:16:26.792Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/112632", 
    "created_at": "2016-01-25T02:27:56.487Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>Hello,</p>\n\n<p>the name_parse function in libevent&#39;s DNS code is vulnerable to a buffer overread.</p>\n<pre class=\"highlight c\"><code> <span class=\"mi\">935</span> <span class=\"k\">static</span> <span class=\"kt\">int</span>\n <span class=\"mi\">936</span> <span class=\"nf\">name_parse</span><span class=\"p\">(</span><span class=\"n\">u8</span> <span class=\"o\">*</span><span class=\"n\">packet</span><span class=\"p\">,</span> <span class=\"kt\">int</span> <span class=\"n\">length</span><span class=\"p\">,</span> <span class=\"kt\">int</span> <span class=\"o\">*</span><span class=\"n\">idx</span><span class=\"p\">,</span> <span class=\"kt\">char</span> <span class=\"o\">*</span><span class=\"n\">name_out</span><span class=\"p\">,</span> <span class=\"kt\">int</span> <span class=\"n\">name_out_len</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n <span class=\"mi\">937</span>     <span class=\"kt\">int</span> <span class=\"n\">name_end</span> <span class=\"o\">=</span> <span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">;</span>\n <span class=\"mi\">938</span>     <span class=\"kt\">int</span> <span class=\"n\">j</span> <span class=\"o\">=</span> <span class=\"o\">*</span><span class=\"n\">idx</span><span class=\"p\">;</span>\n <span class=\"mi\">939</span>     <span class=\"kt\">int</span> <span class=\"n\">ptr_count</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">;</span>\n <span class=\"mi\">940</span> <span class=\"err\">#</span><span class=\"n\">define</span> <span class=\"n\">GET32</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"k\">do</span> <span class=\"p\">{</span> <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">j</span> <span class=\"o\">+</span> <span class=\"mi\">4</span> <span class=\"o\">&gt;</span> <span class=\"n\">length</span><span class=\"p\">)</span> <span class=\"k\">goto</span> <span class=\"n\">err</span><span class=\"p\">;</span> <span class=\"n\">memcpy</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"n\">_t32</span><span class=\"p\">,</span> <span class=\"n\">packet</span> <span class=\"o\">+</span> <span class=\"n\">j</span><span class=\"p\">,</span> <span class=\"mi\">4</span><span class=\"p\">);</span> <span class=\"n\">j</span> <span class=\"o\">+=</span> <span class=\"mi\">4</span><span class=\"p\">;</span> <span class=\"n\">x</span> <span class=\"o\">=</span> <span class=\"n\">ntohl</span><span class=\"p\">(</span><span class=\"n\">_t32</span><span class=\"p\">);</span> <span class=\"p\">}</span> <span class=\"k\">while</span>      <span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">)</span>\n <span class=\"mi\">941</span> <span class=\"err\">#</span><span class=\"n\">define</span> <span class=\"n\">GET16</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"k\">do</span> <span class=\"p\">{</span> <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">j</span> <span class=\"o\">+</span> <span class=\"mi\">2</span> <span class=\"o\">&gt;</span> <span class=\"n\">length</span><span class=\"p\">)</span> <span class=\"k\">goto</span> <span class=\"n\">err</span><span class=\"p\">;</span> <span class=\"n\">memcpy</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"n\">_t</span><span class=\"p\">,</span> <span class=\"n\">packet</span> <span class=\"o\">+</span> <span class=\"n\">j</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">);</span> <span class=\"n\">j</span> <span class=\"o\">+=</span> <span class=\"mi\">2</span><span class=\"p\">;</span> <span class=\"n\">x</span> <span class=\"o\">=</span> <span class=\"n\">ntohs</span><span class=\"p\">(</span><span class=\"n\">_t</span><span class=\"p\">);</span> <span class=\"p\">}</span> <span class=\"k\">while</span> <span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">)</span>\n <span class=\"mi\">942</span> <span class=\"err\">#</span><span class=\"n\">define</span> <span class=\"n\">GET8</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"k\">do</span> <span class=\"p\">{</span> <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">j</span> <span class=\"o\">&gt;=</span> <span class=\"n\">length</span><span class=\"p\">)</span> <span class=\"k\">goto</span> <span class=\"n\">err</span><span class=\"p\">;</span> <span class=\"n\">x</span> <span class=\"o\">=</span> <span class=\"n\">packet</span><span class=\"p\">[</span><span class=\"n\">j</span><span class=\"o\">++</span><span class=\"p\">];</span> <span class=\"p\">}</span> <span class=\"k\">while</span> <span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">)</span>\n <span class=\"mi\">943</span> \n <span class=\"mi\">944</span>     <span class=\"kt\">char</span> <span class=\"o\">*</span><span class=\"n\">cp</span> <span class=\"o\">=</span> <span class=\"n\">name_out</span><span class=\"p\">;</span>\n <span class=\"mi\">945</span>     <span class=\"k\">const</span> <span class=\"kt\">char</span> <span class=\"o\">*</span><span class=\"k\">const</span> <span class=\"n\">end</span> <span class=\"o\">=</span> <span class=\"n\">name_out</span> <span class=\"o\">+</span> <span class=\"n\">name_out_len</span><span class=\"p\">;</span>\n <span class=\"mi\">946</span> \n <span class=\"mi\">947</span>     <span class=\"cm\">/* Normally, names are a series of length prefixed strings terminated */</span>\n <span class=\"mi\">948</span>     <span class=\"cm\">/* with a length of 0 (the lengths are u8&#39;s &lt; 63). */</span>\n <span class=\"mi\">949</span>     <span class=\"cm\">/* However, the length can start with a pair of 1 bits and that */</span>\n <span class=\"mi\">950</span>     <span class=\"cm\">/* means that the next 14 bits are a pointer within the current */</span>\n <span class=\"mi\">951</span>     <span class=\"cm\">/* packet. */</span>\n <span class=\"mi\">952</span> \n <span class=\"mi\">953</span>     <span class=\"k\">for</span> <span class=\"p\">(;;)</span> <span class=\"p\">{</span>\n <span class=\"mi\">954</span>         <span class=\"n\">u8</span> <span class=\"n\">label_len</span><span class=\"p\">;</span>\n <span class=\"mi\">955</span>         <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">j</span> <span class=\"o\">&gt;=</span> <span class=\"n\">length</span><span class=\"p\">)</span> <span class=\"k\">return</span> <span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">;</span>\n <span class=\"mi\">956</span>         <span class=\"n\">GET8</span><span class=\"p\">(</span><span class=\"n\">label_len</span><span class=\"p\">);</span>\n <span class=\"mi\">957</span>         <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"o\">!</span><span class=\"n\">label_len</span><span class=\"p\">)</span> <span class=\"k\">break</span><span class=\"p\">;</span>\n <span class=\"mi\">958</span>         <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">label_len</span> <span class=\"o\">&amp;</span> <span class=\"mh\">0xc0</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n <span class=\"mi\">959</span>             <span class=\"n\">u8</span> <span class=\"n\">ptr_low</span><span class=\"p\">;</span>\n <span class=\"mi\">960</span>             <span class=\"n\">GET8</span><span class=\"p\">(</span><span class=\"n\">ptr_low</span><span class=\"p\">);</span>\n <span class=\"mi\">961</span>             <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">name_end</span> <span class=\"o\">&lt;</span> <span class=\"mi\">0</span><span class=\"p\">)</span> <span class=\"n\">name_end</span> <span class=\"o\">=</span> <span class=\"n\">j</span><span class=\"p\">;</span>\n <span class=\"mi\">962</span>             <span class=\"n\">j</span> <span class=\"o\">=</span> <span class=\"p\">(((</span><span class=\"kt\">int</span><span class=\"p\">)</span><span class=\"n\">label_len</span> <span class=\"o\">&amp;</span> <span class=\"mh\">0x3f</span><span class=\"p\">)</span> <span class=\"o\">&lt;&lt;</span> <span class=\"mi\">8</span><span class=\"p\">)</span> <span class=\"o\">+</span> <span class=\"n\">ptr_low</span><span class=\"p\">;</span>\n <span class=\"mi\">963</span>             <span class=\"cm\">/* Make sure that the target offset is in-bounds. */</span>\n <span class=\"mi\">964</span>             <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">j</span> <span class=\"o\">&lt;</span> <span class=\"mi\">0</span> <span class=\"o\">||</span> <span class=\"n\">j</span> <span class=\"o\">&gt;=</span> <span class=\"n\">length</span><span class=\"p\">)</span> <span class=\"k\">return</span> <span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">;</span>\n <span class=\"mi\">965</span>             <span class=\"cm\">/* If we&#39;ve jumped more times than there are characters in the\n 966              * message, we must have a loop. */</span>\n <span class=\"mi\">967</span>             <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"o\">++</span><span class=\"n\">ptr_count</span> <span class=\"o\">&gt;</span> <span class=\"n\">length</span><span class=\"p\">)</span> <span class=\"k\">return</span> <span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">;</span>\n <span class=\"mi\">968</span>             <span class=\"k\">continue</span><span class=\"p\">;</span>\n <span class=\"mi\">969</span>         <span class=\"p\">}</span>\n <span class=\"mi\">970</span>         <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">label_len</span> <span class=\"o\">&gt;</span> <span class=\"mi\">63</span><span class=\"p\">)</span> <span class=\"k\">return</span> <span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">;</span>\n <span class=\"mi\">971</span>         <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">cp</span> <span class=\"o\">!=</span> <span class=\"n\">name_out</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n <span class=\"mi\">972</span>             <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">cp</span> <span class=\"o\">+</span> <span class=\"mi\">1</span> <span class=\"o\">&gt;=</span> <span class=\"n\">end</span><span class=\"p\">)</span> <span class=\"k\">return</span> <span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">;</span>\n <span class=\"mi\">973</span>             <span class=\"o\">*</span><span class=\"n\">cp</span><span class=\"o\">++</span> <span class=\"o\">=</span> <span class=\"sc\">&#39;.&#39;</span><span class=\"p\">;</span>\n <span class=\"mi\">974</span>         <span class=\"p\">}</span>\n <span class=\"mi\">975</span>         <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">cp</span> <span class=\"o\">+</span> <span class=\"n\">label_len</span> <span class=\"o\">&gt;=</span> <span class=\"n\">end</span><span class=\"p\">)</span> <span class=\"k\">return</span> <span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">;</span>\n <span class=\"mi\">976</span>         <span class=\"n\">memcpy</span><span class=\"p\">(</span><span class=\"n\">cp</span><span class=\"p\">,</span> <span class=\"n\">packet</span> <span class=\"o\">+</span> <span class=\"n\">j</span><span class=\"p\">,</span> <span class=\"n\">label_len</span><span class=\"p\">);</span>\n <span class=\"mi\">977</span>         <span class=\"n\">cp</span> <span class=\"o\">+=</span> <span class=\"n\">label_len</span><span class=\"p\">;</span>\n <span class=\"mi\">978</span>         <span class=\"n\">j</span> <span class=\"o\">+=</span> <span class=\"n\">label_len</span><span class=\"p\">;</span>\n <span class=\"mi\">979</span>     <span class=\"p\">}</span>\n <span class=\"mi\">980</span>     <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">cp</span> <span class=\"o\">&gt;=</span> <span class=\"n\">end</span><span class=\"p\">)</span> <span class=\"k\">return</span> <span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">;</span>\n <span class=\"mi\">981</span>     <span class=\"o\">*</span><span class=\"n\">cp</span> <span class=\"o\">=</span> <span class=\"sc\">&#39;\\0&#39;</span><span class=\"p\">;</span>                                                                                                   \n <span class=\"mi\">982</span>     <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">name_end</span> <span class=\"o\">&lt;</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n <span class=\"mi\">983</span>         <span class=\"o\">*</span><span class=\"n\">idx</span> <span class=\"o\">=</span> <span class=\"n\">j</span><span class=\"p\">;</span>\n <span class=\"mi\">984</span>     <span class=\"k\">else</span>\n <span class=\"mi\">985</span>         <span class=\"o\">*</span><span class=\"n\">idx</span> <span class=\"o\">=</span> <span class=\"n\">name_end</span><span class=\"p\">;</span>\n <span class=\"mi\">986</span>     <span class=\"k\">return</span> <span class=\"mi\">0</span><span class=\"p\">;</span>\n <span class=\"mi\">987</span>  <span class=\"n\">err</span><span class=\"o\">:</span>\n <span class=\"mi\">988</span>     <span class=\"k\">return</span> <span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">;</span>\n <span class=\"mi\">989</span> <span class=\"p\">}</span>\n</code></pre>\n<p>Prior to the memcpy on line 976 it is not asserted that the range (<code>packet + j</code>) - (<code>packet + j + label_len</code>) does not exceed the length of the <code>packet</code> buffer (as stored in variable <code>length</code>). My proof of concept exploits the possibility to keep jumping around in the buffer (lines 959 - 968), until the buffer index (<code>j</code>) is at the very end --- then, an overread of 63 bytes will occur. No overwrite takes place.</p>\n\n<p>As you know, an overread <em>may</em> result in a crash, depending on a variety of factors.</p>\n\n<p>I believe the code in Tor is vulnerable and I will update this report with PoC against Tor itself as soon as I&#39;ve constructed one.</p>\n\n<p>Nobody has been notified of this bug except you. I will not contact the libevent developers about this issue unless you explicitly request so. It&#39;s up to you to notify them yourself.</p>\n\n<p>To test against the latest version of libevent (libevent-2.0.22-stable.tar.gz):</p>\n<pre class=\"highlight shell\"><code><span class=\"nv\">CFLAGS</span><span class=\"o\">=</span><span class=\"s2\">&quot;-fomit-frame-pointer -fsanitize=address&quot;</span> ./configure\nmake -j4\n<span class=\"nb\">cd </span>samples\n./dns-example -servertest\n</code></pre>\n<p>in a different terminal run</p>\n<pre class=\"highlight shell\"><code>python libevent-poc.py\n</code></pre>\n<p>Output of <code>dns-example</code> should be:</p>\n<pre class=\"highlight plaintext\"><code>EVUTIL_AI_CANONNAME in example = 2\n=================================================================\n==27496== ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7ffcf5a7355c at pc 0x7f6096a6b652 bp 0x7ffcf5a72bb0 sp 0x7ffcf5a72ba8\nREAD of size 1 at 0x7ffcf5a7355c thread T0\n\n...\n...\n</code></pre>\n<p>Guido</p>\n", 
    "vulnerability_information": "Hello,\n\nthe name_parse function in libevent's DNS code is vulnerable to a buffer overread.\n```c\n 935 static int\n 936 name_parse(u8 *packet, int length, int *idx, char *name_out, int name_out_len) {\n 937     int name_end = -1;\n 938     int j = *idx;\n 939     int ptr_count = 0;\n 940 #define GET32(x) do { if (j + 4 > length) goto err; memcpy(&_t32, packet + j, 4); j += 4; x = ntohl(_t32); } while      (0)\n 941 #define GET16(x) do { if (j + 2 > length) goto err; memcpy(&_t, packet + j, 2); j += 2; x = ntohs(_t); } while (0)\n 942 #define GET8(x) do { if (j >= length) goto err; x = packet[j++]; } while (0)\n 943 \n 944     char *cp = name_out;\n 945     const char *const end = name_out + name_out_len;\n 946 \n 947     /* Normally, names are a series of length prefixed strings terminated */\n 948     /* with a length of 0 (the lengths are u8's < 63). */\n 949     /* However, the length can start with a pair of 1 bits and that */\n 950     /* means that the next 14 bits are a pointer within the current */\n 951     /* packet. */\n 952 \n 953     for (;;) {\n 954         u8 label_len;\n 955         if (j >= length) return -1;\n 956         GET8(label_len);\n 957         if (!label_len) break;\n 958         if (label_len & 0xc0) {\n 959             u8 ptr_low;\n 960             GET8(ptr_low);\n 961             if (name_end < 0) name_end = j;\n 962             j = (((int)label_len & 0x3f) << 8) + ptr_low;\n 963             /* Make sure that the target offset is in-bounds. */\n 964             if (j < 0 || j >= length) return -1;\n 965             /* If we've jumped more times than there are characters in the\n 966              * message, we must have a loop. */\n 967             if (++ptr_count > length) return -1;\n 968             continue;\n 969         }\n 970         if (label_len > 63) return -1;\n 971         if (cp != name_out) {\n 972             if (cp + 1 >= end) return -1;\n 973             *cp++ = '.';\n 974         }\n 975         if (cp + label_len >= end) return -1;\n 976         memcpy(cp, packet + j, label_len);\n 977         cp += label_len;\n 978         j += label_len;\n 979     }\n 980     if (cp >= end) return -1;\n 981     *cp = '\\0';                                                                                                   \n 982     if (name_end < 0)\n 983         *idx = j;\n 984     else\n 985         *idx = name_end;\n 986     return 0;\n 987  err:\n 988     return -1;\n 989 }\n```\n\nPrior to the memcpy on line 976 it is not asserted that the range (```packet + j```) - (```packet + j + label_len```) does not exceed the length of the ```packet``` buffer (as stored in variable ```length```). My proof of concept exploits the possibility to keep jumping around in the buffer (lines 959 - 968), until the buffer index (```j```) is at the very end --- then, an overread of 63 bytes will occur. No overwrite takes place.\n\nAs you know, an overread *may* result in a crash, depending on a variety of factors.\n\nI believe the code in Tor is vulnerable and I will update this report with PoC against Tor itself as soon as I've constructed one.\n\nNobody has been notified of this bug except you. I will not contact the libevent developers about this issue unless you explicitly request so. It's up to you to notify them yourself.\n\nTo test against the latest version of libevent (libevent-2.0.22-stable.tar.gz):\n\n```sh\nCFLAGS=\"-fomit-frame-pointer -fsanitize=address\" ./configure\nmake -j4\ncd samples\n./dns-example -servertest\n```\n\nin a different terminal run\n```sh\npython libevent-poc.py\n```\n\nOutput of ```dns-example``` should be:\n```\nEVUTIL_AI_CANONNAME in example = 2\n=================================================================\n==27496== ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7ffcf5a7355c at pc 0x7f6096a6b652 bp 0x7ffcf5a72bb0 sp 0x7ffcf5a72ba8\nREAD of size 1 at 0x7ffcf5a7355c thread T0\n\n...\n...\n```\n\nGuido", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://www.torproject.org/", 
            "about": "Anonymity Online", 
            "twitter_handle": "torproject", 
            "name": "Tor"
        }, 
        "handle": "torproject", 
        "url": "https://hackerone.com/torproject", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/001/800/fe36670e5f7b7381549279801c447ae8a3ee12b0_small.jpg?1453239375", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/001/800/f60c4e0509668a31fcd9604fc653ef8a43f2e5c4_medium.jpg?1453239375"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 1800, 
        "default_currency": "usd"
    }, 
    "is_published": false
}