{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2018-08-11T00:33:20.808Z", 
    "voters": [
        "michiel", 
        "z3t", 
        "spam404", 
        "akashc99", 
        "eveeez", 
        "13ern", 
        "an0nym0us", 
        "akhil-reni", 
        "babayaga_", 
        "ranjit_p", 
        "and 10 more..."
    ], 
    "facebook_team?": false, 
    "has_bounty?": false, 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 388740, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2018-08-11T13:57:57.884Z", 
    "vulnerability_information": "Hello!\n\nWhile browsing through some old reports, I found that https://jenkins.brew.sh was publicly accessible. I got curious when I saw one of the [brew bottle builds](https://jenkins.brew.sh/job/Homebrew%20Bottles/33255/console) doing a `git push` to BrewTestBot/homebrew-core, and wondered if the credentials to make authenticated pushes were accessible.\n\nSure enough, you can view environment variables for the build on [this page](https://jenkins.brew.sh/job/Homebrew%20Bottles/33255/injectedEnvVars/), which includes a `HOMEBREW_GITHUB_API_TOKEN` environment variable.\n\nThis API token belongs to the [BrewTestBot](https://github.com/BrewTestBot) user on GitHub, and this API key allows me to commit to the `BrewTestBot/homebrew-core` repository:\n\n```\n$ export GITHUB_API_TOKEN=<github token from above>\n$ curl https://api.github.com/repos/BrewTestBot/homebrew-core/git/blobs -u $GITHUB_API_TOKEN:x-oauth-basic -d '{\"content\":\"test\"}' -H \"Content-Type: application/json\"\n{\n  \"sha\": \"30d74d258442c7c65512eafab474568dd706c430\",\n  \"url\": \"https://api.github.com/repos/BrewTestBot/homebrew-core/git/blobs/30d74d258442c7c65512eafab474568dd706c430\"\n}\n```\n\n## Impact\n\nBased on the purpose of `BrewTestBot`, this might be entirely intended, but if the GitHub access token has overly permissive scopes, it might be usable to perform other actions, aside from a `git push`. In that case, an SSH deploy key may be better, and less permissive.\n\nIf exposing this API key publicly is intended behavior, please feel free to close this.", 
    "activity_page_count": 1, 
    "severity": {
        "rating": "critical", 
        "author_type": "User"
    }, 
    "title": "GitHub API Key for BrewTestBot is publicly exposed", 
    "is_member_of_team?": null, 
    "vote_count": 20, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2018-09-10T00:33:20.930Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "activity_page_number": 1, 
    "readable_substate": "Resolved", 
    "public": true, 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2018-07-31T08:04:53.981Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-07-31T08:04:53.981Z", 
            "actor": {
                "username": "ejholmes", 
                "url": "/ejholmes", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/160/627/4c001d99a4e2370aaca64685e28117282d0679ea_medium.jpeg?1492641026"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "homebrew", 
            "message": "Did a little more sleuthing. These credentials give me commit access to the following repos:\n\n* Homebrew/brew\n* Homebrew/formulae.brew.sh\n* Homebrew/homebrew-core\n\nProof:\n\n```\n$ curl https://api.github.com/repos/Homebrew/homebrew-core/git/blobs -u $GITHUB_API_TOKEN:x-oauth-basic -d '{\"content\":\"test\"}' -H \"Content-Type: application/json\"\n{\n  \"sha\": \"30d74d258442c7c65512eafab474568dd706c430\",\n  \"url\": \"https://api.github.com/repos/Homebrew/homebrew-core/git/blobs/30d74d258442c7c65512eafab474568dd706c430\"\n}\n```\n", 
            "markdown_message": "<p>Did a little more sleuthing. These credentials give me commit access to the following repos:</p>\n\n<ul>\n<li>Homebrew/brew</li>\n<li>Homebrew/formulae.brew.sh</li>\n<li>Homebrew/homebrew-core</li>\n</ul>\n\n<p>Proof:</p>\n<pre class=\"highlight plaintext\"><code>$ curl https://api.github.com/repos/Homebrew/homebrew-core/git/blobs -u $GITHUB_API_TOKEN:x-oauth-basic -d &#39;{&quot;content&quot;:&quot;test&quot;}&#39; -H &quot;Content-Type: application/json&quot;\n{\n  &quot;sha&quot;: &quot;30d74d258442c7c65512eafab474568dd706c430&quot;,\n  &quot;url&quot;: &quot;https://api.github.com/repos/Homebrew/homebrew-core/git/blobs/30d74d258442c7c65512eafab474568dd706c430&quot;\n}\n</code></pre>", 
            "type": "Activities::Comment", 
            "id": 3119913, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-07-31T08:06:27.189Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-07-31T08:06:27.189Z", 
            "actor": {
                "username": "mikemcquaid", 
                "url": "/mikemcquaid", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/152/571/19c643787646cf38c93060b1438da81cdd216ec3_medium.jpg?1490086473"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "homebrew", 
            "message": "Thanks! This credential previously had no scopes so only provided access to public information but this changed recently. I'm going to reconfigure Jenkins and roll the credential.", 
            "markdown_message": "<p>Thanks! This credential previously had no scopes so only provided access to public information but this changed recently. I&#39;m going to reconfigure Jenkins and roll the credential.</p>\n", 
            "type": "Activities::BugTriaged", 
            "id": 3119924, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "ejholmes", 
                "url": "/ejholmes"
            }, 
            "created_at": "2018-07-31T08:34:35.914Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-07-31T08:34:35.914Z", 
            "actor": {
                "username": "mikemcquaid", 
                "url": "/mikemcquaid", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/152/571/19c643787646cf38c93060b1438da81cdd216ec3_medium.jpg?1490086473"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "homebrew", 
            "message": "Thanks! This should now be resolved. The previous token may show up on the job but should no longer be valid. I've confirmed it now shows \"Bad Credentials\".", 
            "markdown_message": "<p>Thanks! This should now be resolved. The previous token may show up on the job but should no longer be valid. I&#39;ve confirmed it now shows &quot;Bad Credentials&quot;.</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 3120190, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-07-31T10:22:40.311Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-07-31T10:22:40.311Z", 
            "actor": {
                "username": "ejholmes", 
                "url": "/ejholmes", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/160/627/4c001d99a4e2370aaca64685e28117282d0679ea_medium.jpeg?1492641026"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "homebrew", 
            "message": "@mikemcquaid thanks for the quick response! I think it's important that this gets disclosed, and I'm planning on writing a blog post about this. Potentially, all of the internet has had access to commit to Homebrew since this access token has had these scopes (any idea how long that might be?).\n\nThe possibilities for what could have been done with these credentials is pretty concerning; best case I'm the first to discover this, worst case this has been discovered by malicious actors and Homebrew packages have back doors in them now. It seems like auditing whether this has been used maliciously is going to be fairly difficult, since the commits would be coming from BrewTestBot.\n\nI'll defer to you on when you think is the right time to go public with this.", 
            "markdown_message": "<p><a href=\"/mikemcquaid\">@mikemcquaid</a> thanks for the quick response! I think it&#39;s important that this gets disclosed, and I&#39;m planning on writing a blog post about this. Potentially, all of the internet has had access to commit to Homebrew since this access token has had these scopes (any idea how long that might be?).</p>\n\n<p>The possibilities for what could have been done with these credentials is pretty concerning; best case I&#39;m the first to discover this, worst case this has been discovered by malicious actors and Homebrew packages have back doors in them now. It seems like auditing whether this has been used maliciously is going to be fairly difficult, since the commits would be coming from BrewTestBot.</p>\n\n<p>I&#39;ll defer to you on when you think is the right time to go public with this.</p>\n", 
            "type": "Activities::Comment", 
            "id": 3121526, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-07-31T11:18:21.598Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-07-31T11:18:21.598Z", 
            "actor": {
                "username": "mikemcquaid", 
                "url": "/mikemcquaid", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/152/571/19c643787646cf38c93060b1438da81cdd216ec3_medium.jpg?1490086473"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "homebrew", 
            "message": "Excuse my brevity because I\u2019m on my phone. I\u2019m on paternity leave right now so I\u2019ll answer some more of your questions when I get the chance. Please hold off disclosing anything publicly for at least some weeks until I\u2019m back at work. I can provide more details later if requested but it\u2019s not accurate to say that this could be used to backdoor Homebrew packages. At worst this would allow pushing commits (which the audit log will help me identify if this happened) to a single repository and not all of Homebrew for the relatively short window these scopes were upgraded. Personally I\u2019d rather this was not disclosed publicly at all.", 
            "markdown_message": "<p>Excuse my brevity because I\u2019m on my phone. I\u2019m on paternity leave right now so I\u2019ll answer some more of your questions when I get the chance. Please hold off disclosing anything publicly for at least some weeks until I\u2019m back at work. I can provide more details later if requested but it\u2019s not accurate to say that this could be used to backdoor Homebrew packages. At worst this would allow pushing commits (which the audit log will help me identify if this happened) to a single repository and not all of Homebrew for the relatively short window these scopes were upgraded. Personally I\u2019d rather this was not disclosed publicly at all.</p>\n", 
            "type": "Activities::Comment", 
            "id": 3121629, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-07-31T11:33:52.561Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-07-31T11:33:52.561Z", 
            "actor": {
                "username": "ejholmes", 
                "url": "/ejholmes", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/160/627/4c001d99a4e2370aaca64685e28117282d0679ea_medium.jpeg?1492641026"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "homebrew", 
            "message": "Understood. I'll hold off on posting anything publicly about this until you're back from paternity leave, and we have a complete understanding of what could have been achieved with these credentials.", 
            "markdown_message": "<p>Understood. I&#39;ll hold off on posting anything publicly about this until you&#39;re back from paternity leave, and we have a complete understanding of what could have been achieved with these credentials.</p>\n", 
            "type": "Activities::Comment", 
            "id": 3121653, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-01T01:38:26.336Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-01T01:38:26.336Z", 
            "actor": {
                "username": "ejholmes", 
                "url": "/ejholmes", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/160/627/4c001d99a4e2370aaca64685e28117282d0679ea_medium.jpeg?1492641026"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "homebrew", 
            "message": "While I'm waiting, I wanna respond with how I think this could have been used to insert a back door, given I had commit access to `Homebrew/brew`, `Homebrew/homebrew-core`. This assumes that the `master` branch on these repos does not have branch protection + required reviews, meaning I would be able to fast-forward `refs/heads/master`.\n\n### 1) Replacing bin/brew\n\nThe installation instructions on [brew.sh](https://brew.sh/) document the recommended method for installing homebrew as:\n\n```console\n/usr/bin/ruby -e \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)\"\n```\n\nThis downloads and evaluates the Ruby script found at https://github.com/Homebrew/install/blob/master/install.\n\nThe ruby script does a few things, one of which is to [clone the master branch of https://github.com/Homebrew/brew into `/usr/local/Homebrew`](https://github.com/Homebrew/install/blob/052743dae1c004829c02e1a7c0b4aa82eff18846/install#L326-L362).\n\n```ruby\nsystem git, \"config\", \"remote.origin.url\", BREW_REPO\nsystem git, \"config\", \"remote.origin.fetch\", \"+refs/heads/*:refs/remotes/origin/*\"\n\n# ensure we don't munge line endings on checkout\nsystem git, \"config\", \"core.autocrlf\", \"false\"\n\nargs = git, \"fetch\", \"origin\", \"master:refs/remotes/origin/master\",\n       \"--tags\", \"--force\"\nsystem(*args)\n\nsystem git, \"reset\", \"--hard\", \"origin/master\"\n```\n\nGiven that this clones the `master` branch, If I were able to fast-forward `refs/heads/master`, I could have committed a backdoored version of [bin/brew](https://github.com/Homebrew/brew/blob/master/bin/brew). The next time someone downloaded/updated homebrew, I would have control of their machine.\n\n#### 2) Replacing formulae\n\nGiven this also granted commit access to Homebrew/homebrew-core, I could have replaced the formula for any package with a backdoored version of it. The next time someone installs the package, I would have control of their machine.\n\n---\n\nI think the severity of this ultimately rests on whether or not I would have been able to fast-forward the master branches on either repo. It looks like Homebrew/brew might have branch protection + required reviews, but it seems like Homebrew/homebrew-core does not, meaning I would have been able to replace formula.", 
            "markdown_message": "<p>While I&#39;m waiting, I wanna respond with how I think this could have been used to insert a back door, given I had commit access to <code>Homebrew/brew</code>, <code>Homebrew/homebrew-core</code>. This assumes that the <code>master</code> branch on these repos does not have branch protection + required reviews, meaning I would be able to fast-forward <code>refs/heads/master</code>.</p>\n\n<h3 id=\"1-replacing-bin-brew\">1) Replacing bin/brew</h3>\n\n<p>The installation instructions on <a href=\"/redirect?signature=c37babe751fc666aeaf5cc455ee98b3f48d70dc1&amp;url=https%3A%2F%2Fbrew.sh%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>brew.sh</span><i class=\"icon-external-link\"></i></a> document the recommended method for installing homebrew as:</p>\n<pre class=\"highlight shell_session\"><code>/usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;\n</code></pre>\n<p>This downloads and evaluates the Ruby script found at <a title=\"https://github.com/Homebrew/install/blob/master/install\" href=\"/redirect?signature=8ea40b284fcab49d1bf48e9f9c2514100ae67b5d&amp;url=https%3A%2F%2Fgithub.com%2FHomebrew%2Finstall%2Fblob%2Fmaster%2Finstall\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/Homebrew/install/blob/master/install</span><i class=\"icon-external-link\"></i></a>.</p>\n\n<p>The ruby script does a few things, one of which is to <a href=\"/redirect?signature=694ba1a1182c91d0fb50823124da68420f5ba1b5&amp;url=https%3A%2F%2Fgithub.com%2FHomebrew%2Finstall%2Fblob%2F052743dae1c004829c02e1a7c0b4aa82eff18846%2Finstall%23L326-L362\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>clone the master branch of https://github.com/Homebrew/brew into <code>/usr/local/Homebrew</code></span><i class=\"icon-external-link\"></i></a>.</p>\n<pre class=\"highlight ruby\"><code><span class=\"nb\">system</span> <span class=\"n\">git</span><span class=\"p\">,</span> <span class=\"s2\">&quot;config&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;remote.origin.url&quot;</span><span class=\"p\">,</span> <span class=\"no\">BREW_REPO</span>\n<span class=\"nb\">system</span> <span class=\"n\">git</span><span class=\"p\">,</span> <span class=\"s2\">&quot;config&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;remote.origin.fetch&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;+refs/heads/*:refs/remotes/origin/*&quot;</span>\n\n<span class=\"c1\"># ensure we don&#39;t munge line endings on checkout</span>\n<span class=\"nb\">system</span> <span class=\"n\">git</span><span class=\"p\">,</span> <span class=\"s2\">&quot;config&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;core.autocrlf&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;false&quot;</span>\n\n<span class=\"n\">args</span> <span class=\"o\">=</span> <span class=\"n\">git</span><span class=\"p\">,</span> <span class=\"s2\">&quot;fetch&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;origin&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;master:refs/remotes/origin/master&quot;</span><span class=\"p\">,</span>\n       <span class=\"s2\">&quot;--tags&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;--force&quot;</span>\n<span class=\"nb\">system</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">)</span>\n\n<span class=\"nb\">system</span> <span class=\"n\">git</span><span class=\"p\">,</span> <span class=\"s2\">&quot;reset&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;--hard&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;origin/master&quot;</span>\n</code></pre>\n<p>Given that this clones the <code>master</code> branch, If I were able to fast-forward <code>refs/heads/master</code>, I could have committed a backdoored version of <a href=\"/redirect?signature=366b52befae06a9e8468557831a73bde13d2fb18&amp;url=https%3A%2F%2Fgithub.com%2FHomebrew%2Fbrew%2Fblob%2Fmaster%2Fbin%2Fbrew\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>bin/brew</span><i class=\"icon-external-link\"></i></a>. The next time someone downloaded/updated homebrew, I would have control of their machine.</p>\n\n<h4 id=\"2-replacing-formulae\">2) Replacing formulae</h4>\n\n<p>Given this also granted commit access to Homebrew/homebrew-core, I could have replaced the formula for any package with a backdoored version of it. The next time someone installs the package, I would have control of their machine.</p>\n\n<hr>\n\n<p>I think the severity of this ultimately rests on whether or not I would have been able to fast-forward the master branches on either repo. It looks like Homebrew/brew might have branch protection + required reviews, but it seems like Homebrew/homebrew-core does not, meaning I would have been able to replace formula.</p>\n", 
            "type": "Activities::Comment", 
            "id": 3124412, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-01T08:59:28.773Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-01T08:59:28.773Z", 
            "actor": {
                "username": "mikemcquaid", 
                "url": "/mikemcquaid", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/152/571/19c643787646cf38c93060b1438da81cdd216ec3_medium.jpg?1490086473"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "homebrew", 
            "message": "Homebrew/brew has had protected branches and required reviews so this was never possible there. Homebrew/homebrew-core and Homebrew/homebrew-test-bot now have protected branches which prevents BrewTestBot (but not some repository administrators who have higher permissions) from pushing to master. This was not in place when the token was leaked. I've contacted GitHub Support to identify if that token was used to push to any Homebrew repositories in that time (but initial investigations indicate it was not) and verified with an identically scoped token that I cannot push.\n\nIt's worth noting although you'd be able to modify a formula it would have been likely noticed by one of the other homebrew-core maintainers who follow the commit log very closely (e.g. ilovezfs). You would also not have been able to modify existing or create a new binary package on Bintray as these require separate credentials.\n\nI'm not involved with the security space so my preference would be for this not to be publicly disclosed as I feel it's likely to reflect badly on the project and me personally but ultimately that's up to you. I would ask that I can read your blog post before you post it publicly, though, and you still hold off posting it for a while (as we're discussing whether any additional security measures would be feasible and if they are it would be good to announce it there).\n\nThanks again!", 
            "markdown_message": "<p>Homebrew/brew has had protected branches and required reviews so this was never possible there. Homebrew/homebrew-core and Homebrew/homebrew-test-bot now have protected branches which prevents BrewTestBot (but not some repository administrators who have higher permissions) from pushing to master. This was not in place when the token was leaked. I&#39;ve contacted GitHub Support to identify if that token was used to push to any Homebrew repositories in that time (but initial investigations indicate it was not) and verified with an identically scoped token that I cannot push.</p>\n\n<p>It&#39;s worth noting although you&#39;d be able to modify a formula it would have been likely noticed by one of the other homebrew-core maintainers who follow the commit log very closely (e.g. ilovezfs). You would also not have been able to modify existing or create a new binary package on Bintray as these require separate credentials.</p>\n\n<p>I&#39;m not involved with the security space so my preference would be for this not to be publicly disclosed as I feel it&#39;s likely to reflect badly on the project and me personally but ultimately that&#39;s up to you. I would ask that I can read your blog post before you post it publicly, though, and you still hold off posting it for a while (as we&#39;re discussing whether any additional security measures would be feasible and if they are it would be good to announce it there).</p>\n\n<p>Thanks again!</p>\n", 
            "type": "Activities::Comment", 
            "id": 3126661, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-01T14:22:12.442Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-01T14:22:12.442Z", 
            "actor": {
                "username": "ejholmes", 
                "url": "/ejholmes", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/160/627/4c001d99a4e2370aaca64685e28117282d0679ea_medium.jpeg?1492641026"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "homebrew", 
            "message": "> I'm not involved with the security space so my preference would be for this not to be publicly disclosed as I feel it's likely to reflect badly on the project and me personally but ultimately that's up to you. I would ask that I can read your blog post before you post it publicly, though, and you still hold off posting it for a while (as we're discussing whether any additional security measures would be feasible and if they are it would be good to announce it there).\n\nTotally understand your feelings here, and I don\u2019t want this to draw negative attention on Homebrew maintainers themselves, or point blame at anyone. As a long time user of Homebrew, I appreciate the amount of effort you and the rest of the team have put in to making Homebrew what it is today.\n\nHowever, I think it\u2019s important to note that if this was leaked without being disclosed by the Homebrew team, it would look a lot worse than just saying \u201cHere\u2019s what happened, it wasn\u2019t used maliciously. We screwed up because we\u2019re human, we\u2019ll do better\u201d. For something like this, I would recommend a public disclosure from Homebrew, ideally including proof that this wasn\u2019t used maliciously.\n\nI think this can be used to draw more support to the needs of Homebrew; given how popular it is, and the potential impact of a vulnerability like this, a lot more resources could be devoted to improving security for Homebrew. If this draws the attention of something like the Project Zero team at Google, that might mean an overall better and more secure tool for users. I think this also highlights a fundamental flaw in the industry where we put a lot of implicit trust in package managers to be perfect, which ends up leading to a massively large attack vector for backdoors; NPM, RubyGems, PyPi and the like have all had and will have very similar vulnerabilities to this.\n\nI\u2019ll be drafting the blog post over the next few weeks, and I\u2019ll give you a chance to review it before I publish (and after you\u2019re back from paternity leave).", 
            "markdown_message": "<blockquote>\n<p>I&#39;m not involved with the security space so my preference would be for this not to be publicly disclosed as I feel it&#39;s likely to reflect badly on the project and me personally but ultimately that&#39;s up to you. I would ask that I can read your blog post before you post it publicly, though, and you still hold off posting it for a while (as we&#39;re discussing whether any additional security measures would be feasible and if they are it would be good to announce it there).</p>\n</blockquote>\n\n<p>Totally understand your feelings here, and I don\u2019t want this to draw negative attention on Homebrew maintainers themselves, or point blame at anyone. As a long time user of Homebrew, I appreciate the amount of effort you and the rest of the team have put in to making Homebrew what it is today.</p>\n\n<p>However, I think it\u2019s important to note that if this was leaked without being disclosed by the Homebrew team, it would look a lot worse than just saying \u201cHere\u2019s what happened, it wasn\u2019t used maliciously. We screwed up because we\u2019re human, we\u2019ll do better\u201d. For something like this, I would recommend a public disclosure from Homebrew, ideally including proof that this wasn\u2019t used maliciously.</p>\n\n<p>I think this can be used to draw more support to the needs of Homebrew; given how popular it is, and the potential impact of a vulnerability like this, a lot more resources could be devoted to improving security for Homebrew. If this draws the attention of something like the Project Zero team at Google, that might mean an overall better and more secure tool for users. I think this also highlights a fundamental flaw in the industry where we put a lot of implicit trust in package managers to be perfect, which ends up leading to a massively large attack vector for backdoors; NPM, RubyGems, PyPi and the like have all had and will have very similar vulnerabilities to this.</p>\n\n<p>I\u2019ll be drafting the blog post over the next few weeks, and I\u2019ll give you a chance to review it before I publish (and after you\u2019re back from paternity leave).</p>\n", 
            "type": "Activities::Comment", 
            "id": 3128819, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-01T16:01:17.390Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-01T16:01:17.390Z", 
            "actor": {
                "username": "mikemcquaid", 
                "url": "/mikemcquaid", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/152/571/19c643787646cf38c93060b1438da81cdd216ec3_medium.jpg?1490086473"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "homebrew", 
            "message": "Thanks for that. I'll work on a public disclosure that we can release at the same time as your blog post (if that works for you) and perhaps we could each review the other's? I like the idea of getting more help directed to Homebrew. I've started a conversation internally on how we can deal with issues like this better in future. Thanks again!", 
            "markdown_message": "<p>Thanks for that. I&#39;ll work on a public disclosure that we can release at the same time as your blog post (if that works for you) and perhaps we could each review the other&#39;s? I like the idea of getting more help directed to Homebrew. I&#39;ve started a conversation internally on how we can deal with issues like this better in future. Thanks again!</p>\n", 
            "type": "Activities::Comment", 
            "id": 3129302, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-02T01:19:07.066Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-02T01:24:54.168Z", 
            "actor": {
                "username": "ejholmes", 
                "url": "/ejholmes", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/160/627/4c001d99a4e2370aaca64685e28117282d0679ea_medium.jpeg?1492641026"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "homebrew", 
            "message": "Awesome. More than happy to review your draft when you have it.\n\nAlso, if I can make a few recommendations, here's a few things that would be worth doing (if they haven't already been done), and included in the public disclosure.\n\n1. Enable the \"Require 2FA\" setting on the Homebrew org: https://github.com/organizations/Homebrew/settings/security. This wouldn't have prevented the issue at hand, but could help prevent another similar attack (e.g. see the recent [Gentoo GitHub breach](https://thehackernews.com/2018/07/github-hacking-gentoo-linux.html)). It would probably be a good idea to also vocalize to any members of the Homebrew team to not use SMS based 2FA (see the [Reddit breach](https://www.reddit.com/r/announcements/comments/93qnm5/we_had_a_security_incident_heres_what_you_need_to/) today). The Reddit disclosure is also a really great example of a good disclosure (What happened, What's the impact, What we're doing).\n2. Enable third party app restrictions for the Homebrew org: https://github.com/organizations/Homebrew/settings/oauth_application_policy. This will help ensure that, if any Homebrew members OAuth with some mom-and-pop app, those API keys won't be usable on the Homebrew/* repos. Like the above, this wouldn't have prevented this issue, but it can prevent a similar one in the future.\n3. Enable branch protection + required reviews on any core Homebrew repos that don't have it (e.g. `Homebrew/homebrew-core`, `Homebrew/homebrew-cask`, `Homebrew/brew.sh`), and audit the number of people that have \"admin\" rights on the repos so this can't be bypassed.\n4. Have all the Homebrew org members review their personal access tokens and prune anything that's not used: https://github.com/settings/tokens\n\nThere's probably a broader discussion that could be had on how the brew client could be made to put less trust in the `Homebrew/homebrew-core` repo and GitHub, like using GPG signing, but those are probably discussions that would need to happen elsewhere.", 
            "markdown_message": "<p>Awesome. More than happy to review your draft when you have it.</p>\n\n<p>Also, if I can make a few recommendations, here&#39;s a few things that would be worth doing (if they haven&#39;t already been done), and included in the public disclosure.</p>\n\n<ol>\n<li>Enable the &quot;Require 2FA&quot; setting on the Homebrew org: <a title=\"https://github.com/organizations/Homebrew/settings/security\" href=\"/redirect?signature=17c547b8cd9a3083f82932273daeef09ecc42b72&amp;url=https%3A%2F%2Fgithub.com%2Forganizations%2FHomebrew%2Fsettings%2Fsecurity\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/organizations/Homebrew/settings/security</span><i class=\"icon-external-link\"></i></a>. This wouldn&#39;t have prevented the issue at hand, but could help prevent another similar attack (e.g. see the recent <a href=\"/redirect?signature=a046b77492774381e18bd04d353db9e3883c67b6&amp;url=https%3A%2F%2Fthehackernews.com%2F2018%2F07%2Fgithub-hacking-gentoo-linux.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>Gentoo GitHub breach</span><i class=\"icon-external-link\"></i></a>). It would probably be a good idea to also vocalize to any members of the Homebrew team to not use SMS based 2FA (see the <a href=\"/redirect?signature=d26577d6161c4f40588490c5393462e6790c3093&amp;url=https%3A%2F%2Fwww.reddit.com%2Fr%2Fannouncements%2Fcomments%2F93qnm5%2Fwe_had_a_security_incident_heres_what_you_need_to%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>Reddit breach</span><i class=\"icon-external-link\"></i></a> today). The Reddit disclosure is also a really great example of a good disclosure (What happened, What&#39;s the impact, What we&#39;re doing).</li>\n<li>Enable third party app restrictions for the Homebrew org: <a title=\"https://github.com/organizations/Homebrew/settings/oauth_application_policy\" href=\"/redirect?signature=e6902c177be8a30b0fea203559473948d9ce6e52&amp;url=https%3A%2F%2Fgithub.com%2Forganizations%2FHomebrew%2Fsettings%2Foauth_application_policy\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/organizations/Homebrew/settings/oauth_application_policy</span><i class=\"icon-external-link\"></i></a>. This will help ensure that, if any Homebrew members OAuth with some mom-and-pop app, those API keys won&#39;t be usable on the Homebrew/* repos. Like the above, this wouldn&#39;t have prevented this issue, but it can prevent a similar one in the future.</li>\n<li>Enable branch protection + required reviews on any core Homebrew repos that don&#39;t have it (e.g. <code>Homebrew/homebrew-core</code>, <code>Homebrew/homebrew-cask</code>, <code>Homebrew/brew.sh</code>), and audit the number of people that have &quot;admin&quot; rights on the repos so this can&#39;t be bypassed.</li>\n<li>Have all the Homebrew org members review their personal access tokens and prune anything that&#39;s not used: <a title=\"https://github.com/settings/tokens\" href=\"/redirect?signature=e3fa5b607cd197155b9f57e1e9830f670b2805d4&amp;url=https%3A%2F%2Fgithub.com%2Fsettings%2Ftokens\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/settings/tokens</span><i class=\"icon-external-link\"></i></a>\n</li>\n</ol>\n\n<p>There&#39;s probably a broader discussion that could be had on how the brew client could be made to put less trust in the <code>Homebrew/homebrew-core</code> repo and GitHub, like using GPG signing, but those are probably discussions that would need to happen elsewhere.</p>\n", 
            "type": "Activities::Comment", 
            "id": 3130881, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-02T06:29:30.664Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-02T06:29:30.664Z", 
            "actor": {
                "username": "mikemcquaid", 
                "url": "/mikemcquaid", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/152/571/19c643787646cf38c93060b1438da81cdd216ec3_medium.jpg?1490086473"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "homebrew", 
            "message": "Thanks! \n\n1. We've had \"require 2FA\" enabled for as long as it's been a feature but I'll recommend avoiding SMS to the current maintainers.\n2. We've had this enabled as long as it's been a feature (or close to that)\n3. Branch protection has been enabled on all repos. We can't have required reviews unfortunately because the team isn't big enough. I've enabled mandated CI checks on all repos but other maintainers have turned them off on the Homebrew Cask repos and wish to have the ability to push directly to master on the Homebrew Core repo.\n4. Good idea, I'll let them know too.\n\nOn GPG signing: I proposed that to the Homebrew leadership team and was unfortunately outvoted. I think there should still be a public discussion, though, so please feel free to open an issue on Homebrew/homebrew-core proposing that (without disclosing anything from here yet but I think it can be recommended as a good security practice regardless). If you'd rather not, I can do so but I figure you'll be able to do a better write-up than me!\n\nThanks again!", 
            "markdown_message": "<p>Thanks! </p>\n\n<ol>\n<li>We&#39;ve had &quot;require 2FA&quot; enabled for as long as it&#39;s been a feature but I&#39;ll recommend avoiding SMS to the current maintainers.</li>\n<li>We&#39;ve had this enabled as long as it&#39;s been a feature (or close to that)</li>\n<li>Branch protection has been enabled on all repos. We can&#39;t have required reviews unfortunately because the team isn&#39;t big enough. I&#39;ve enabled mandated CI checks on all repos but other maintainers have turned them off on the Homebrew Cask repos and wish to have the ability to push directly to master on the Homebrew Core repo.</li>\n<li>Good idea, I&#39;ll let them know too.</li>\n</ol>\n\n<p>On GPG signing: I proposed that to the Homebrew leadership team and was unfortunately outvoted. I think there should still be a public discussion, though, so please feel free to open an issue on Homebrew/homebrew-core proposing that (without disclosing anything from here yet but I think it can be recommended as a good security practice regardless). If you&#39;d rather not, I can do so but I figure you&#39;ll be able to do a better write-up than me!</p>\n\n<p>Thanks again!</p>\n", 
            "type": "Activities::Comment", 
            "id": 3131266, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-05T08:51:21.335Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-05T08:51:21.335Z", 
            "actor": {
                "username": "mikemcquaid", 
                "url": "/mikemcquaid", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/152/571/19c643787646cf38c93060b1438da81cdd216ec3_medium.jpg?1490086473"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "homebrew", 
            "message": "I've written my first draft of the blog post, let me know what you think: https://github.com/Homebrew/brew.sh/compare/master...MikeMcQuaid:security-disclosure?expand=1&short_path=4f1f53b#diff-4f1f53bd979bc0cf0ad1c6d75a43eadd\n\nPlease feel free to suggest any changes; this is my first security vulnerability disclosure. I'm more than happy to mention you by name and link to you directly.\n\nAdditionally good news from GitHub: they confirmed the relevant token's user did not push to and of those repositories in the given vulnerable window (from when the token had elevated privileges)", 
            "markdown_message": "<p>I&#39;ve written my first draft of the blog post, let me know what you think: <a title=\"https://github.com/Homebrew/brew.sh/compare/master...MikeMcQuaid:security-disclosure?expand=1&amp;short_path=4f1f53b#diff-4f1f53bd979bc0cf0ad1c6d75a43eadd\" href=\"/redirect?signature=702f54f95fb83f518a83dc205fb1c1433a1adfd1&amp;url=https%3A%2F%2Fgithub.com%2FHomebrew%2Fbrew.sh%2Fcompare%2Fmaster...MikeMcQuaid%3Asecurity-disclosure%3Fexpand%3D1%26short_path%3D4f1f53b%23diff-4f1f53bd979bc0cf0ad1c6d75a43eadd\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/Homebrew/brew.sh/compare/master...MikeMcQuaid:security-disclosure?expand=1&amp;short_path=4f1f53b#diff-4f1f53bd979bc0cf0ad1c6d75a43eadd</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>Please feel free to suggest any changes; this is my first security vulnerability disclosure. I&#39;m more than happy to mention you by name and link to you directly.</p>\n\n<p>Additionally good news from GitHub: they confirmed the relevant token&#39;s user did not push to and of those repositories in the given vulnerable window (from when the token had elevated privileges)</p>\n", 
            "type": "Activities::Comment", 
            "id": 3143350, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-05T12:12:48.591Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-05T12:12:48.591Z", 
            "actor": {
                "username": "mikemcquaid", 
                "url": "/mikemcquaid", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/152/571/19c643787646cf38c93060b1438da81cdd216ec3_medium.jpg?1490086473"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "homebrew", 
            "message": "Also to be explicit: whenever you're happy with this post I'm good to post it. If you'd rather I wait for you post (as you waited for ours) then I'm happy to do so.", 
            "markdown_message": "<p>Also to be explicit: whenever you&#39;re happy with this post I&#39;m good to post it. If you&#39;d rather I wait for you post (as you waited for ours) then I&#39;m happy to do so.</p>\n", 
            "type": "Activities::Comment", 
            "id": 3144894, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-06T19:22:16.782Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-06T19:22:16.782Z", 
            "actor": {
                "username": "mikemcquaid", 
                "url": "/mikemcquaid", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/152/571/19c643787646cf38c93060b1438da81cdd216ec3_medium.jpg?1490086473"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "homebrew", 
            "message": "Hi, just checking in here; don't want to rush you but want to probably get this post out sooner rather than later. Thanks again!", 
            "markdown_message": "<p>Hi, just checking in here; don&#39;t want to rush you but want to probably get this post out sooner rather than later. Thanks again!</p>\n", 
            "type": "Activities::Comment", 
            "id": 3152426, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-06T23:40:51.835Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-06T23:40:51.835Z", 
            "actor": {
                "username": "ejholmes", 
                "url": "/ejholmes", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/160/627/4c001d99a4e2370aaca64685e28117282d0679ea_medium.jpeg?1492641026"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "homebrew", 
            "message": "Hey @mikemcquaid. Sorry for the late response. I'll take a look at reviewing it now. I also have a rough draft of the blog post I'm planning, if you don't mind reviewing as well: https://medium.com/p/2ae314df03ab/edit", 
            "markdown_message": "<p>Hey <a href=\"/mikemcquaid\">@mikemcquaid</a>. Sorry for the late response. I&#39;ll take a look at reviewing it now. I also have a rough draft of the blog post I&#39;m planning, if you don&#39;t mind reviewing as well: <a title=\"https://medium.com/p/2ae314df03ab/edit\" href=\"/redirect?signature=a6515a69ea3508bd3350a6f5be3555b62acf9ed9&amp;url=https%3A%2F%2Fmedium.com%2Fp%2F2ae314df03ab%2Fedit\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://medium.com/p/2ae314df03ab/edit</span><i class=\"icon-external-link\"></i></a></p>\n", 
            "type": "Activities::Comment", 
            "id": 3153152, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-06T23:55:29.335Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-06T23:55:29.335Z", 
            "actor": {
                "username": "ejholmes", 
                "url": "/ejholmes", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/160/627/4c001d99a4e2370aaca64685e28117282d0679ea_medium.jpeg?1492641026"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "homebrew", 
            "message": "I think this looks good. I made some minor changes that I think makes it read a little better; some headings, and more explicit actions that were taken as mitigation steps. https://gist.github.com/ejholmes/7a0efa29911431293b8a409b3a30e08d\n\nFeel free to pull those changes in, or publish as is.", 
            "markdown_message": "<p>I think this looks good. I made some minor changes that I think makes it read a little better; some headings, and more explicit actions that were taken as mitigation steps. <a title=\"https://gist.github.com/ejholmes/7a0efa29911431293b8a409b3a30e08d\" href=\"/redirect?signature=42199e2752ba3a24f5acf3960fb1a2f7d6e05550&amp;url=https%3A%2F%2Fgist.github.com%2Fejholmes%2F7a0efa29911431293b8a409b3a30e08d\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://gist.github.com/ejholmes/7a0efa29911431293b8a409b3a30e08d</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>Feel free to pull those changes in, or publish as is.</p>\n", 
            "type": "Activities::Comment", 
            "id": 3153181, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-07T06:48:06.825Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-07T06:48:06.825Z", 
            "actor": {
                "username": "mikemcquaid", 
                "url": "/mikemcquaid", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/152/571/19c643787646cf38c93060b1438da81cdd216ec3_medium.jpg?1490086473"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "homebrew", 
            "message": "@ejholmes I can't read that Medium link; does it need an account? Any change of pasting it into a Gist (even with formatting removed)?", 
            "markdown_message": "<p><a href=\"/ejholmes\">@ejholmes</a> I can&#39;t read that Medium link; does it need an account? Any change of pasting it into a Gist (even with formatting removed)?</p>\n", 
            "type": "Activities::Comment", 
            "id": 3153747, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-07T08:00:49.585Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-07T08:00:49.585Z", 
            "actor": {
                "username": "mikemcquaid", 
                "url": "/mikemcquaid", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/152/571/19c643787646cf38c93060b1438da81cdd216ec3_medium.jpg?1490086473"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "homebrew", 
            "message": "Got through now! Left a few comments that are open to discussion. Will post ours and can add a link to yours from ours when it's published.", 
            "markdown_message": "<p>Got through now! Left a few comments that are open to discussion. Will post ours and can add a link to yours from ours when it&#39;s published.</p>\n", 
            "type": "Activities::Comment", 
            "id": 3153872, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-07T09:10:30.454Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-07T09:10:30.454Z", 
            "actor": {
                "username": "mikemcquaid", 
                "url": "/mikemcquaid", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/152/571/19c643787646cf38c93060b1438da81cdd216ec3_medium.jpg?1490086473"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "homebrew", 
            "message": "The post is live now: https://brew.sh/2018/08/05/security-incident-disclosure/. Will happily edit in your name and post as desired when they are public. Thanks again for all your work.", 
            "markdown_message": "<p>The post is live now: <a title=\"https://brew.sh/2018/08/05/security-incident-disclosure/\" href=\"/redirect?signature=9489d0c0f39609b092ed131fbbeffcb86cdaa8ce&amp;url=https%3A%2F%2Fbrew.sh%2F2018%2F08%2F05%2Fsecurity-incident-disclosure%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://brew.sh/2018/08/05/security-incident-disclosure/</span><i class=\"icon-external-link\"></i></a>. Will happily edit in your name and post as desired when they are public. Thanks again for all your work.</p>\n", 
            "type": "Activities::Comment", 
            "id": 3154430, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-07T12:35:45.104Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-07T12:35:45.104Z", 
            "actor": {
                "username": "ejholmes", 
                "url": "/ejholmes", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/160/627/4c001d99a4e2370aaca64685e28117282d0679ea_medium.jpeg?1492641026"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "homebrew", 
            "message": "Awesome. I also published my blog post at https://medium.com/@vesirin/how-i-gained-commit-access-to-homebrew-in-30-minutes-2ae314df03ab. Thanks for your hard work (especially while on paternity leave)!", 
            "markdown_message": "<p>Awesome. I also published my blog post at <a title=\"https://medium.com/@vesirin/how-i-gained-commit-access-to-homebrew-in-30-minutes-2ae314df03ab\" href=\"/redirect?signature=ffaea215477ca2628c5736f0e566dbe5b4e07af9&amp;url=https%3A%2F%2Fmedium.com%2F%40vesirin%2Fhow-i-gained-commit-access-to-homebrew-in-30-minutes-2ae314df03ab\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://medium.com/@vesirin/how-i-gained-commit-access-to-homebrew-in-30-minutes-2ae314df03ab</span><i class=\"icon-external-link\"></i></a>. Thanks for your hard work (especially while on paternity leave)!</p>\n", 
            "type": "Activities::Comment", 
            "id": 3155359, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-07T13:11:20.779Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-07T13:11:20.779Z", 
            "actor": {
                "username": "mikemcquaid", 
                "url": "/mikemcquaid", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/152/571/19c643787646cf38c93060b1438da81cdd216ec3_medium.jpg?1490086473"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "homebrew", 
            "message": "Thanks again! Linking to it here: https://github.com/Homebrew/brew.sh/pull/238", 
            "markdown_message": "<p>Thanks again! Linking to it here: <a title=\"https://github.com/Homebrew/brew.sh/pull/238\" href=\"/redirect?signature=cd17a5529859f04a669da3eefcd625036e30067c&amp;url=https%3A%2F%2Fgithub.com%2FHomebrew%2Fbrew.sh%2Fpull%2F238\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://github.com/Homebrew/brew.sh/pull/238</span><i class=\"icon-external-link\"></i></a></p>\n", 
            "type": "Activities::Comment", 
            "id": 3155512, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-11T00:33:20.847Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-11T00:33:20.847Z", 
            "actor": {
                "username": "ejholmes", 
                "url": "/ejholmes", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/160/627/4c001d99a4e2370aaca64685e28117282d0679ea_medium.jpeg?1492641026"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "homebrew", 
            "first_to_agree": true, 
            "message": "Hey @mikemcquaid. Since this is public now, mind opening up this report as well?", 
            "markdown_message": "<p>Hey <a href=\"/mikemcquaid\">@mikemcquaid</a>. Since this is public now, mind opening up this report as well?</p>\n", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 3174536, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-11T13:57:57.918Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-11T13:57:57.918Z", 
            "actor": {
                "username": "mikemcquaid", 
                "url": "/mikemcquaid", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/152/571/19c643787646cf38c93060b1438da81cdd216ec3_medium.jpg?1490086473"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "homebrew", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 3177036, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-08-11T13:57:58.022Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-11T13:57:58.022Z", 
            "actor": {
                "username": "mikemcquaid", 
                "url": "/mikemcquaid", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/152/571/19c643787646cf38c93060b1438da81cdd216ec3_medium.jpg?1490086473"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "homebrew", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 3177037, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "ejholmes", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/ejholmes", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/160/627/08fb50014a551504a66a731a07353561aae6dc20_small.jpeg?1492641026"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 18, 
        "name": "Information Disclosure"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -7595083.144103895, 
    "disclosed_at": "2018-08-11T13:57:57.996Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/388740", 
    "created_at": "2018-07-31T05:47:18.646Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>Hello!</p>\n\n<p>While browsing through some old reports, I found that <a title=\"https://jenkins.brew.sh\" href=\"/redirect?signature=80a65ccab38416dc7a25aac81fae82d58e794e56&amp;url=https%3A%2F%2Fjenkins.brew.sh\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://jenkins.brew.sh</span><i class=\"icon-external-link\"></i></a> was publicly accessible. I got curious when I saw one of the <a href=\"/redirect?signature=a19258a4cd3dc4b95adf66ca0f00370d881808db&amp;url=https%3A%2F%2Fjenkins.brew.sh%2Fjob%2FHomebrew%2520Bottles%2F33255%2Fconsole\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>brew bottle builds</span><i class=\"icon-external-link\"></i></a> doing a <code>git push</code> to BrewTestBot/homebrew-core, and wondered if the credentials to make authenticated pushes were accessible.</p>\n\n<p>Sure enough, you can view environment variables for the build on <a href=\"/redirect?signature=3f8b4a229f40e68b13c688a5dd5cb7afb395f6a4&amp;url=https%3A%2F%2Fjenkins.brew.sh%2Fjob%2FHomebrew%2520Bottles%2F33255%2FinjectedEnvVars%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>this page</span><i class=\"icon-external-link\"></i></a>, which includes a <code>HOMEBREW_GITHUB_API_TOKEN</code> environment variable.</p>\n\n<p>This API token belongs to the <a href=\"/redirect?signature=2bfbca4ed8093e3d59a6bf850d4a302eb190a4b5&amp;url=https%3A%2F%2Fgithub.com%2FBrewTestBot\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>BrewTestBot</span><i class=\"icon-external-link\"></i></a> user on GitHub, and this API key allows me to commit to the <code>BrewTestBot/homebrew-core</code> repository:</p>\n<pre class=\"highlight plaintext\"><code>$ export GITHUB_API_TOKEN=&lt;github token from above&gt;\n$ curl https://api.github.com/repos/BrewTestBot/homebrew-core/git/blobs -u $GITHUB_API_TOKEN:x-oauth-basic -d &#39;{&quot;content&quot;:&quot;test&quot;}&#39; -H &quot;Content-Type: application/json&quot;\n{\n  &quot;sha&quot;: &quot;30d74d258442c7c65512eafab474568dd706c430&quot;,\n  &quot;url&quot;: &quot;https://api.github.com/repos/BrewTestBot/homebrew-core/git/blobs/30d74d258442c7c65512eafab474568dd706c430&quot;\n}\n</code></pre>\n<h2 id=\"impact\">Impact</h2>\n\n<p>Based on the purpose of <code>BrewTestBot</code>, this might be entirely intended, but if the GitHub access token has overly permissive scopes, it might be usable to perform other actions, aside from a <code>git push</code>. In that case, an SSH deploy key may be better, and less permissive.</p>\n\n<p>If exposing this API key publicly is intended behavior, please feel free to close this.</p>\n", 
    "severity_rating": "critical", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://brew.sh", 
            "about": "The missing package manager for macOS", 
            "twitter_handle": "MacHomebrew", 
            "name": "Homebrew"
        }, 
        "handle": "homebrew", 
        "url": "https://hackerone.com/homebrew", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/019/399/434efa55879ea157beff4ca2b39926fc956e9910_small.png?1490086416", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/019/399/b8a645b36e10de501cda718c1184aaab63a11cf3_medium.png?1490086416"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 19399, 
        "default_currency": "usd"
    }, 
    "is_published": false
}